<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Hero's Tale Engine - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Forge of Code</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Hero&#39;s Tale Engine</h1>
<hr>
<p>In the heart of Codara, the Kingdom&#39;s legendary Forge continues to churn with unbridled magic, empowering heroes to craft their tales of valor. The mythical Hero&#39;s Tale Engine is at the heart of this enchantment, imbuing quests with purpose and shaping challenges with its boundless creativity. In this chapter, your task is to uncover the inner workings of the Hero&#39;s Tale Engine, deciphering its patterns, and unearthing its ancient magic. The Forge must sing with precision‚Äîevery line of the enchanted code must harmonize to bring Codara&#39;s quests to life. Only with that understanding can the greatest of sagas be created!  </p>
<p><strong>The Tale Beckons!</strong> Dive into the arcane mysteries of adventure management, quest generation, and the spellbound logic that binds them.  </p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:  </p>
<ul>
<li>üîç <strong>The Magic of Initialization</strong>: How are project context, theme, and adventures prepared when a new journey begins?  </li>
<li>‚ö° <strong>Channeling the Quest</strong>: What mechanisms bind user choices to the execution of specific quests?  </li>
<li>üõ°Ô∏è <strong>Enshrining Consistency</strong>: How does the system validate inputs, manage progress, and ensure quests enforce their rules?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span></h3>
<p>The <code class="inline-code">AdventureManager</code> is the beating heart of the codebase‚Äôs hero orchestration. In this file, the grand systems for adventure initialization, user interactions, and quest execution are forged. The code choreographs how input is validated, quests are completed, and progress is updated as a hero‚Äôs tale progresses.  </p>
<h4><span class="header-prefix">Highlights:</span></h4>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Crafts the entire adventure by synchronizing projects, themes, and quest creation. It bears the mantle of the first invocation, shaping the coding odyssey.  </li>
<li><code class="inline-code">exploreQuest</code>: Guides the adventurer to the correct quest, using validation to accept input and determining quest parameters.  </li>
<li><code class="inline-code">get progressPercentage</code>: Governs the formula for progress updates, offering transparency on the hero‚Äôs journey.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  // Reset state for new adventure
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  // Set custom theme data if provided
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  // Generate the overall story and quests using LLM
  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;
  
  // Merge files from adventure config into the generated quests
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  
  // Enforce quest count from adventure.config.json if it exists
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  // Return the story with available quests
  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<ul>
<li><p><strong>What it does</strong>:<br>Initializes a new adventure by preparing project information, setting the theme, and generating quests through the <code class="inline-code">StoryGenerator</code>.  </p>
</li>
<li><p><strong>Techniques used</strong>:<br>Utilizes <code class="inline-code">state</code> resets, conditional checks for custom themes, and invokes downstream generators to create a dynamic narrative ecosystem.  </p>
</li>
<li><p><strong>Importance</strong>:<br>Serves as the entry to creating new narratives, ensuring thematic relevance and syncing with external configurations.</p>
</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  
  // Check if this is a progress request
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }
  
  // Find the quest based on the choice
  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  // Execute the quest
  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li><p><strong>What it does</strong>:<br>Handles user-selected choices, differentiates progress updates from requests to execute a specific quest, and connects choices to their respective quest mechanics.  </p>
</li>
<li><p><strong>Techniques used</strong>:<br>Employs input validation (<code class="inline-code">validateAndSanitizeChoice</code>) and modular private methods to maintain clean behavior separation.  </p>
</li>
<li><p><strong>Importance</strong>:<br>The bridge between user input and system flow, ensuring choices are actionable and errors are gracefully managed.</p>
</li>
</ul>
<hr>
<pre><code class="language-typescript">get progressPercentage(): number {
  return this.quests.length &gt; 0 
    ? Math.round((this.completedQuests.size / this.quests.length) * 100)
    : 0;
}
</code></pre>
<ul>
<li><p><strong>What it does</strong>:<br>Calculates the hero‚Äôs progress as a percentage of the total quests completed.  </p>
</li>
<li><p><strong>Techniques used</strong>:<br>A simple mathematical operation leveraging object sizing for clarity, heavily dependent on quest state structure.  </p>
</li>
<li><p><strong>Importance</strong>:<br>Provides transparency in navigation and serves as a motivator for adventurers to complete their coding journey.</p>
</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Guiding Exploration</strong>: Consider how <code class="inline-code">initializeAdventure</code> structures the narrative and coding focus before looking at quest validation deeper in the file.  </li>
<li><strong>Valid Input Paths</strong>: Trace how validation guards in <code class="inline-code">exploreQuest</code> prevent invalid inputs from derailing progress.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>With the celestial quill inked in triumph and the Hero&#39;s Tale Engine forged anew, your first quest ignites the path to legendary glory‚Äîonward to conquer the mythical scrolls of destiny! ‚ö°üíéüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>