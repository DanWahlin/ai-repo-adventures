<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Taleweaver and the Questing Scrolls - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'mythical' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Enchanted Realm of Aetherium: Chronicles of the Codebound</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Taleweaver and the Questing Scrolls</h1>
<hr>
<p>Within the towering halls of the Codebound Citadel lies an ancient repository known as the Taleweaver Archives. Here, the enchanted scrolls whisper their secrets, waiting to be unlocked by those daring enough to embark on a quest. Summoned by the pulsating heart of the Lyrical Logician Matrix, you must confront the mystic challenge of aligning structured lore with the vibrant forces of coding sorcery. Guided by the Repomix Grimoire, you shall weave a tapestry from the threads of knowledge scattered throughout the enchanted files. Take heart, bold adventurer, for the Taleweaver Archives are full of discovery and peril alike!</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure orchestration managing state, themes, and user interactions</h3>
<p>The file <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a> serves as the magical hub for orchestrating tales within the Codebound Citadel. Acting as the spellbinding conductor, the <code class="inline-code">AdventureManager</code> class maintains the harmony of quest generation, user interaction, and progress tracking. Central to its prowess is the <code class="inline-code">initializeAdventure()</code> method, which sets the stage for each adventure by drawing upon project context, theme enchantments, and the pulsating energies of the Lyrical Logician Matrix. Like a wizard crafting an intricate potion, it blends Repomix content and guidance from <code class="inline-code">adventure.config.json</code>, fostering quests that evoke both peril and wonder. Meanwhile, <code class="inline-code">exploreQuest()</code> acts as the guiding hand for adventurers, breathing life into selected challenges, validating choices, and weaving quest content from structured lore. Notably, the file conjures many useful utilities, such as <code class="inline-code">markQuestCompleted()</code> for tracking triumphs and <code class="inline-code">getProgress()</code> for revealing progress in the grand endeavor.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">AdventureManager.initializeAdventure()</code> integrates multiple magical components like themes, quests, and configs into cohesive adventure setups.</li>
<li><code class="inline-code">exploreQuest()</code> validates choices and dispatches quests with precision and flair.</li>
<li><code class="inline-code">AdventureState.progressPercentage</code> calculates the completion journey, inspiring adventurers onward.</li>
<li><code class="inline-code">generateCompletionSummary()</code> casts spells to summarize the hero’s tale for each quest.</li>
<li><code class="inline-code">validateAdventureChoice()</code> ensures adventurers stay true to the tale’s path.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/adventure/story-generator.ts:</span> LLM-powered story creation with theme-based narratives and prompt engineering</h3>
<p>The file <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/story-generator.ts</code></a> is akin to the Taleweaver’s wand, wielding the enchanted power of Large Language Models to craft intricate tales and vibrant quests tailored to each explorer. It all begins with the <code class="inline-code">generateStoryAndQuests()</code> method, which conjures a complete narrative map based on the chosen theme. This spell invokes the Repomix content and transforms mundane project information into mythical adventures brimming with character and mystique. Meanwhile, the <code class="inline-code">generateQuestContent()</code> method dives deeper into the scrolls, extracting detailed insights and weaving meticulous tasks that immerse the adventurer in the code’s uncharted realms. Supporting these efforts is the <code class="inline-code">buildStoryGenerationPrompt()</code>, which constructs a precise spell for the LLM’s incantation, ensuring every tale adheres to its mythical foundations. Whether creating quests or offering completion summaries through <code class="inline-code">generateCompletionSummary()</code>, this file is the repository’s bard, echoing its magic loud and clear.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateStoryAndQuests()</code> transforms structured code files into legendary adventures and thematic realms.</li>
<li><code class="inline-code">generateQuestContent()</code> crafts detailed explorations of specific files with tailored content.</li>
<li><code class="inline-code">buildStoryGenerationPrompt()</code> shapes magical prompts to ensure the narrative’s integrity.</li>
<li><code class="inline-code">removeLLMMetaCommentary()</code> cleanses the returned magic of unintended echoes and distractions.</li>
<li><code class="inline-code">generateCompletionSummary()</code> offers poetic reflections on a quest’s significance.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration system for guided adventures that enhance story generation</h3>
<p>The file <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a> acts as the Tome of Guidance, steering adventurers through structured narratives as dictated by <code class="inline-code">adventure.config.json</code>. Within its chapters lies the <code class="inline-code">parseAdventureConfig()</code> function, which reads and validates the texts of configuration, thereby preserving quest integrity. Complementing this power is <code class="inline-code">extractUniqueFilePaths()</code>, a spell that traverses the mystical references contained within the configuration, ensuring only valid paths are drawn into the treasure map for discovery. Through the artistry of <code class="inline-code">formatAdventureConfigForPrompt()</code>, the file curates structured prompts that guide the storytelling spells of the LLM, enforcing consistent analysis sections and illuminating key files for exploration. It serves as an unsung ally to the Taleweaver, facilitating the alignment of legendary workshops with raw code lore.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig()</code> uncovers and validates the ancient texts from <code class="inline-code">adventure.config.json</code>.</li>
<li><code class="inline-code">extractUniqueFilePaths()</code> focuses on authentic paths, preventing disturbances in repository exploration.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code> curates text into structured prompts for story and quest generation.</li>
<li>Ensures consistent formatting guidelines for Repomix-based adventures.</li>
<li>Bridges practical configuration with thematic narratives effortlessly.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  // Reset state for new adventure
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  // Set custom theme data if provided
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  // Generate the overall story and quests using LLM
  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = typeof storyResponse.story === &#39;string&#39; ? storyResponse.story : storyResponse.story.content;

  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);
  
  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<p>This method is like a master chef blending ingredients to create a feast—each element contributes to crafting an adventure worthy of legend.</p>
<h3>packages/core/src/adventure/story-generator.ts</h3>
<pre><code class="language-typescript">async generateStoryAndQuests(projectInfo: ProjectInfo, theme: AdventureTheme, projectPath?: string): Promise&lt;StoryResponse&gt; {
  this.currentProject = projectInfo;
  this.projectPath = projectPath;
  
  const validatedTheme = this.validateTheme(theme);
  return await this.generateWithLLM(projectInfo, validatedTheme);
}
</code></pre>
<p>This function mirrors a sorcerer summoning a map of destiny—each project becomes a mythical domain echoed through coded tales.</p>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure Guidelines\n\n`;
  formatted += `**CRITICAL: Each quest MUST include dedicated file analysis sections**\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    formatted += `${quest.description}\n\n`;
    formatted += `**Required File Analysis Sections:**\n`;

    for (const file of quest.files) {
      if (!file.path || !file.description) continue;

      formatted += `\n**File: \`${file.path}\`**\n`;
      formatted += `- Description: ${file.description}\n`;

      if (Array.isArray(file.highlights)) {
        formatted += `- Key Functions/Areas to Highlight:\n`;
        for (const highlight of file.highlights) {
          if (highlight.name &amp;&amp; highlight.description) {
            formatted += `  • **${highlight.name}**: ${highlight.description}\n`;
          }
        }
      }
    }
    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<p>This code is akin to a scribe meticulously crafting instructions for adventurers—its clarity ensures quests unfold with purpose and precision.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Ensure every quest adheres to the structure described in <code class="inline-code">adventure.config.json</code> for seamless storytelling.</li>
<li>Dive deeper into <code class="inline-code">generateCompletionSummary()</code> to optimize reflection points in quests for participants.</li>
<li>Next, explore file-specific highlights to offer immersive workshop-style adventures through targeted code exploration.</li>
</ul>
<hr>
<p>Huzzah, valiant seeker! By unraveling the arcane mysteries of Quest 2, &quot;The Taleweaver and the Questing Scrolls,&quot; you have etched your mark upon the stars of destiny—20% closer to conquering the fabled Pentad of Wisdom! ⭐💎⚡</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: The Grimoire of Insight →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>