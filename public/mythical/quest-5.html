<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Ever-Shifting Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Chronicles of the Codebase</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Ever-Shifting Themes</h1>
<hr>
<p>In the magical realm of Codethia, you have traversed through kingdoms and battled challenges tied to mystic spells, enchanted knights, and ancient treasures. As the castle of Codebase trembles with power from its artifacts, a final trial above all stands between you and eternal mastery: an adventure into the enigmatic &quot;Ever-Shifting Themes.&quot; Codethia‚Äôs survival relies on theme allocation spells, binding knights to adventures. Delve into the ever-turning engine of theme definitions, validations, and enchantments. Will you uncover the secrets?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:  </p>
<ul>
<li>üîç <strong>Spell Correspondences</strong>: How does the <code class="inline-code">parseTheme</code> function align theme inputs with the enchanted <code class="inline-code">THEMES</code> registry, and what magic is used for validation?  </li>
<li>‚ö° <strong>Artifact Discovery</strong>: How are theme icons created dynamically in the <code class="inline-code">ThemeManager.getThemeIcons</code> function, and how does the artifact they call upon connect to the broader <code class="inline-code">ThemeDefinition</code>?  </li>
<li>üõ°Ô∏è <strong>Thematic Guards</strong>: What safeguards ensure input integrity throughout <code class="inline-code">validateTheme</code> and <code class="inline-code">validateAdventureChoice</code>, and how does this foundation protect Codethia‚Äôs castle from mischief?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/theme.ts</h3>
<p>Central to Codethia&#39;s spell arsenal, this file defines the enchanted themes that underpin the adventures. Each adventure aligns with a <code class="inline-code">ThemeDefinition</code> composed of properties such as mystical identifiers and descriptive charms. This file further equips knights with tools like <code class="inline-code">isValidTheme</code> for verifying the enchantment‚Äôs authenticity and <code class="inline-code">parseTheme</code> for deciphering user-supplied incantations.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseTheme</code>: Matches input to the <code class="inline-code">THEMES</code> artifact using a multi-step validation process of direct matching, numeric ID parsing, and keyword checks.  </li>
<li><code class="inline-code">isValidTheme</code>: Confirms if a spell input corresponds to a valid theme, preventing meddling with Codethia&#39;s core energies.  </li>
<li><code class="inline-code">getFormattedThemeOptions</code>: Lists all themes alongside their mystical properties for display, enabling knights to choose wisely.</li>
</ul>
<h2>Code</h2>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Works through multiple enchantment matrices, prioritizing exact matches before deeper explorations.  </li>
<li>Prevents malformed input from summoning chaos by only returning themes explicitly defined in <code class="inline-code">THEMES</code>.  </li>
<li>Supports versatile inputs by accepting IDs, names, and keywords.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>Fortifies the kingdom by returning true only when a theme is valid, establishing a protective layer.  </li>
<li>Allows easy integration into other spells, reinforcing reliability in the <code class="inline-code">Theme</code> artifact.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getFormattedThemeOptions(): string {
  return getAllThemes()
    .sort((a, b) =&gt; a.id - b.id)
    .map(formatThemeOption)
    .join(&#39;\n&#39;);
}
</code></pre>
<ul>
<li>Prepares a knight&#39;s battleground of choices via consistent, sorted displays.  </li>
<li>Grants knights clear guidance on selecting paths using accessible properties like <code class="inline-code">id</code> and <code class="inline-code">emoji</code>.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> packages/generator/src/cli/theme-manager.ts</h3>
<p>This file governs the ThemeForge, where knights wield spells to manage theme configurations. From icons to gathered CSS, the <code class="inline-code">ThemeManager</code> class empowers knights to impose visual cohesion across all adventures.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getThemeIcons</code>: Dynamically supplies a knight‚Äôs theme-based icons, ensuring thematic consistency in Codethia‚Äôs enchanted realms.  </li>
<li><code class="inline-code">generateThemeCSS</code>: Weaves together specific CSS scrolls for adventures, joining base coding spells to theme-specific enhancements.  </li>
<li><code class="inline-code">isLightTheme</code>: Detects spectral lightness and demands darker sigils (e.g., logos), customizing output for each kingdom.</li>
</ul>
<h2>Code</h2>
<h3><span class="header-prefix">File:</span> packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">getThemeIcons(theme: AdventureTheme): { theme: string; quest: string } {
  const themeIcons = {
    space: { theme: &#39;üöÄ&#39;, quest: &#39;‚≠ê&#39; },
    mythical: { theme: &#39;üè∞&#39;, quest: &#39;‚öîÔ∏è&#39; },
    ancient: { theme: &#39;üè∫&#39;, quest: &#39;üìú&#39; },
    developer: { theme: &#39;üíª&#39;, quest: &#39;üîß&#39; },
    custom: { theme: &#39;üé®&#39;, quest: &#39;‚≠ê&#39; }
  };

  return (themeIcons as any)[theme] || themeIcons.space;
}
</code></pre>
<ul>
<li>Provides knights with visually matching icons for their quests.  </li>
<li>Fosters adventure branding within enchanted interfaces.  </li>
<li>Defaults effortlessly to the <code class="inline-code">space</code> icon when variations are absent.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/input-validator.ts</h3>
<p>This file safeguards Codethia‚Äôs core from corrupted spell inputs. The <code class="inline-code">InputValidator</code> ensures all magical scrolls are coherent before use.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures an adventure selection&#39;s validity, preserving the kingdom&#39;s integrity.  </li>
<li><code class="inline-code">validateTheme</code>: Confirms a chosen theme exists and meets criteria, protecting application flow.  </li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleanses lore outputs of potentially harmful tokens.</li>
</ul>
<h2>Code</h2>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Blocks invalid themes from entering the castle gates.  </li>
<li>Calls upon both <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> to unite their defenses.  </li>
<li>Offers clear error handling to guide knights during improper inputs.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Renders potentially dangerous tokens inactive to prevent attacks in Codethia.  </li>
<li>Maintains efficiency with regex-fueled logic‚Äîfast and lightweight.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>To explore inputs‚Äô path through the castle, trace enchanted hand-offs between <code class="inline-code">validateTheme</code> and <code class="inline-code">parseTheme</code>.  </li>
<li>Experiment with different inputs like &quot;magic&quot;, &quot;ancient&quot;, and &quot;123&quot; to see theme-parsing spells in action.  </li>
<li>Ensure you test <code class="inline-code">getThemeIcons</code> against multiple themes to encompass its versatility and defaults.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Codethia&#39;s magical realm! Your adventure is complete.</p>
<p>By the glowing aurora of the celestial phoenix and under the watchful gaze of the astral guardians, your mastery of Quest 5: The Ever-Shifting Themes shines like a champion&#39;s blade, heralding your triumphant march towards final glory‚Äîbrave hero, onward to destiny!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>