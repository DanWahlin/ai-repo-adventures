<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Foundation of Heroes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Repository Chronicles</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Foundation of Heroes</h1>
<hr>
<p>Amidst the labyrinthine halls of the Kingdom of Reposithia lies the Foundation, a sanctum where the essence of quests is forged. Here, the crystalline scrolls hold the blueprints for each heroic endeavor‚Äîbeacons for adventurers far and wide. In this chapter, you are summoned to the ‚ÄúFoundation of Heroes,‚Äù where you will inquire into the sacred spells and formulas that bind the grand adventures into existence. Seek clarity in how the kingdom‚Äôs sacred texts ensure balance, extract purpose, and preserve tales for generations.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Pathfinder‚Äôs Eye</strong>: How does <code class="inline-code">extractUniqueFilePaths</code> traverse the configuration to map out file paths? What methods ensure validity and uniqueness?</li>
<li>‚ö° <strong>The Alchemist‚Äôs Glyphs</strong>: What role does <code class="inline-code">formatAdventureConfigForPrompt</code> play in distilling the raw quest data, and how does it optimize the output for magical comprehension?</li>
<li>üõ°Ô∏è <strong>The Tomekeeper‚Äôs Safeguard</strong>: How does <code class="inline-code">parseAdventureConfig</code> manage risks during parsing? What safeguards are in place for corrupted or missing configurations?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Foundation of Quest Handling</h3>
<p>This file contains the mystical scripts used to manage and process adventure configurations. It reads, parses, and refines configuration files, ensuring adventurers encounter no broken paths. Key elements include robust error handling during JSON parsing (<code class="inline-code">parseAdventureConfig</code>), recursive file path extraction with validation (<code class="inline-code">extractUniqueFilePaths</code>), and the transformative processing of quest data into a performant and reduced format suitable for guiding LLMs (<code class="inline-code">formatAdventureConfigForPrompt</code>).</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Parses JSON while ensuring errors or missing configuration files don‚Äôt disrupt flow.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Recursively scans the adventure configuration, validating file paths and deduplicating entries.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Transforms and optimizes quest configuration data into a compact format designed for magic-ready comprehension.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>The <code class="inline-code">parseAdventureConfig</code> acts as a watchful sentry, ensuring corrupted or absent scrolls (configuration files) do not halt the quest.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<p>The <code class="inline-code">extractUniqueFilePaths</code> is a mystical cartographer, charting a clean and validated map of all referenced file paths within the enchanted configuration.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    const filePaths = quest.files
      .filter((f: any) =&gt; f.path)
      .map((f: any) =&gt; f.path);
    if (filePaths.length &gt; 0) {
      formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    }

    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .filter((h: any) =&gt; h.name)
      .map((h: any) =&gt; h.name);
    if (functions.length &gt; 0) {
      formatted += `Functions: ${functions.join(&#39;, &#39;)}\n`;
    }

    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<p>The <code class="inline-code">formatAdventureConfigForPrompt</code> is an alchemical process, refining the raw data into an optimal size and structure to invoke the most potent results from magical LLMs.</p>
<h2>Helpful Hints</h2>
<ul>
<li>When delving into <code class="inline-code">extractUniqueFilePaths</code>, focus on the recursive pattern‚Äînote the use of a stack to traverse nested structures.</li>
<li>Pay attention to <code class="inline-code">formatAdventureConfigForPrompt</code>‚Äôs reduction steps. Observe how it prioritizes essential fields while discarding unnecessary details.</li>
<li>Consider how error handling in <code class="inline-code">parseAdventureConfig</code> keeps the foundational spells stable, even if input data is flawed.</li>
</ul>
<hr>
<p>Your heroic understanding grows as the Foundation‚Äôs secrets unfurl before your eyes. Every snippet read is another step in your journey to mastery. Adventure onward!</p>
<p>With the radiant glow of the Celestial Forge upon you, your heroic mastery in &quot;Quest 5: The Foundation of Heroes&quot; has fortified the pillars of the kingdom‚Äôs destiny‚Äîpress onward, champion of the stars! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>