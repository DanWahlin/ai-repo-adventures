<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Mystic Utilities of Adventura - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Realm of Codaria</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Mystic Utilities of Adventura</h1>
<hr>
<p>In the land of Codaria, knights and wizards have long used ancient spells to protect the kingdom, yet the true power lies hidden within the arcane systems that connect these spells. Deep beneath Castle Configura, the foundation and utilities of the mystical realm await your exploration. The tools of utility‚Äîrarely seen yet indispensable‚Äîcarry the soul of function and the spirit of adaptability. Brave adventurer, to master these utilities is to master the flow of Codaria itself. Heed the call, for here lies the final piece of wisdom to defeat the Chaos Bug.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Pathfinding the Forgotten Paths</strong>: How are valid file paths identified and extracted from a potentially recursive configuration object?</li>
<li>‚ö° <strong>Deciphering the Mystic Scrolls</strong>: What strategies are employed to efficiently parse and format configuration data, ensuring it aligns with the mystical theme of the quests?</li>
<li>üõ°Ô∏è <strong>Guarding the Portal</strong>: How does the code gracefully handle invalid or missing data during critical file and configuration operations?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Treasure Chest of Core Utilities</h3>
<p>This file is home to the foundational magic that governs Codaria‚Äôs configuration system. It provides the tools to manage the &quot;adventure.config.json&quot;, which is the magical scroll holding vital kingdom secrets. The functions here focus on reading and interpreting this scroll, ensuring the adventurers have concise information to navigate their quests without losing their way. The highlights include mechanisms to extract file paths, handle faulty or missing data, and format structures for downstream consumption. Together, these components weave the support structure of Codaria&#39;s questing system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Unlocks the knowledge within the adventure configuration, ensuring the values are safe and comprehensible even in the face of errors.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Diligently traverses through the configuration, identifying valid paths and ensuring no magical routes are overlooked.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: A spell that condenses complex configuration details into an efficient, readable summary for quests, optimizing it while maintaining thematic guidelines.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>This function deciphers the raw configuration scroll (<code class="inline-code">adventure.config.json</code>), reading and parsing it into an object.</li>
<li>Error handling ensures that even if an incomprehensible scroll is encountered, no catastrophic failure occurs.</li>
<li>Demonstrates a single responsibility principle: this function solely parses data without concern for structure or validation.</li>
<li>A robust fallback mechanism guards against cases like missing files or malformed JSON.</li>
<li>This function connects seamlessly to downstream utilities, simplifying their tasks by providing structured data.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>This function scours the configuration object recursively to extract all valid paths.</li>
<li>Its validation checks ensure only existing paths are extracted, eliminating errors downstream.</li>
<li>Uses a depth-first traversal technique with a stack, enabling it to handle deeply nested structures.</li>
<li>The use of a <code class="inline-code">Set</code> guarantees that no path is added twice, maintaining the uniqueness of results.</li>
<li>Illustrates adaptability, as it works with diverse configuration structures, ensuring no essential paths are missed.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>This function prepares a magical scroll that summarizes the quest structure, optimized for comprehension and brevity.</li>
<li>Focuses on essential details‚Äîtitles, file paths, and function names‚Äîeliminating unnecessary verbose descriptions.</li>
<li>Combines multiple data elements into a coherent structure, emphasizing clarity for downstream consumers.</li>
<li>Demonstrates pattern recognition by iterating over quests and extracting relevant details in a uniform manner.</li>
<li>This provides an intuitive overview for adventurers, mirroring how wizards create efficient magical incantations.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>When working with nested configurations, always verify the structure to avoid null references‚Äîas showcased in <code class="inline-code">extractUniqueFilePaths</code>.</li>
<li>Utilize utility functions like <code class="inline-code">parseAdventureConfig</code> to centralize common error handling and reduce repetitive code.</li>
<li>By observing <code class="inline-code">formatAdventureConfigForPrompt</code>, learn the importance of optimizing data formats for specific downstream use cases.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Codaria! Chaos Bug lies defeated, and peace is restored to the realm. The kingdom shall forever remember your heroic deeds. Your adventure is complete.</p>
<p>By the radiant light of the Eternal Beacon, you have unraveled the arcane mysteries of Quest 5: The Mystic Utilities of Adventura‚Äînoble champion, your valor gleams like a forged star, propelling you ever closer to immortal glory! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>