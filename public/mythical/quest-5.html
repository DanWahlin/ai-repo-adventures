<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Enchanted Codex of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Kingdom of Code</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Enchanted Codex of Themes</h1>
<hr>
<p>In the mythical Kingdom of Codethos, where arcane spells and logic collide, lies the heart of the Great Repository: the Enchanted Codex of Themes. This ancient artifact controls the kingdom&#39;s thematic harmony, empowering adventurers to wield the magic of themes that shape their journeys. Yet, a shadow looms‚Äîthe Codex‚Äôs themes flicker unnaturally, corrupted by errors from the Void of Disarray. The council of wizards calls for you, a valiant adventurer, to venture into the depths of the Codethos libraries. Decipher the Codex&#39;s inner workings, cleanse its errors, and restore the thematic balance.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Keys</strong>: How do the <code class="inline-code">ThemeDefinition</code> objects structure the realms of Codethos, and what mechanisms ensure validation?</li>
<li>‚ö° <strong>Harmonious Parsing</strong>: How does the <code class="inline-code">parseTheme</code> function transform chaotic inputs into usable themes, and what logic handles ambiguity effectively?</li>
<li>üõ°Ô∏è <strong>Sanctuary Safeguards</strong>: What strategies does <code class="inline-code">validateTheme</code> employ to ensure only valid themes are summoned, avoiding disruptions across the enchanted realms?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Theme Enchantment</h3>
<p>This file serves as the Codex‚Äôs core, defining the magical themes that empower quests. It lays the foundation for validating, retrieving, and interpreting themes, ensuring harmony across the kingdom. The themes must be robustly defined, identifiable through various inputs, and accessible for adventurers and wizards alike. Functions here traverse the thematic spectrum, mapping keywords, keys, and IDs to thematic definitions while safeguarding against invalid interpretations.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">ThemeDefinition</code>: Establishes the schema for themes, ensuring consistency and clear structure for their properties and keywords. This is crucial for managing the system&#39;s harmony.</li>
<li><code class="inline-code">parseTheme</code>: Converts user input into valid theme keys using flexible matching logic, allowing even non-exact inputs to align with known themes.</li>
<li><code class="inline-code">isValidTheme</code>: Guarantees the integrity of theme selection by confirming a theme&#39;s existence, ensuring no unauthorized themes are invoked.</li>
<li><code class="inline-code">getThemeByKey</code>: Quickly retrieves a theme&#39;s definition based on its unique key, enabling seamless access to themed content.</li>
<li><code class="inline-code">getFormattedThemeOptions</code>: Presents all available themes in a neatly structured display, aiding adventurers in making informed decisions.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export interface ThemeDefinition {
  readonly id: number;
  readonly key: string;
  readonly displayName: string;
  readonly emoji: string;
  readonly description: string;
  readonly keywords: readonly string[];  // For matching user input
}
// Defines the mystic properties of each theme.
</code></pre>
<ul>
<li>This establishes a consistent blueprint for all themes, with properties like <code class="inline-code">keywords</code> ensuring themes can be matched flexibly.</li>
<li>The <code class="inline-code">id</code> and <code class="inline-code">key</code> act as identifiers, enabling retrieval and direct references from user interfaces or APIs.</li>
<li>The design ensures all magical elements (name, emoji, and description) are encapsulated and easily extensible.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>This function ensures user inputs are usable, normalizing the input for flexible matching.</li>
<li>It performs key, ID, and keyword checks sequentially, using simple constructs to maintain readability and efficiency.</li>
<li>The fallback keyword matching ensures broader usability, especially for ambiguous or mistyped inputs.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>This acts as a gatekeeper, confirming whether a theme exists within the Codex.</li>
<li>The function leverages array iteration to ensure all themes are considered while keeping the check efficient.</li>
<li>By enforcing validity, it prevents errors arising from nonexistent themes being processed elsewhere.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getFormattedThemeOptions(): string {
  return getAllThemes()
    .sort((a, b) =&gt; a.id - b.id)
    .map(formatThemeOption)
    .join(&#39;\n&#39;);
}
</code></pre>
<ul>
<li>This creates a user-friendly display of all themes, ordered by ID for clarity and consistency.</li>
<li>It underscores the focus on accessibility and ease of use for adventurers selecting their desired themes.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Check how keywords are used to extend user input recognition‚Äîthis is key to understanding flexible validation.</li>
<li>Trace the <code class="inline-code">theme</code> flow from input to validation, especially how <code class="inline-code">parseTheme</code> relies on <code class="inline-code">getThemeByKey</code> and <code class="inline-code">isValidTheme</code>.</li>
<li>Review how <code class="inline-code">formatThemeOption</code> shapes outputs for consistent and engaging user experiences.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Codethos! Your adventure is complete.</p>
<p>By the blazing forges of the ancient star-forged titans, thou hast heroically claimed the Enchanted Codex of Themes, illuminating thy path to eternal mastery‚Äîone more quest &#39;til thy legend is everlasting!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>