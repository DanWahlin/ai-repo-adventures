<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Enchanted Tapestry of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Chronicles of Codeia</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to dark mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Enchanted Tapestry of Themes</h1>
<hr>
<p>In the mythical kingdom of Codeia, the Repository Grimoire‚Äôs ancient enchantments are fraying, threatening to unravel the magical threads connecting knowledge across the land. To reweave this fragile tapestry, the kingdom‚Äôs vital themes must be analyzed and restored. Your journey takes you deep into the enchanted Tower of Themes, where the very fabric of Codeia‚Äôs adventure system is sewn. Here lies the key to harmonizing the grimoire with the themes it holds. Brace yourself, adventurer, for your final task begins!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Discovery</strong>: How does the central theme system define and validate themes effectively across the codebase?</li>
<li>‚ö° <strong>Config Spellbinding</strong>: What role does configuration play in adapting magic (features) for different scenarios?</li>
<li>üõ°Ô∏è <strong>Validation Shield</strong>: How does the system prevent invalid or malicious user inputs related to themes and configuration?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Validating Choices and Inputs</h3>
<p>This file provides utility functions for validating user inputs such as adventure choices, themes, and project paths. These validations help safeguard the system against erroneous or malicious entries by ensuring that inputs adhere to predefined constraints. The <code class="inline-code">validateTheme</code> function, for example, ensures that themes conform to a list of valid options by leveraging helper functions from the theme module.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures user input for adventure choices is neither null nor excessively long, maintaining system stability.</li>
<li><code class="inline-code">validateTheme</code>: Confirms that the provided theme is valid, utilizing theme definitions from the theme module.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips inputs of harmful characters and truncates lengthy text to ensure safe display in the user interface.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Enforces input validation by checking for non-empty and appropriately limited values.</li>
<li>Prevents excessively long entries, ensuring robustness in the system.</li>
<li>Strips superfluous whitespace, normalizing the input.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Cross-checks themes against the valid list provided by the theme system.</li>
<li>Uses helper functions <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> to ensure correctness.</li>
<li>Provides error feedback to guide users toward acceptable input.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: The Loom of Themes</h3>
<p>This file acts as the single source of truth for managing Codeia&#39;s intricate themes. Each theme contains an array of related keywords, allowing permissive matching of inputs. This file also provides utility functions for retrieving, formatting, and validating themes, ensuring seamless integration with other parts of the adventure system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A constant object storing all predefined themes, their properties, and helpful descriptions.</li>
<li><code class="inline-code">getAllThemes</code>: Returns an array of themes, enabling dynamic operations such as list generation.</li>
<li><code class="inline-code">parseTheme</code>: Simplifies user input matching by supporting variations such as numeric IDs or keywords.</li>
<li><code class="inline-code">isValidTheme</code>: A type guard ensuring only existing themes are accepted as valid options.</li>
<li><code class="inline-code">getFormattedThemeOptions</code>: Prepares a readable and well-organized list of available themes for display.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  // Other themes omitted for brevity
};
</code></pre>
<ul>
<li>Centralizes theme definitions, ensuring consistency across the entire codebase.</li>
<li>Provides keywords to extend flexibility when matching input.</li>
<li>Establishes a foundation for extending themes easily in the future.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Extracts themes based on diverse inputs such as IDs, keys, or keywords.</li>
<li>Iterates over predefined themes to allow flexible matches.</li>
<li>Provides fallback logic to handle invalid entries.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Enchantments for Configuration</h3>
<p>This file provides critical configuration settings, defining universal constants for timeouts, cache durations, and system limits. It supports theme-specific operations and environment variables, aligning with the adaptive needs of the adventure engine.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines time constraints for interactions with the LLM, optimizing performance.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Prevents analysis on excessively large files, maintaining resource efficiency.</li>
<li><code class="inline-code">DEFAULT_THEME</code>: Sets a fallback theme when none is specified by the user.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;);
export const MAX_FILE_SIZE_MB = 10;
export const DEFAULT_THEME = &#39;space&#39; as const;
</code></pre>
<ul>
<li>Provides configurable timeouts for flexibility across different environments.</li>
<li>Prevents excessive resource usage by limiting file sizes.</li>
<li>Ensures a consistent default theme for fallback scenarios.</li>
</ul>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">THEMES</code> as a blueprint to expand or modify available themes in the system.</li>
<li>Investigate how <code class="inline-code">parseTheme</code> enables flexible user input handling through matching techniques.</li>
<li>Review how validation functions in <code class="inline-code">input-validator.ts</code> depend on <code class="inline-code">theme.ts</code> to ensure cohesion.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Codeia‚Äôs enchanted Repository Grimoire! The balance between magic and logic is restored, and the kingdom flourishes once more. Your legendary deeds shall be sung throughout the land. Long live the adventurer!</p>
<p>With the wisdom of the enchanted tapestry now woven into your heroic journey, you rise as a shining champion of themes, one quest away from eternal mastery‚Äîforge boldly ahead, O seeker of mythical renown! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>