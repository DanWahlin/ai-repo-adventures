<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Enchanted Attire of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Chronicles of the Code Kingdom</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Enchanted Attire of Themes</h1>
<hr>
<p>In the heart of the Repository Tower lies a workshop filled with shimmering textiles, magical inks, and ethereal enchantments. Here, the Enchanted Attire of Themes awaits, a collection of mystical cloaks representing the kingdom&#39;s diverse realms‚Äîfrom the celestial fields of space to the fantasy of mythical lands. These attires not only adorn the kingdom‚Äôs adventures but channel specific magical powers. Your task is to imbue these attires with their spells, ensuring the themes are vibrant, functional, and harmonized with the world of magic.</p>
<p>To uncover the magic weavers&#39; secrets, you must examine the spells binding the garments‚Äîthe methods, validations, and structures that give each theme its power. Only by mastering these arts can you restore the kingdom&#39;s wardrobe and complete your journey through the Repository Tower.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Design Study</strong>: How are theme attributes structured, and what key properties define each theme in <code class="inline-code">theme.ts</code>?  </li>
<li>‚ö° <strong>Choice Validation</strong>: What mechanisms are implemented to ensure only valid themes are selected using <code class="inline-code">input-validator.ts</code>?  </li>
<li>üõ°Ô∏è <strong>Adaptive Crafting</strong>: How does the system handle theme-specific assets and CSS generation through <code class="inline-code">theme-manager.ts</code>?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Central repository for themes</h3>
<p>The <code class="inline-code">theme.ts</code> file defines themes as magical constructs, complete with properties like <code class="inline-code">id</code>, <code class="inline-code">key</code>, <code class="inline-code">displayName</code>, and the enchantments (<code class="inline-code">keywords</code>) that resonate with each theme. It centralizes all knowledge of themes, making this the critical reference for bindings across the entire kingdom. Simple helper functions are used to parse, validate, and fetch themes, enforcing consistency and ensuring no magical missteps occur.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">ThemeDefinition</code>: Specifies the properties of a theme, ensuring clear structure and metadata for each realm.</li>
<li><code class="inline-code">isValidTheme</code>: Verifies whether a given string matches one of the predefined themes, preventing entry of invalid spells into the system.</li>
<li><code class="inline-code">getAllThemes</code>: Retrieves an array of all available themes, providing a reference point for theme exploration elsewhere in the codebase.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export interface ThemeDefinition {
  readonly id: number;
  readonly key: string;
  readonly displayName: string;
  readonly emoji: string;
  readonly description: string;
  readonly keywords: readonly string[];  
}
</code></pre>
<ul>
<li>This structure defines the mystical properties of each theme.</li>
<li>It ensures every theme adheres to the same rules, enabling themes to scale and remain consistent.</li>
<li>Properties such as <code class="inline-code">keywords</code> connect user input to themes via simple matching.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>This function guards against invalid inputs, ensuring the magical fabrics aren&#39;t enchanted with mistakes.</li>
<li>By leveraging array iteration, the system keeps checks efficient and ensures correctness during user validation.</li>
<li>It exemplifies simple yet effective use of type guards in TypeScript.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li>Provides a compiled list of all themes from the magical repository.</li>
<li>Acts as the spellbook index for quick reference wherever themes are handled.</li>
<li>Simplification through array storage makes it highly performant without redundant complexity.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Gatekeeper of choices</h3>
<p>This file safeguards the mystical systems by validating user inputs such as adventure paths and theme selections. Validation is the warding spell that protects the Repository Tower from harmful input disruptions. Functions like <code class="inline-code">validateTheme</code> check for proper alignment with predefined themes, ensuring each selection resonates harmoniously within the enchanted system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures user-provided adventure titles are concise, non-empty, and free of unsafe patterns.</li>
<li><code class="inline-code">validateTheme</code>: Checks if a chosen theme is valid by utilizing theme parsing and verification mechanisms.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleanses user input for display, preventing unsafe content from corrupting the magical displays.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }

  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);

  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }

  return parsedTheme;
}
</code></pre>
<ul>
<li>This function ensures themes are meaningful, correctly spelled, and adhere to system conventions.</li>
<li>It uses both <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> to provide robust validation.</li>
<li>Clear error handling provides user feedback, guiding them to valid theme choices.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }

  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }

  return input.trim();
}
</code></pre>
<ul>
<li>This input check safeguards the spellbook from overly verbose or empty titles.</li>
<li>Its focus on length and sanitation keeps the Repository Tower organized and secure.</li>
<li>Useful for avoiding injection or overflow errors during downstream processing.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;

  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Protects the magical displays by removing harmful characters such as <code class="inline-code">&lt;</code>, <code class="inline-code">&gt;</code>, and <code class="inline-code">&quot;</code>.</li>
<li>This sanitization spell is crucial for preventing accidental or malicious input risks.</li>
<li>Truncates content to prevent visual clutter, keeping enchanted displays concise.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> Forging theme-specific assets</h3>
<p>The <code class="inline-code">ThemeManager</code> class is the master craftsman responsible for combining theme-specific assets, such as CSS and icons, into cohesive sets. It provides methods for parsing user choices, creating CSS for each theme, and managing theme-specific assets like logos and icons.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getGitHubLogo</code>: Determines which logo variant best suits the theme, ensuring visual harmony.</li>
<li><code class="inline-code">generateThemeCSS</code>: Combines various CSS assets into a single file tailored to the theme, reducing file fragmentation.</li>
<li><code class="inline-code">getThemeIcons</code>: Maps each theme to its associated icons for cohesive visual storytelling.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">public getGitHubLogo(theme: AdventureTheme): string {
  return this.isLightTheme(theme) 
    ? &#39;assets/shared/github-mark.svg&#39;
    : &#39;assets/shared/github-mark-white.svg&#39;;
}
</code></pre>
<ul>
<li>Dynamically selects the appropriate logo version for each theme.</li>
<li>Ensures visual consistency, especially for &quot;light&quot; themes like <code class="inline-code">mythical</code> that require dark assets.</li>
<li>Implements adaptive design based on theme properties.</li>
</ul>
<hr>
<pre><code class="language-typescript">public generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;),
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];

  let combinedCSS = &#39;&#39;;
  
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });

  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li>Merges base and theme-specific styles into a single, optimized CSS file.</li>
<li>Combines modular files for better maintainability and performance.</li>
<li>Verifies file existence, reducing runtime errors during the enchantment process.</li>
</ul>
<hr>
<pre><code class="language-typescript">public getThemeIcons(theme: AdventureTheme): { theme: string; quest: string } {
  const themeIcons = {
    space: { theme: &#39;üöÄ&#39;, quest: &#39;‚≠ê&#39; },
    mythical: { theme: &#39;üè∞&#39;, quest: &#39;‚öîÔ∏è&#39; },
    ancient: { theme: &#39;üè∫&#39;, quest: &#39;üìú&#39; },
    developer: { theme: &#39;üíª&#39;, quest: &#39;üîß&#39; },
    custom: { theme: &#39;üé®&#39;, quest: &#39;‚≠ê&#39; }
  };

  return (themeIcons as any)[theme] || themeIcons.space;
}
</code></pre>
<ul>
<li>Maps themes to relevant iconography, aligning assets with story elements.</li>
<li>Provides consistency in visual representation, aiding user immersion.</li>
<li>Defaults to <code class="inline-code">space</code> as a fallback, preventing errors when unknown themes are encountered.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Remember, themes define more than appearances‚Äîthey structure the kingdom&#39;s magic. Investigate their alignment with user input!  </li>
<li>Pay close attention to how modularization, such as CSS files, reduces complexity and enhances maintainability.  </li>
<li>Magic in this castle flows from validation and consistency‚Äîobserve the harmony across functions!</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Repository Tower! The kingdom&#39;s magic is now well-organized and flourishing thanks to your legendary efforts. Your adventure is complete.</p>
<p>With the wisdom of the Fabled Loom now woven into your heroic tapestry, you ascend as a beacon of triumph‚Äîone step closer to claiming the crown of mastery, noble champion! ‚≠ê‚ö°üó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>