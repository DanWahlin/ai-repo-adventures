<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Arcane Codex of Configuration - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'mythical' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Enchanted Realm of Aetherium: Chronicles of the Codebound</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Arcane Codex of Configuration</h1>
<hr>
<p>The magic of the Codebound Citadel stirs as you delve deeper into the halls of structured enchantments. Your path leads to the Arcane Codex of Configuration, an ancient grimoire said to hold the foundational spells for guiding adventures through the fabric of code. Its essence calls to the brave and astute, demanding mastery over its formulas to shape quests, extract hidden paths, and breathe life into this vast magical system. But beware‚Äîthe hidden recesses of its logic are guarded not only by sorcery but by riddles of parsing and protection. Prepare to unlock the codex‚Äôs secrets and wield its power.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration System for Guided Adventures</h3>
<p>The file <code class="inline-code">adventure-config.ts</code> creates the framework to interact with the Arcane Codex of Configuration, acting as both a guidebook and a magical toolkit for adventurers seeking clarity amid the spells of structured code. At its core, this script facilitates the reading, parsing, and formatting of the adventure configuration stored within <code class="inline-code">adventure.config.json</code>. The three primary pieces of magic here‚Äîthe functions <code class="inline-code">loadAdventureConfig()</code>, <code class="inline-code">parseAdventureConfig()</code>, and <code class="inline-code">extractUniqueFilePaths()</code>‚Äîwork in tandem to summon, decipher, and curate data from the enchanted grimoire. Each function has safeguards so even the most elusive pathways won‚Äôt easily trip unwary sorcerers. </p>
<p>The final synthesis‚Äîthe <code class="inline-code">formatAdventureConfigForPrompt()</code> spell‚Äîprepares this extracted information, weaving it with meticulous formatting rules to present it elegantly for the Lyrical Logician Matrix (LLM). This ensures that generated quests follow harmonious guidelines and encourages resonance between structured data and the thematic tapestry of adventures. By safeguarding against malformed incantations and maintaining clarity in prompts, <code class="inline-code">adventure-config.ts</code> is the unsung hero of every perfected quest, bridging raw data with the vibrant lore crafted by the LLM.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig()</code>: Reads the configuration file to retrieve raw text data.</li>
<li><code class="inline-code">parseAdventureConfig()</code>: Deciphers the raw text into usable objects while guarding against errors.</li>
<li><code class="inline-code">extractUniqueFilePaths()</code>: Extracts valid and existing paths from configuration for targeted exploration.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code>: Constructs quests and file details into a structured format for magical story generation.</li>
<li>Ensures security by validating paths and gracefully handling errors during parsing.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">const ADVENTURE_CONFIG_FILE = &#39;adventure.config.json&#39;;

function readFileIfExists(filePath: string): string | null {
  try {
    return fs.readFileSync(filePath, &#39;utf-8&#39;);
  } catch {
    return null;
  }
}

/**
 * Loads the raw adventure config text if present.
 * Pure file read - no parsing here.
 */
export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<p>This spell opens the enchanted tome, seeking out its secrets, but remains cautious‚Äîif the tome isn‚Äôt present, the function gracefully retreats.</p>
<pre><code class="language-typescript">/**
 * Parses the adventure config into an object (or null on error/missing).
 * Single point of JSON parsing and validation.
 */
export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>This enchantment takes raw, enigmatic scrolls and transforms them into easily readable objects or notes any malignant errors, functioning much like a sorcerer deciphering ancient scripts found in treacherous ruins.</p>
<pre><code class="language-typescript">/**
 * Formats adventure config into a readable format for LLM prompts
 * This ensures structured sections always appear in quest content
 */
export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure Guidelines\n\n`;
  adventure.quests.forEach(quest =&gt; {
    if (quest.title &amp;&amp; Array.isArray(quest.files)) {
      formatted += `### ${quest.title}\n`;
      quest.files.forEach(file =&gt; {
        if (file.path &amp;&amp; file.description) {
          formatted += `\n**File: \`${file.path}\`**\n- Description: ${file.description}\n`;
        }
      });
    }
  });

  return formatted;
}
</code></pre>
<p>This function assembles threads of logic into a lyrical tapestry, ensuring harmony and structure in every created quest while guarding against chaotic configuration.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Focus on mastering <code class="inline-code">loadAdventureConfig()</code> and <code class="inline-code">parseAdventureConfig()</code> first‚Äîthey are the foundation for interacting with the grimoire‚Äôs magic.</li>
<li>Use <code class="inline-code">formatAdventureConfigForPrompt()</code> to simplify the storytelling process, ensuring prompts align with mystical guidelines.</li>
<li>Explore related files like <code class="inline-code">theme.ts</code> to understand how themes enrich quests, complementing the Arcane Codex.</li>
</ul>
<hr>
<p>Hail, valiant seeker of wisdom, for you have unearthed the sacred Arcane Codex of Configuration, proving your mastery over the mystic arts and standing but one quest away from eternal glory in the annals of the celestial realms! ‚ö°üíéüìúüó∫Ô∏è</p>

</div>


    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>