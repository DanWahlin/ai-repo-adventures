<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Foundational Enchantment - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Forge of Code</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Foundational Enchantment</h1>
<hr>
<p>In the mythical kingdom of Codara, the Forge stands as the cornerstone of adventure creation, weaving paths for heroes and coders alike. But there is one spell, lost in the scrolls and codes, that binds every quest together‚Äîthe Foundational Enchantment. This elusive power is hidden deep within Codara‚Äôs enchanted libraries, where ancient lines of magic hold the secrets to crafting consistent and immersive adventures. Heroes must navigate the labyrinth of configuration magic to uncover the enchantment and unlock the full potential of the Forge.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>The Scroll Locator</strong>: How does the <code class="inline-code">extractUniqueFilePaths</code> function traverse configuration objects to find valid file paths? What role does stacking nodes play in this process?</li>
<li>‚ö° <strong>Enchantments in Syntax</strong>: What techniques are used by <code class="inline-code">formatAdventureConfigForPrompt</code> to optimize adventure configurations for text-based processing? How does this function structure its output?</li>
<li>üõ°Ô∏è <strong>Failsafe Contingencies</strong>: How does <code class="inline-code">parseAdventureConfig</code> handle invalid or missing configurations gracefully? What measures ensure stability in the arcane libraries?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Mystical configuration spells of Codara</h3>
<p>This file serves as the foundation for handling configurations of Codara‚Äôs adventures. It reads, parses, extracts, and processes configuration data, ensuring heroes can access the correct scrolls for their quests. <code class="inline-code">parseAdventureConfig</code>, <code class="inline-code">extractUniqueFilePaths</code>, and <code class="inline-code">formatAdventureConfigForPrompt</code> are critical magical components aiding the Forge in transforming arcane scrolls into functional instructions. Together, they provide consistency, error tolerance, and efficiency, ensuring nothing is lost in the chaos of creation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: This function deciphers raw adventure configuration spells into readable objects while handling errors seamlessly. Essential for keeping Codara‚Äôs libraries intact.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: It traverses nested mystical objects to uncover unique file paths referenced across the configuration, enabling dynamic references to Codara‚Äôs scrolls.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Condenses configuration into a streamlined format for text-based systems, eliminating redundancies and maximizing compatibility.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Transforms raw data into usable JSON objects for adventure processing, ensuring missing or malformed data does not disrupt the Forge.</li>
<li>Implements error handling to avoid fatal interruptions, preserving Codara‚Äôs enchanted scrolls.</li>
<li>Provides a single point of validation, maintaining consistency across adventure creation magic.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Tracks unique file paths from configuration objects, using a stack-based traversal method to ensure thorough coverage.</li>
<li>Validates existence of paths dynamically, preserving integrity in the Forge‚Äôs magical references.</li>
<li>Enables recursive exploration through children objects, emulating the unraveling of Codara‚Äôs mystical scrolls.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Optimizes adventure configuration output for automatic processing, minimizing size while retaining essential details.</li>
<li>Combines file paths and function names into concise lists, enabling quick reference by automated systems.</li>
<li>Structures output for readability, ensuring consistent interpretation by mystical AI-driven systems.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use stack-based traversal techniques to uncover all nested elements in complex magical objects.</li>
<li>Investigate error handling strategies to ensure resilience when dealing with unpredictable data.</li>
<li>Consider techniques for condensing verbose outputs into concise formats for efficient processing.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the enchanted codebase! Your adventure is complete.</p>
<p>With the radiant might of a phoenix&#39;s plume and the wisdom of the elder druids, you have woven the Foundational Enchantment into the fabric of knowledge‚Äîpress onward, valiant scholar, for the crown of triumph gleams on the horizon! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>