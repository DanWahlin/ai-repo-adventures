<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Configuration Chamber - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Repository: Quests of the Mystic Codebase</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Configuration Chamber</h1>
<hr>
<p>In the enchanted halls of Codevale‚Äôs Repository Castle lies the Configuration Chamber, a concealed and mystical room where the foundational essence of adventures is born. Here, within ancient scripts and structured spells, lies the power to ensure quests abide by the codified rules of themes and configurations. The chamber is guarded by the Mystic Codex‚Äôs final encoded challenge‚Äîdeciphering and harmonizing the various rules that dictate the safe and seamless execution of mythical realms. Heroes who succeed unlock everlasting wisdom into adventure creation.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üõ°Ô∏è <strong>Sanctuary of Validation</strong>: How does <code class="inline-code">validateTheme</code> ensure user inputs conform to predefined theme definitions and handle invalid cases?</li>
<li>üîç <strong>Chronicles of Adventure</strong>: What techniques does <code class="inline-code">parseAdventureConfig</code> utilize to safely load and interpret configuration files?</li>
<li>‚ö° <strong>Artifacts of Thematic Power</strong>: How does <code class="inline-code">generateThemeCSS</code> merge multiple styles into a cohesive visual representation tailored for themes?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Ensuring Inputs Align with Domain Rules</h3>
<p>This file handles validation mechanisms integral to maintaining the harmony of user inputs across adventures. It ensures adventure choices, themes, and project paths comply with required formats and exclude dangerous or invalid data.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Normalizes user input, validates against magical theme definitions‚Äîrejecting mismatches with helpful guidance.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Guards against presentation vulnerabilities by neutralizing risky characters and formatting input for safe display.</li>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures adventure names conform to basic length constraints and non-empty values.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Applies normalization techniques (<code class="inline-code">toLowerCase</code> and <code class="inline-code">trim</code>) for consistency.</li>
<li>Relies on <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> to validate themes against repository-defined magical keywords.</li>
<li>Provides explicit error messaging, listing acceptable themes to guide adventurers.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Strips hazardous characters (<code class="inline-code">&lt;&gt;{}&quot;</code>) to ensure display-ready formatting and reduce XSS risk.</li>
<li>Uses normalization (e.g., trimming spaces and collapsing whitespace) for cleaner presentation.</li>
<li>Limits output length (<code class="inline-code">maxLength</code>) to prevent display overflow or memory exhaustion.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Implements basic length validation for adventure names (200 characters max).</li>
<li>Enforces non-empty values through a <code class="inline-code">trim</code> check, ensuring meaningful inputs.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: Deciphering Configurations</h3>
<p>This file governs the reading, parsing, and organization of adventure configurations. It ensures the sanctuary of reliable and structured inputs by extracting data safely from files.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Loads and interprets adventure configuration files, returning safely parsed JSON or null on failure.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Traverses configuration objects to locate all referenced file paths, ensuring validity through existence checks.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Converts adventure configurations into concise summaries optimized for use in prompts.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Combines file reading (<code class="inline-code">loadAdventureConfig</code>) with JSON parsing, handling syntax failures via <code class="inline-code">try-catch</code>.</li>
<li>Returns <code class="inline-code">null</code> for absent or invalid configurations, ensuring graceful degradation.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Uses a <code class="inline-code">stack</code>-based depth-first search to traverse configuration structures recursively.</li>
<li>Identifies and validates file paths using <code class="inline-code">fs</code> and <code class="inline-code">path</code> utilities, ensuring referenced paths are physically present.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;

    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Extracts quest details (<code class="inline-code">title</code>, <code class="inline-code">files</code>, and <code class="inline-code">functions</code>) into concise formats for structured prompts.</li>
<li>Iterates over configuration content and reduces verbosity for LLM compatibility.</li>
<li>Enables rapid comprehension of adventure structures through formatted summaries.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/theme-manager.ts</code></a>: Theme Harmonization</h3>
<p>This file invokes toolkit magic to compose visual elements for the enchanted adventures, merging artifacts into unified styles.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateThemeCSS</code>: Combines CSS files associated with theme styling, outputting seamless configurations.</li>
<li><code class="inline-code">getGitHubLogo</code>: Selects appropriate assets based on the thematic background properties (light/dark).</li>
<li><code class="inline-code">getThemeIcons</code>: Maps themes to specific icons for visual reinforcement.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/theme-manager.ts</code></a></h3>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;), 
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
  
  let combinedCSS = &#39;&#39;;
  
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
  
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li>Merges multiple CSS files (<code class="inline-code">base.css</code>, thematic styles like <code class="inline-code">mythical.css</code>) into a complete stylesheet.</li>
<li>Ensures readability by checking file existence before inclusion.</li>
<li>Outputs consolidated CSS to the designated <code class="inline-code">assets</code> directory.</li>
</ul>
<hr>
<pre><code class="language-typescript">isLightTheme(theme: AdventureTheme): boolean {
  const lightThemes: AdventureTheme[] = [&#39;mythical&#39;];
  return lightThemes.includes(theme);
}
</code></pre>
<ul>
<li>Identifies themes with light backgrounds, used for dynamic asset selection (e.g., <code class="inline-code">GitHub-mark.svg</code>).</li>
<li>Safeguards visual consistency ensuring assets match thematic designs.</li>
</ul>
<hr>
<pre><code class="language-typescript">getThemeIcons(theme: AdventureTheme): { theme: string; quest: string } {
  const themeIcons = {
    space: { theme: &#39;üöÄ&#39;, quest: &#39;‚≠ê&#39; },
    mythical: { theme: &#39;üè∞&#39;, quest: &#39;‚öîÔ∏è&#39; },
    ancient: { theme: &#39;üè∫&#39;, quest: &#39;üìú&#39; },
    developer: { theme: &#39;üíª&#39;, quest: &#39;üîß&#39; },
    custom: { theme: &#39;üé®&#39;, quest: &#39;‚≠ê&#39; }
  };

  return (themeIcons as any)[theme] || themeIcons.space;
}
</code></pre>
<ul>
<li>Maps themes to magical icons (<code class="inline-code">üè∞</code>, <code class="inline-code">‚öîÔ∏è</code>) for thematic immersion.</li>
<li>Enhances the enhanced kingdom feel with visual reinforcement across adventures.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Familiarize yourself with theme validation flow within <code class="inline-code">validateTheme</code>.</li>
<li>Investigate CSS styling generation techniques to strengthen your enchanted UI toolkit.</li>
<li>Explore configuration traversal in <code class="inline-code">extractUniqueFilePaths</code> for robust path gathering practices.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Codevale‚Äôs arcane repository! Your adventure is complete.</p>
<p>By the blazing wisdom of the Celestial Forge, brave hero, you have unlocked the ancient secrets of the Configuration Chamber‚Äî80% through your odyssey‚Äînow, march onward toward your ultimate triumph, for the stars themselves herald your glory! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>