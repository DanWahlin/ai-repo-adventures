<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Codex of Themes and Runes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Kingdom of Enchanted Code</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Codex of Themes and Runes</h1>
<hr>
<p>In the final chapter of your journey through the enchanted kingdom of Codethra, you approach the Font of Syntax, where the mystical Codex of Themes and Runes is stored. The Codex, a repository of elemental designs and arcane patterns, governs the kingdom&#39;s thematic harmony. Yet it lies fragmented, its magic disrupted. To restore its power, you must delve into the ancient spells and structure the themes and runes anew. Beware—the Codex&#39;s riddles can confound even the wisest sages. The kingdom’s fate depends on your mastery of this knowledge.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>🪞 <strong>Theme Harmonization</strong>: How are themes normalized, validated, and structured for consistency within the kingdom&#39;s logic?</li>
<li>📜 <strong>Runic Configurations</strong>: How do configuration constants ensure stability and adaptability in processing coded adventures?</li>
<li>🔮 <strong>Validation Rituals</strong>: How does input validation safeguard the realm from errant or malicious inputs?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Configuration of Enchanted Constants</h3>
<p>This file holds the foundational constants that stabilize the kingdom’s arcane flows, setting limits and managing timeouts for mystical invocations. Each constant reflects a balance struck between power and safety, like the careful weaving of a spell. These values influence the scalability and robustness of the magic coursing through Codethra’s enchanted scripts.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Manages the time limit for invoking language models, ensuring spells do not exhaust magical energies.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Sets boundaries for how large scrolls (files) can be, preventing resource exhaustion during analysis.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: Defines directories and file names to avoid, ensuring focus on magical scripts relevant to the kingdom&#39;s quests.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: The Codex of Themes</h3>
<p>The Codex defines the thematic archetypes governing Codethra. Each theme layer is imbued with unique properties such as identifiers, keywords, and descriptions. Utilities here allow retrieval, parsing, and validation of themes, ensuring harmony among the kingdom’s enchanted adventures.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">isValidTheme</code>: Validates whether a theme key is legitimate, guarding against misuse of thematic energy.</li>
<li><code class="inline-code">parseTheme</code>: Transforms raw input into normalized themes via pattern recognition and keyword matching.</li>
<li><code class="inline-code">getAllThemes</code>: Provides a catalog of all themes, enabling knights to select their path with clarity and precision.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: The Rituals of Input Validation</h3>
<p>This file protects Codethra from chaotic inputs, ensuring that every invocation of magic (function) is performed with pure intent. Through validation and sanitization, the scripts are shielded from fragmentation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures the selected adventure is meaningful and adheres to the kingdom&#39;s rules.</li>
<li><code class="inline-code">validateTheme</code>: Normalizes and validates theme inputs, ensuring that only compatible themes are invoked.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleanses outputs of harmful symbols, ensuring all displays are safe for the realm&#39;s inhabitants.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">// Timeouts in milliseconds
export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds for complex story generation with large prompts, configurable via env

// Analysis limits
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code

// Directory patterns to ignore during scanning
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;.nuxt&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;coverage&#39;,
  &#39;.nyc_output&#39;,
  &#39;logs&#39;,
  &#39;*.log&#39;,
  &#39;.env&#39;,
  &#39;.DS_Store&#39;,
  &#39;Thumbs.db&#39;,
] as const;
</code></pre>
<ul>
<li>These constants directly influence Codethra&#39;s stability by managing analysis boundaries and preventing resource abuse.</li>
<li>Patterns used in <code class="inline-code">IGNORE_PATTERNS</code> help knights (tools) avoid distractions from irrelevant paths.</li>
<li>The timeout limit ensures that spells (API calls) do not linger indefinitely, maintaining efficiency.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;

  const normalized = input.trim().toLowerCase();

  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }

  return null;
}

export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li><code class="inline-code">isValidTheme</code> ensures that all attempts to engage thematic magic utilize predefined archetypes, retaining harmony.</li>
<li><code class="inline-code">parseTheme</code> allows knights to extract the valid runes of a theme from imperfect inputs, ensuring flexibility in invocation.</li>
<li><code class="inline-code">getAllThemes</code> showcases the catalog of all available archetypes, akin to a knight&#39;s armory.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> ensures that knights embark on meaningful quests by validating their choices.</li>
<li><code class="inline-code">validateTheme</code> provides a mechanism for faithful invocation of themes, protecting against rogue inputs.</li>
<li><code class="inline-code">sanitizeForDisplay</code> cleanses harmful characters, safeguarding the kingdom&#39;s inhabitants from textual curses.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">getAllThemes</code> to understand the full spectrum of thematic options available in Codethra.</li>
<li>Pay extra attention to <code class="inline-code">IGNORE_PATTERNS</code> to identify what paths are excluded during analysis.</li>
<li>Validation functions can inspire your efforts to ensure robust input handling in other realms.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Codethra! Your adventure is complete. The Book of Adventures has been restored, and balance reigns once more in the enchanted kingdom. Take pride in your deeds, oh knight of code!</p>
<p>With the triumph over Quest 5, the Codex of Themes and Runes has been unveiled, etching your name among the legendary stars of the realm—take heart, valiant hero, for the final chapter nears with your indomitable spirit shining like a celestial beacon! ⚡💎🚀</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">← Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>