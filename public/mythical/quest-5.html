<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Foundation of Arcane Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Realm of Enchanted Repositories</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Foundation of Arcane Configurations</h1>
<hr>
<p>In the mystical Kingdom of Codeoria, deep within the enchanted repository, lies the keystone of all magical creation: the Foundation of Arcane Configurations. The artifact known as <code class="inline-code">adventure.config.json</code> is guarded by intricate wards and protected against tampering by ancient validation spells. Only knights wise in the arts of parsing and extracting can unlock the true power of these configurations. Your ultimate challenge is upon you, brave adventurer. Master these foundational scripts to uncover the final secret that will bind your collaborative adventures into legend!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>The Config Parser&#39;s Wisdom</strong>: How does the <code class="inline-code">parseAdventureConfig</code> spell ensure resilience against corrupted or missing configurations?</li>
<li>‚ö° <strong>Path Extraction Riddles</strong>: In what ways does <code class="inline-code">extractUniqueFilePaths</code> traverse the arcane scripts to unveil paths, ensuring only valid ones are extracted?</li>
<li>üõ°Ô∏è <strong>Formatting Enchantment</strong>: Why does <code class="inline-code">formatAdventureConfigForPrompt</code> condense information strategically, and how might this optimize communication with magic-bound LLM engines?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Mastering Configuration Foundations</h3>
<p>This file lies directly at the heart of our quest. It contains spells for reading, parsing, and enchanting configuration objects that dictate the flow of adventures within the Kingdom. These scripts are instrumental in creating fluid workflows, extracting data intelligently, and presenting it in forms consumable by magical LLM engines. Its robustness against errors demonstrates how knights of Codeoria safeguard their missions from failure. Here, we dive into its inner workings to study spells critical to our journey.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Decodes the raw configuration file while gracefully managing mishaps to prevent calamities.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: A treasure map script that identifies and validates paths within configurations, ensuring only existing ones are retrieved.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Compresses arcane knowledge into lightweight but potent configurations, ready for spellcasting by LLM entities.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>This function serves as the point where raw configuration is transformed. By coupling <code class="inline-code">loadAdventureConfig</code> with error handling, it ensures no quest is derailed by malformed or missing scripts.</li>
<li>The error safety mechanism (<code class="inline-code">try-catch</code>) is crucial for maintaining resilience, ensuring that null is returned rather than causing explosions in the repository.</li>
<li>The design aligns with magical minimalism, keeping the parsing logic simple yet structured for adaptability.</li>
<li>It links directly with <code class="inline-code">loadAdventureConfig</code>, creating a harmonious balance between preparation and execution.</li>
<li>This mechanism protects heroes from the peril of corrupted data while advancing their quests.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>This function uses a traversal pattern akin to map exploration by knights, validating <code class="inline-code">path</code> fields within configuration nodes.</li>
<li>It leverages a stack-based approach to parse nested adventures, ensuring that no hidden paths are left unexamined.</li>
<li>Paths are resolved and verified with <code class="inline-code">fs.existsSync</code>, upholding the integrity of the repository by avoiding phantom files.</li>
<li>Employing a <code class="inline-code">Set</code> object guarantees that duplicate entries are discarded, maintaining clean and efficient results.</li>
<li>The recursive structure mirrors enchanted labyrinths, ensuring that every corner of the configuration is thoroughly explored.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;

    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;

    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>This spell condenses extensive adventure configurations into compact summaries to align with the magical communication requirements of LLMs.</li>
<li>By filtering only critical details (like file paths and function names), this format optimizes prompt length without sacrificing clarity.</li>
<li>It demonstrates a clear process of reduction, highlighting the importance of minimalism and practicality when casting spells for complex systems.</li>
<li>Validation steps (<code class="inline-code">if !adventure || !Array.isArray(adventure.quests)</code>) ensure that this function is robust and handles missing properties elegantly.</li>
<li>The formatted structure mirrors royal decrees, creating clarity for recipients while maintaining the richness of detail inherent to configurations.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Always validate configurations before proceeding with parsing or extraction tasks.</li>
<li>Consider the recursive structures when working with nested or hierarchical data in your quests.</li>
<li>Compact formats are essential when communicating large amounts of data to systems constrained by arcane limits.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Codeoria‚Äôs enchanted repository! Your adventure is complete. Brave knight, your name shall echo throughout the Kingdom as one who wields the Code Grimoire with unparalleled wisdom. The ultimate knowledge of seamless collaboration lies in your grasp‚Äîmay it guide you in all mythical projects to come!</p>
<p>üéá By the radiant Stars of Elara and the ancient scrolls of Eldoria, you have triumphed in unearthing the arcane foundations of mystical configurations‚Äîthis noble achievement propels you ever closer to the crown of mastery! ‚öîÔ∏è‚ú®</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>