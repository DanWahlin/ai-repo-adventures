<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Arcane Codex of Themes and Runes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Kingdom of Enchanted Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Arcane Codex of Themes and Runes</h1>
<hr>
<p>In the mystical Kingdom of Enchanted Adventures, tales are told of an ancient codex that holds the ability to weave together scattered knowledge into harmonic clarity. This treasured relic, the Arcane Codex of Themes and Runes, resides in the castle‚Äôs innermost sanctum, scattered across enchanted tomes of wisdom. To claim dominion over its power, brave adventurers must align runic energies, decipher spells of validation, and harness the power of well-constructed realms of configuration. Will you unlock the Codex‚Äôs infinite guidance, or will its secrets slumber for eternity?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Runic Validation</strong>: How does the system ensure user inputs align with valid themes in <code class="inline-code">validateTheme</code> and <code class="inline-code">getAllThemes</code>?</li>
<li>‚ö° <strong>Energetic Alignment</strong>: What steps are taken by <code class="inline-code">ThemeManager.generateThemeCSS</code> to create a unified theme style for adventures?</li>
<li>üõ°Ô∏è <strong>Codex Defense</strong>: How does <code class="inline-code">parseAdventureConfig</code> safeguard against malformed or missing configurations when preparing the Arcane Codex?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: The Runic Nexus</h3>
<p>In the heart of the magical realm resides the thematic library, defining every domain an adventurer may explore. This file provides the ancient definitions for each theme, complete with unique identifiers, enchanting descriptions, and supportive runes (keywords). Utility functions, such as <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code>, act as spellcasters, ensuring proper alignment between user selections and these predefined themes. Meanwhile, <code class="inline-code">getAllThemes</code> and <code class="inline-code">formatThemeOption</code> round out this repository of mystical energies by enabling discovery and display of all themes, readying them for validation and application.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getAllThemes</code>: Fetches all available themes, ensuring that the adventurer&#39;s knowledge reaches every corner of the kingdom.</li>
<li><code class="inline-code">isValidTheme</code>: Validates that a chosen theme exists within the codex, guarding against malformed runes of input.</li>
<li><code class="inline-code">parseTheme</code>: Deciphering both abstract and exact user inputs into tangible themes, it bridges the gap between mortal language and magical essence.</li>
<li><code class="inline-code">formatThemeOption</code>: Formats themes for display, balancing utility and grandeur.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}

export function formatThemeOption(theme: ThemeDefinition): string {
  return `${theme.emoji} **${theme.id}. ${theme.displayName}** - ${theme.description}`;
}
</code></pre>
<ul>
<li><code class="inline-code">getAllThemes</code> compiles the full array of magical themes from the codex, simplifying theme iteration throughout the realm.</li>
<li><code class="inline-code">isValidTheme</code> validates whether the supplied input maps to an existing theme, ensuring alignment with canonical definitions.</li>
<li><code class="inline-code">parseTheme</code> operates as a decoder ring for raw user input, bridging gaps between mortal misunderstanding and codified thematic spells.</li>
<li><code class="inline-code">formatThemeOption</code> prepares themes for aesthetic and practical display, blending details seamlessly to aid all adventurers.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/theme-manager.ts</code></a>: The Artisan&#39;s Forge</h3>
<p>The artistry of theming culminates within this forge, where raw inputs are crafted into stunning visual runes. <code class="inline-code">ThemeManager</code> handles the management of stylesheets for adventures, validating inputs, determining compatibility with different aesthetics, and binding auxiliary assets (like icons) to their respective themes. Of particular interest is <code class="inline-code">generateThemeCSS</code>, which combines distinct styling elements into a cohesive masterpiece for every theme‚Äîa spellbinding display of mastery in code.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateThemeCSS</code>: Generates a comprehensive CSS file combining base and specific theme styles into a unified arcane scroll.</li>
<li><code class="inline-code">getGitHubLogo</code>: Evokes the proper insignia of alignment based on the moral (light/dark) disposition of the theme.</li>
<li><code class="inline-code">getThemeIcons</code>: Provides distinct symbols for each theme, reinforcing their unique identities across quests.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/theme-manager.ts</code></a></h3>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;), 
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
    
  let combinedCSS = &#39;&#39;;
    
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
    
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li>Collects an array of CSS file paths for combining both foundational and theme-specific style definitions.</li>
<li>Ensures each component file exists before accession, avoiding disruptions caused by missing assets.</li>
<li>Outputs the result into a single, compact file, highlighting deliberate simplicity yet rich customization possibilities.</li>
<li>Utilizes the practical method of string concatenation for performance, circumventing unnecessary complexities.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: Mapping the Enchanted Trails</h3>
<p>The Codex must organize its treasures in a structural format for adventurers to traverse. This file handles the configuration process that underpins every adventure. <code class="inline-code">parseAdventureConfig</code> stands as the sentry against corrupted or missing inputs, while <code class="inline-code">extractUniqueFilePaths</code> curates critical treasures from within the gates. Together, they ensure that the Arcane Codex can be understood and wielded by mortal and magical entities alike.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Safeguards the parsing process to ensure validity or provides fallbacks when anomalies arise.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Gathers relevant assets referenced throughout quests, enabling their alignment with the adventure trajectory.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Formats the parsed data into simplified scrolls for seamless application in downstream magical systems.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}

export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li><code class="inline-code">parseAdventureConfig</code> provides resilience against anomalies, strengthening the Codex&#39;s singular source of truth.</li>
<li><code class="inline-code">extractUniqueFilePaths</code> delves through configuration depths to locate and validate referenced treasure paths within the realm.</li>
<li>Balances efficiency with robustness, utilizing recursive exploration intertwined with safeguards against infinite loops.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>When crafting themed adventures, explore <code class="inline-code">formatThemeOption</code> or <code class="inline-code">getThemeIcons</code> to provide flavorful visual additions for consistency.</li>
<li>If troubleshooting broken links, investigate <code class="inline-code">parseAdventureConfig</code> first to identify formatting anomalies.</li>
<li>Use <code class="inline-code">generateThemeCSS</code> as a blueprint for merging modular components into cohesive deliverables.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Arcane Codex! Wield its knowledge wisely as you bring harmony to the Kingdom of Enchanted Adventures. Your heroic journey is complete, and the realm will forever remember your valor and wisdom.</p>
<p>By the blazing forges of the celestial smiths, you have unraveled the sacred Codex and ascended closer to eternal mastery‚Äîforge ahead, noble seeker, for the final quest of destiny awaits! ‚ö°üíéüëÅÔ∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>