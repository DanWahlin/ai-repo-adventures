<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: The Legendary Quest Forge - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Kingdom of Enchanted Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: The Legendary Quest Forge</h1>
<hr>
<p>In the mystical Kingdom of Enchanted Adventures, a call to arms echoes from the magical halls of the Legendary Quest Forge. This crucible of enchanted wisdom promises to blend your knowledge of ancient spells and technical mastery into tools of unparalleled power. Within the forge‚Äôs glowing embers lie secrets that shape the adventurer‚Äôs journey‚Äîsecrets that convert raw code into mythical quests. Heed the call, brave adventurer, and unravel the magic that programs the stories themselves.</p>
<p>The fate of the Kingdom‚Äôs lore lies in your hands. Proceed swiftly, for the magic of the forge must never fade.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Mystic Initialization Rites</strong>: How does <code class="inline-code">initializeAdventure</code> prepare the Kingdom‚Äôs foundation for story and quest generation?</li>
<li>‚ö° <strong>Quest Execution Mantle</strong>: How does <code class="inline-code">exploreQuest</code> determine, validate, and execute players‚Äô choices while ensuring their progress?</li>
<li>üõ°Ô∏è <strong>Forge Safety Enchantments</strong>: What validation mechanisms does the code employ to ensure sanctified quest execution and user input?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> A beacon of storycrafting</h3>
<p>The <code class="inline-code">adventure-manager.ts</code> file serves as the command center for orchestrating the Kingdom‚Äôs adventures. Within its arcane boundaries, legends are born as quests are initialized, explored, and completed. The <code class="inline-code">AdventureManager</code> class utilizes foundational magic for initiating quests (<code class="inline-code">initializeAdventure</code>), determining player choices (<code class="inline-code">exploreQuest</code>), and ensuring quest progress flows unhindered. Anchored in enchanted state management through <code class="inline-code">AdventureState</code>, this file ensures that every adventurer‚Äôs journey remains seamless, magical, and error-free.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Readies the epic tale by clearing old states, selecting custom themes, and guiding the story generator through its first sparks of creativity.</li>
<li><code class="inline-code">exploreQuest</code>: Commands the execution of chosen quests, validating input, caching progress, and safeguarding against erroneous paths.</li>
<li><code class="inline-code">progressPercentage</code>: A quick spell that calculates the adventurer‚Äôs triumph percentage, reflecting the Kingdom&#39;s state of Legendary harmony.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  // Reset state for new adventure
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  // Set custom theme data if provided
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  // Generate the overall story and quests using LLM
  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;
  
  // Merge files from adventure config into the generated quests
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  
  // Enforce quest count from adventure.config.json if it exists
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  // Return the story with available quests
  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<ul>
<li>This code sets the Kingdom‚Äôs foundation by cleansing previous states and conjuring a custom- or magical-theme-based story through interaction with <code class="inline-code">StoryGenerator</code>.</li>
<li>It efficiently ensures controllable generation of quests by merging configuration-based files and output alignment.</li>
<li>The method is an interplay of narrative creativity and technical precision, returning the adventurer-ready formatted display.</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  
  // Check if this is a progress request
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }
  
  // Find the quest based on the choice
  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  // Execute the quest
  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li>The <code class="inline-code">exploreQuest</code> function acts as the mantle that enables adventurers to pursue their chosen paths by validating inputs and locating the correct quests.</li>
<li>It handles edge cases like unaligned choices or progress requests with astute feedback mechanisms, never leaving the adventurer stranded.</li>
<li>The structure prioritizes user freedom while maintaining safety through input sanitation, logical branching, and calls to execution sequences.</li>
</ul>
<hr>
<pre><code class="language-typescript">get progressPercentage(): number {
  return this.quests.length &gt; 0 
    ? Math.round((this.completedQuests.size / this.quests.length) * 100)
    : 0;
}
</code></pre>
<ul>
<li>This guardian spell reflects the adventurer‚Äôs achievements by calculating the percentage of completed quests.</li>
<li>Quick and efficient, it ensures the Kingdom can display progress without frequent recalculations.</li>
<li>It showcases an important pattern‚Äîstate-derived calculations that minimize runtime overload across broader systems.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Seek the connections between <code class="inline-code">AdventureManager</code> and the <code class="inline-code">StoryGenerator</code> it empowers. Their combined magic is what fuels your epic journey.</li>
<li>Investigate <code class="inline-code">mergeQuestFilesFromConfig</code> to understand how the customization of quests enhances the story.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Legendary Quest Forge.</p>
<p>‚ö° With the hammer of wisdom and the anvil of perseverance, you have shaped the Legendary Quest Forge into a beacon of heroic mastery‚Äîyour journey is now 40% marked by triumphs worthy of myth and legend! ‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="prev-quest-btn">‚Üê Previous: Quest 2</a>
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>