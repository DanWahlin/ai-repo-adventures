<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: The Heroic Script of Adventure - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Codex: A Kingdom's Tale</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: The Heroic Script of Adventure</h1>
<hr>
<p>In the mythical Kingdom of Codora, whispers of an arcane quest to decipher the <em>Heroic Script</em> reverberate through castle halls. This script is steeped in ancient magic, holding the power to unlock legendary coding tools and guide brave adventurers to conquer challenges. Many knights have faltered, unable to grasp the design of this enchanted logic. You will venture forth to decode its spells, revealing the mystical pathways that breathe life into stories, calculate quests, and usher progress in this magical kingdom! Onward, noble hero, to unravel Codora‚Äôs deepest secrets and restore balance to the enchanted lands!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Mystic Configuration Decoding</strong>: How does <code class="inline-code">parseAdventureConfig</code> validate and structure the mythical configuration file, ensuring its magical paths are understood?</li>
<li>‚ö° <strong>Hero&#39;s Journey Initialization</strong>: How does <code class="inline-code">initializeAdventure</code> orchestrate the quest generation process, linking the enchanted configuration to user themes and project pathways?</li>
<li>üõ°Ô∏è <strong>Arcane Progress Tracker</strong>: How does <code class="inline-code">progressPercentage</code> calculate progress in the Adventure, and what safeguards ensure it correctly reflects the hero‚Äôs strides?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration File Reader and Validator</h3>
<p>To unlock the essence of Codora‚Äôs quests, <strong>this file</strong> holds the secrets of configuration reading and interpretation. Here, the magical codex is verified and prepared for the adventurer‚Äôs exploration. From file presence detection to enchanted validation, every spell woven here ensures a seamless journey.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code> invokes arcane methods to discover and load the enchanted configuration text based on project pathways.</li>
<li><code class="inline-code">parseAdventureConfig</code> translates the raw, mystical text into structured objects, enabling adventurers to interpret its commands without peril.</li>
<li><code class="inline-code">extractUniqueFilePaths</code> ventures into the depths of configuration references, drawing forth valid paths that are required for magical rituals.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Orchestrating the Hero‚Äôs Journey</h3>
<p>In the heart of Codora, <strong>this file</strong> is a beacon of adventure orchestration. It manages the state, quests, and themes, ensuring harmony in the hero‚Äôs journey. When invoked, it spawns quests based on the heroic script and tracks the knight‚Äôs bravery across magical landscapes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code> stands at the crux of the narrative, linking project information, themes, and configurations to produce a unified storyline.</li>
<li><code class="inline-code">progressPercentage</code> is the enchanted gauge that computes the adventurer‚Äôs progress meticulously, ensuring a fair heralding of success.</li>
<li><code class="inline-code">generateQuestContent</code> dynamically produces mystical quests, drawing insight from configuration paths and project knowledge.</li>
</ul>
<hr>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}

export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}

export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  // Extraction logic goes here
  return Array.from(unique);
}
</code></pre>
<ul>
<li><code class="inline-code">loadAdventureConfig</code>: Searches for the mythical configuration file and loads its contents. If absent, it gracefully returns null‚Äîavoiding fatal errors for adventurers.</li>
<li><code class="inline-code">parseAdventureConfig</code>: Parses the arcane text into a JSON object, ensuring only valid configurations are interpreted. Ill-formed scripts are safely discarded.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Extracts file paths mentioned in the config, relying on validation to ensure they exist‚Äîa vital step in securing quest artifacts.</li>
</ul>
<hr>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">export class AdventureManager {
  async initializeAdventure(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme, 
    projectPath?: string
  ): Promise&lt;string&gt; {
    this.state.reset();
    this.state.projectInfo = projectInfo;
    this.state.currentTheme = theme;
    this.state.projectPath = projectPath || process.cwd();
  
    const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
    
    this.state.title = storyResponse.title;
    this.state.story = storyResponse.story;
    this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
    return this.formatStoryWithQuests({
      ...storyResponse,
      quests: this.state.quests
    });
  }

  get progressPercentage(): number {
    return this.quests.length &gt; 0 
      ? Math.round((this.completedQuests.size / this.quests.length) * 100)
      : 0;
  }
}
</code></pre>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Links project knowledge and themes to generate a unified, magical narrative and quests. It merges codex data and resets before invoking the story generator.</li>
<li><code class="inline-code">progressPercentage</code>: Determines the knight‚Äôs strides within their heroic saga based on completed quests, ensuring accurate representation of success.</li>
<li><code class="inline-code">mergeQuestFilesFromConfig</code>: Combines the enchanted quests generated and the magical references from the codex, enriching the hero‚Äôs campaign.</li>
</ul>
<hr>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return &#39;&#39;;

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) return &#39;&#39;;

  let formatted = `## Quest Structure\n`;
  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;
    formatted += `### ${quest.title}\nFiles: ${quest.files.map((f: any) =&gt; f.path).join(&#39;, &#39;)}\n`;
  }
  return formatted;
}
</code></pre>
<ul>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Condenses details from the magical configuration to produce an enriched map for LLM-guided exploration, keeping information concise but accurate.</li>
<li>Highlights focus on optimization for clarity within generated prompts.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Start by understanding how configurations are loaded and validated. These are your keys to unlocking hidden quests in Codora.</li>
<li>Pay attention to the mechanisms of <code class="inline-code">progressPercentage</code>‚Äîits math encapsulates the heart of tracking the knight‚Äôs journey.</li>
<li>Review quest generation workflows, as they provide insight into dynamic storytelling magic.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>With the quill of destiny and the valorous ink of ambition, thou hast inscribed thy name upon the scroll of triumph, gallant seeker, marking two realms conquered on thy epic path to legendary greatness! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="prev-quest-btn">‚Üê Previous: Quest 2</a>
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>