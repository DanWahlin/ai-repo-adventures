<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: The Dragon of Code Analysis - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Codex of Mystic Quests</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: The Dragon of Code Analysis</h1>
<hr>
<p>In the heart of the Kingdom of Computarion lies an unfathomable challenge ‚Äì the Dragon of Code Analysis. This fearsome creature has entwined itself within the sacred libraries, protecting the fragmented secrets of the &quot;Enchanted Codex of Mystic Quests.&quot; Brave adventurer, harness your magic of programming to unearth two guarded files, <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/analyzer/repo-analyzer.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/analyzer/repo-analyzer.ts</code></a> and <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/llm/llm-client.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/llm/llm-client.ts</code></a>, taming their spells. Only by conquering its riddles can the path to restoration begin.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/analyzer/repo-analyzer.ts:</span> The Pathfinder‚Äôs Map</h3>
<p>The Pathfinder must venture through <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/analyzer/repo-analyzer.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/analyzer/repo-analyzer.ts</code></a>, a treasure trove of magical enchantments that enable adventurers to explore specific files and generate optimized map-like content. At its core lies the ability to configure targeted repomix output (<code class="inline-code">RepoAnalyzer.generateTargetedContent</code>) from the chaotic ethers. The analyzer also validates a project&#39;s path (<code class="inline-code">RepoAnalyzer.validateProjectPath</code>) with precision to prevent traps laid by malicious spells. Lastly, the spellbinding method (<code class="inline-code">RepoAnalyzer.captureRepomixStdout</code>) summons subprocess commands that retrieve the map-like structures while resisting timeout breaches. Each incantation is vital for approaching the dragon‚Äôs lair.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">RepoAnalyzer.generateRepomixContext</code> enables a broad spectrum of context generation for paths, caching the results for efficiency.</li>
<li><code class="inline-code">RepoAnalyzer.generateTargetedContent</code> refines signatures to specific spells, shielding others from resource overuse.</li>
<li><code class="inline-code">RepoAnalyzer.captureRepomixStdout</code> orchestrates magic to extract code context using external invocation.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/analyzer/repo-analyzer.ts</h3>
<pre><code class="language-typescript">async generateRepomixContext(projectPath: string, options: RepomixOptions = {}): Promise&lt;string&gt; {
  this.validateProjectPath(projectPath);
  const ignorePatterns = [&#39;node_modules&#39;, &#39;dist&#39;, &#39;build&#39;, &#39;.git&#39;, &#39;coverage&#39;, &#39;.nyc_output&#39;];
  const cliOptions: CliOptions = { style: &#39;markdown&#39;, compress: true, ignore: ignorePatterns.join(&#39;,&#39;) };
  const context = await this.captureRepomixStdout([&#39;.&#39;], projectPath, cliOptions);
  return context;
}
</code></pre>
<p>Imagine casting a wide net over a region to reveal all its possible pathways, enabling a broad exploration of its magical terrains.</p>
<pre><code class="language-typescript">async generateTargetedContent(projectPath: string, targetFiles: string[], compress: boolean = true): Promise&lt;string&gt; {
  const safeFiles = this.validateAndNormalizeTargetFiles(projectPath, targetFiles);
  const cliOptions: CliOptions = { compress: compress, include: safeFiles.join(&#39;,&#39;), style: &#39;markdown&#39; };
  return this.captureRepomixStdout([&#39;.&#39;], projectPath, cliOptions);
}
</code></pre>
<p>This is akin to focusing a magical lens only on chosen artifacts within a vault, ensuring clarity without distraction.</p>
<pre><code class="language-typescript">private async captureRepomixStdout(directories: string[], cwd: string, options: CliOptions): Promise&lt;string&gt; {
  const args = [&#39;--stdout&#39;, &#39;--style&#39;, options.style || &#39;markdown&#39;];
  if (options.compress) args.push(&#39;--compress&#39;);
  const repomix = spawn(&#39;npx&#39;, [&#39;repomix&#39;, ...args], { cwd });
  let stdout = &#39;&#39;; repomix.stdout.on(&#39;data&#39;, data =&gt; { stdout += data.toString(); });
  return stdout;
}
</code></pre>
<p>Visualize a magician summoning a scroll of truth from distant lands while protecting against overwhelming magical responses.</p>
<hr>
<h3><span class="header-prefix">packages/core/src/llm/llm-client.ts:</span> The Dragon‚Äôs Whisper</h3>
<p>The file <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/llm/llm-client.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/llm/llm-client.ts</code></a> acts as a conduit to communicate with the dragon directly. Here lies the adventurer‚Äôs ability to engage (<code class="inline-code">LLMClient.generateResponse</code>) and request its wisdom using prompts filled with spells. The constructor (<code class="inline-code">LLMClient.constructor</code>) configures the dragon‚Äôs domain, ensuring the communication between kingdoms is well-guarded. Finally, <code class="inline-code">LLMClient.getApiKey</code> determines the most potent magical token, allowing access to the dragon‚Äôs thoughts. Through these artifacts, adventurers decipher the enigmatic clues to unlock fragments of the codex.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLMClient.generateResponse</code> creates the magical query and parses the response from the dragon.</li>
<li><code class="inline-code">LLMClient.constructor</code> initializes the connection for interaction.</li>
<li><code class="inline-code">LLMClient.getApiKey</code> retrieves the essential access token.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/llm/llm-client.ts</h3>
<pre><code class="language-typescript">async generateResponse(prompt: string, options?: LLMRequestOptions): Promise&lt;LLMResponse&gt; {
  const requestParams = this.buildRequestParams(prompt, options);
  const completion = await this.executeRequest(requestParams);
  const content = this.validateResponse(completion);
  return { content };
}
</code></pre>
<p>This function acts as the knight‚Äôs question posed to the dragon, carefully tailored to entice valuable truths.</p>
<pre><code class="language-typescript">constructor() {
  const apiKey = this.getApiKey();
  if (!apiKey || !LLM_BASE_URL) throw new Error(&#39;LLM configuration required.&#39;);
  this.client = new OpenAI({ apiKey, baseURL: LLM_BASE_URL });
}
</code></pre>
<p>Here, the knight secures their enchanted sword ‚Äì the configuration ‚Äì readying for the battle ahead.</p>
<pre><code class="language-typescript">private getApiKey(): string {
  return LLM_API_KEY || GITHUB_TOKEN || throw new Error(&#39;LLM_API_KEY required.&#39;);
}
</code></pre>
<p>This retrieval ensures the adventurer carries the proper key to open the gates to the realm of wisdom.</p>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Focus on <code class="inline-code">RepoAnalyzer</code> to untangle complex code spells guarding fragments of the codex.</li>
<li><code class="inline-code">LLMClient</code> will help you translate dragon whispers into meaningful clues to continue your mystical journey.</li>
<li>Next steps: Extract targeted quest highlights from additional files to grow your heroic artifacts.</li>
</ul>
<hr>
<p>You have advanced in the quest, brave adventurer! The enchanted path toward restoring the codex clears with every step.</p>
<p>With valiant resolve, thou hast vanquished the fiery Dragon of Code Analysis, fortifying thy realm&#39;s wisdom with newfound mastery‚Äîonward, noble hero, for thy legend sparks brighter with every quest! ‚ö°üöÄüíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="prev-quest-btn">‚Üê Previous: Quest 2</a>
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>