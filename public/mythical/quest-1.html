<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Enchantment Weaver - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Codex of Questoria</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Enchantment Weaver</h1>
<hr>
<p>In the magical kingdom of Questoria, the Enchanted Codex is the keystone of adventurers‚Äô dreams - a mythical artifact that empowers its wielder to transform code into enchanting stories. However, this relic has long been fragmented, with its knowledge buried in scattered scrolls. One such wondrous scroll resides within the halls of the Template Guild, where incantations take the form of rendered pages. Within these runes lies the path to unify rows of data, summon dynamic content, and breathe life into hollow templates.</p>
<p>Fellow traveler, your quest begins here! Will you wield the power of the Template Engine, ensuring the Codex‚Äôs wisdom awakens once more? Journey deep into the enchanted lines of <code class="inline-code">template-engine.ts</code>, and be guided by its companion, the Asset Keeper, within <code class="inline-code">asset-manager.ts</code>.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Hall of Cached Glyphs</strong>: How does template caching work, and what role does <code class="inline-code">loadTemplate</code> play in the reuse of magical scrolls?</li>
<li>‚ö° <strong>Incantation of Replacement</strong>: How are template placeholders dynamically replaced with enchanted values through <code class="inline-code">replacePlaceholders</code>?</li>
<li>üõ°Ô∏è <strong>Artefact Transference</strong>: In what ways does <code class="inline-code">copyGlobalAssets</code> ensure quest treasures are prepared for all themes while handling magical errors gracefully?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/generator/src/cli/template-engine.ts:</span> The Template Enchanter</h3>
<p>Deep within the Codex lies the Template Engine, a class that manipulates enchanted scrolls, stored in the <code class="inline-code">templates</code> directory. It summons these scrolls dynamically, replacing placeholders with context-specific variables to construct dynamic HTML pages. Core highlights include:</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Retrieves a template file, storing it in a cache for future use. If the scroll does not exist, an exception is raised, maintaining the reliability of the script.</li>
<li><code class="inline-code">replacePlaceholders</code>: Ensures each template‚Äôs placeholders (e.g., <code class="inline-code">{{key}}</code>) are replaced by their corresponding values, enchanting static scrolls for use in dynamic dispatch.</li>
<li><code class="inline-code">renderPage</code>: Combines a base template (always the foundation) with a content template, replacing placeholders and producing a fully rendered page.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/template-engine.ts</h3>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li><strong>What it does</strong>: Retrieves a template file and stores it in the local cache (<code class="inline-code">templateCache</code>) for optimized subsequent use.</li>
<li><strong>Patterns used</strong>: Implements caching to avoid redundant file read operations, improving performance.</li>
<li><strong>Challenges resolved</strong>: Dynamically loading templates from the file system while ensuring smooth operation through error handling when templates are missing.</li>
<li><strong>Connections</strong>: Essential to all template rendering methods, as templates are required before they can be rendered dynamically.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;

  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li><strong>Core functionality</strong>: Replaces placeholders such as <code class="inline-code">{{key}}</code> with corresponding variable values provided during function invocation.</li>
<li><strong>Technical techniques</strong>: Uses regular expressions to find placeholders and dynamically substitute values throughout the template.</li>
<li><strong>Efficiency</strong>: Processes templates in a single pass, ensuring optimal runtime performance even for dense content.</li>
<li><strong>Integration</strong>: Extensively used by <code class="inline-code">renderPage</code> to ensure complete generation of contextualized, ready-to-display content.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);

  // First render the content template
  const renderedContent = this.replacePlaceholders(contentHtml, variables);

  // Then render the base template with the content
  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li><strong>Purpose</strong>: Orchestrates the rendering of full HTML pages by joining base templates and content templates, enhancing reusability and modularity.</li>
<li><strong>Structure</strong>: Combines rendering layers iteratively to ensure accurate context propagation.</li>
<li><strong>Why it matters</strong>: Enables rapid prototyping of quests or documents, as only placeholders and specialized content need to be defined and merged.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<p>The Asset Manager safeguards the Codex‚Äôs visual treasures - icons, images, and shared artifacts. It handles the transference of assets across directories to ensure proper functionality during HTML quest generation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyGlobalAssets</code>: Transfers shared images and global assets to their respective locations, accommodating theme-specific and universal configurations.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Handles the duplication of navigation resources (CSS, JS) at both a local and global level depending on scope.</li>
<li><code class="inline-code">copyImages</code>: Ensures theme-unique and shared images are consolidated in the target output directory.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<pre><code class="language-typescript">copyGlobalAssets(outputDir: string): void {
  try {
    const globalAssetsDir = path.join(outputDir, &#39;assets&#39;);
    const targetImagesDir = path.join(globalAssetsDir, &#39;images&#39;);
    fs.mkdirSync(targetImagesDir, { recursive: true });

    // Copy global shared images to shared directory  
    const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
    fs.mkdirSync(globalSharedDir, { recursive: true });
    
    const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
    globalImages.forEach(file =&gt; {
      const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
      if (fs.existsSync(sourcePath)) {
        const targetPath = path.join(globalSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      }
    });

    // Copy header image for theme selection page
    const headerImageSource = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;, &#39;ai-adventures.png&#39;);
    if (fs.existsSync(headerImageSource)) {
      const headerImageTarget = path.join(targetImagesDir, &#39;ai-adventures.png&#39;);
      fs.copyFileSync(headerImageSource, headerImageTarget);
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy global images&#39;));
  }
}
</code></pre>
<ul>
<li><strong>What it does</strong>: Transfers assets critical for theme styling and quest guidance (e.g., images, headers) while copying shared components cleanly.</li>
<li><strong>Design principles</strong>: Ensures robust error handling and reusability across multi-themed environments.</li>
<li><strong>Contextual importance</strong>: A key facilitator in ensuring visual consistency and functionality of all generated quest environments.</li>
</ul>
<hr>
<pre><code class="language-typescript">copyQuestNavigator(outputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);
  const svgSource = path.join(templatesDir, &#39;compass-icon.svg&#39;);

  const assetsDir = path.join(outputDir, &#39;assets&#39;);
  fs.mkdirSync(assetsDir, { recursive: true });

  // Copy CSS file
  if (fs.existsSync(cssSource)) {
    fs.copyFileSync(cssSource, path.join(assetsDir, &#39;quest-navigator.css&#39;));
  }

  // Copy JS file  
  if (fs.existsSync(jsSource)) {
    fs.copyFileSync(jsSource, path.join(assetsDir, &#39;quest-navigator.js&#39;));
  }

  // Copy SVG icon
  if (fs.existsSync(svgSource)) {
    fs.copyFileSync(svgSource, path.join(assetsDir, &#39;compass-icon.svg&#39;));
  }
}
</code></pre>
<ul>
<li><strong>Purpose</strong>: Supplies individual themes or quests with unique navigational resources, ensuring structural autonomy.</li>
<li><strong>Handling limitations</strong>: Includes safety checks to handle any omission of expected assets without breaking dependent processes.</li>
<li><strong>Why it‚Äôs useful</strong>: Combines theme independence with the scalability required for multi-themed projects.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>‚ú® The Template Engine excels with modular design ‚Äì observe the separation of <code class="inline-code">replacePlaceholders</code> for flexibility in rendering.</li>
<li>‚öîÔ∏è When reading error handling flows, ensure reusable constructs like <code class="inline-code">loadTemplate</code> are properly leveraged.</li>
<li>üìú Practice combining themes with shared assets to reduce duplication while maintaining styling freedom.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Huzzah, noble seeker, you have woven the first thread of mastery in the Enchantment Weaver‚Äôs tapestry‚Äîlet the realms herald your triumph as you rise toward destiny‚Äôs stellar crown! ‚ö°üíé‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>