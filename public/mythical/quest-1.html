<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Hall of Ancient Tools - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'mythical' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Chronicles of Lumina: The Enchanted Repository</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Hall of Ancient Tools</h1>
<hr>
<p>In the mystical realm of Lumina, the adventurer steps boldly into the Hall of Ancient Tools, where an intricate dance of magic and mechanisms awaits. Glittering runes engraved on the walls recount tales of the kingdom‚Äôs past champions, their spirits bound forever to the tools they once wielded. This quest unfolds before you as a test to harness the Enchanted Repository‚Äôs knowledge. The tools, both wondrous and mysterious, demand wit and courage to unlock their latent powers. Will you succeed in deciphering their purpose and bring light to the shadows of their origins?</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/mcp/src/server.ts:</span> MCP server protocol implementation</h3>
<p>The <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/server.ts</code></a> file serves as the command center for establishing communication between the Enchanted Repository and its adventurers. Here lies the heart of the quest engine‚Äîthe <code class="inline-code">RepoAdventureServer</code>. This class orchestrates the tools that bring life to the adventure. Two key methods, <code class="inline-code">setupHandlers()</code> and <code class="inline-code">run()</code>, form the backbone of this process. In <code class="inline-code">setupHandlers()</code>, each tool is registered and furnished with the capability to validate inputs using schemas, ensuring that adventurers interact harmoniously with the system. The <code class="inline-code">run()</code> method then activates the adventurer‚Äôs gateway, employing <code class="inline-code">StdioServerTransport</code> for seamless connectivity and preloading magical insights of the repository via <code class="inline-code">repoAnalyzer.preGenerate()</code>.</p>
<p>The narrative doesn‚Äôt end there; the <code class="inline-code">main()</code> function heroically assumes its duty as the entry point, watching vigilantly for rogue errors and preparing the server for graceful shutdowns upon signals like <code class="inline-code">SIGINT</code> and <code class="inline-code">SIGTERM</code>. This structure ensures a robust and resilient foundation for the adventurer&#39;s journey, inviting further exploration with confidence.</p>
<h4>Highlights</h4>
<ul>
<li>Contains the <code class="inline-code">RepoAdventureServer</code> class that sets up the core MCP server.</li>
<li>Registers handlers for tools using <code class="inline-code">setupHandlers()</code> to validate and execute requests.</li>
<li>Activates communication transport in <code class="inline-code">run()</code>, supported by preloading repository insights.</li>
</ul>
<h3><span class="header-prefix">packages/mcp/src/tools.ts:</span> The adventure tools central entry point</h3>
<p>The <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/tools.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/tools.ts</code></a> file is a map to the enchanted tools adventurers will use to navigate their journey. It gathers together four pivotal tools‚Äî<code class="inline-code">start_adventure</code>, <code class="inline-code">choose_theme</code>, <code class="inline-code">explore_quest</code>, and <code class="inline-code">view_progress</code>‚Äîeach designed to add depth and color to the quest. These tools are assigned descriptive handlers, with <code class="inline-code">start_adventure</code> providing the opening doorway to analyze repositories and <code class="inline-code">choose_theme</code> weaving the narrative for adventures. The <code class="inline-code">explore_quest</code> tool immerses adventurers in the challenge of unraveling individual tasks, while <code class="inline-code">view_progress</code> ensures a beacon of guidance by tracking progress.</p>
<p>This file ensures all tools are bundled with corresponding metadata for easy access and feature dynamic validation to prevent misuse. Like the fabled four treasures of old, these tools offer their wisdom only to those with the will to wield them wisely.</p>
<h4>Highlights</h4>
<ul>
<li>Gathers and exports four key tools: <code class="inline-code">start_adventure</code>, <code class="inline-code">choose_theme</code>, <code class="inline-code">explore_quest</code>, and <code class="inline-code">view_progress</code>.</li>
<li>Establishes foundational interfaces to enable all MCP clients to interact with tools.</li>
<li>Links tools to descriptive handlers responsible for key parts of the journey.</li>
</ul>
<h2>Code</h2>
<h3>packages/mcp/src/server.ts</h3>
<pre><code class="language-typescript">private setupHandlers() {
  this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; {
    const toolList = Object.entries(tools).map(([name, tool]) =&gt; ({
      name,
      description: tool.description,
      inputSchema: zodToJsonSchema(tool.schema, { 
        target: &#39;jsonSchema7&#39;,
        $refStrategy: &#39;none&#39;
      })
    }));

    return { tools: toolList };
  });

  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    try {
      const { name, arguments: args } = request.params;

      if (!(name in tools)) {
        throw new McpError(ErrorCode.MethodNotFound, `Unknown tool: ${name}`);
      }

      const tool = tools[name as keyof typeof tools];
      
      const validationResult = tool.schema.safeParse(args);
      if (!validationResult.success) {
        const errorMessages = validationResult.error.issues.map((err) =&gt; 
          `${err.path.join(&#39;.&#39;)}: ${err.message}`
        ).join(&#39;, &#39;);
        throw new McpError(ErrorCode.InvalidParams, `Invalid parameters: ${errorMessages}`);
      }

      return await tool.handler(validationResult.data as any);
    } catch (error) {
      if (error instanceof McpError) {
        throw error;
      }
      throw new McpError(
        ErrorCode.InternalError,
        `Tool execution failed: ${error instanceof Error ? error.message : String(error)}`
      );
    }
  });
}
</code></pre>
<p>This method delegates tasks like listing tools and validating user commands, much like a librarian organizes and safeguards a repository of legendary tomes.</p>
<h3>packages/mcp/src/tools.ts</h3>
<pre><code class="language-typescript">export const tools = {
  start_adventure,
  choose_theme,
  explore_quest,
  view_progress
};
</code></pre>
<p>This section represents the adventurer&#39;s arsenal, providing a well-equipped toolkit for unraveling challenges and quests.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Cleanly structure server configurations and dynamic handlers for an easier debugging flow.</li>
<li>Explore <code class="inline-code">start_adventure</code> in detail to uncover how adventures are seeded from the repository insights.</li>
<li>Dive into <code class="inline-code">view_progress</code> to find opportunities to enhance feedback systems for adventurers.</li>
</ul>
<hr>
<p>O brave seeker, you have unlocked the hallowed mysteries of the Hall of Ancient Tools, igniting the first spark of your legendary odyssey‚Äîlet destiny‚Äôs tapestry unravel with your unyielding might! ‚öîÔ∏è ‚≠ê üó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2: The Rune of Storycraft ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>