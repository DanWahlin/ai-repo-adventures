<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Mystic Forge of Adventures - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Repository of Code Chronicles</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Mystic Forge of Adventures</h1>
<hr>
<p>In the mythical Kingdom of Codexia, you stand before the gates of the Enchanted Repository‚Äîthe nexus of magical constructs and arcane coding knowledge. Within its stone walls lies the ability to weave realms and write legendary quests. Your journey begins at the Mystic Forge, a place for shaping enchanted HTML adventures. The Forge sings with the hum of magical code threads, and its guardians, the Template Engine and Asset Manager, await your wisdom to unlock their secrets.</p>
<p>Prepare yourself, brave adventurer. This quest requires mastery over thematic generation, asset orchestration, and navigational design. Venture forward to shape Codexia‚Äôs newest tales!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>The Wizardry of Templates</strong>: How does <code class="inline-code">TemplateEngine</code> transform raw templates and placeholder variables into fully rendered HTML pages? How is template caching managed for efficiency?</li>
<li>‚ö° <strong>Arcane Asset Handling</strong>: What patterns does <code class="inline-code">AssetManager</code> employ to handle shared assets across themes and ensure proper file placement?</li>
<li>üõ°Ô∏è <strong>Navigational Magic</strong>: How does <code class="inline-code">HTMLAdventureGenerator</code> ensure smooth theme-specific quest navigation while adhering to Codexia‚Äôs organization principles?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/generator/src/cli/template-engine.ts:</span> Template Transformation</h3>
<p>The <code class="inline-code">TemplateEngine</code> class contains spells for loading, caching, and rendering templates, allowing us to infuse quest layouts with magical text. This file is vital for creating HTML adventures, enabling placeholder replacement and structured page assembly. Its caching mechanism ensures efficiency in the mystical forge, preventing redundant reads.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: This method retrieves templates, caching them after the first invocation to save time for repeated calls. Important for efficient asset generation within the forge.</li>
<li><code class="inline-code">replacePlaceholders</code>: A critical function that fills placeholders with variable data using regex patterns. Its purpose lies in dynamically embedding quest context into templates.</li>
<li><code class="inline-code">renderPage</code>: Combines two templates‚Äîa base template and a content template‚Äîby weaving placeholders together, producing complete pages for Codexia‚Äôs adventurers.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/asset-manager.ts:</span> Asset Orchestration</h3>
<p>The <code class="inline-code">AssetManager</code> class ensures that enchanted assets like images, stylesheets, and navigator scripts are carefully copied into their rightful locations across single and multi-theme adventures. Without this orchestration, the visual map of Codexia‚Äôs adventures would remain fragmented.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyImages</code>: Handles the duplication of thematic and shared images, ensuring visual continuity in the realm.</li>
<li><code class="inline-code">copySharedNavigator</code>: A spell that consolidates shared navigator assets like CSS and icons to a common directory for efficient access.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Ensures quest-specific navigational assets are copied to theme-specific directories, critical for proper user guidance within Codexia.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/html-generator.ts:</span> Quest Navigation and Integration</h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> is the mind behind the adventure progression. It manages themes, quests, and navigation links, ensuring that adventurers can seamlessly traverse Codexia‚Äôs enchanted paths.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: Orchestrates the creation of entire adventures, including quests, styling, and asset linking. It‚Äôs the pillar for structured HTML outputs.</li>
<li><code class="inline-code">buildQuestHTML</code>: Generates individual quest pages, embedding navigation links for sequential or themed browsing.</li>
<li><code class="inline-code">startHttpServer</code>: Deploys generated adventures for real-time exploration and testing, ensuring the magical paths remain open for adventurers.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/template-engine.ts</h3>
<pre><code class="language-typescript">/**
 * Load a template file with caching
 */
private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Efficient caching prevents repetitive reads of template files, saving computational effort.</li>
<li>Path resolution combines directories with filenames to ensure templates are retrieved correctly.</li>
<li>Graceful handling of loading failures ensures the forge doesn‚Äôt halt abruptly.</li>
</ul>
<pre><code class="language-typescript">/**
 * Replace placeholders in template with variables
 */
private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li>Regex-based design dynamically finds and replaces placeholder patterns for flexibility.</li>
<li>Keeps templates adaptable to varying themes, quests, or stories without altering structure.</li>
<li>Supports fallback values (<code class="inline-code">&#39;&#39;</code>) ensuring robust adventures regardless of missing inputs.</li>
</ul>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<pre><code class="language-typescript">/**
 * Copy images for single or multi-theme generation
 */
copyImages(outputDir: string, isMultiTheme: boolean = false): void {
  const sourceImagesDir = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;);
  const targetImagesDir = path.join(outputDir, &#39;assets&#39;, &#39;images&#39;);

  try {
    if (fs.existsSync(sourceImagesDir)) {
      fs.mkdirSync(targetImagesDir, { recursive: true });
      const imageFiles = fs.readdirSync(sourceImagesDir);
      imageFiles.forEach(file =&gt; {
        const sourcePath = path.join(sourceImagesDir, file);
        const targetPath = path.join(targetImagesDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      });
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy images from source directory&#39;));
  }
}
</code></pre>
<ul>
<li>Ensures thematic and shared assets are correctly duplicated for proper visual experiences.</li>
<li>Follows structured source-to-output asset placement for predictable file management.</li>
<li>Graceful error logging avoids interruptions while alerting for potential issues.</li>
</ul>
<pre><code class="language-typescript">/**
 * Copy quest navigator files to theme-specific location
 */
copyQuestNavigator(outputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);
  const svgSource = path.join(templatesDir, &#39;compass-icon.svg&#39;);
  
  const assetsDir = path.join(outputDir, &#39;assets&#39;);
  fs.mkdirSync(assetsDir, { recursive: true });

  // Copy navigator files
  if (fs.existsSync(cssSource)) {
    fs.copyFileSync(cssSource, path.join(assetsDir, &#39;quest-navigator.css&#39;));
  }
  if (fs.existsSync(jsSource)) {
    fs.copyFileSync(jsSource, path.join(assetsDir, &#39;quest-navigator.js&#39;));
  }
  if (fs.existsSync(svgSource)) {
    fs.copyFileSync(svgSource, path.join(assetsDir, &#39;compass-icon.svg&#39;));
  }
}
</code></pre>
<ul>
<li>Facilitates targeted theme navigation file setup for streamlined asset organization.</li>
<li>Ensures navigators integrate aesthetic and functionality for theme-specific identities.</li>
<li>Robust error handling ensures smooth execution.</li>
</ul>
<h3>packages/generator/src/cli/html-generator.ts</h3>
<pre><code class="language-typescript">/**
 * Build quest pages with navigational links
 */
private buildQuestHTML(quest: QuestInfo, content: string, questIndex: number): string {
  const prevQuest = questIndex &gt; 0 ? this.quests[questIndex - 1] : null;
  const nextQuest = questIndex &lt; this.quests.length - 1 ? this.quests[questIndex + 1] : null;

  let bottomNavigation = &#39;&#39;;
  const isLastQuest = questIndex === this.quests.length - 1;

  if (prevQuest || nextQuest || isLastQuest) {
    bottomNavigation = `
    &lt;div class=&quot;quest-navigation quest-navigation-bottom&quot;&gt;`;

    if (prevQuest) {
      bottomNavigation += `&lt;a href=&quot;${prevQuest.filename}&quot; class=&quot;prev-quest-btn&quot;&gt;‚Üê Previous: Quest ${questIndex}&lt;/a&gt;`;
    }
    
    if (nextQuest) {
      bottomNavigation += `&lt;a href=&quot;${nextQuest.filename}&quot; class=&quot;next-quest-btn&quot;&gt;Next: Quest ${questIndex + 2} ‚Üí&lt;/a&gt;`;
    } else if (isLastQuest) {
      bottomNavigation += `&lt;a href=&quot;summary.html&quot; class=&quot;next-quest-btn complete-btn&quot;&gt;Complete Adventure ‚Üí&lt;/a&gt;`;
    }
    
    bottomNavigation += `&lt;/div&gt;`;
  }

  const variables = {
    ...this.getCommonTemplateVariables(),
    PAGE_TITLE: this.formatInlineMarkdown(quest.title),
    QUEST_CONTENT: this.formatMarkdown(content),
    BOTTOM_NAVIGATION: bottomNavigation
  };

  return this.templateEngine.renderPage(&#39;quest-template.html&#39;, variables);
}
</code></pre>
<ul>
<li>Combines page-specific content with dynamic navigation elements for story progression.</li>
<li>Modular use of templates ensures consistent page layouts across varied themes.</li>
<li>Navigation ensures adventurers traverse Codexia seamlessly, respecting quest order.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use the <code class="inline-code">TemplateEngine</code> highlights to understand caching and efficient rendering processes.</li>
<li>Explore the asset copy functions to learn the organized handling of shared resources.</li>
<li>Study the <code class="inline-code">buildQuestHTML</code> method to master page structure and navigation magic.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Huzzah, noble adventurer! üéâ Your courage has wrought victory in Quest 1: The Mystic Forge of Adventures, and the realms sing your name as a blazing ‚≠ê among heroes‚Äîforge on, for greater glory awaits! ‚öîÔ∏è‚ú®</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>