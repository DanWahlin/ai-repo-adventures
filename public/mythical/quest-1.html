<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Enchanted HTML Weavers' Forge - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Kingdom of Enchanted Code</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Enchanted HTML Weavers&#39; Forge</h1>
<hr>
<p>In the mythical kingdom of Codethra, where enchanted code flows through the winds like whispers of old magic, chaos has struck the land. The HTML Weavers&#39; Forge, famed for crafting majestic web artifacts, has become unstable. Its delicate strands of mystic code‚Äîthe foundation of countless quests‚Äîare tangled and corrupted. As the chosen adventurer, you must venture deep into the HTML Forge, decoding scripts, cleansing templates, and restoring harmony through the art of weaving enchanted HTML. Only you can repair the fragile balance that sustains Codethra‚Äôs magical constructs.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Template Harmony</strong>: How does <code class="inline-code">TemplateEngine.replacePlaceholders</code> ensure variables are embedded correctly into HTML templates?</li>
<li>‚ö° <strong>Forge Flow</strong>: What techniques does <code class="inline-code">HTMLAdventureGenerator.generateAdventure</code> use to orchestrate the generation of quests and assets seamlessly?</li>
<li>üõ°Ô∏è <strong>Asset Preservation</strong>: How does <code class="inline-code">AssetManager.copyGlobalAssets</code> maintain shared resources in theme directories for multi-theme support?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/generator/src/cli/template-engine.ts:</span> Template Crafting Mechanics</h3>
<p>The <code class="inline-code">TemplateEngine</code> is a cornerstone in Codethra&#39;s HTML Weaver&#39;s Forge, handling the weaving of templates into structured HTML. It dynamically loads and caches template files, replaces placeholders with variables, and stitches templates seamlessly for dynamic content rendering.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Loads a template from the file system with caching, reducing redundant accesses and enhancing performance. It&#39;s critical for managing Codethra&#39;s enchanted template scrolls.</li>
<li><code class="inline-code">replacePlaceholders</code>: Replaces placeholders like <code class="inline-code">{{KEY}}</code> in templates with corresponding values from a variable map. This ensures the magic flows unbroken through the heroic code.</li>
<li><code class="inline-code">renderPage</code>: Constructs full HTML pages by embedding content templates into a base template. It represents the epitome of orchestration between template parts.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/template-engine.ts</h3>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);

  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Preloads and caches templates to avoid redundant file reads, optimizing the forge&#39;s workflow.</li>
<li>Utilizes <code class="inline-code">fs.readFileSync</code> for synchronous loading, ensuring templates are ready immediately.</li>
<li>Handles errors gracefully with an informative exception to alert adventurers of missing or inaccessible template scrolls.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;

  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }

  return result;
}
</code></pre>
<ul>
<li>Iterates through variable mappings to substitute placeholders with their corresponding values.</li>
<li>Uses regular expressions to find placeholders, ensuring full replacement across the template.</li>
<li>Avoids template fragmentation by replacing undefined variables with empty strings, preserving harmony.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);

  const renderedContent = this.replacePlaceholders(contentHtml, variables);

  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };

  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Combines base and content templates into a single cohesive page, stitching fragmented magic together.</li>
<li>Ensures modular rendering with variable substitution, enabling dynamic HTML generation.</li>
<li>Acts as the final craft of the forge, producing fully enchanted web pages.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/asset-manager.ts:</span> Asset Preservation Rituals</h3>
<p>The <code class="inline-code">AssetManager</code> preserves Codethra&#39;s shared images, styles, and navigators, ensuring adventurers across themes have consistent resources. It handles global asset synchronization and maintains organization within multi-theme configurations.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyGlobalAssets</code>: Safeguards globally shared images, such as the enchanted GitHub marks, and theme logos.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Specifically adjusts and deploys navigation assets within individual themes, ensuring adventurers can explore smoothly.</li>
<li><code class="inline-code">copyImages</code>: Transfers magical imagery to the appropriate directories, catering to both single and multi-theme adventures.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<pre><code class="language-typescript">copyGlobalAssets(outputDir: string): void {
  try {
    const globalAssetsDir = path.join(outputDir, &#39;assets&#39;);
    const targetImagesDir = path.join(globalAssetsDir, &#39;images&#39;);
    fs.mkdirSync(targetImagesDir, { recursive: true });

    const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
    fs.mkdirSync(globalSharedDir, { recursive: true });

    const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
    globalImages.forEach(file =&gt; {
      const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
      if (fs.existsSync(sourcePath)) {
        const targetPath = path.join(globalSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      }
    });

    const headerImageSource = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;, &#39;ai-adventures.png&#39;);
    if (fs.existsSync(headerImageSource)) {
      const headerImageTarget = path.join(targetImagesDir, &#39;ai-adventures.png&#39;);
      fs.copyFileSync(headerImageSource, headerImageTarget);
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy global images&#39;));
  }
}
</code></pre>
<ul>
<li>Creates necessary directories for globally shared assets within the forge‚Äôs output structure.</li>
<li>Copies GitHub and header images to centralized locations, ensuring visual consistency across quests.</li>
<li>Demonstrates robust error handling, logging warnings without halting operations when resources are unavailable.</li>
</ul>
<hr>
<pre><code class="language-typescript">copyQuestNavigator(outputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const sourceAssetsDir = path.join(this.sourceDir, &#39;assets&#39;);
  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);
  const svgSource = path.join(templatesDir, &#39;compass-icon.svg&#39;);

  const themeToggleCssSource = path.join(sourceAssetsDir, &#39;theme-toggle.css&#39;);
  const themeToggleJsSource = path.join(sourceAssetsDir, &#39;theme-toggle.js&#39;);

  const assetsDir = path.join(outputDir, &#39;assets&#39;);
  fs.mkdirSync(assetsDir, { recursive: true });

  if (fs.existsSync(cssSource)) {
    fs.copyFileSync(cssSource, path.join(assetsDir, &#39;quest-navigator.css&#39;));
  }
  if (fs.existsSync(jsSource)) {
    fs.copyFileSync(jsSource, path.join(assetsDir, &#39;quest-navigator.js&#39;));
  }
  if (fs.existsSync(svgSource)) {
    fs.copyFileSync(svgSource, path.join(assetsDir, &#39;compass-icon.svg&#39;));
  }

  if (fs.existsSync(themeToggleCssSource)) {
    fs.copyFileSync(themeToggleCssSource, path.join(assetsDir, &#39;theme-toggle.css&#39;));
  }
  if (fs.existsSync(themeToggleJsSource)) {
    fs.copyFileSync(themeToggleJsSource, path.join(assetsDir, &#39;theme-toggle.js&#39;));
  }
}
</code></pre>
<ul>
<li>Deploys navigation assets, ensuring each quest flows smoothly with a thematic compass guiding adventurers.</li>
<li>Copies theme toggling files into the appropriate directories, enabling stylistic flexibility between themes.</li>
<li>Guarantees that Codethra‚Äôs magical navigation scripts remain accessible across web artifacts.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/html-generator.ts:</span> The Orchestrator&#39;s Blueprint</h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> is the master overseer of quest creation‚Äîcombining templates, assets, and user input to forge fully realized adventures. Its rituals ensure quests are generated, styled, and organized for optimal exploration.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: The main orchestration function responsible for transforming code into quests and narrative stories.</li>
<li><code class="inline-code">generateAllThemes</code>: Creates adventures for multiple themes concurrently, balancing flow among Codethra‚Äôs diverse lands.</li>
<li><code class="inline-code">startHttpServer</code>: Deploys the forged adventures into a live environment for adventurers to experience and share.</li>
<li><code class="inline-code">buildQuestHTML</code>: Crafts individual quest pages with dynamic elements, ensuring smooth navigation through Codethra‚Äôs enchanted realms.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/html-generator.ts</h3>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
  try {
    console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
    const config = parseAdventureConfig(this.projectPath);
    const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);
    const projectInfo = createProjectInfo(repomixContent);

    console.log(chalk.dim(&#39;‚ú® Generating themed story and quests...&#39;));
    const storyContent = await this.adventureManager.initializeAdventure(
      projectInfo, 
      this.selectedTheme, 
      this.projectPath,
      this.customThemeData
    );

    this.extractQuestInfo();
    await this.generateQuestPages();
    console.log(chalk.dim(&#39;üéâ Creating adventure summary page...&#39;));
    await this.generateSummaryHTML();
  } catch (error) {
    console.error(chalk.red(&#39;‚ùå Error generating adventure:&#39;), error);
  }
}
</code></pre>
<ul>
<li>Serves as Codethra‚Äôs ceremonial conductor, transforming repository inputs into HTML quests and thematic narratives.</li>
<li>Integrates repository analysis and adventure initialization rituals, ensuring coherent content creation.</li>
<li>Handles errors gracefully, ensuring adventurers face minimal disruptions during their journeys.</li>
</ul>
<hr>
<pre><code class="language-typescript">buildQuestHTML(quest: QuestInfo, content: string, questIndex: number): string {
  const prevQuest = questIndex &gt; 0 ? this.quests[questIndex - 1] : null;
  const nextQuest = questIndex &lt; this.quests.length - 1 ? this.quests[questIndex + 1] : null;
  
  let bottomNavigation = &#39;&#39;;
  if (prevQuest || nextQuest || questIndex === this.quests.length - 1) {
    bottomNavigation += `&lt;div&gt;`;
    if (prevQuest) bottomNavigation += `&lt;a href=&quot;${prevQuest.filename}&quot;&gt;‚Üê Previous&lt;/a&gt;`;
    if (nextQuest) bottomNavigation += `&lt;a href=&quot;${nextQuest.filename}&quot;&gt;Next ‚Üí&lt;/a&gt;`;
    bottomNavigation += `&lt;/div&gt;`;
  }

  const variables = {
    QUEST_CONTENT: content,
    BOTTOM_NAVIGATION: bottomNavigation,
  };
  return this.templateEngine.renderPage(&#39;quest-template.html&#39;, variables);
}
</code></pre>
<ul>
<li>Combines content and navigation elements to magically weave individual quest pages.</li>
<li>Links quests in a seamless progression, enabling smooth exploration within Codethra‚Äôs enchanted HTML Forge.</li>
<li>Adapts navigation for single and multi-theme adventures, providing flexibility for various quest configurations.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Always address placeholder issues in template files to uphold enchantments and prevent disruptions.</li>
<li>Review shared asset directories for consistent file placement across themes to avoid duplication.</li>
<li>If errors arise during orchestration, inspect initialization methods for misconfigured parameters and paths.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of Codethra‚Äôs enchanted realms.</p>
<p>Through firelit trials and celestial resolve, you have emerged from the fabled Forge of HTML Weavers crowned with the shimmering wisdom of ancient code‚Äîonward, hero, for the stars await your next conquest! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>