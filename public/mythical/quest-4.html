<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Palace of Themes and Spells - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Kingdom of Code: The Enchanted Repository</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Palace of Themes and Spells</h1>
<hr>
<p>The Kingdom of Code brims with enchanted systems, but at its core lies the fabled Palace of Themes and Spells ‚Äì the archive where the magical styles of the land are defined and validated. Within its walls, ancient scrolls classify mystical themes, and spells ensure adventurers tread the right path. Brave one, your mission beckons! Uncover the Palace&#39;s inner workings to understand how its magical themes guide the realm and validate choices. Gather knowledge, for only then will you unlock the power to restore harmony.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Chronicles</strong>: How are the mystical themes structured, and what information do they contain about their powers and attributes?</li>
<li>‚ö° <strong>Pathway Guidance</strong>: How does the system determine the validity of a chosen theme or adventure path?</li>
<li>üõ°Ô∏è <strong>Enchanted Barriers</strong>: What protections ensure invalid choices or corrupted inputs cannot disrupt the kingdom?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Repository of Mythical Themes</h3>
<p>This file breathes life into the Kingdom of Code by defining its magical themes. It houses the <code class="inline-code">THEMES</code> object, a critical construct that enumerates available themes and their associated identifiers, descriptions, and keywords. Helper functions within this file, such as <code class="inline-code">getAllThemes</code>, <code class="inline-code">isValidTheme</code>, and <code class="inline-code">parseTheme</code>, act as guardians, ensuring input aligns with these mystical definitions. Additionally, it defines key operations for formatting and accessing theme data.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> object: Defines the universe of themes, including attributes like &quot;mythical&quot; and &quot;ancient&quot;.</li>
<li><code class="inline-code">getAllThemes</code> function: Collects and presents all themes in the kingdom.</li>
<li><code class="inline-code">parseTheme</code> function: Deciphers user input to determine its corresponding magical theme.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  // Additional themes truncated for brevity
} as const;
</code></pre>
<p>Every theme is akin to a character, defined by its name (key), symbol (emoji), and enchanting descriptors.</p>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<p>This function acts as a magical scroll, presenting a full list of available themes to adventurers.</p>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<p>This function acts as a translator, deciphering mortal input and mapping it to a magical theme.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Sword of Validation</h3>
<p>This file ensures harmony by validating user choices before they can disrupt the kingdom. Functions such as <code class="inline-code">validateAdventureChoice</code> and <code class="inline-code">validateTheme</code> check input for proper structure, preventing errors before they emerge. It acts like an enchanted sword that slices through invalid entries to ensure the realm remains stable.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> function: Ensures adventure inputs are non-empty and within acceptable length limits.</li>
<li><code class="inline-code">validateTheme</code> function: Validates received themes, guarding against invalid or malformed input.</li>
<li><code class="inline-code">sanitizeForDisplay</code> function: Protects the realm by cleaning and truncating potentially unsafe text.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<p>This function ensures adventurers&#39; choices are clear and concise before granting them access to the adventure.</p>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<p>This function ensures themes chosen by adventurers are valid, preventing intrusions from illegitimate elements.</p>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<p>This function safeguards the magical displays, turning potentially harmful content into harmless text suitable for mortal eyes.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">getAllThemes</code> to familiarize yourself with the kingdom‚Äôs available magical paths.</li>
<li>Study the <code class="inline-code">validateAdventureChoice</code> and <code class="inline-code">validateTheme</code> functions to understand how invalid inputs are blocked.</li>
<li>Watch how <code class="inline-code">parseTheme</code> uses keywords, keys, and IDs to unravel the mystery of user inputs.</li>
</ul>
<hr>
<p>Congratulations! You‚Äôve illuminated the magical workings of the Palace of Themes and Spells. Equipped with this wisdom, you are one step closer to restoring harmony to the Kingdom of Code!</p>
<p>With the wisdom of enchanted scrolls and the valor of a spellbound hero, you have triumphed in Quest 4: The Palace of Themes and Spells, forging onward through the mythical realms with 60% of your legendary journey complete‚Äîshine brightly, seeker of glory! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>