<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Castle's Heart - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Repository of Mystic Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Castle&#39;s Heart</h1>
<hr>
<p>In the enchanted realm of Codania, where magic intertwines with logic and code, an ancient castle protects its most vital treasure ‚Äì the Castle&#39;s Heart. This heart isn&#39;t just a mystical gem but a pulsating core of enchanted files that empower explorers with heroic skills. Only those guided by the wisdom of DevMancers can uncover its secrets by unraveling the delicate threads woven within its configuration spells, themes, and validations. Prepare, brave adventurer, to unlock Codania&#39;s mythical essence and safeguard its magical repository for future quests!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Echo of Eternity</strong>: How are critical timeouts and cache settings managed to ensure the repository&#39;s operations remain smooth amidst large-scale generation?</li>
<li>‚ö° <strong>Theme of the Crown</strong>: What mechanisms determine the validity of an adventurer‚Äôs theme selection, and how are themes enriched with enchanting details?</li>
<li>üõ°Ô∏è <strong>Path of Truth</strong>: Which validations protect critical user inputs such as the castle&#39;s directory and adventure choices from becoming invalid or corrupted?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration for magical operations</h3>
<p>This file serves as the spellbook of Codania, controlling critical operational settings like timeouts, cache lifetimes, and guiding the enchanted themes. With every line, constants and environmental variables are imbued with magical limits that shape the interaction between mortals and machines. Configuring limits ensures adventurers can explore vast code realms without succumbing to chaos or memory depletion.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Governs how long an enchanted query can linger before timing out, ensuring spells stay efficient.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Configures how long the repository retains cache before refreshing, maintaining balance between speed and relevance.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Establishes the upper limit for file size, protecting Codania from overwhelming invasions of excessive data.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> The gateway&#39;s protective runes</h3>
<p>This file safeguards the entry points of Codania&#39;s repository. It validates user inputs, ensuring only pure, error-free choices pass through its mystical gates. These validations prevent adventurers from veering into treacherous lands caused by invalid themes or corrupted paths.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures the adventurer&#39;s choice adheres to set rules of brevity and clarity, preventing rogue inputs from instability.</li>
<li><code class="inline-code">validateTheme</code>: Inspects the chosen theme for validity and matches it against the repository‚Äôs ancient records of mythical realms.</li>
<li><code class="inline-code">validateProjectPath</code>: Secures and sanitizes the repository‚Äôs path, protecting its enchanted infrastructure from ill-formed entries.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Codania‚Äôs chronicle of mythical realms</h3>
<p>Entrenched within this file is the central knowledge of Codania‚Äôs themes. Each theme acts as a mythical realm ‚Äì a curated adventure that blends user desires with structured storytelling. As the repository expands, this file ensures themes remain consistent, accessible, and enchanting.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Stores enchanted definitions for all supported realms, providing adventurers with contexts like mythical lands or ancient civilizations.</li>
<li><code class="inline-code">getAllThemes</code>: Retrives all magical realms, supporting exploration of their details and offering adventurers choice clarity.</li>
<li><code class="inline-code">isValidTheme</code>: Guards against invalid selections, fastening restricted entries to keep Codania&#39;s mechanisms precise and focused.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">// Timeouts in milliseconds for repository performance
export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 1-minute cache
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues
</code></pre>
<ul>
<li>This snippet sets parameters for critical operations, enabling predictable system performance and avoiding operational bottlenecks.</li>
<li>Constants ensure clashes between conflicting user inputs or excessive prompts are mitigated.</li>
<li>Timeout and size limits guard Codania against sprawling queries, preserving repository stability.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>These functions safeguard inputs, maintaining consistency and preventing errors from invalid choices or corrupted themes.</li>
<li>Input validations employ safeguards, ensuring inputs contain no invalid strings or misleading configurations.</li>
<li>Limits on length and normalization help mortals tame unwieldy or malicious entries.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical realms where databases are dragon hoards and functions are spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
};

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>Defines thematic realms like &quot;MYTHICAL,&quot; connecting adventurers with vivid environments tailored to their explorations.</li>
<li>Validation methods such as <code class="inline-code">isValidTheme</code> enforce the repository&#39;s consistency, ensuring only legitimate themes are applied.</li>
<li>Encapsulation of theme elements into readable definitions fosters clarity for explorers venturing into Codania&#39;s regions.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Check the repository boundaries: All constants have meaningful constraints to prevent unwanted behaviors.</li>
<li>Inspect input sanitization techniques to discover how invalid characters or missteps are gracefully balanced.</li>
<li>Explore theme definitions for a richer understanding of Codania‚Äôs multiverse adventure possibilities.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries in Codania‚Äôs enchanted repository.</p>
<p>With the Castle&#39;s Heart reclaimed and the beams of ancient wisdom igniting your path, you rise as a steadfast champion, blazing through the realm at 60% mastery‚Äîonward, valiant hero, for the stars themselves await your conquest! ‚ö°üëÅÔ∏è‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>