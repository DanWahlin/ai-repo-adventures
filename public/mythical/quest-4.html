<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Thematic Enchanter's Workshop - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Realm of Enchanted Repositories</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Thematic Enchanter&#39;s Workshop</h1>
<hr>
<p>In the mystical Kingdom of Codeoria, wise heroes gathered from far and wide to step into the Enchanter&#39;s Workshop, a realm where magical scripts and thematic spells forged the foundation of their adventures. Within this enchanted chamber lie the keys to crafting immersive themes and ensuring the paths of legendary quests align with the desires of brave seekers. Ancient scrolls and validating charms guard the entrance to this domain, designed to ensure all adventurers carry forth their intentions with precision. Do you possess the cognitive magic to unravel the intricacies of thematic enchantment?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Alignment</strong>: How do the code patterns ensure that a chosen theme is properly validated and assigned to an adventure?</li>
<li>‚ö° <strong>Ethereal Filters</strong>: What techniques are used to identify and match themes against various user inputs such as keywords or IDs?</li>
<li>üõ°Ô∏è <strong>Validation Spells</strong>: How does the code defend against invalid or harmful inputs, ensuring safe and functional system behavior?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Configuration for core system settings</h3>
<p>This file serves as the enchanted scroll dictating limits, defaults, and behavior for generating the adventure system. It defines constants that impose boundaries, such as token limits, API settings, and directory exclusions. The focus is on creating a scalable and adaptable environment by retrieving variables from the magical &quot;environment&quot; realm. Crucially, it ensures no spell exceeds its scope while customizing behavior thematically.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> configures how long the system waits on the LLM, balancing patience and efficiency.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> controls caching durations to optimize memory without overloading capacities.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> defines the size limits for files, crucial to avoiding memory exhaustion or inefficiency with oversized inputs.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> ensures processes leveraging the LLM don&#39;t hang indefinitely by enforcing an upper bound on completion time.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> dynamically adjusts the cache lifetime for temporary data storage, allowing flexibility based on the environment.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> prevents analysis of bloated files, promoting agility by concentrating on manageable inputs while avoiding performance pitfalls.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Definition and management of themes</h3>
<p>This file codifies all themes and their attributes while providing tools to validate, extract, and display theme information. It&#39;s the single source of truth for thematic identity. Functions simplify theme matching, making it faster and more reliable for adventurers to navigate a wide range of choices. It&#39;s significant for maintaining the consistency and alignment of adventures to their corresponding magical themes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> is the definitive repository of themed data, acting as the enchanted grimoire for all adventure options.</li>
<li><code class="inline-code">isValidTheme</code> guards against invalid themes, ensuring inputs are filtered like a protective spell.</li>
<li><code class="inline-code">getAllThemes</code> retrieves all themes, forming the foundation for user prompts and exploration.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: { /* Space Theme Configuration */ },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  /* Additional Themes */
} as const;
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> centralizes theme definitions, ensuring interface consistency and enabling structured expansion for new thematic elements.</li>
<li>Keywords allow broad matching options between user inputs and existing categories, accommodating varied adventurer lexicons.</li>
<li>Each theme embodies a carefully crafted identity, tying technical settings to immersive narratives.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li><code class="inline-code">isValidTheme</code> uses boolean checks to validate if an input aligns with registered themes, protecting against misuse with invalid or corrupted keys.</li>
<li>Acts as a safe-guard mechanism for ensuring system stability during theme assignments.</li>
<li>Implements simplicity and speed through efficient iteration over predefined themes.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li><code class="inline-code">getAllThemes</code> efficiently aggregates all available themes for potential query systems or prompts.</li>
<li>Facilitates use cases like dropdown menus or formatted lists for user selection.</li>
<li>Simplifies broader interactions with themes, avoiding repetitive code for core theme retrieval logic.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Validation of user inputs</h3>
<p>This file acts as the magical barrier to prevent improperly formed or harmful inputs from disrupting adventures. Through functions like <code class="inline-code">validateTheme</code>, it ensures that user-provided themes align with available options, while other methods handle general input trimming and sanitization. Input sanitization remains a critical protection against breaches in the intricate web of enchanted systems.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code> confirms that theme inputs are genuine, invoking all available checks on its legitimacy.</li>
<li><code class="inline-code">validateAdventureChoice</code> ensures user selections are lightweight, within bounds, and free of excess.</li>
<li><code class="inline-code">sanitizeForDisplay</code> purifies any visible input, limiting the potential for abuse or intrusion.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }

  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);

  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }

  return parsedTheme;
}
</code></pre>
<ul>
<li>Validates a theme against all known options by leveraging <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code>, ensuring user inputs remain well-structured.</li>
<li>Normalization ensures input flexibility, aligning varied capitalization or extra spaces to a defined standard.</li>
<li>Protects adventurers from inadvertently choosing incompatible or nonexistent themes.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Ensures user decisions don&#39;t exceed size constraints or stall functionality with invalid entries.</li>
<li>Prevents unintentional system abuse, such as overwhelming arrays or other data structures with oversized inputs.</li>
<li>Guarantees trimmed, clean output for subsequent stages of processing.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Cleanses outputs of potentially dangerous characters or excessive length, ensuring safe handling during display.</li>
<li>Provides an additional layer of defense against injection-based inaccuracies or security risks.</li>
<li>Highlights a proactive approach to sanitization, focusing on both utility and safety.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">getAllThemes</code> as the quickest way to display all thematic options to adventurers.</li>
<li>When dealing with inputs, always validate and sanitize early on to prevent errors downstream.</li>
<li>Customize themes by focusing on the <code class="inline-code">THEMES</code> object, but ensure new additions follow the same structure.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>With the legendary forging of wisdom in &quot;The Thematic Enchanter&#39;s Workshop,&quot; you shine as a true champion of the arcane realms‚Äîbraving 60% of the Kingdom&#39;s trials with valor and brilliance! ‚ö°üíéüëÅÔ∏èüöÄ</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>