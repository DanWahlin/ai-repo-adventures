<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Grand Configuration Codex - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Realm of Codaria</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Grand Configuration Codex</h1>
<hr>
<p>In the mystical realm of Codaria, where spells (code) maintain harmony and magic flows through every system, your latest trial takes you to the heart of the Grand Configuration Codex. This ancient tome holds the secrets of Codaria&#39;s system configuration, themes, and input validation‚Äîcritical elements that empower the kingdom&#39;s knights and wizards to safeguard their land. However, whispers tell of the Chaos Bug‚Äôs attempts to infiltrate and corrupt these foundational elements. Assemble the scattered wisdom of the enchanted scripts to fortify Codaria&#39;s defenses and ensure that configuration integrity endures.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Configuration Enchantment</strong>: How do constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> and <code class="inline-code">REPOMIX_CACHE_TTL</code> ensure stability and adaptability within Codaria&#39;s magical ecosystem?</li>
<li>‚ö° <strong>Theme Selection Arcana</strong>: What mechanisms enable the categorization and validation of themes, and how can this system support future expansions?</li>
<li>üõ°Ô∏è <strong>Validation Runes</strong>: How do the input validation methods protect Codaria‚Äôs realm against malicious or malformed entries?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Central Settings and Constants</h3>
<p>This file serves as the grand archive of Codaria‚Äôs foundational constants and settings. It dictates the system&#39;s key performance parameters, such as timeouts and limits for scanning and analysis. These constants ensure balance and prevent resource exhaustion while also providing provisions for user customization via environment variables. Additionally, it holds error messages and directory ignore patterns to shield Codaria‚Äôs wizards from distractions or dangerous consequences.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Regulates the maximum time allotted for long spells (requests) to the Codarian magical core (LLM).</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Controls the lifespan of cached results, balancing performance against freshness.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Protects against memory exhaustion by limiting file sizes processed in quests.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>The <code class="inline-code">LLM_REQUEST_TIMEOUT</code> ensures interactive spells do not lock up for too long, preserving a responsive system.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> allows adaptability by pulling environment-based configurations, supporting dynamic deployments.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> guarantees that adventures target manageable and meaningful files, avoiding performance degradation.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Ensuring the Purity of Choices</h3>
<p>This file wields powerful validation spells to protect Codaria‚Äôs Grand Configuration Codex against ill-formed input. By enforcing strict checks, it ensures theme choices, project paths, and adventure selections remain safe, functional, and within acceptable limits.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures players provide a valid, concise adventure selection.</li>
<li><code class="inline-code">validateTheme</code>: Validates and normalizes themes, safeguarding consistency.</li>
<li><code class="inline-code">validateProjectPath</code>: Shields the system from harmful or malformed project paths.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Verifies if a theme was provided and trims superfluous whitespace.</li>
<li>Uses <code class="inline-code">parseTheme</code> to normalize input and detect the correct theme format.</li>
<li>Throws informative errors when invalid themes are encountered, ensuring users stay on the righteous path of pre-approved themes.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Theme Management Codex</h3>
<p>The theme file contains the arcane knowledge behind Codaria‚Äôs themes. Each theme is a structured definition featuring unique identifiers and attributes, designed to guide user experience and quests. Helper functions enable easy access, validation, and the dynamic nature of theme expansion.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Dictates the essence of all predefined themes within Codaria.</li>
<li><code class="inline-code">getAllThemes</code>: Provides a comprehensive view of all canonical theme settings.</li>
<li><code class="inline-code">parseTheme</code>: Deciphers user input and maps it to a structured theme definition.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  ...
};
</code></pre>
<ul>
<li>Each theme features unique properties such as <code class="inline-code">id</code>, <code class="inline-code">displayName</code>, and <code class="inline-code">keywords</code>, enabling structured classification.</li>
<li>The <code class="inline-code">keywords</code> array makes each theme discoverable through various user inputs, enhancing usability.</li>
<li>All themes follow a unified definition, simplifying validation and ensuring consistency.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Efficiently normalizes and validates user input to detect themes by their <code class="inline-code">key</code>, <code class="inline-code">id</code>, or <code class="inline-code">keywords</code>.</li>
<li>Includes prioritization of exact matches before keyword-based discovery, enhancing precision.</li>
<li>The layer of error handling ensures that only valid themes are passed through.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use the <code class="inline-code">THEMES</code> to understand the structured definition of Codaria‚Äôs supported adventures.</li>
<li>Trace how validation methods work in coordination with <code class="inline-code">parseTheme</code> to ensure reliable input handling.</li>
<li>Test timeouts and limits from <code class="inline-code">config.ts</code> to simulate resource-bound scenarios.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries and vanquish the Chaos Bug once and for all.</p>
<p>Huzzah, valiant seeker! By harnessing the wisdom of the ancients, you have unlocked the Grand Configuration Codex, illuminating the celestial pathways of knowledge‚Äîmay your next triumph shine as brilliantly as the enchanted stars above! üåü‚öîÔ∏èüìñ</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>