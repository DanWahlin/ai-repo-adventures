<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Codex of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Enchanted Repository of the Mystic Engine</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Codex of Themes</h1>
<hr>
<p>In the land of Codoria, the Mystic Engine hums with anticipation, awaiting the touch of its destined hero. Legend tells of the Codex of Themes, a powerful collection of enchanted scrolls that hold the key to navigating through realms of magic, ancient wisdom, and cosmic wonders. The kingdom&#39;s secrets intertwine with these themes, each representing a unique lens of adventure. It is your noble quest to decode the Codex and decipher its magical essence, as understanding this will unlock unparalleled mastery over the castle&#39;s arcane machinery.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Patterns</strong>: How does the mystical <code class="inline-code">THEMES</code> object organize and define the Codex of Themes, aligning each entry with its magical properties?</li>
<li>‚ö° <strong>Essence Decoding</strong>: What unique mechanisms are employed in functions like <code class="inline-code">parseTheme</code> to interpret user inputs and align them with the kingdom‚Äôs available themes?</li>
<li>üõ°Ô∏è <strong>Validation Rituals</strong>: How does the <code class="inline-code">validateTheme</code> function ensure that errant wizardry (invalid themes) is safely thwarted?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Demystifying the Adventure Basics</h3>
<p>This file serves as the foundational grimoire for Codoria‚Äôs adventure system, defining rules and settings governing the Mystic Engine. Constants such as <code class="inline-code">MAX_FILE_SIZE_MB</code> and <code class="inline-code">REPOMIX_CACHE_TTL</code> form the magical boundaries spell-casters must respect. Notably, the <code class="inline-code">DEFAULT_THEME</code> sets the tone of the starting adventure realm as &quot;space,&quot; but the code hints at the flexibility to alter this with proper incantations.</p>
<h4><span class="header-prefix">Highlights:</span></h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: The limit for mystical invocations to return their insights.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: The temporal boundary for caching magical analyses.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: The threshold for avoiding overwhelming the Mystic Engine with excessively large spellbooks.</li>
</ul>
<h3>Code</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000;
</code></pre>
<p>The duration in milliseconds for awaiting the response of an invoked spell to craft quests.</p>
<pre><code class="language-typescript">export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); 
</code></pre>
<p>The time-to-live for caching magical scrolls created by Repomix, ensuring the engine remains efficient.</p>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10;
</code></pre>
<p>The file size limit that prevents overloading Codoria‚Äôs arcane machinery with vast tomes.</p>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> The Codex of Themes</h3>
<p>This enchanted scroll is the heart of the Codex, meticulously organizing mystical realms into the <code class="inline-code">THEMES</code> object. Each theme possesses properties like <code class="inline-code">keywords</code>, <code class="inline-code">emoji</code>, and <code class="inline-code">description</code> to guide adventurers on their path. Functions such as <code class="inline-code">parseTheme</code> and <code class="inline-code">getThemeByKey</code> act as key decoders for the Codex, ensuring adventurers accurately align with the specified mythical domain.</p>
<h4><span class="header-prefix">Highlights:</span></h4>
<ul>
<li><code class="inline-code">THEMES</code>: The master scroll containing all themes, from enchanted castles to cosmic exploration.</li>
<li><code class="inline-code">getAllThemes</code>: A function to summon the entire roster of the Codex of Themes.</li>
<li><code class="inline-code">parseTheme</code>: The mechanism for deciphering raw input and matching it to a theme.</li>
</ul>
<h3>Code</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: { ... },
  MYTHICAL: { ... },
  ANCIENT: { ... },
  DEVELOPER: { ... },
  CUSTOM: { ... },
} as const;
</code></pre>
<p>This object represents the sacred Codex, its entries describing realms and their associated properties.</p>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<p>A spell to list all available realities in the Codex for a hero‚Äôs selection.</p>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<p>A decoder spell that evaluates input and determines the corresponding entry in the Codex of Themes, leveraging keywords, identifiers, and names.</p>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Ensuring Sanctity of Choices</h3>
<p>This scroll embodies the kingdom‚Äôs protective layers, safeguarding the Mystic Engine from improper inputs. The <code class="inline-code">validateTheme</code> function scans theme inputs, ensuring that only valid entries from the Codex are accepted. It collaborates with the functions in <code class="inline-code">theme.ts</code>, such as <code class="inline-code">parseTheme</code>, to maintain the integrity of user choices.</p>
<h4><span class="header-prefix">Highlights:</span></h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Guards against invalid theme inputs and returns a normalized entry.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Ensures that no malicious spells (e.g., unsafe characters) are introduced into the visuals.</li>
<li><code class="inline-code">validateAdventureChoice</code>: Verifies and trims user-entered choices, avoiding errors from unclean inputs.</li>
</ul>
<h3>Code</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  return parsedTheme;
}
</code></pre>
<p>This function acts as the guardian of the kingdom, ensuring only valid theme inputs gain passage into the Mystic Engine.</p>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<p>Purification magic for removing unsafe characters from visualized user inputs.</p>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  return input.trim();
}
</code></pre>
<p>A function that ensures the knight‚Äôs adventure choice is both valid and properly formatted before being submitted to the Mystic Engine.</p>
<h2>Helpful Hints</h2>
<ul>
<li>When analyzing the Codex of Themes, focus on <code class="inline-code">THEMES</code> and related functions like <code class="inline-code">getAllThemes</code> and <code class="inline-code">parseTheme</code> to understand theme organization.</li>
<li>Use <code class="inline-code">input-validator.ts</code> to trace how improper inputs are rejected or corrected for the Mystic Engine.</li>
<li>Dive into <code class="inline-code">config.ts</code> for context on limits and constraints in Codoria‚Äôs magical quest framework.</li>
</ul>
<hr>
<p>Congratulations, Knight of Progress! With the Codex deciphered, you hold the key to unlocking the Mystic Engine‚Äôs boundless realms. Prepare for your next quest as the magic of the kingdom awaits your mastery!</p>
<p>With the Codex of Themes now secured in your heroic grasp, the kingdom‚Äôs stars align and thunderous applause echoes across the realms, heralding your triumphant march toward mastery with 60% of the quests vanquished‚Äîforge ahead, noble champion! ‚ö°üíéüëÅÔ∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>