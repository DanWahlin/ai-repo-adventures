<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Codex of Eternal Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Repository of Aetheria</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Codex of Eternal Themes</h1>
<hr>
<p>Safeguarded within a radiant chamber of the Repository of Codes, the Codex of Eternal Themes holds the secrets to harmonizing adventures across Aetheria. This artifact embodies the essence of every magical quest, dictating how themes shape the world and guide its heroes. Yet, the Chaos of Bugs seeks to desecrate these sacred scripts, twisting themes into incoherent whispers. Only by mastering its truths will you restore the Codex‚Äôs power and preserve the enchanted kingdom!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Unveiling</strong>: How does the <code class="inline-code">ThemeDefinition</code> structure ensure every theme is consistently represented, and what attributes enrich the themes?</li>
<li>‚ö° <strong>Magical Flow</strong>: How do the helper functions like <code class="inline-code">getAllThemes</code> or <code class="inline-code">isValidTheme</code> streamline the selection and validation processes for themes?</li>
<li>üõ°Ô∏è <strong>Shield of Validation</strong>: What mechanisms in <code class="inline-code">validateTheme</code> prevent invalid or corrupted theme inputs from infiltrating the system?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Thematic Core of Aetheria</h3>
<p>The <code class="inline-code">theme.ts</code> file represents the backbone of thematic consistency in the Repository of Codes. It defines the structure and behavior of themes, enabling them to seamlessly interact with the adventure system. At its heart, the <code class="inline-code">ThemeDefinition</code> interface outlines the properties of each theme, while utility functions such as <code class="inline-code">getThemeById</code>, <code class="inline-code">isValidTheme</code>, and <code class="inline-code">parseTheme</code> ensure that only valid, well-formed themes are incorporated.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">ThemeDefinition</code>: This interface defines the blueprint for organizing and enriching themes, encapsulating their unique identifiers, display names, attributes, and descriptions that capture the essence of Aetheria‚Äôs adventures.</li>
<li><code class="inline-code">getAllThemes</code>: A helper function that conveniently retrieves all available themes as an array, providing a central source for theme iteration without extra complexity.</li>
<li><code class="inline-code">parseTheme</code>: A parsing utility that interprets user input to determine the correct matching theme using normalization, keywords, or IDs.</li>
<li><code class="inline-code">isValidTheme</code>: A type-guard function that ensures the integrity of a theme key by verifying its existence and validity.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export interface ThemeDefinition {
  readonly id: number;
  readonly key: string;
  readonly displayName: string;
  readonly emoji: string;
  readonly description: string;
  readonly keywords: readonly string[];  // For matching user input
}
</code></pre>
<ul>
<li>Defines immutable properties for every theme, ensuring consistency.</li>
<li>Includes essential attributes like <code class="inline-code">id</code>, <code class="inline-code">key</code>, and <code class="inline-code">description</code> that are crucial for identification and context.</li>
<li>Uses the <code class="inline-code">keywords</code> array to introduce flexibility in matching user-provided inputs to themes.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li>Provides a straightforward way to fetch all registered themes as an array.</li>
<li>Removes the need for complex data structures like Maps in favor of simplicity and ease of iteration.</li>
<li>Acts as a foundation for other theme-related functions downstream.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Parses user input to determine the intended theme, making educated guesses based on keywords or theme IDs.</li>
<li>Includes multiple validation layers to accommodate diverse input formats.</li>
<li>Demonstrates robust input normalization and handling to minimize errors.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>Confirms the existence of a valid theme key within the predefined set of themes.</li>
<li>Guards against arbitrary or malformed theme inputs, reinforcing system integrity.</li>
<li>Efficiently utilizes array operations for validation without requiring additional computational overhead.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Remember that keywords in the <code class="inline-code">ThemeDefinition</code> are instrumental for user input matching‚Äîexplore how themes remain flexible yet precise.</li>
<li>Consider how <code class="inline-code">isValidTheme</code> and <code class="inline-code">parseTheme</code> work in concert to reconcile user intent with system definitions.</li>
<li>Investigate how themes cater to Aetheria‚Äôs magical diversity, allowing flexibility without breaking the established structure.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries and secure the Repository of Codes for future generations.</p>
<p>Hail, valiant seeker, with the unlocking of the Codex of Eternal Themes, you have summoned the wisdom of ages and carved your name into the stars of legend‚Äîonward to destiny, for the realm awaits your crowning triumph! ‚ö°üíéüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>