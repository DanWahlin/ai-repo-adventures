<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Mystic Forge of HTML - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Repository Chronicles</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Mystic Forge of HTML</h1>
<hr>
<p>In the enchanted realm of Codoria, the Mystic Forge of HTML is said to be the birthplace of all interactive adventures. Nestled deep within the forest of Templates, this forge is powered by the flames of the Template Engine, the precision of the Asset Manager, and the wisdom of the HTML Generator. As the chosen hero, your task is to master these enchanted tools and craft a magical HTML adventure. Beware, for the forge demands both skill and understanding to wield its power effectively.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Template Rendering</strong>: How templates are dynamically loaded and placeholders replaced in the <code class="inline-code">TemplateEngine</code>.</li>
<li>üîç <strong>Asset Management</strong>: Techniques for managing and copying shared and theme-specific assets using the <code class="inline-code">AssetManager</code>.</li>
<li>‚ö° <strong>HTML Generation Workflow</strong>: The orchestration of HTML generation and theme-specific content in the <code class="inline-code">HTMLAdventureGenerator</code>.</li>
<li>üí° <strong>Separation of Concerns</strong>: How modular design simplifies the pipeline for generating multi-theme adventures.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/template-engine.ts</code></a></h3>
<p>The <code class="inline-code">TemplateEngine</code> is the heart of the Mystic Forge, allowing the dynamic rendering of HTML templates. It loads templates from the filesystem, caches them for efficiency, and replaces placeholders with provided variables. This ensures that both base and content templates are seamlessly combined into a cohesive HTML page.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L25" target="_blank" rel="noopener noreferrer"><code class="inline-code">loadTemplate</code></a> caches and loads template files, ensuring efficient reuse across multiple render operations.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L44" target="_blank" rel="noopener noreferrer"><code class="inline-code">replacePlaceholders</code></a> substitutes variables in templates, dynamically generating content.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">renderPage</code></a> combines base and content templates into a complete HTML page.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Ensures efficient template reuse by caching loaded templates in memory.</li>
<li>Reduces filesystem overhead by avoiding redundant reads.</li>
<li>Provides clear error handling for missing or inaccessible templates.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li>Dynamically replaces placeholders (<code class="inline-code">{{key}}</code>) in templates with provided variable values.</li>
<li>Uses regular expressions to ensure all instances of a placeholder are replaced.</li>
<li>Supports flexible content generation by allowing variable substitution.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  
  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Combines base and content templates to create a complete HTML page.</li>
<li>Injects rendered content into the base template using the <code class="inline-code">CONTENT</code> variable.</li>
<li>Demonstrates the composability of templates for modular HTML generation.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/asset-manager.ts</code></a></h3>
<p>The <code class="inline-code">AssetManager</code> serves as the forge&#39;s artisan, handling the copying and management of assets such as images, CSS, and shared files. It ensures that each theme has the necessary resources to create a visually cohesive adventure.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L18" target="_blank" rel="noopener noreferrer"><code class="inline-code">copyImages</code></a> copies theme-specific and shared images to the output directory.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L54" target="_blank" rel="noopener noreferrer"><code class="inline-code">copySharedNavigator</code></a> consolidates shared assets like navigation CSS and JavaScript.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L97" target="_blank" rel="noopener noreferrer"><code class="inline-code">copyQuestNavigator</code></a> manages quest-specific navigator files for single-theme adventures.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">copyImages(outputDir: string, isMultiTheme: boolean = false): void {
  const sourceImagesDir = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;);
  const targetImagesDir = path.join(outputDir, &#39;assets&#39;, &#39;images&#39;);

  try {
    if (fs.existsSync(sourceImagesDir)) {
      fs.mkdirSync(targetImagesDir, { recursive: true });
      const imageFiles = fs.readdirSync(sourceImagesDir);
      imageFiles.forEach(file =&gt; {
        const sourcePath = path.join(sourceImagesDir, file);
        const targetPath = path.join(targetImagesDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      });
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy images from source directory&#39;));
  }
}
</code></pre>
<ul>
<li>Ensures all theme-specific images are copied to the appropriate output directory.</li>
<li>Uses <code class="inline-code">fs.mkdirSync</code> to create directories recursively if they don&#39;t exist.</li>
<li>Provides error handling to avoid interruptions during asset copying.</li>
</ul>
<hr>
<pre><code class="language-typescript">copySharedNavigator(rootOutputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const sharedAssetsDir = path.join(rootOutputDir, &#39;assets&#39;, &#39;shared&#39;);
  fs.mkdirSync(sharedAssetsDir, { recursive: true });

  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);
  
  if (fs.existsSync(cssSource)) {
    fs.copyFileSync(cssSource, path.join(sharedAssetsDir, &#39;quest-navigator.css&#39;));
  }
  if (fs.existsSync(jsSource)) {
    fs.copyFileSync(jsSource, path.join(sharedAssetsDir, &#39;quest-navigator.js&#39;));
  }
}
</code></pre>
<ul>
<li>Copies shared navigation assets like CSS and JavaScript to a consolidated directory.</li>
<li>Ensures assets are accessible across multiple themes by using a shared location.</li>
<li>Demonstrates modular asset management for multi-theme support.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/html-generator.ts</code></a></h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> orchestrates the entire HTML generation process, combining the power of the <code class="inline-code">TemplateEngine</code> and <code class="inline-code">AssetManager</code>. It manages everything from analyzing the codebase to generating quests and creating summary pages.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts#L235" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateAdventure</code></a> coordinates the entire HTML generation workflow, including analysis and quest generation.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateThemeCSS</code></a> combines theme-specific, base, and animations CSS into a single file.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts#L382" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateIndexHTML</code></a> builds the main adventure index page.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
  
  const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);
  const projectInfo = createProjectInfo(repomixContent);

  const storyContent = await this.adventureManager.initializeAdventure(
    projectInfo, 
    this.selectedTheme, 
    this.projectPath,
    this.customThemeData
  );

  this.extractQuestInfo();

  this.htmlBuilder = new HTMLBuilder(
    this.adventureManager,
    this.templateEngine,
    this.contentProcessor,
    this.projectPath,
    this.selectedTheme,
    this.isMultiTheme,
    this.quests
  );

  console.log(chalk.dim(&#39;üìñ Generating quest pages...&#39;));
  await this.contentGenerator.generateQuestPages();
}
</code></pre>
<ul>
<li>Orchestrates the entire workflow, from repository analysis to quest generation.</li>
<li>Initializes key components like <code class="inline-code">HTMLBuilder</code> and <code class="inline-code">ContentGenerator</code>.</li>
<li>Demonstrates how modular components are combined to achieve a cohesive pipeline.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <code class="inline-code">TemplateEngine</code> caches templates to improve efficiency in dynamic content generation.</li>
<li>Observe how <code class="inline-code">AssetManager</code> organizes assets for single and multi-theme adventures to maintain consistency.</li>
<li>Explore how <code class="inline-code">HTMLAdventureGenerator</code> coordinates various components to streamline the HTML generation process.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Create a New Template</strong>: Add a custom content template to the <code class="inline-code">templates</code> directory and modify the <code class="inline-code">TemplateEngine</code> to render it. Observe how placeholders are replaced with variables.</p>
</li>
<li><p><strong>Add a New Asset Type</strong>: Extend the <code class="inline-code">AssetManager</code> to copy a new type of asset (e.g., audio files). Test the functionality by adding theme-specific audio files to your adventure.</p>
</li>
<li><p><strong>Generate a Multi-Theme Adventure</strong>: Use the <code class="inline-code">HTMLAdventureGenerator</code> to create an adventure with all themes. Compare the output directories to understand how assets and templates are managed across themes.</p>
</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of Codoria‚Äôs enchanted codebase.</p>
<p>By the radiant glow of knowledge&#39;s eternal flame, you have emerged victorious from the Mystic Forge of HTML, forging the first blade of wisdom in your heroic quest‚Äîonward, brave coder, for the realms of mastery await! ‚ö°üíéüëÅÔ∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>