<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Adventure Pipeline - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Cosmic Codebase Chronicles</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: HTML Adventure Pipeline</h1>
<hr>
<p>The Starship Codex hovers at the edge of the Repository Nebula, its systems humming with the anticipation of discovery. Your mission begins in the HTML Adventure Pipeline, a critical subsystem designed to transform raw repository data into immersive, interactive narratives. As you navigate this system, you will uncover the intricate mechanisms that render stellar adventures into HTML pages, ensuring that every explorer can traverse the galaxy of code with ease.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Template Rendering</strong>: How the <code class="inline-code">TemplateEngine</code> dynamically replaces placeholders to generate complete HTML pages.</li>
<li>üîç <strong>Asset Management</strong>: Techniques used by the <code class="inline-code">AssetManager</code> to organize and copy shared resources for both single and multi-theme adventures.</li>
<li>‚ö° <strong>HTML Generation Workflow</strong>: The orchestration of adventure generation, including theme selection, quest creation, and output directory management.</li>
<li>üí° <strong>Extensibility Patterns</strong>: How modular design in the HTML generator supports isolated theme generation and multi-theme workflows.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/html-generator.ts</code></a></h3>
<p>The <code class="inline-code">html-generator.ts</code> file orchestrates the entire HTML adventure generation process. It handles theme selection, repository analysis, quest creation, and the final output of styled HTML pages. This file demonstrates how modular components, such as the <code class="inline-code">AdventureManager</code>, <code class="inline-code">TemplateEngine</code>, and <code class="inline-code">AssetManager</code>, work together to create a seamless generation pipeline.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts#L235" target="_blank" rel="noopener noreferrer"><code class="inline-code">HTMLAdventureGenerator.generateAdventure</code></a> coordinates the generation process, from repository analysis to creating quest pages and copying assets.</li>
<li><code class="inline-code">HTMLAdventureGenerator.generateAllThemes</code> enables parallel or sequential generation of multiple themes for multi-theme adventures.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts#L122" target="_blank" rel="noopener noreferrer"><code class="inline-code">HTMLAdventureGenerator.startWithArgs</code></a> processes command-line arguments to configure and execute the HTML generation workflow.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private async generateAdventure(): Promise&lt;void&gt; {
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
  console.log();

  // Load repository URL from adventure.config.json
  const config = parseAdventureConfig(this.projectPath);
  if (config &amp;&amp; typeof config === &#39;object&#39; &amp;&amp; &#39;adventure&#39; in config) {
    const adventure = (config as any).adventure;
    if (adventure &amp;&amp; typeof adventure.url === &#39;string&#39;) {
      this.repoUrl = adventure.url.replace(/\/$/, &#39;&#39;); // Remove trailing slash
    }
  }

  // Initialize content processor with project path and repo URL
  this.contentProcessor = new ContentProcessor(this.projectPath, this.repoUrl);

  // Step 1: Generate project analysis
  console.log(chalk.dim(&#39;üìä Analyzing codebase...&#39;));
  const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);
  const projectInfo = createProjectInfo(repomixContent);

  // Step 2: Initialize adventure
  console.log(chalk.dim(&#39;‚ú® Generating themed story and quests...&#39;));
  const storyContent = await this.adventureManager.initializeAdventure(
    projectInfo, 
    this.selectedTheme, 
    this.projectPath,
    this.customThemeData
  );

  // Save story content if logging is enabled
  this.saveLlmOutput(&#39;story.output.md&#39;, storyContent);

  // Step 3: Extract quest information
  this.extractQuestInfo();

  // Step 4: Generate all files
  console.log(chalk.dim(&#39;üé® Creating theme styling...&#39;));
  await this.generateThemeCSS();

  console.log(chalk.dim(&#39;üß≠ Adding quest navigator...&#39;));
  if (!this.isMultiTheme) {
    const assetManager = await this.getAssetManager();
    assetManager.copyQuestNavigator(this.outputDir);
  }

  console.log(chalk.dim(&#39;üñºÔ∏è Copying images...&#39;));
  if (!this.isMultiTheme) {
    const assetManager = await this.getAssetManager();
    assetManager.copyImages(this.outputDir, this.isMultiTheme);
  }

  console.log(chalk.dim(&#39;üìù Creating main adventure page...&#39;));
  this.generateIndexHTML();

  console.log(chalk.dim(&#39;üìñ Generating quest pages...&#39;));
  await this.contentGenerator.generateQuestPages();

  console.log(chalk.dim(&#39;üéâ Creating adventure summary page...&#39;));
  await this.generateSummaryHTML();
}
</code></pre>
<ul>
<li>This function orchestrates the entire adventure generation process, ensuring a smooth workflow.</li>
<li>Repository analysis (<code class="inline-code">repoAnalyzer.generateRepomixContext</code>) feeds critical project data into the adventure pipeline.</li>
<li>Modular components like <code class="inline-code">ContentProcessor</code> and <code class="inline-code">AssetManager</code> handle specialized tasks, promoting code reuse and maintainability.</li>
<li>The function dynamically adapts to single or multi-theme modes, demonstrating flexibility in design.</li>
<li>Extensive logging provides transparency and aids in debugging.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/template-engine.ts</code></a></h3>
<p>The <code class="inline-code">TemplateEngine</code> is a lightweight utility for rendering HTML pages by replacing placeholders in templates with dynamic content. This file highlights how simple yet powerful template engines can drive HTML generation.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">TemplateEngine.renderPage</code></a> renders a complete HTML page by combining a base template with content templates.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L44" target="_blank" rel="noopener noreferrer"><code class="inline-code">TemplateEngine.replacePlaceholders</code></a> replaces placeholders in templates with actual values from a provided variable map.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L25" target="_blank" rel="noopener noreferrer"><code class="inline-code">TemplateEngine.loadTemplate</code></a> caches and retrieves template files for efficient reuse.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  // First render the content template
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  
  // Then render the base template with the content
  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>This function combines a base layout with dynamic content, ensuring consistency across pages.</li>
<li>The use of placeholder replacement allows for flexible and reusable templates.</li>
<li>By separating content and layout, the function adheres to the Single Responsibility Principle.</li>
<li>Caching templates with <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L25" target="_blank" rel="noopener noreferrer"><code class="inline-code">loadTemplate</code></a> improves performance, especially for multi-page adventures.</li>
<li>The modular design makes it easy to extend for additional templates or themes.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/asset-manager.ts</code></a></h3>
<p>The <code class="inline-code">AssetManager</code> handles copying and organizing shared assets, such as images, CSS, and JavaScript files, for the generated HTML adventures. This file demonstrates robust file system operations and error handling.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L134" target="_blank" rel="noopener noreferrer"><code class="inline-code">AssetManager.copyGlobalAssets</code></a> copies shared assets, including images and CSS, to the output directory.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L97" target="_blank" rel="noopener noreferrer"><code class="inline-code">AssetManager.copyQuestNavigator</code></a> adds navigation assets to theme-specific directories.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L186" target="_blank" rel="noopener noreferrer"><code class="inline-code">AssetManager.loadThemeCSS</code></a> loads theme-specific CSS files with optional fallbacks.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">copyGlobalAssets(outputDir: string): void {
  try {
    const globalAssetsDir = path.join(outputDir, &#39;assets&#39;);
    const targetImagesDir = path.join(globalAssetsDir, &#39;images&#39;);
    fs.mkdirSync(targetImagesDir, { recursive: true });

    // Copy global shared images to shared directory
    const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
    fs.mkdirSync(globalSharedDir, { recursive: true });

    const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
    globalImages.forEach(file =&gt; {
      const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
      if (fs.existsSync(sourcePath)) {
        const targetPath = path.join(globalSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      }
    });

    // Copy header image for theme selection page
    const headerImageSource = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;, &#39;ai-adventures.png&#39;);
    if (fs.existsSync(headerImageSource)) {
      const headerImageTarget = path.join(targetImagesDir, &#39;ai-adventures.png&#39;);
      fs.copyFileSync(headerImageSource, headerImageTarget);
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy global assets&#39;));
    throw error;
  }
}
</code></pre>
<ul>
<li>This function ensures all necessary assets are available in the output directory for consistent user experiences.</li>
<li>The use of <code class="inline-code">fs.mkdirSync</code> with <code class="inline-code">recursive: true</code> creates directories as needed, simplifying asset management.</li>
<li>Error handling with <code class="inline-code">try-catch</code> ensures that issues during asset copying do not crash the entire pipeline.</li>
<li>The function supports both single and multi-theme workflows by organizing assets accordingly.</li>
<li>Modular design allows for easy extension to support additional asset types or formats.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use the <code class="inline-code">--theme</code> option with <code class="inline-code">npm run generate-html</code> to quickly test different themes.</li>
<li>Explore the <code class="inline-code">TemplateEngine</code> to understand how placeholder replacement simplifies HTML generation.</li>
<li>Study how the <code class="inline-code">AssetManager</code> organizes assets to ensure consistency across all generated themes.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Add a Custom Placeholder</strong>: Modify the <code class="inline-code">TemplateEngine</code> to support a new placeholder, such as <code class="inline-code">{{FOOTER_TEXT}}</code>. Update a template file to include this placeholder and pass a value for it during rendering.</p>
</li>
<li><p><strong>Trace Asset Copying</strong>: Add console logs to the <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L134" target="_blank" rel="noopener noreferrer"><code class="inline-code">AssetManager.copyGlobalAssets</code></a> method to trace which files are being copied. Run the generator and verify the output directory structure.</p>
</li>
<li><p><strong>Experiment with Multi-Theme Mode</strong>: Run the generator with the <code class="inline-code">--theme all</code> option and observe how the system handles parallel theme generation. Analyze the output directories for each theme.</p>
</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Starship Codex&#39;s systems.</p>
<p>Mission accomplished, cosmic explorer‚Äîyour mastery of the HTML Adventure Pipeline has ignited like a supernova, propelling you one star closer to intergalactic coding brilliance! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>