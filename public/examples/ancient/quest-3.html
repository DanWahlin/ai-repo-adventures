<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Quest Forge - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Pyramid of Code</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: The Chamber of Configurations</h1>
<hr>
<p>As you delve deeper into the Pyramid of Code, you discover the Chamber of Configurations, where ancient glyphs whisper secrets about managing complex systems. The walls are adorned with inscriptions detailing the art of structuring configurations and themes, ensuring harmony across the vast domains of the codebase. The chamber challenges you to decipher these inscriptions and master the techniques of dynamic configuration, validation, and theme management to unlock the next path.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Dynamic Configuration Loading</strong>: How configuration files are read, parsed, and validated to adapt to project needs.</li>
<li>üîç <strong>Theme Management</strong>: Techniques for generating and applying themes dynamically across different parts of the system.</li>
<li>‚ö° <strong>Validation Patterns</strong>: How input validation ensures consistent and secure processing of user and system data.</li>
<li>üí° <strong>Integration with Content Generation</strong>: How configurations influence story generation and quest formatting.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<p>The <code class="inline-code">adventure-config.ts</code> file is a critical piece in the Chamber of Configurations, responsible for loading, parsing, and extracting data from the <code class="inline-code">adventure.config.json</code> file. Its functions enable dynamic project configuration, ensuring that adventures are tailored to the specific structure and requirements of the codebase. This file demonstrates patterns for safe file handling, JSON parsing, and data extraction, making it an essential tool in the quest for dynamic content generation.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L19" target="_blank" rel="noopener noreferrer"><code class="inline-code">loadAdventureConfig</code></a>: Reads the raw configuration file text from the project directory.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L28" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseAdventureConfig</code></a>: Parses the configuration JSON and validates its structure, providing a safe entry point for configuration data.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L41" target="_blank" rel="noopener noreferrer"><code class="inline-code">extractUniqueFilePaths</code></a>: Extracts and validates file paths referenced in the configuration, ensuring they exist within the project.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L75" target="_blank" rel="noopener noreferrer"><code class="inline-code">formatAdventureConfigForPrompt</code></a>: Formats the configuration data for use in LLM prompts, optimizing it for concise and effective storytelling.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<ul>
<li>This function reads the configuration file from the specified project path.</li>
<li>It uses <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L6" target="_blank" rel="noopener noreferrer"><code class="inline-code">readFileIfExists</code></a> to handle missing or unreadable files gracefully.</li>
<li>Ensures the system can adapt to projects with or without configuration files.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Parses the JSON content of the configuration file, returning structured data or <code class="inline-code">null</code> on error.</li>
<li>Centralizes error handling to prevent crashes from malformed files.</li>
<li>Validates the structure of the configuration, ensuring it aligns with expected patterns.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Extracts file paths from the configuration, validating their existence in the project directory.</li>
<li>Uses a stack-based traversal to explore nested objects and arrays.</li>
<li>Ensures only valid and unique paths are returned, avoiding duplicates.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<p>The <code class="inline-code">theme.ts</code> file serves as the glyph of visual storytelling, defining and validating themes for adventures. It encapsulates the logic for managing pre-defined and custom themes, ensuring consistent styling and vocabulary across quests. This file illustrates how themes are structured, validated, and applied dynamically.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L88" target="_blank" rel="noopener noreferrer"><code class="inline-code">isValidTheme</code></a>: Validates whether a given theme is supported by the system.</li>
<li><code class="inline-code">ThemeDefinition</code>: Provides the schema for defining new themes, ensuring they follow the required structure.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L82" target="_blank" rel="noopener noreferrer"><code class="inline-code">getAllThemes</code></a>: Retrieves a list of all available themes, including custom ones.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export function isValidTheme(theme: string): boolean {
  return THEMES.includes(theme);
}
</code></pre>
<ul>
<li>Checks if the provided theme exists in the predefined list of themes.</li>
<li>Ensures adventures use consistent and supported themes.</li>
<li>Prevents errors caused by invalid or unsupported theme inputs.</li>
</ul>
<hr>
<pre><code class="language-typescript">export interface ThemeDefinition {
  name: string;
  description: string;
  keywords: string[];
  cssFilePath?: string;
}
</code></pre>
<ul>
<li>Defines the structure for themes, including optional CSS file paths for styling.</li>
<li>Enables the creation of custom themes with specific keywords and descriptions.</li>
<li>Provides flexibility for extending the system with new visual styles.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES.map(theme =&gt; ({
    name: theme,
    description: `The ${theme} theme provides a unique perspective for code exploration.`,
    keywords: [`${theme}-themed`, `${theme} exploration`],
  }));
}
</code></pre>
<ul>
<li>Generates a list of all available themes dynamically.</li>
<li>Includes descriptions and keywords to guide users in selecting a theme.</li>
<li>Demonstrates the use of mapping for creating structured data from simple arrays.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L28" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseAdventureConfig</code></a> to validate configuration files before using their data.</li>
<li>Explore how <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L41" target="_blank" rel="noopener noreferrer"><code class="inline-code">extractUniqueFilePaths</code></a> ensures referenced files exist, preventing runtime errors.</li>
<li>Study <code class="inline-code">ThemeDefinition</code> to understand how themes are structured and extended.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Create a Custom Theme</strong>: Define a new theme in <code class="inline-code">theme.ts</code> with a unique name, description, and keywords. Add a custom CSS file and test its integration with the system.</p>
<ul>
<li>Example: &quot;Create an &#39;Oceanic&#39; theme with aquatic vocabulary and blue-toned styling.&quot;</li>
</ul>
</li>
<li><p><strong>Validate Configuration Paths</strong>: Modify <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L41" target="_blank" rel="noopener noreferrer"><code class="inline-code">extractUniqueFilePaths</code></a> to log invalid paths and suggest corrections. Test it with a configuration file containing both valid and invalid paths.</p>
<ul>
<li>Example: &quot;Add error messages for paths that do not exist and propose similar existing paths.&quot;</li>
</ul>
</li>
<li><p><strong>Optimize Prompt Formatting</strong>: Enhance <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L75" target="_blank" rel="noopener noreferrer"><code class="inline-code">formatAdventureConfigForPrompt</code></a> to include additional metadata like quest difficulty or estimated time. Test how this affects LLM responses.</p>
<ul>
<li>Example: &quot;Include quest complexity levels to guide LLM-generated content.&quot;</li>
</ul>
</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to unlock more mysteries hidden within the Pyramid of Code.</p>
<p>Hail, seeker of wisdom, for thou hast tempered thy spirit in the sacred fires of The Quest Forge, forging thy path with valor‚Äîpress onward, for the stars of ancient glory yet await thee! ‚≠ê‚ö°üó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="prev-quest-btn">‚Üê Previous: Quest 2</a>
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>