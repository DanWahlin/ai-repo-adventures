<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Tablets of Configuration - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Sacred Repository of Ancient Wisdom</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Tablets of Configuration</h1>
<hr>
<p>In the heart of the Sacred Repository lies the Tablets of Configuration, ancient artifacts inscribed with the secrets of system stability and adaptability. These tablets, revered by the ancients, hold the keys to managing resources, defining boundaries, and orchestrating harmonious interactions between components. As you carefully examine their inscriptions, you uncover timeless wisdom encoded in constants, validation techniques, and dynamic theme management. These discoveries promise to guide your journey toward mastering the balance between flexibility and control in the realm of code.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Configuration Constants</strong>: How centralized constants enforce system-wide stability and scalability.</li>
<li>üîç <strong>Theme Management</strong>: Methods for dynamically handling themes and their associated assets.</li>
<li>‚ö° <strong>Validation Techniques</strong>: Strategies for ensuring user input adheres to predefined constraints.</li>
<li>üí° <strong>Dynamic Parsing</strong>: How modular parsing adapts system behavior based on configuration files.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<p>The Tablets of Configuration define the core constants and parameters that govern the Sacred Repository. This file centralizes all critical settings, including timeouts, resource limits, and environment variables. It ensures consistent behavior across the system while allowing flexibility through external configurations like <code class="inline-code">.env</code> files. The architectural decisions here demonstrate how to balance default values with dynamic overrides, ensuring reliability and adaptability.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> defines the maximum duration for LLM API calls, ensuring timely responses.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> specifies caching duration for repository analysis results, optimizing performance.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> sets limits on file size for analysis, preventing resource exhaustion.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds for complex story generation
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;300000&#39;); // 5 minutes
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> ensures API calls complete within a reasonable timeframe, enhancing user experience.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> uses caching to reduce redundant computations, improving system efficiency.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> prevents overloading memory by skipping excessively large files during analysis.</li>
<li>Centralized constants provide a single source of truth, simplifying debugging and configuration management.</li>
<li>The use of environment variables enables dynamic adjustments without changing code.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<p>The Tablets of Configuration also encapsulate the wisdom of theme management, allowing adventurers to traverse different realms of exploration. This file defines the structure and properties of themes, enabling dynamic selection and customization. The theme-related functions ensure seamless integration of visual elements and user preferences into the adventure system.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L78" target="_blank" rel="noopener noreferrer"><code class="inline-code">getThemeByKey</code></a> retrieves theme definitions based on their unique keys, ensuring accurate mapping.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> dynamically matches user input to themes using keywords or IDs.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L125" target="_blank" rel="noopener noreferrer"><code class="inline-code">getFormattedThemeOptions</code></a> provides a display-ready list of themes for user selection.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;

  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }

  return null;
}
</code></pre>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> uses normalization and keyword matching to dynamically interpret user input.</li>
<li>The function supports multiple input formats (e.g., IDs, keywords), enhancing flexibility.</li>
<li>Iterative matching ensures robust theme detection even with partial or imprecise inputs.</li>
<li>The modular approach separates theme parsing logic, making it reusable and maintainable.</li>
<li>This design supports extensibility, allowing new themes to be added without altering core logic.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<p>The Tablets of Configuration also safeguard the repository with validation techniques to ensure the integrity of user input. This file defines simple yet effective methods for sanitizing and validating data, protecting the system from errors and malicious entries.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts#L686" target="_blank" rel="noopener noreferrer"><code class="inline-code">validateTheme</code></a> checks user-provided themes against available options, enforcing correctness.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">validateProjectPath</code></a> ensures file paths are valid and within acceptable limits.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts#L53" target="_blank" rel="noopener noreferrer"><code class="inline-code">sanitizeForDisplay</code></a> removes potentially harmful characters from text displayed to users.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }

  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);

  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }

  return parsedTheme;
}
</code></pre>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts#L686" target="_blank" rel="noopener noreferrer"><code class="inline-code">validateTheme</code></a> ensures user input matches predefined themes, preventing invalid selections.</li>
<li>The function uses <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> for dynamic matching, leveraging centralized theme logic.</li>
<li>Error messages provide clear feedback, improving user experience and reducing confusion.</li>
<li>Validation techniques prevent system misuse and maintain data integrity.</li>
<li>This approach demonstrates defensive programming, safeguarding critical operations.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how centralized constants in <code class="inline-code">config.ts</code> simplify adjustments across the system.</li>
<li>Observe how <code class="inline-code">theme.ts</code> handles dynamic user input with normalization and keyword matching.</li>
<li>Explore the validation logic in <code class="inline-code">input-validator.ts</code> for insights into error handling and user feedback.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Add a New Theme</strong>: Create a custom theme by modifying <code class="inline-code">theme.ts</code>. Define its properties, keywords, and emoji, then test its integration with the system.</p>
<ul>
<li>Example: Add a &quot;Cyberpunk&quot; theme with futuristic keywords and neon styling.</li>
</ul>
</li>
<li><p><strong>Enhance Validation Feedback</strong>: Modify <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts#L686" target="_blank" rel="noopener noreferrer"><code class="inline-code">validateTheme</code></a> to suggest the closest matching theme when an invalid input is provided. This will improve user experience and demonstrate advanced validation techniques.</p>
</li>
<li><p><strong>Dynamic Configuration</strong>: Experiment with changing environment variables like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> or <code class="inline-code">REPOMIX_CACHE_TTL</code> in <code class="inline-code">.env</code> and observe their impact on system behavior.</p>
</li>
</ol>
<hr>
<p>You have mastered all the secrets of the Sacred Repository! Your adventure is complete.</p>
<p>By the sacred light of the eternal flame, thou hast unlocked the wisdom of the Tablets of Configuration, forging a path through the annals of time‚Äîpress onward, seeker, for the final truth awaits! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>