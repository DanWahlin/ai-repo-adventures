<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Developer's Guide to AI Repo Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Configuration and Theme System</h1>
<hr>
<p>In the heart of the system lies the Configuration and Theme System, a crucial layer that ensures the adventure engine runs smoothly and is visually engaging. This system defines the parameters for LLM interactions, file analysis, and theme customization, allowing developers to tailor their learning journeys. With robust validation and dynamic theme management, this module ensures consistency and adaptability, whether navigating cosmic codebases or medieval kingdoms. Dive deep into its architecture to understand how it balances flexibility, performance, and user experience.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Theme Management</strong>: How themes are dynamically defined, validated, and applied to adventures.</li>
<li>üîç <strong>Configuration Patterns</strong>: How centralized configuration simplifies system-wide parameter management.</li>
<li>‚ö° <strong>Validation Techniques</strong>: How input validation ensures system integrity and user-friendly error handling.</li>
<li>üí° <strong>Dynamic CSS Generation</strong>: How theme-specific styles are composed and applied for seamless visual integration.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<p>The <code class="inline-code">config.ts</code> file centralizes all system-wide parameters, such as timeouts, limits, and environment variables. This approach ensures consistency across modules while allowing for easy updates. It also includes default values and fallback mechanisms for critical settings like LLM configurations, file analysis, and resource constraints.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines the maximum time for LLM requests to prevent hangs.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Sets the caching duration for repository analysis results.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Limits the size of files processed to enhance performance and stability.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds for complex story generation
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds cache for repository analysis
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than 10MB to prevent memory issues
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> ensures long-running requests are capped, improving the system&#39;s responsiveness.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> optimizes performance by caching analysis results, reducing redundant operations.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> prevents memory exhaustion by skipping overly large files, focusing on source code.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<p>The <code class="inline-code">theme.ts</code> file defines the adventure themes and provides utilities for theme selection and validation. It ensures that each theme has a unique identity and that user input is correctly matched to available themes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A centralized collection of predefined themes, each with unique properties.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L78" target="_blank" rel="noopener noreferrer"><code class="inline-code">getThemeByKey</code></a>: Retrieves a theme based on its key, ensuring accurate mapping.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a>: Matches user input to themes using keywords or IDs.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: { id: 1, key: &#39;space&#39;, displayName: &#39;Space Exploration&#39;, emoji: &#39;üöÄ&#39;, description: &#39;Journey through cosmic codebases&#39; },
  MYTHICAL: { id: 2, key: &#39;mythical&#39;, displayName: &#39;Enchanted Kingdom&#39;, emoji: &#39;üè∞&#39;, description: &#39;Explore magical realms&#39; },
  ANCIENT: { id: 3, key: &#39;ancient&#39;, displayName: &#39;Ancient Civilization&#39;, emoji: &#39;üè∫&#39;, description: &#39;Discover lost temples of code&#39; },
  DEVELOPER: { id: 4, key: &#39;developer&#39;, displayName: &#39;Developer Documentation&#39;, emoji: &#39;üìñ&#39;, description: &#39;Technical documentation approach&#39; },
  CUSTOM: { id: 5, key: &#39;custom&#39;, displayName: &#39;Custom Theme&#39;, emoji: &#39;üé®&#39;, description: &#39;Design your own adventure&#39; },
};
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> provides a structured way to define and manage themes, ensuring consistency.</li>
<li>Each theme includes metadata such as <code class="inline-code">emoji</code> and <code class="inline-code">description</code> for user-friendly selection.</li>
<li>The modular structure allows for easy addition of new themes.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  return null;
}
</code></pre>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> ensures user input is interpreted correctly, supporting both keywords and numeric IDs.</li>
<li>The function handles edge cases gracefully, returning <code class="inline-code">null</code> for invalid inputs.</li>
<li>This approach improves user experience by allowing flexible input methods.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/theme-manager.ts</code></a></h3>
<p>The <code class="inline-code">theme-manager.ts</code> file handles theme-specific operations, such as CSS generation and icon selection. It ensures that each theme is visually distinct and that assets are correctly applied.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateThemeCSS</code></a>: Combines multiple CSS files into a single theme-specific stylesheet.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L81" target="_blank" rel="noopener noreferrer"><code class="inline-code">getThemeIcons</code></a>: Provides theme-specific icons for templates, enhancing visual consistency.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L40" target="_blank" rel="noopener noreferrer"><code class="inline-code">isLightTheme</code></a>: Identifies themes requiring light or dark logos for better visibility.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];

  let combinedCSS = &#39;&#39;;
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\n\n&#39;;
    }
  });

  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateThemeCSS</code></a> dynamically creates a consolidated stylesheet for each theme.</li>
<li>This modular approach simplifies theme updates and ensures consistent styling.</li>
<li>The function checks for file existence, preventing errors during generation.</li>
</ul>
<hr>
<pre><code class="language-typescript">getThemeIcons(theme: AdventureTheme): { theme: string; quest: string } {
  const themeIcons = {
    space: { theme: &#39;üöÄ&#39;, quest: &#39;‚≠ê&#39; },
    mythical: { theme: &#39;üè∞&#39;, quest: &#39;‚öîÔ∏è&#39; },
    ancient: { theme: &#39;üè∫&#39;, quest: &#39;üìú&#39; },
    developer: { theme: &#39;üíª&#39;, quest: &#39;üîß&#39; },
    custom: { theme: &#39;üé®&#39;, quest: &#39;‚≠ê&#39; }
  };
  return themeIcons[theme] || themeIcons.space;
}
</code></pre>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L81" target="_blank" rel="noopener noreferrer"><code class="inline-code">getThemeIcons</code></a> maps each theme to unique icons, enhancing user engagement.</li>
<li>The function ensures fallback to a default icon set, maintaining robustness.</li>
<li>This mapping simplifies the integration of visual elements into templates.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Review the <code class="inline-code">THEMES</code> object structure to understand how themes are defined and managed.</li>
<li>Explore the <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateThemeCSS</code></a> function to see how dynamic CSS generation is implemented.</li>
<li>Test the <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> function with various inputs to observe its flexibility and error handling.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Add a New Theme</strong>: Create a new theme called &quot;Cyberpunk&quot; with a neon aesthetic. Update the <code class="inline-code">THEMES</code> object and ensure it integrates with <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateThemeCSS</code></a> and <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L81" target="_blank" rel="noopener noreferrer"><code class="inline-code">getThemeIcons</code></a>.</p>
</li>
<li><p><strong>Enhance Validation</strong>: Modify <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts#L686" target="_blank" rel="noopener noreferrer"><code class="inline-code">validateTheme</code></a> to provide more detailed error messages, including suggestions for valid themes based on user input.</p>
</li>
<li><p><strong>Dynamic Theme Switching</strong>: Implement a feature in <code class="inline-code">theme-manager.ts</code> to allow real-time theme switching during adventure exploration. Test it by toggling between themes without restarting the system.</p>
</li>
</ol>
<hr>
<p>You have mastered all the secrets of the Configuration and Theme System! Your adventure is complete.</p>
<p>Congratulations on successfully deploying the Configuration &amp; Theme System‚Äîyour codebase just leveled up with modular elegance and dynamic scalability; onward to the final quest! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>