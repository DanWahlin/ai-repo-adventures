<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration and Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Developer's Guide to AI Repo Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Configuration and Theme System</h1>
<hr>
<p>The Configuration and Theme System serves as the backbone of your adventure, ensuring that every quest is tailored to the explorer&#39;s preferences. This system harmonizes the technical complexity of the MCP server with the aesthetic and functional demands of the HTML generator. By understanding how themes are defined, validated, and applied, you will gain mastery over the tools that shape the entire adventure experience. Dive deep into the mechanics that make customization seamless and configuration robust.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Centralized Configuration</strong>: How shared constants and environment variables manage system-wide behavior.</li>
<li>üîç <strong>Theme System Design</strong>: How themes are structured, validated, and applied dynamically within the project.</li>
<li>‚ö° <strong>CLI Integration</strong>: How the <code class="inline-code">ThemeManager</code> generates CSS and handles theme-specific assets for HTML adventures.</li>
<li>üí° <strong>Validation Patterns</strong>: How input validation ensures data integrity and user-friendly error handling.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<p>This file defines system-wide constants and environment-driven configurations, centralizing all key parameters for the MCP server and related modules. It ensures consistency across packages while allowing flexibility through environment variables.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> specifies the maximum allowed time for LLM requests, ensuring operations do not hang indefinitely.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> sets the cache duration for repository analysis results, optimizing performance by reducing redundant computations.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> enforces a file size limit to prevent memory issues during repository scans.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.REPO_ADV_LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPO_ADV_REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues
</code></pre>
<ul>
<li>These constants ensure the system operates within defined resource limits, improving reliability.</li>
<li>Environment variables like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> allow for runtime configuration without code changes.</li>
<li>The file size limit (<code class="inline-code">MAX_FILE_SIZE_MB</code>) protects against excessive memory consumption during analysis.</li>
<li>Centralized definitions reduce duplication and ensure consistent behavior across modules.</li>
<li>These settings are critical for maintaining performance and stability in large-scale projects.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<p>This file serves as the single source of truth for theme definitions, providing a structured way to define, retrieve, and validate themes. It enables dynamic customization of the adventure&#39;s aesthetic and functional elements.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> defines a set of predefined themes, each with unique properties like <code class="inline-code">id</code>, <code class="inline-code">key</code>, and <code class="inline-code">description</code>.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L78" target="_blank" rel="noopener noreferrer"><code class="inline-code">getThemeByKey</code></a> retrieves a theme by its key, enabling dynamic lookups based on user input.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> processes user input to match it to a valid theme, using keywords and ID-based matching.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  // Additional themes omitted for brevity
};
</code></pre>
<ul>
<li>The <code class="inline-code">THEMES</code> object defines all available themes, each with unique identifiers and metadata.</li>
<li>Keywords allow for flexible user input matching, enhancing usability.</li>
<li>The structure supports easy extension for custom themes or additional metadata.</li>
<li>By centralizing theme definitions, the system ensures consistency across modules.</li>
<li>The use of TypeScript&#39;s <code class="inline-code">readonly</code> properties enforces immutability, reducing errors.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/theme-manager.ts</code></a></h3>
<p>The <code class="inline-code">ThemeManager</code> class handles theme-specific operations for the HTML generator, including CSS generation and asset management. It bridges the gap between theme definitions and their practical application in generated adventures.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateThemeCSS</code></a> combines multiple CSS files into a single output, ensuring each theme has a cohesive style.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L49" target="_blank" rel="noopener noreferrer"><code class="inline-code">getGitHubLogo</code></a> selects the appropriate logo variant based on the theme&#39;s background color.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L81" target="_blank" rel="noopener noreferrer"><code class="inline-code">getThemeIcons</code></a> retrieves theme-specific icons for use in templates, enhancing visual consistency.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;), 
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
  
  let combinedCSS = &#39;&#39;;
  
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
  
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li>This function consolidates multiple CSS files into a single theme-specific stylesheet.</li>
<li>The use of <code class="inline-code">fs</code> ensures compatibility with local file systems during generation.</li>
<li>By dynamically including theme-specific CSS, the system supports a wide range of visual styles.</li>
<li>The function&#39;s modular design makes it easy to extend or modify the CSS pipeline.</li>
<li>The output directory structure ensures assets are organized and accessible.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Review how <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> matches user input to themes to understand flexible input handling.</li>
<li>Examine how <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateThemeCSS</code></a> combines base and theme-specific styles for a cohesive design.</li>
<li>Explore <code class="inline-code">LLM_REQUEST_TIMEOUT</code> and other constants to learn how environment variables influence runtime behavior.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Add a New Theme</strong>: Define a custom theme in <code class="inline-code">theme.ts</code> with unique properties and keywords. Test its integration by generating an adventure with the <code class="inline-code">ThemeManager</code>.</p>
</li>
<li><p><strong>Trace Theme Application</strong>: Add logging to <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/theme-manager.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateThemeCSS</code></a> to trace how CSS files are combined. Observe how changes in theme definitions affect the generated styles.</p>
</li>
<li><p><strong>Enhance Validation</strong>: Modify <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts#L686" target="_blank" rel="noopener noreferrer"><code class="inline-code">validateTheme</code></a> in <code class="inline-code">input-validator.ts</code> to provide detailed error messages when invalid themes are entered. This will improve user feedback and error handling.</p>
</li>
</ol>
<hr>
<p>You have mastered all the secrets of AI Repo Adventures! Your adventure is complete.</p>
<p>You&#39;ve successfully refactored the codebase with a robust Configuration and Theme System‚Äîyour architecture is scaling like a üöÄ and you&#39;re just one commit away from deploying greatness!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>