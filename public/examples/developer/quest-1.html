<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Adventure Pipeline - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Developer's Guide to AI Repo Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: HTML Adventure Pipeline</h1>
<hr>
<p>The HTML Adventure Pipeline is where codebases transform into interactive journeys. This quest explores the mechanisms behind generating themed adventures as standalone HTML websites. From template manipulation to asset management, the pipeline ensures every adventure is styled, functional, and ready for exploration. Dive into the intricate details of rendering pages, copying assets, and orchestrating multi-theme generation.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Template Rendering</strong>: How placeholders in HTML templates are dynamically replaced with content variables.</li>
<li>üîç <strong>Asset Management</strong>: Techniques for copying and organizing assets across themes and directories.</li>
<li>‚ö° <strong>Multi-Theme Generation</strong>: Strategies for generating themed adventures with isolated state and parallel processing.</li>
<li>üí° <strong>CSS Integration</strong>: How theme-specific and shared styles are combined for cohesive design.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/template-engine.ts</code></a></h3>
<p>The <code class="inline-code">TemplateEngine</code> handles the dynamic generation of HTML content by loading, caching, and rendering templates. It ensures that placeholders in templates are replaced with actual values, creating fully functional pages for the adventure.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L25" target="_blank" rel="noopener noreferrer"><code class="inline-code">loadTemplate</code></a>: Loads and caches template files for efficient reuse across rendering operations.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L44" target="_blank" rel="noopener noreferrer"><code class="inline-code">replacePlaceholders</code></a>: Replaces placeholder strings in templates with values from a provided variable map.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">renderPage</code></a>: Combines base and content templates to generate complete HTML pages.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Implements caching to prevent redundant file reads, improving performance.</li>
<li>Uses <code class="inline-code">fs.readFileSync</code> for synchronous file access, ensuring templates are loaded before rendering begins.</li>
<li>Throws descriptive errors for missing templates, aiding debugging.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li>Performs global replacements using regular expressions for all placeholders in the template.</li>
<li>Ensures undefined variables are replaced with empty strings, preventing rendering errors.</li>
<li>Demonstrates how dynamic content is injected into static templates.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Combines base and content templates into a cohesive HTML page.</li>
<li>Enables modular design by separating layout (base template) and content (specific templates).</li>
<li>Illustrates a multi-step rendering process for complex pages.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/asset-manager.ts</code></a></h3>
<p>The <code class="inline-code">AssetManager</code> organizes and copies assets like images, CSS, and JavaScript files, ensuring adventures have all necessary resources. It supports both single-theme and multi-theme generation modes.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L18" target="_blank" rel="noopener noreferrer"><code class="inline-code">copyImages</code></a>: Copies theme-specific and shared images to the appropriate directories.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L97" target="_blank" rel="noopener noreferrer"><code class="inline-code">copyQuestNavigator</code></a>: Adds navigation assets like CSS and JavaScript for quest tracking.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L134" target="_blank" rel="noopener noreferrer"><code class="inline-code">copyGlobalAssets</code></a>: Manages shared assets for multi-theme adventures.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">copyImages(outputDir: string, isMultiTheme: boolean = false): void {
  const sourceImagesDir = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;);
  const targetImagesDir = path.join(outputDir, &#39;assets&#39;, &#39;images&#39;);

  try {
    if (fs.existsSync(sourceImagesDir)) {
      fs.mkdirSync(targetImagesDir, { recursive: true });
      const imageFiles = fs.readdirSync(sourceImagesDir);
      imageFiles.forEach(file =&gt; {
        const sourcePath = path.join(sourceImagesDir, file);
        const targetPath = path.join(targetImagesDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      });
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy images from source directory&#39;));
  }
}
</code></pre>
<ul>
<li>Ensures directories are created before copying files, avoiding runtime errors.</li>
<li>Uses <code class="inline-code">fs.readdirSync</code> and <code class="inline-code">fs.copyFileSync</code> for efficient file operations.</li>
<li>Provides error handling with warnings for missing source directories.</li>
</ul>
<hr>
<pre><code class="language-typescript">copyQuestNavigator(outputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);

  const assetsDir = path.join(outputDir, &#39;assets&#39;);
  fs.mkdirSync(assetsDir, { recursive: true });

  if (fs.existsSync(cssSource)) {
    fs.copyFileSync(cssSource, path.join(assetsDir, &#39;quest-navigator.css&#39;));
  }
  if (fs.existsSync(jsSource)) {
    fs.copyFileSync(jsSource, path.join(assetsDir, &#39;quest-navigator.js&#39;));
  }
}
</code></pre>
<ul>
<li>Adds navigation assets for tracking quests within the adventure.</li>
<li>Creates asset directories dynamically, ensuring compatibility across themes.</li>
<li>Demonstrates modular asset management for reusable components.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/html-generator.ts</code></a></h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> orchestrates the entire pipeline, from repository analysis to themed HTML generation. It handles multi-theme processing and ensures adventures are fully configured and styled.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts#L235" target="_blank" rel="noopener noreferrer"><code class="inline-code">generateAdventure</code></a>: Coordinates the generation of quests, assets, and CSS for a single theme.</li>
<li><code class="inline-code">generateAllThemes</code>: Manages parallel processing for multi-theme adventures.</li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts#L122" target="_blank" rel="noopener noreferrer"><code class="inline-code">startWithArgs</code></a>: Allows CLI-based configuration and execution for automated workflows.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));

  const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);
  const projectInfo = createProjectInfo(repomixContent);

  const storyContent = await this.adventureManager.initializeAdventure(
    projectInfo, 
    this.selectedTheme, 
    this.projectPath,
    this.customThemeData
  );

  this.extractQuestInfo();
  await this.generateThemeCSS();

  console.log(chalk.dim(&#39;üìñ Generating quest pages...&#39;));
  await this.contentGenerator.generateQuestPages();

  console.log(chalk.dim(&#39;üéâ Creating adventure summary page...&#39;));
  await this.generateSummaryHTML();
}
</code></pre>
<ul>
<li>Analyzes the repository to extract project details for adventure generation.</li>
<li>Initializes themed stories and quests using <code class="inline-code">AdventureManager</code>.</li>
<li>Demonstrates sequential steps for generating CSS, quest pages, and summaries.</li>
</ul>
<hr>
<pre><code class="language-typescript">static async generateSingleThemeStatic(
  theme: AdventureTheme,
  themeDir: string,
  maxQuests: number | undefined,
  logLlmOutput: boolean,
  logLlmOutputDir: string
): Promise&lt;void&gt; {
  const themeGenerator = new HTMLAdventureGenerator();
  themeGenerator.selectedTheme = theme;
  themeGenerator.outputDir = themeDir;
  themeGenerator.maxQuests = maxQuests;
  themeGenerator.logLlmOutput = logLlmOutput;
  themeGenerator.logLlmOutputDir = logLlmOutputDir;
  themeGenerator.isMultiTheme = true;

  try {
    await themeGenerator.generateAdventure();
  } finally {
    themeGenerator.cliInterface.close();
  }
}
</code></pre>
<ul>
<li>Creates isolated generator instances for each theme, preventing state conflicts.</li>
<li>Supports parallel processing for efficient multi-theme generation.</li>
<li>Demonstrates how static methods can encapsulate complex workflows.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L44" target="_blank" rel="noopener noreferrer"><code class="inline-code">TemplateEngine.replacePlaceholders</code></a> uses regular expressions for dynamic rendering.</li>
<li>Observe how <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L18" target="_blank" rel="noopener noreferrer"><code class="inline-code">AssetManager.copyImages</code></a> organizes assets across directories for single and multi-theme modes.</li>
<li>Explore the sequential flow in <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts#L235" target="_blank" rel="noopener noreferrer"><code class="inline-code">HTMLAdventureGenerator.generateAdventure</code></a> for generating complete adventures.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Custom Template Variables</strong>: Modify <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts#L58" target="_blank" rel="noopener noreferrer"><code class="inline-code">TemplateEngine.renderPage</code></a> to include new variables like <code class="inline-code">FOOTER_TEXT</code>. Create a custom footer in your base template and render it dynamically.</p>
</li>
<li><p><strong>Multi-Theme Analysis</strong>: Add logging to <code class="inline-code">HTMLAdventureGenerator.generateAllThemes</code> to trace the execution flow. Observe how themes are processed in parallel and analyze performance implications.</p>
</li>
<li><p><strong>Enhanced Asset Handling</strong>: Extend <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts#L18" target="_blank" rel="noopener noreferrer"><code class="inline-code">AssetManager.copyImages</code></a> to optimize image formats during copying. Experiment with converting PNGs to JPEGs and resizing large images.</p>
</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the HTML generation pipeline.</p>
<p>Congratulations on deploying the final commit to your &quot;HTML Adventure Pipeline&quot; journey‚Äîyour DOM manipulation skills have leveled up, and you&#39;re now ready to refactor your way to 100% completion! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>