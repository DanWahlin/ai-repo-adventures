<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Quest Engine’s Galactic Core - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">Starship Adventure: Navigating the Codebase Nebula</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Quest Engine’s Galactic Core</h1>
<hr>
<p>The <em>Code Voyager</em> glided silently toward the Galactic Core of the Codebase Nebula, where the very essence of its mission awaited. As you navigated the dense tangle of protocols and frameworks, the ship&#39;s scanners detected an intricate lattice of connections—a pulsating engine of quests that seemed to power the entire system. The <strong>Quest Engine</strong>, a sprawling construct of logic and creativity, was the mind behind this cosmic playground. Your mission was clear: decode, explore, and understand this celestial mechanism to ensure the seamless configuration of future explorers’ paths through the nebula. Failure was not an option; the galaxy’s modular systems depended on you.</p>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a>: Adventure Management Nexus</h3>
<p>This file is the overseer of all galactic adventures, orchestrating initialization, execution, and tracking for every mission undertaken. At its core lies the <code class="inline-code">AdventureManager</code> class, which serves as the mission commander, responsible for setting up project contexts, generating stories, and managing quests. Notable methods like <code class="inline-code">initializeAdventure()</code> ensure the seamless integration of project data with themed storytelling. Here, the <em>Quest Engine</em> taps into the power of LLMs to generate captivating narratives and engaging tasks. Additionally, <code class="inline-code">exploreQuest()</code> validates user choices, while <code class="inline-code">markQuestCompleted()</code> tracks achievements, ensuring that interstellar progress is monitored. These methods act as the thrusters, propelling explorers through their journey in the nebula’s complex architecture. </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure()</code> meticulously integrates project data with narrative generation.</li>
<li><code class="inline-code">exploreQuest()</code> validates user input and dynamically spins new quests.</li>
<li>The <code class="inline-code">AdventureState</code> object tracks progress, including completed quests and percentage completion.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/story-generator.ts</code></a>: The Galactic Quest Forge</h3>
<p>The heart of the <em>Quest Engine</em>, this file specializes in weaving the cosmic threads of adventure narratives. The <code class="inline-code">StoryGenerator</code> class, powered by the latest LLM technology, crafts dynamic stories and quest content tailored to the project data and selected themes. It uses methods like <code class="inline-code">generateStoryAndQuests()</code> to produce entire adventure structures, while <code class="inline-code">generateQuestContent()</code> generates detailed, file-specific tasks that turn mundane code analysis into galactic exploits. The class’s robust validation ensures that all generated content adheres to JSON schemas, making it a stellar example of logical creativity at the nebula’s core.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateStoryAndQuests()</code> creates comprehensive themed narratives.</li>
<li><code class="inline-code">generateQuestContent()</code> generates detailed explorations of specific files.</li>
<li>Strong error handling ensures robust LLM-driven response validations.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: The Codebase Alignment Protocol</h3>
<p>This file underpins the <em>Quest Engine</em> by extracting, parsing, and formatting configuration data from <code class="inline-code">adventure.config.json</code>. The <code class="inline-code">parseAdventureConfig()</code> function, for instance, ensures that quest-related metadata is loaded correctly, enabling missions to align with the intended structure. Meanwhile, the <code class="inline-code">formatAdventureConfigForPrompt()</code> function transforms this data into structured prompts, ensuring that the LLM remains hyper-focused on creating relevant content. This ensures the <em>Quest Engine</em> maintains synchronization between code files and generated quests, acting as a compass for exploration routes within the nebula.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig()</code> enables seamless loading of configuration files.</li>
<li><code class="inline-code">extractUniqueFilePaths()</code> ensures that all analyzed files are essential and project-specific.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code> structures quests into actionable and LLM-compatible formats.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a></h3>
<pre><code class="language-typescript">export class AdventureManager {
  private state: AdventureState = new AdventureState();
  private storyGenerator: StoryGenerator;

  constructor() {
    this.storyGenerator = new StoryGenerator();
  }

  async initializeAdventure(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme, 
    projectPath?: string,
    customThemeData?: CustomThemeData
  ): Promise&lt;string&gt; {
    this.state.reset();
    this.state.projectInfo = projectInfo;
    this.state.currentTheme = theme;
    this.state.projectPath = projectPath || process.cwd();
    
    const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
    
    this.state.title = storyResponse.title;
    this.state.story = storyResponse.story;
    this.state.quests = this.enforceConfigQuestCount(
      this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath),
      this.state.projectPath
    );

    return this.formatStoryWithQuests(storyResponse);
  }
}
</code></pre>
<p>The <code class="inline-code">initializeAdventure()</code> method is the flight plan, charting the course for your expedition with themes, quests, and a clear narrative.</p>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/story-generator.ts</code></a></h3>
<pre><code class="language-typescript">export class StoryGenerator {
  async generateStoryAndQuests(projectInfo: ProjectInfo, theme: AdventureTheme, projectPath?: string): Promise&lt;StoryResponse&gt; {
    const prompt = loadStoryGenerationPrompt({
      theme,
      repomixContent: projectInfo.repomixContent || &#39;No repomix content available&#39;
    });

    const response = await this.llmClient.generateResponse(prompt, { maxTokens: LLM_MAX_TOKENS_STORY });
    
    if (!response.content || response.content.trim() === &#39;&#39;) {
      throw new Error(&#39;LLM returned empty response&#39;);
    }

    return parseMarkdownToStoryResponse(response.content.trim());
  }
}
</code></pre>
<p>This method is like a starship’s navigation computer, transforming vast streams of input into detailed stellar charts and mission briefs.</p>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;

  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>The <code class="inline-code">parseAdventureConfig()</code> function is like a decoding relay, translating raw cosmic signals into actionable navigation data.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Always start with <code class="inline-code">initializeAdventure()</code> to ensure project context and quest alignment.</li>
<li>Refactor <code class="inline-code">generateQuestContent()</code> to modularize prompts for different LLMs or themes.</li>
<li>Investigate <code class="inline-code">adventure.config.json</code> to fine-tune the balance between creativity and precision in quest generation.</li>
</ul>
<hr>
<p>Congratulations, Star Voyager, for navigating the cosmic currents and powering through the Galactic Core—your mission is 25% complete, and the Universe applauds your brilliance as you chart the stars ahead! ⭐🚀💎📡</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: Unveiling the Repomix Transmiss... →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>