<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíé Quest 2: The Codemancer‚Äôs Spellbook of Storyweaving - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <script>
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'mythical' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">üè∞ Realm of Enchanted Code: The Quest for the Mystic Repository</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1><span class="header-prefix">Quest 2:</span> The Codemancer‚Äôs Spellbook of Storyweaving</h1>
<p>‚≠ê The Codemancer‚Äôs Spellbook is said to possess incantations capable of binding scattered knowledge into unified spells‚Äîa key to unlocking the secrets of the Enchanted Repository. You, the bold adventurer, have delved into the forbidden chamber of Structura Arcanum, where fragmented spells swirl in disarray. To restore coherence, you must decipher the manuscripts and imbue them with the clarity needed to empower the kingdom‚Äôs council. However, beware‚Äîthe tongue of code requires more than sight, for only those who understand its essence will weave the story true.</p>
<hr>
<h2>File Exploration</h2>
<h3><span class="header-prefix">src/shared/adventure-config.ts:</span> Configuration for Guided Story Generation</h3>
<p>The <strong>adventure-config.ts</strong> file is the cornerstone spell of the Codemancer‚Äôs arsenal. It serves as the enchanted map for interpreting and structuring the quests derived from the adventure.config.json file. Like an ancient scroll, this file allows the system to unravel the paths laid out in configuration while ensuring every thread of logic is meticulously validated. Key functionalities include loading the raw adventure config, parsing it for usable data, and extracting unique file paths tied to the realm&#39;s spells. Its operations are thoughtful‚Äîensuring errors, such as missing or empty files, do not derail the journey. For those seeking precision in their narratives, it also formats the config‚Äôs structure into LLM-friendly prompts, creating clarity in a mystic haze of data.</p>
<h4>Highlights</h4>
<ul>
<li><strong>File Validation</strong>: Ensures adventure.config.json is properly loaded, parsed, and accessible.</li>
<li><strong>LLM Prompt Formatting</strong>: Compiles the configuration into prompts suitable for the highest clarity in spellbinding.</li>
<li><strong>Error Handling</strong>: Guards against wayward paths and invalid nodes during parsing to protect against false enchantments.</li>
</ul>
<hr>
<h3><span class="header-prefix">src/adventure/adventure-manager.ts:</span> Master of Adventurous Flow</h3>
<p>The <strong>adventure-manager.ts</strong> is a grand tome overseeing the orchestration of mystical adventures. This file stands as the Codemancer‚Äôs stage manager, coordinating the interplay of story, quests, and user decisions. Through <strong>AdventureManager.initializeAdventure</strong>, it weaves the initial tapestry, blending context from the codebase with the selected theme. The <strong>exploreQuest</strong> spell is a decisive incantation that immerses the user into specific quests while validating choices. This file also accounts for progress, storing completed tasks and calculating the glow of achievement. It ensures that every quest fits snugly within the larger narrative, merging harmoniously with the overarching design.</p>
<h4>Highlights</h4>
<ul>
<li><strong>initializeAdventure</strong>: Crafts a new adventure, setting the theme and preparing storylines.</li>
<li><strong>exploreQuest</strong>: Guides the adventurer into the depths of chosen quests with meticulous validation.</li>
<li><strong>progressPercentage</strong>: Monitors adventurer progress, serving as a magic mirror reflecting achievements.</li>
</ul>
<hr>
<h3><span class="header-prefix">src/adventure/story-generator.ts:</span> Storycrafting Engine of Themes</h3>
<p>The <strong>story-generator.ts</strong> spins the mystical threads of the Codemancer‚Äôs narrative. It is here that raw ideas spring to life as thematic stories and assigned quests. Through <strong>generateStoryAndQuests</strong>, it compels the latent magic of the codebase and user choices, collaborating with an LLM (Language Logic Master) to deliver artful, structured campaigns. With the <strong>generateQuestContent</strong> spell, the file dives deep into quests, transforming details and file highlights into playable, entertaining adventures. This generator also validates the story‚Äôs essence, ensuring consistency with the arcane guidelines laid out by the Codemancer.</p>
<h4>Highlights</h4>
<ul>
<li><strong>generateStoryAndQuests</strong>: Summons the LLM to shape coherent stories and quest trees.</li>
<li><strong>generateQuestContent</strong>: Creates purposeful adventures by combining narrative magic and technical direction.</li>
<li><strong>parseMarkdownToStoryResponse</strong>: Deciphers raw markdown stories into usable components, ensuring better readability and integrity.</li>
</ul>
<hr>
<h2>Code</h2>
<h3>src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(
  projectPath: string
): string | null {
  const configPath = path.join(projectPath, &#39;adventure.config.json&#39;);
  return readFileIfExists(configPath);
}

/**
 * Parses the adventure config into an object (or null on error/missing).
 */
export function parseAdventureConfig(
  projectPath: string
): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>The file works like a magical courier, fetching and validating your adventure scrolls so they‚Äôre ready for deciphering.</p>
<h3>src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo,
  theme: AdventureTheme,
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();

  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(
    projectInfo,
    theme,
    this.state.projectPath
  );

  this.state.title = storyResponse.title;
  this.state.story = typeof storyResponse.story === &#39;string&#39;
    ? storyResponse.story
    : storyResponse.story.content;
  return this.formatStoryWithQuests(storyResponse);
}
</code></pre>
<p>This function sets the stage for a new chapter by binding context, theme, and LLM response into the adventurer‚Äôs journey.</p>
<h3>src/adventure/story-generator.ts</h3>
<pre><code class="language-typescript">async generateQuestContent(
  quest: Quest,
  theme: AdventureTheme,
  codeContent: string
): Promise&lt;QuestContent&gt; {
  const prompt = loadQuestContentPrompt({
    theme,
    adventureTitle: quest.title,
    codeContent,
    storyContent: this.currentStoryContent || &#39;No story context available.&#39;
  });

  const response = await this.llmClient.generateResponse(prompt, {
    maxTokens: 1000
  });

  return {
    adventure: response.content.trim(),
    codeSnippets: [],
    hints: []
  };
}
</code></pre>
<p>This method inspires the Codemancer‚Äôs spellbook to tailor unique quests, merging code-based details with enchanting narrative.</p>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Remember that <strong>adventure-config.ts</strong> serves as the repository‚Äôs guidebook‚Äîstudy its role in establishing thematic consistency.</li>
<li>Dive deeper into <strong>story-generator.ts</strong> to uncover how LLM interactions are structured with prompts and token limits.</li>
<li>For the next quest, explore progress tracking in <strong>adventure-manager.ts</strong> to understand how completions are logged and reflected.</li>
</ul>
<hr>
<p>‚ú® Huzzah, valiant Storyweaver, for unearthing the Codemancer&#39;s arcane spellbook and weaving its first enchantments into your legend‚Äîone quarter of your epic quest complete, with the realms alight with your brilliance! ‚ö°üìñ</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: üìú Quest 3: The Scrolls of Insight ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="images/github-mark.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>