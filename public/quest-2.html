<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŒŒ Quest 2: The Stellar Story Forge - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <script>
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">ðŸš€ Starship Infinity: The Lost Code Chronicles</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1><span class="header-prefix">ðŸŒŒ Quest 2:</span> The Stellar Story Forge</h1>
<hr>
<p>The <em>Starship Infinity</em> hummed with life as the crew gathered on the bridge, their faces illuminated by the cool blue glow of the holodisplays. The Lost Code Pulse flickered like a phantom signal, its distant whispers calling out from the fragmented nebula known as the Veiled Shards. To decode the message, the <em>Infinity</em>â€™s advanced computational systems needed aligning. The Stellar Story Forgeâ€”the intelligence weaving together the questsâ€”was at the heart of this operation. With galactic maps sprawled across the command panels, you feel a ripple of determination as you prepare to unravel the secrets of the universe.</p>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/mcp-repo-adventure/blob/main/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/adventure/adventure-manager.ts</code></a>: Adventure orchestration managing state and user interactions</h3>
<p>The <code class="inline-code">adventure-manager.ts</code> file is the captain of the <em>Infinity</em>&#39;s narrative journey. It orchestrates the exploration of interstellar quests by managing the adventure state, generating quests, and validating user inputs. This fileâ€™s critical role lies in how it leverages the <em>Stellar Story Forge</em> (powered by an LLM) to craft stories based on configuration data and code analysis. It dynamically merges these stories with project context to create deeply immersive and interactive experiences. With its ability to track progress, cache quest content, and ensure prerequisite validation, <code class="inline-code">adventure-manager.ts</code> is the mission control that keeps the storytelling seamless. Handling quests ranges from initializing the adventure with configuration files to executing them in real time. It also integrates safety measures like timeout protection to ensure the system runs smoothly even when deep celestial mysteries threaten to overwhelm its circuits.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">AdventureManager.initializeAdventure</code>: Sets up user-defined quests and connects the story to project context.</li>
<li><code class="inline-code">AdventureManager.exploreQuest</code>: Executes chosen quests, tracking progress and generating narrative content.</li>
<li><code class="inline-code">AdventureState.progressPercentage</code>: Offers real-time insight into mission completion.</li>
<li><code class="inline-code">AdventureManager.generateQuestContent</code>: Produces focused code analyses tailored to the current quest.</li>
<li><code class="inline-code">AdventureManager.getAvailableQuestChoices</code>: Provides interactive quest options to adventurers.</li>
</ul>
<h3><a href="https://github.com/danwahlin/mcp-repo-adventure/blob/main/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/adventure/story-generator.ts</code></a>: LLM-powered story creation engine</h3>
<p>A marvel of creative engineering, the <code class="inline-code">story-generator.ts</code> file allows the <em>Infinity</em> to breathe life into its galactic voyages through structured storytelling. It leverages the intelligence of LLMs to generate thematic adventures, tailoring narratives based on available project data and themes. The file is a vital component of the quest generation process, offering schema validation to ensure that every journey produced is systematically sound. With tools to craft detailed prompts and ensure the authenticity of adventures, the story generator bridges the gap between cold repository data and immersive tales. This system demonstrates the power of merging computational creativity with guidance data, ensuring every quest is cohesive, relevant, and packed with starry wonder.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">StoryGenerator.generateStoryAndQuests</code>: Generates a galaxy of adventures in one sweep.</li>
<li><code class="inline-code">StoryGenerator.buildStoryGenerationPrompt</code>: Crafts intricate prompts for AI-generated storytelling.</li>
<li><code class="inline-code">StoryGenerator.generateQuestContent</code>: Uses adaptive prompts to create context-aware quests.</li>
<li><code class="inline-code">StoryGenerator.getThemeGuidelines</code>: Ensures thematic consistency throughout missions.</li>
<li><code class="inline-code">StoryGenerator.generateCompletionSummary</code>: Provides rewarding mission-success debriefs.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/mcp-repo-adventure/blob/main/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/adventure/adventure-manager.ts</code></a></h3>
<pre><code class="language-typescript">export class AdventureManager {
  private state: AdventureState = new AdventureState();
  private storyGenerator: StoryGenerator;

  constructor() {
    this.storyGenerator = new StoryGenerator();
  }

  async initializeAdventure(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme, 
    projectPath?: string,
    customThemeData?: CustomThemeData
  ): Promise&lt;string&gt; {
    this.state.reset();
    this.state.projectInfo = projectInfo;
    this.state.currentTheme = theme;
    this.state.projectPath = projectPath || process.cwd();

    if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
      this.storyGenerator.setCustomTheme(customThemeData);
    }

    const storyResponse = await this.storyGenerator.generateStoryAndQuests(
      projectInfo, theme, this.state.projectPath
    );

    this.state.title = storyResponse.title;
    this.state.story = typeof storyResponse.story === &#39;string&#39; ? storyResponse.story : storyResponse.story.content;
    
    this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);

    return this.formatStoryWithQuests({
      ...storyResponse,
      quests: this.state.quests
    });
  }
}
</code></pre>
<p>This section is like a mission briefing room, ensuring all crew members know their role before venturing forth.</p>
<h3><a href="https://github.com/danwahlin/mcp-repo-adventure/blob/main/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/adventure/story-generator.ts</code></a></h3>
<pre><code class="language-typescript">export class StoryGenerator {
  async generateStoryAndQuests(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme, 
    projectPath?: string
  ): Promise&lt;StoryResponse&gt; {
    this.currentProject = projectInfo;
    this.projectPath = projectPath;

    const validatedTheme = this.validateTheme(theme);
    return await this.generateWithLLM(projectInfo, validatedTheme);
  }

  private async generateWithLLM(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme
  ): Promise&lt;StoryResponse&gt; {
    const repomixContent = projectInfo.repomixContent || &#39;No repomix content available&#39;;

    const prompt = loadStoryGenerationPrompt({
      theme,
      repomixContent,
    });

    const response = await this.withTimeout(
      this.llmClient.generateResponse(prompt, { maxTokens: LLM_MAX_TOKENS_STORY })
    );

    let parsed;
    try {
      let cleanContent = response.content.trim();
      if (cleanContent.startsWith(&#39;```markdown&#39;)) {
        cleanContent = cleanContent.replace(/^```markdown\s*/, &#39;&#39;).replace(/\s*```$/, &#39;&#39;);
      }

      parsed = parseMarkdownToStoryResponse(cleanContent);
      StoryResponseSchema.parse(parsed);
    } catch (error) {
      throw new Error(`Invalid LLM response for story: ${error.message}`);
    }
    return parsed;
  }
}
</code></pre>
<p>This sequence is the shipâ€™s imagination engine, producing detailed star maps using its cosmic knowledge.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Groundbreaking tools like <code class="inline-code">adventure-manager.ts</code> require clear error handling for user inputs; focus on <code class="inline-code">validateQuestPrerequisites</code>.</li>
<li>For depth in storytelling, explore prompt formats in <code class="inline-code">StoryGenerator.buildStoryGenerationPrompt</code>.</li>
<li>Broaden quest possibilities by optimizing the mission flow between the manager and the generator.</li>
</ul>
<p>Bravo, Stellar Storycrafter! ðŸŒ  Youâ€™ve ignited the cosmic quill and navigated the nebula of creativity, completing Quest 2 with the brilliance of a supernovaâ€”launch engines primed for the next intergalactic adventure!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: ðŸŒ  Quest 3: The Nebula Analyzer â†’</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/mcp-repo-adventure" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>