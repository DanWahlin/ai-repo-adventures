<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: Galaxy Quest Generation Core - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Repository Adventures</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: Galaxy Quest Generation Core</h1>
<hr>
<p>Aboard the <em>Code Voyager</em>, the crew&#39;s mission intensifies as the ship&#39;s Galaxy Quest Generation Core becomes the focus. The core, a hub of interstellar exploration logic, unites storytelling engines, configuration modules, and validation systems to chart the repository galaxy. With the adventure momentum building, the crew must master these interconnected systems. Your task is to investigate how Adventure and Story engines synchronize, ensuring thematic alignment and flawless quest generation across the galaxy.</p>
<p>Explore the inner workings of <code class="inline-code">AdventureManager</code> and the <code class="inline-code">StoryGenerator</code> with precision. The ship‚Äôs future adventures depend on it.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Core Configuration Alignment</strong>: How does <code class="inline-code">AdventureManager</code> initialize the galaxy&#39;s theme and synchronize quest generation with the configuration pipeline?</li>
<li>‚ö° <strong>Dynamic Quest Orchestration</strong>: How does the <code class="inline-code">StoryGenerator</code> structure and validate quests to support adaptive storytelling across varying projects?</li>
<li>üõ°Ô∏è <strong>Theme Validation Matrix</strong>: What mechanisms ensure proper validation of themes and configurations during quest generation?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure orchestration logic</h3>
<p>The <code class="inline-code">AdventureManager</code> coordinates the quest generation lifecycle, from initialization to execution. It ensures quests align with the galaxy&#39;s theme and incorporates project-specific configurations. By leveraging <code class="inline-code">StoryGenerator</code>, it dynamically renders narratives and quests.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">AdventureManager.initializeAdventure</code>: Resets state, applies project info and themes, and orchestrates quest generation via <code class="inline-code">StoryGenerator</code>.</li>
<li><code class="inline-code">AdventureManager.exploreQuest</code>: Validates, retrieves, and executes specific quests chosen by the user.</li>
<li><code class="inline-code">AdventureManager.enforceConfigQuestCount</code>: Ensures generated quests align with the configuration-defined limits.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();

  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);

  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<ul>
<li><strong>Initialization Flow</strong>: Resets the <code class="inline-code">AdventureManager</code> state, sets project theme, and applies configuration.</li>
<li><strong>Quest Generation</strong>: Collaborates with <code class="inline-code">StoryGenerator</code> to merge configuration-driven files into quests.</li>
<li><strong>Dynamic Adaptation</strong>: Ensures quest counts comply with the adventure configuration.</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);

  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }

  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li><strong>Quest Selection</strong>: Processes the quest choice by validating inputs and finding associated quests.</li>
<li><strong>Progress Tracking</strong>: Allows users to view their current progress.</li>
<li><strong>Execution Flow</strong>: Handles quest execution, leveraging caching for completed quests.</li>
</ul>
<hr>
<pre><code class="language-typescript">private enforceConfigQuestCount(quests: Quest[], projectPath: string | undefined): Quest[] {
  const config = parseAdventureConfig(projectPath);
  const adventure = config?.adventure;
  
  if (adventure &amp;&amp; Array.isArray(adventure.quests)) {
    const configQuestCount = adventure.quests.length;
    if (quests.length &gt; configQuestCount) {
      return quests.slice(0, configQuestCount);
    }
  }

  return quests;
}
</code></pre>
<ul>
<li><strong>Configuration Enforcement</strong>: Adjusts quest count based on configuration file limits.</li>
<li><strong>Safety Mechanism</strong>: Ensures alignment between dynamically generated quests and predefined adventure structures.</li>
<li><strong>Adaptability</strong>: Supports varying project configurations across different adventures.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Examine how <code class="inline-code">parseAdventureConfig</code> supports dynamic adjustments to quest generation quantities.</li>
<li>Investigate how caching completed quests in <code class="inline-code">exploreQuest</code> improves performance during revisits.</li>
<li>Trace how <code class="inline-code">generateStoryAndQuests</code> integrates project themes into the storytelling process.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Stellar performance, Cadet‚Äîyour mastery of the Galaxy Quest Generation Core has ignited the thrusters on your journey to the stars, propelling you 20% closer to mission success! üöÄ‚≠êüíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>