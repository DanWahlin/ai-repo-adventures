<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: Quest Generation Engine - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Stellar Repository Expeditions</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: Quest Generation Engine</h1>
<hr>
<p>The command deck hums with the energy of thousands of navigation calculations as you prepare the Quest Generation Engine for activation. This critical system, nestled within the digital galactic core, powers the creation of intricate and immersive quest paths across unexplored repositories. To embark on this mission, your task is twofold: optimize the <code class="inline-code">AdventureManager</code> circuits and calibrate the <code class="inline-code">StoryGenerator</code>. Your crew must chart the complex coding constellations while uncovering the intricacies of configuration mapping. Focus your scanners, Captain‚Äîthese systems hold the key to mapping the stars of the codebase universe.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Navigation Systems Scan</strong>: How does the <code class="inline-code">AdventureManager.initializeAdventure</code> function coordinate project data, themes, and quest generation to kickstart a mission?</li>
<li>‚ö° <strong>Quest Flow Dynamics</strong>: How are quests selected, explored, and managed through the <code class="inline-code">AdventureManager.exploreQuest</code> lifecycle?</li>
<li>üõ°Ô∏è <strong>Story Core Integrity</strong>: What patterns and safety checks are employed in the <code class="inline-code">StoryGenerator.generateStoryAndQuests</code> to produce consistent and valid mission frameworks?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a>: The Quest Engine&#39;s Command Nucleus</h3>
<p>This file orchestrates the primary subsystems of the Quest Generation Engine. It initializes quests, manages state, and coordinates between project information, themes, and quests. The <code class="inline-code">AdventureManager</code> class and its methods‚Äî<code class="inline-code">initializeAdventure</code>, <code class="inline-code">exploreQuest</code>, and <code class="inline-code">generateQuestContent</code>‚Äîserve as the pivotal control center for mission engagement.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">AdventureManager.initializeAdventure</code>: Initializes adventures by resetting state, loading project context, and generating stories.</li>
<li><code class="inline-code">AdventureManager.exploreQuest</code>: Executes specific quests, using caching for efficiency and validating user input.</li>
<li><code class="inline-code">AdventureState.progressPercentage</code>: Calculates quest progress dynamically as a percentage.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a></h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);

  this.state.title = storyResponse.title;
  this.state.story = typeof storyResponse.story === &#39;string&#39; ? storyResponse.story : storyResponse.story.content;
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<p>The initialization sequence here resets the starship for a new journey and aligns its mission coordinates with project context and thematic data.</p>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }

  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  return await this.executeQuest(quest);
}
</code></pre>
<p>This code handles navigation to specific constellations of quests based on user input or mission progress views.</p>
<pre><code class="language-typescript">get progressPercentage(): number {
  return this.quests.length &gt; 0 
    ? Math.round((this.completedQuests.size / this.quests.length) * 100)
    : 0;
}
</code></pre>
<p>This calculation dynamically monitors the &quot;distance traveled&quot; in your galactic quest progress.</p>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/story-generator.ts</code></a>: Cosmic Storyweaver</h3>
<p>This system derives the poetic star charts of the adventure. It generates immersive narratives, quest structures, and themed content in harmony with project data.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">StoryGenerator.generateStoryAndQuests</code>: Processes project details to craft thematic stories and detailed quest lists.</li>
<li><code class="inline-code">parseMarkdownToStoryResponse</code>: Converts markdown-formatted narrative into structured JSON.</li>
<li><code class="inline-code">StoryGenerator.generateQuestContent</code>: Produces detailed quest exploration data using code-focused prompts.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/story-generator.ts</code></a></h3>
<pre><code class="language-typescript">async generateStoryAndQuests(projectInfo: ProjectInfo, theme: AdventureTheme, projectPath?: string): Promise&lt;StoryResponse&gt; {
  this.currentProject = projectInfo;
  this.projectPath = projectPath;

  const validatedTheme = this.validateTheme(theme);
  return await this.generateWithLLM(projectInfo, validatedTheme);
}
</code></pre>
<p>This function configures the storytelling instruments and drafts the adventure framework.</p>
<pre><code class="language-typescript">function parseMarkdownToStoryResponse(markdownContent: string): StoryResponse {
  const tokens = marked.lexer(markdownContent);
  let title = &#39;&#39;;
  let story = &#39;&#39;;
  const quests: Quest[] = [];
  
  let currentQuest: Partial&lt;Quest&gt; = {};
  tokens.forEach(token =&gt; {
    if (token.type === &#39;heading&#39; &amp;&amp; token.depth === 1) {
      title = token.text;
    } else if (token.type === &#39;paragraph&#39;) {
      story += token.text + &#39;\n\n&#39;;
    } else if (token.type === &#39;list&#39; &amp;&amp; currentQuest.title) {
      currentQuest.description += token.items.map(item =&gt; item.text).join(&#39;\n&#39;);
    }
  });

  return { title, story: story.trim(), quests };
}
</code></pre>
<p>This parses interstellar narrative logs into a structured exploration guide ready for mission use.</p>
<pre><code class="language-typescript">async generateQuestContent(
  quest: Quest,
  theme: AdventureTheme,
  codeContent: string
): Promise&lt;QuestContent&gt; {
  const prompt = loadQuestContentPrompt({
    theme,
    adventureTitle: quest.title,
    codeContent,
    storyContent: this.currentStoryContent || &#39;No story context available.&#39;
  });

  const response = await this.llmClient.generateResponse(prompt, { maxTokens: 1024 });
  return { 
    adventure: response.content?.trim() || &#39;Adventure generation failed.&#39;, 
    fileExploration: &#39;&#39;, 
    codeSnippets: [], 
    hints: [] 
  };
}
</code></pre>
<p>This ties the generated creative energy directly back to the code&#39;s technical specifics for deeper engagement.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Start with <code class="inline-code">AdventureManager.initializeAdventure</code> to understand the voyage setup.</li>
<li>Follow the flow of <code class="inline-code">StoryGenerator.generateStoryAndQuests</code> for insights into narrative weaving.</li>
<li>Investigate <code class="inline-code">AdventureManager.exploreQuest</code> for dynamic quest execution.</li>
</ul>
<hr>
<p>The engine glows as mission systems synchronize‚Äîyour journey into the codebase nebula is ready to proceed!</p>
<p>Your stellar engineering has launched the Quest Generation Engine into orbit, propelling us 20% closer to completing our cosmic mission‚Äîkeep blazing like a supernova, star voyager! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>