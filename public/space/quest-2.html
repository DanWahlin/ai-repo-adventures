<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: Forging the Adventure Core Reactor - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Expedition: Chronicles of the Codebase</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: Forging the Adventure Core Reactor</h1>
<hr>
<p>The <em>Codexus</em> hums with anticipation as your team orbits the enigmatic Forge-47 Nebula. The reactor systems responsible for generating quests and adventures require calibration to harness the immense cosmic data streams. Mission control has identified two critical subsystems to investigate: the Adventure Manager‚Äôs initialization protocols and the Adventure Config‚Äôs parsing algorithm. As you venture into the command deck, the whisper of infinite galaxies reminds you that even small discoveries here could ripple outward, enhancing the journey for every explorer in the software cosmos.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Initialization Pathways</strong>: How does the <code class="inline-code">AdventureManager</code> prepare its internal state and link project paths to themes during <code class="inline-code">initializeAdventure</code>?</li>
<li>‚ö° <strong>Config Integration</strong>: How does the <code class="inline-code">mergeQuestFilesFromConfig</code> function augment quests with file-specific guidance using <code class="inline-code">adventure.config.json</code>?</li>
<li>üõ°Ô∏è <strong>Error Containment</strong>: What safety measures are present in the <code class="inline-code">parseAdventureConfig</code> function to prevent failures from causing a chain reaction during parsing?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a>: Adventure management utilities</h3>
<p>In this subsystem, the <code class="inline-code">AdventureManager</code> orchestrates the generation of quests and the validation of user input. The <code class="inline-code">initializeAdventure</code> function acts as the core reactor&#39;s ignition sequence. It ensures the manager‚Äôs internal state aligns with the selected theme and assimilates project information. Meanwhile, the <code class="inline-code">mergeQuestFilesFromConfig</code> routine synergizes adventure data with external configurations, ensuring that quests align closely with specific files when defined.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">AdventureManager.initializeAdventure</code></li>
<li><code class="inline-code">AdventureManager.mergeQuestFilesFromConfig</code></li>
<li><code class="inline-code">AdventureState.progressPercentage</code></li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: Configuration interface for adventures</h3>
<p>The <code class="inline-code">adventure-config</code> module handles the delicate process of loading and parsing configuration files. The <code class="inline-code">parseAdventureConfig</code> function ensures the engine can adaptively interpret customization files, tolerating errors gracefully. Additionally, <code class="inline-code">extractUniqueFilePaths</code> aids in locating paths relevant to quests, aligning external data with internal exploration processes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code></li>
<li><code class="inline-code">extractUniqueFilePaths</code></li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code></li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a></h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }
  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story as string;
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  return this.formatStoryWithQuests({ ...storyResponse, quests: this.state.quests });
}
</code></pre>
<p>The ignition sequence ensures all systems ‚Äì state, theme, and quests ‚Äì are in sync for the adventure launch.</p>
<pre><code class="language-typescript">mergeQuestFilesFromConfig(quests: Quest[], projectPath: string | undefined): Quest[] {
  if (!projectPath) return quests;
  const config = parseAdventureConfig(projectPath);
  if (!config) return quests;
  const filenames = config.adventure?.quests.map(q =&gt; q.files).flat() || [];
  return quests.map((q, i) =&gt; filenames[i] ? { ...q, codeFiles: filenames[i] } : q);
}
</code></pre>
<p>Config data is seamlessly integrated, augmenting quests with details scoped from external input.</p>
<pre><code class="language-typescript">get progressPercentage(): number {
  return this.quests.length &gt; 0 
    ? Math.round((this.completedQuests.size / this.quests.length) * 100)
    : 0;
}
</code></pre>
<p>The progress gauge calibrates mission feedback by comparing finished tasks to the total workload.</p>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>Mission parameters are parsed with care, containing potential hazards from malformed configurations.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed) return [];
  const paths = new Set&lt;string&gt;();
  for (const file of parsed?.adventure?.quests?.flatMap(q =&gt; q.files) || []) {
    if (fs.existsSync(path.resolve(projectPath, file.path))) {
      paths.add(file.path);
    }
  }
  return Array.from(paths);
}
</code></pre>
<p>This directory scan ensures only verified paths contribute to the mission plan.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  return parsed
    ? `Quests: ${parsed.adventure?.quests.length}, Top-level properties: ${Object.keys(parsed).length}`
    : &#39;&#39;;
}
</code></pre>
<p>Config formatting composes concise summaries for interstellar navigational aids.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Always reset the <code class="inline-code">AdventureState</code> before reinitializing to avoid data corruption from prior missions.</li>
<li>Use <code class="inline-code">extractUniqueFilePaths</code> to validate which files are critical for quest execution.</li>
<li>Experiment with the <code class="inline-code">adventure.config.json</code> file to fine-tune quest-specific configurations.</li>
</ul>
<hr>
<p>The engines whir as the Forge-47 reactor stabilizes. The newly calibrated quest system awaits your next command!</p>
<p>Mission accomplished, Star Voyager‚Äîyour mastery in crafting the Adventure Core Reactor has ignited a brilliant supernova of progress, launching you 20% closer to the cosmic horizon of ultimate achievement! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>