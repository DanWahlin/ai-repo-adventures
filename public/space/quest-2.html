<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Stellar Forge: Crafting Galactic Adventures - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">Galactic Navigator: Secrets of the Code Nebula</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Stellar Forge: Crafting Galactic Adventures</h1>
<hr>
<p>The <strong>Galactic Navigator</strong> had entered a region of the <strong>Code Nebula</strong> known as the Fragmented Forge, where countless pieces of shattered repositories floated in cosmic disarray. The Navigator’s adventure engine hummed, ready to align these chaotic shards into cohesive galactic narratives. But to revive the greater story framework, the crew needed to brave the tempestuous void, examining each stellar fragment for hidden insights. With the tools of LLM reactors and Repomix analyzers, their mission was clear: forge an epic adventure from the ashes of disunited code.  </p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure orchestration and quest execution</h3>
<p>The <strong>adventure-manager.ts</strong> file is the command center of the Galactic Navigator’s quest operations. Packed with robust methods, it acts as the crew’s roadmap, directing how adventures are initialized, quests are explored, and progress is tracked. At its core, the <code class="inline-code">AdventureManager</code> operates like the ship&#39;s captain, ensuring each mission starts with precise preparation. The <code class="inline-code">initializeAdventure()</code> method is vital, combining <strong>project context</strong> and user-selected themes to create a fully immersive story. Meanwhile, the <code class="inline-code">exploreQuest()</code> function manages the seamless delivery of quests, transforming user choices into actionable adventures through LLM-generated content. Notably, the <code class="inline-code">generateQuestContent()</code> function adapts the adventure output by analyzing specific files or full project contexts via Repomix. This file also manages an intricate <code class="inline-code">AdventureState</code>, which calculates progress percentage, making it indispensable for unraveling multiple quests.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">AdventureManager.initializeAdventure</code>: Sets up the entire context for a project and aligns quests with selected themes.  </li>
<li><code class="inline-code">AdventureManager.exploreQuest</code>: Safeguards the journey by validating user decisions and linking them to clear narratives.  </li>
<li><code class="inline-code">generateQuestContent()</code>: Crafts highly relevant adventures by analyzing targeted files or comprehensive repository contexts.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Guided configuration for enhanced adventures</h3>
<p>This file acts as the ship&#39;s <strong>cosmic cartographer</strong>, providing structured guidance for quests in the form of the <code class="inline-code">adventure.config.json</code> file. The <code class="inline-code">parseAdventureConfig()</code> function decodes the configuration data, translating it into clear directives for the adventure system. Its companion, <code class="inline-code">formatAdventureConfigForPrompt()</code>, prepares this structured data for integration with LLM prompts, ensuring quests are built with thematic and structural consistency. An essential feature is the <code class="inline-code">extractUniqueFilePaths()</code> method, which diligently traverses the adventure configuration to pinpoint critical repository files, turning raw code into polished, star-worthy prompts. By combining technical rigor with clear documentation mapping, this file ensures that adventures and their supporting contexts remain accurate and cohesive.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig()</code>: Reads and validates adventure configuration data.  </li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code>: Prepares quest details and file highlights for user-friendly storytelling.  </li>
<li><code class="inline-code">extractUniqueFilePaths()</code>: Gathers all file paths referenced in the adventure configuration, streamlining exploration.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">export class AdventureManager {  
  private state: AdventureState = new AdventureState();  
  private storyGenerator: StoryGenerator;  

  constructor() {  
    this.storyGenerator = new StoryGenerator();  
  }  

  async initializeAdventure(  
    projectInfo: ProjectInfo,  
    theme: AdventureTheme,  
    projectPath?: string,  
    customThemeData?: CustomThemeData  
  ): Promise&lt;string&gt; {  
    this.state.reset();  
    this.state.projectInfo = projectInfo;  
    this.state.currentTheme = theme;  
    this.state.projectPath = projectPath || process.cwd();  

    if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {  
      this.storyGenerator.setCustomTheme(customThemeData);  
    }  

    const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);  
    this.state.title = storyResponse.title;  
    this.state.story = typeof storyResponse.story === &#39;string&#39; ? storyResponse.story : storyResponse.story.content;  
    this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);  
    this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);  

    return this.formatStoryWithQuests({ ...storyResponse, quests: this.state.quests });  
  }  
}  
</code></pre>
<p>This function is akin to setting up the flight plan for a starship, where the exact destinations (quests) and operational parameters (themes) are mapped out.</p>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {  
  const raw = loadAdventureConfig(projectPath);  
  if (!raw) return null;  
  try {  
    return JSON.parse(raw);  
  } catch {  
    return null;  
  }  
}  

export function formatAdventureConfigForPrompt(projectPath: string): string {  
  const parsed = parseAdventureConfig(projectPath);  
  if (!parsed || typeof parsed !== &#39;object&#39;) {  
    return &#39;&#39;;  
  }  

  const adventure = (parsed as any).adventure;  
  if (!adventure || !Array.isArray(adventure.quests)) {  
    return &#39;&#39;;  
  }  

  let formatted = `## Quest Structure Guidelines\n\n`;  
  formatted += `**CRITICAL: Each quest MUST include dedicated file analysis sections**\n\n`;  

  for (const quest of adventure.quests) {  
    if (!quest.title || !Array.isArray(quest.files)) continue;  

    formatted += `### ${quest.title}\n`;  
    formatted += `${quest.description}\n\n`;  
    formatted += `**Required File Analysis Sections:**\n`;  

    for (const file of quest.files) {  
      if (!file.path || !file.description) continue;  

      formatted += `\n**File: \`${file.path}\`**\n`;  
      formatted += `- Description: ${file.description}\n`;  

      if (Array.isArray(file.highlights)) {  
        formatted += `- Key Functions/Areas to Highlight:\n`;  
        for (const highlight of file.highlights) {  
          if (highlight.name &amp;&amp; highlight.description) {  
            formatted += `  • **${highlight.name}**: ${highlight.description}\n`;  
          }  
        }  
      }  
    }  
    formatted += `\n`;  
  }  

  return formatted;  
}  
</code></pre>
<p>These two functions resemble a stellar compass and map, guiding explorers through the swirling chaos of the Code Nebula in an organized, step-by-step fashion.  </p>
<h2>Helpful Hints</h2>
<ul>
<li>Thoroughly review the <code class="inline-code">adventure.config.json</code> file’s structure to verify its consistency before generating prompts.  </li>
<li>Consider extending the <code class="inline-code">AdventureState</code> class to include more complex progress-tracking systems like quest dependencies.  </li>
<li>As a next step, integrate project-specific data into story introductions for richer contexts.</li>
</ul>
<p>Mission accomplished, star voyager! 🚀 You&#39;ve ignited the quantum core of creativity in the Stellar Forge, propelling your journey to 25% galactic mastery—keep charting those uncharted universes! ⭐✨</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: The Repomix Core: Mapping the C... →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>