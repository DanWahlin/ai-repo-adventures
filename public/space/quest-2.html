<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: Generating Galactic Missions - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Cosmic Codex: The Tales of the Starship Codexia</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: Generating Galactic Missions</h1>
<hr>
<p>As the Codexia crew ventures deeper into the Repository Nebula, turbulent waves of cosmic data disrupt their systems. They&#39;ve uncovered fragments of ancient algorithms within the nebula‚Äôs data streams. Your quest is to decode these stellar patterns, analyze interstellar configurations, and design thematic star charts that map the core adventures within the repository. The nebula guards its mysteries with fragmented data nodes, requiring precision calibration and relentless exploration to uncover hidden quests.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Celestial Calibration</strong>: How does the <code class="inline-code">AdventureManager.initializeAdventure</code> create and configure the adventure story based on the repository&#39;s blueprints and theme?</li>
<li>‚ö° <strong>Quest Synchronization</strong>: What mechanisms are in place to merge adventure quest files with the generated story configuration using <code class="inline-code">mergeQuestFilesFromConfig</code>?</li>
<li>üõ°Ô∏è <strong>Mission Validation</strong>: What safeguards ensure the integrity and validity of user choices in <code class="inline-code">AdventureManager.exploreQuest</code>?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Manage and execute the galactic adventures.</h3>
<p>The <code class="inline-code">AdventureManager</code> class within this file acts as the central command interface for creating, managing, and executing quests. It dynamically integrates project context, themes, and quest configurations, channeling the vast expanses of the Repository Nebula into structured adventures. By using utilities like <code class="inline-code">initializeAdventure</code> and <code class="inline-code">mergeQuestFilesFromConfig</code>, this manager ensures seamless alignment between user selections and galactic narratives. It also validates user input to protect the mission against error-prone disruptions.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Configures the celestial adventure by resetting the state, applying themes, and generating quests from the repository‚Äôs cosmic data streams.</li>
<li><code class="inline-code">mergeQuestFilesFromConfig</code>: Aligns quests with specific data nodes from the nebula based on the adventure configuration file.</li>
<li><code class="inline-code">exploreQuest</code>: Validates user inputs, selects a specific quest, and executes it‚Äînavigating through the tumultuous nebula while caching quest results for efficiency.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  // Reset state for new adventure
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;
  
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<ul>
<li>This code initializes the adventure by consolidating key project information, setting themes, and resetting the state for the new mission.</li>
<li>Complex logic separates theme-specific customization, demonstrating versatility in configuration for both standard and custom quests.</li>
<li>Quest alignment ensures results from the <code class="inline-code">repository</code> are seamlessly incorporated into the nebula&#39;s adventure.</li>
<li>Strategies such as caching and validation contribute to high-performance operations, enabling quick exploration across sectors.</li>
</ul>
<hr>
<pre><code class="language-typescript">private mergeQuestFilesFromConfig(quests: Quest[], projectPath: string | undefined): Quest[] {
  if (!projectPath) return quests;
  
  const config = parseAdventureConfig(projectPath);
  if (!config || typeof config !== &#39;object&#39;) return quests;

  const adventure = (config as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) return quests;

  const configQuestFiles = new Map&lt;string, string[]&gt;();
  for (const configQuest of adventure.quests) {
    if (configQuest.title &amp;&amp; Array.isArray(configQuest.files)) {
      const filePaths = configQuest.files
        .filter((f: any) =&gt; f.path)
        .map((f: any) =&gt; f.path);
      if (filePaths.length &gt; 0) {
        configQuestFiles.set(configQuest.title.toLowerCase(), filePaths);
      }
    }
  }

  return quests.map((quest, index) =&gt; {
    const configQuests = adventure.quests;
    if (index &lt; configQuests.length &amp;&amp; configQuests[index] &amp;&amp; configQuests[index].files) {
      const files = configQuests[index].files
        .filter((f: any) =&gt; f.path)
        .map((f: any) =&gt; f.path);
      if (files.length &gt; 0) {
        return { ...quest, codeFiles: files };
      }
    }
    
    const questTitleLower = quest.title.toLowerCase();
    for (const [configTitle, files] of configQuestFiles.entries()) {
      if (questTitleLower.includes(configTitle) || configTitle.includes(questTitleLower)) {
        return { ...quest, codeFiles: files };
      }
    }
    
    return quest;
  });
}
</code></pre>
<ul>
<li>Important logic maps adventure configurations from the nebula‚Äôs galactic archives into active quests.</li>
<li>Functions cater to both direct-order file matching and fallback mechanisms ensuring flexible adaptation to fragmented configurations.</li>
<li>Patterns illustrate robust scope management for maintaining integrity when syncing adventure files with pre-generated quests.</li>
<li>The merging behavior ensures consistent alignment of user selections with data available in the configuration.</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }
  
  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li>This feature guarantees the navigation fidelity of nebulous missions, implementing validation to protect users from invalid choices.</li>
<li>Segmented logical checks differentiate between progress-view requests and explicit quest exploration.</li>
<li>Error mechanisms handle missing quests gracefully, ensuring uninterrupted user interactions.</li>
<li>The modular structure highlights scalability, enabling direct quest-based operations with minimal compute overhead.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Always trace the flow of the <code class="inline-code">initializeAdventure</code> function to visualize how state resets precede story and quest generation.</li>
<li>Dive into the merging logic to understand how the file configuration safeguards fragmented data exploration.</li>
<li>Revisit <code class="inline-code">exploreQuest</code> interactions to between choice validation and efficient quest caching.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries hidden in the Repository Nebula.</p>
<p>Mission accomplished, star voyager! üöÄ You‚Äôve charted the uncharted and launched into a new galaxy of knowledge‚ÄîQuest 2 complete and your interstellar journey is powered to 20% brilliance! ‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>