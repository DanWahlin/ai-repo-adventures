<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: Navigating the Adventure Core - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Starship Codex: Chronicles of the Repo Nebula</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: Navigating the Adventure Core</h1>
<hr>
<p>As the <em>Starship Codex</em> drifts through the shimmering currents of the repo nebula, the mission intensifies. Your next objective is navigating the heart of the Adventure Core itself—a realm where the cosmic intricacies of storytelling and codebase management converge. Armed with the <em>LLM Navigator</em> and bolstered by the insights of the previous journey, you prepare to delve into the core files that breathe life into every quest and configure the entire adventure experience. Uncharted systems hum, awaiting discovery, as the galaxy whispers its mysteries through the thematic layers of space exploration.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure Orchestration</h3>
<p>This file is the command center of the adventure system, orchestrating quest generation, tracking state, and facilitating seamless interactions. At its core lies the <code class="inline-code">AdventureManager</code> class, responsible for initializing the adventure through <code class="inline-code">initializeAdventure()</code> by setting up project context, choosing a theme, and generating story-driven quests. Its <code class="inline-code">exploreQuest()</code> method validates user choices and executes quest exploration, while caching content for revisited quests to optimize performance. The <code class="inline-code">AdventureState</code> class tracks overall progress using <code class="inline-code">progressPercentage</code>, ensuring aspirations for completion are visible at every step. Additionally, the <code class="inline-code">generateQuestContent()</code> method dynamically adapts repomix content to provide focused exploration or broader insights, making coding journeys immersive and tailored.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure()</code> prepares the mission by generating quests based on themes and project details.</li>
<li><code class="inline-code">exploreQuest()</code> ensures user input is validated and leads the charge into targeted journey exploration.</li>
<li><code class="inline-code">AdventureState.progressPercentage</code> calculates mission progress with precision, keeping adventurers informed.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration Navigator</h3>
<p>Configuration is key in adventure management, and this file ensures the system behaves predictably and is customized effectively. Its <code class="inline-code">loadAdventureConfig()</code> method reads the central configuration file, <code class="inline-code">adventure.config.json</code>, providing the foundational guide for quests. <code class="inline-code">extractUniqueFilePaths()</code> traverses the config to list all unique file paths referenced, streamlining the focus on specific portions of the codebase. Additionally, <code class="inline-code">formatAdventureConfigForPrompt()</code> organizes the config data into prescriptions for quest structure, ensuring a clear, educational adventure narrative for every generated theme.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig()</code> retrieves the adventure&#39;s blueprint from <code class="inline-code">adventure.config.json</code>.</li>
<li><code class="inline-code">extractUniqueFilePaths()</code> identifies all crucial file paths called out in the configuration settings.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code> transforms configuration into an LLM-friendly format, enhancing quest depth.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/adventure/story-generator.ts:</span> Story Creation Reactor</h3>
<p>The heartbeat of the adventure system, this file powers the narrative engine. The <code class="inline-code">StoryGenerator</code> class uses advanced LLM integration to transform repomix content into vibrant tales and themed journeys. Its <code class="inline-code">generateStoryAndQuests()</code> method crafts an overarching narrative along with structured quests, while <code class="inline-code">generateQuestContent()</code> dives into specific files, presenting meaningful code insights in thematic context. With methods like <code class="inline-code">validateTheme()</code>, the StoryGenerator ensures that the adventure respects its thematic structure, whether it leans into cosmic exploration or another genre.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateStoryAndQuests()</code> composes quests and their stories using advanced LLM tools.</li>
<li><code class="inline-code">generateQuestContent()</code> crafts file-specific explorations to deepen understanding.</li>
<li><code class="inline-code">validateTheme()</code> ensures quest narratives stay aligned with the chosen theme.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">export class AdventureManager {
  private state: AdventureState = new AdventureState();
  ...
  
  async initializeAdventure(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme, 
    projectPath?: string,
    customThemeData?: CustomThemeData
  ): Promise&lt;string&gt; {
    this.state.reset();
    this.state.projectInfo = projectInfo;
    this.state.currentTheme = theme;
  }

  async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
    const sanitizedChoice = this.validateAndSanitizeChoice(choice);
    const quest = this.findQuest(sanitizedChoice);
    if (!quest) return this.createNotFoundResult();
    return await this.executeQuest(quest);
  }

  get progressPercentage(): number {
    return this.state.quests.length &gt; 0 
        ? Math.round((this.state.completedQuests.size / this.state.quests.length) * 100)
        : 0;
  }
}
</code></pre>
<p>This code is like the captain directing the ship, charting routes and tracking the crew’s progress toward new horizons.</p>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}

export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];
  const stack: any[] = [parsed];
  const unique = new Set&lt;string&gt;();
  while (stack.length) {
    const node = stack.pop();
    if (node.path &amp;&amp; typeof node.path === &#39;string&#39;) unique.add(node.path);
    if (Array.isArray(node)) stack.push(...node);
  }
  return Array.from(unique);
}

export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return &#39;&#39;;
  const adventure = parsed.adventure;
  let formatted = `## Quest Structure Guidelines\n\n`;
  for (const quest of adventure.quests) {
    formatted += `### ${quest.title}\n**Required File Analysis Sections:**\n`;
  }
  return formatted;
}
</code></pre>
<p>Much like a navigator scanning blueprints and guiding operations, this code organizes and clarifies the route.</p>
<h3>packages/core/src/adventure/story-generator.ts</h3>
<pre><code class="language-typescript">export class StoryGenerator {
  async generateStoryAndQuests(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme
  ): Promise&lt;StoryResponse&gt; {
    const prompt = loadStoryGenerationPrompt({ theme });
    const response = await this.llmClient.generateResponse(prompt);
    const parsed = parseMarkdownToStoryResponse(response.content);
    return parsed;
  }

  async generateQuestContent(
    quest: Quest, 
    theme: AdventureTheme, 
    codeContent: string
  ): Promise&lt;QuestContent&gt; {
    const prompt = loadQuestContentPrompt({ theme, adventureTitle: quest.title });
    const response = await this.llmClient.generateResponse(prompt);
    return { adventure: response.content };
  }
}
</code></pre>
<p>This code resembles an engine converting raw fuel into cosmic stories and meaningful quests, propelling explorers forward.</p>
<h2>Helpful Hints</h2>
<ul>
<li>To optimize quest generation, use the structured guidance provided in <code class="inline-code">adventure.config.json</code>.</li>
<li>Consider enhancing file-specific exploration by refining highlights within the configuration.</li>
<li>Dive further into thematic customization to create distinct narratives that resonate deeply.</li>
</ul>
<hr>
<p>Mission accomplished, star navigator! Quest 2 has been mastered with galactic precision—your trajectory to adventure shines brighter than a supernova! ⭐🚀⚡</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: Mapping the Repomix Galaxy →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>