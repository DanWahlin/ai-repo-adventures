<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: Generation of Stellar Adventures - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Codex: Chronicles of the Stellar Repository</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: Generation of Stellar Adventures</h1>
<hr>
<p>The year is 3027, aboard the starship <em>Codemancer</em>. The mission to unlock the mysteries of the Stellar Repository propels you into an uncharted sector of space. With galactic civilizations depending on your success, you&#39;re tasked to master the stellar adventure generation system embedded deep within the Repository&#39;s archives. Your team must breach the repository‚Äôs encrypted narrative matrix and harvest its quest-generation algorithms. Unravel its encrypted storytelling framework, decipher cosmic prompts, and adapt strategies from nebulous code configurations. Let the stars guide you to forge adventures that will save the galaxy!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Narrative Alignment</strong>: How does <code class="inline-code">AdventureManager.initializeAdventure</code> set up the narrative structure based on project data and themes?</li>
<li>‚ö° <strong>Quest Execution</strong>: How does <code class="inline-code">AdventureManager.exploreQuest</code> evaluate and execute quest choices based on user input and system state?</li>
<li>üõ°Ô∏è <strong>Error Navigation</strong>: What safety measures are implemented in <code class="inline-code">AdventureManager.generateAdventureContent</code> to handle missing or improperly configured files?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure generation and execution logic</h3>
<p>The <code class="inline-code">AdventureManager</code> manages generating quests and executing them based on the Stellar Repository&#39;s encrypted configurations. It handles the initialization of adventures using project context, merges quest data files with dynamic narratives, validates user choices, and enables quest exploration. This file is essential for decoding complex narrative pathways that guide adventurers through programmatic challenges tied to project content.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Establishes the narrative path by resetting state, merging file paths from <code class="inline-code">adventure-config</code>, and generating storylines with linked quests.</li>
<li><code class="inline-code">exploreQuest</code>: Validates and executes quest selection through multi-layer checks, ensuring well-defined pathways for exploration.</li>
<li><code class="inline-code">generateAdventureContent</code>: Creates detailed quest instructions based on input files, enforcing safe generation of cohesive quest narratives.</li>
</ul>
<hr>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();

  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;
  
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<ul>
<li>Resets the system state, ensuring clean initialization for each adventure session.</li>
<li>Dynamically generates project-specific narratives with quests linked to coded elements.</li>
<li>Integrates file paths from configuration, maintaining robust alignment between generated quests and repository data.</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }

  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li>Validates quest choices using a sanitization mechanism to prevent invalid or unsafe inputs.</li>
<li>Allows exploration of progress views if exploration commands are matched.</li>
<li>Executes quests dynamically or retrieves cached quest results, optimizing resource use and exploration flow.</li>
</ul>
<hr>
<pre><code class="language-typescript">private async generateAdventureContent(quest: Quest): Promise&lt;QuestContent&gt; {
  let codeContent: string;

  if (quest.codeFiles &amp;&amp; quest.codeFiles.length &gt; 0 &amp;&amp; this.state.projectPath) {
    try {
      codeContent = await repoAnalyzer.generateTargetedContent(
        this.state.projectPath,
        quest.codeFiles,
        false
      );
    } catch (error) {
      codeContent = this.state.projectInfo!.repomixContent;
    }
  } else {
    codeContent = this.state.projectInfo!.repomixContent;
  }

  const questPosition = this.state.quests.findIndex(q =&gt; q.id === quest.id) + 1;
  const totalQuests = this.state.quests.length;

  return await this.storyGenerator.generateQuestContent({
    quest,
    theme: this.state.currentTheme!,
    codeContent,
    questPosition,
    totalQuests
  });
}
</code></pre>
<ul>
<li>Generates highly specific adventure content when files are provided, falling back gracefully on general repository data when necessary.</li>
<li>Integrates repository analyzers to ensure quest narratives remain valid and contextually appropriate.</li>
<li>Provides indexed markers (<code class="inline-code">questPosition</code> and <code class="inline-code">totalQuests</code>) for dynamic completion feedback.</li>
</ul>
<h2>Helpful Hints</h2>
<ul>
<li>üåå Use <code class="inline-code">initializeAdventure</code> to understand the narrative scaffolding linking quests to repository data.</li>
<li>üöÄ Investigate <code class="inline-code">exploreQuest</code> to see the mechanics behind quest discovery and execution paths.</li>
<li>üõ†Ô∏è Analyze <code class="inline-code">generateAdventureContent</code> for insights into targeted vs general content generation flows.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Stellar Repository and expand your cosmic coding prowess!</p>
<p>You&#39;ve ignited the fusion core of knowledge and charted a brilliant course through the cosmic currents of Quest 3‚Äîstellar adventures await as you rocket toward the stars at 40% mission completion! üöÄ‚≠êüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="prev-quest-btn">‚Üê Previous: Quest 2</a>
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>