<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: The Cosmic Analyzers - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Adventures: The Codebase Chronicles</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: The Cosmic Analyzers</h1>
<hr>
<p>The Codebreaker‚Äôs navigation systems hum with anticipation as your crew prepares to enter the <strong>Celestial Rift</strong>, a dazzling cosmic anomaly shrouded in charged stellar filaments. This region is thought to house vital coordinates to unlock the <strong>Repository Core</strong>‚Äôs true potential. However, only by analyzing encrypted nebula star maps, stabilizing energy flows, and invoking intelligent processing can the crew decipher these cosmic riddles. Your team‚Äôs expertise in activating analytical tools will determine whether you can illuminate the hidden pathways‚Äîor be lost to the galactic unknown.</p>
<p><strong>Your next mission is clear: synchronize the ship‚Äôs analyzers, communicate with advanced AI systems, and pave the way to the Repository Core!</strong></p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/analyzer/repo-analyzer.ts:</span> Analyzer logic for file-based context generation</h3>
<p>In this file, we delve into the <strong>RepoAnalyzer</strong> class, which is critical to extracting, validating, and optimizing project data. Methods like <code class="inline-code">generateRepomixContext</code> work as the backbone, gathering necessary codebase context by interfacing with the Repomix CLI. Another such essential feature is <code class="inline-code">captureRepomixStdout</code>, which integrates subprocess calls to retrieve the project‚Äôs metadata securely. Finally, <code class="inline-code">validateProjectPath</code> sets constraints to confirm safe file interactions, ensuring that the operations avoid unsafe or unexpected file paths. Together, these tools serve as a map, not for stars, but for structured project data!</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">RepoAnalyzer.generateRepomixContext</code> gathers the context of the given repository through intelligent CLI invocations.</li>
<li><code class="inline-code">RepoAnalyzer.captureRepomixStdout</code> ensures safe and resource-controlled communication with external processes.</li>
<li><code class="inline-code">RepoAnalyzer.validateProjectPath</code> verifies the integrity and safety of project paths to prevent harmful operations.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/analyzer/repo-analyzer.ts</h3>
<pre><code class="language-typescript">async generateRepomixContext(projectPath: string, options: RepomixOptions = {}): Promise&lt;string&gt; {
  this.validateProjectPath(projectPath);
  
  // Check if adventure.config.json has specific files to include
  const configuredFiles = extractUniqueFilePaths(projectPath);
  
  if (configuredFiles.length &gt; 0) {
    console.log(`Using adventure.config.json: analyzing ${configuredFiles.length} configured files with optimization`);
    return await this.generateOptimizedContent(projectPath, configuredFiles)
               .catch(() =&gt; this.generateTargetedContent(projectPath, configuredFiles));
  }
  
  console.log(&#39;No adventure.config.json found: analyzing full codebase (compressed)&#39;);
  return await this.captureRepomixStdout([&#39;.&#39;], projectPath, {
    style: options.style || &#39;markdown&#39;,
    compress: options.compress !== false,
  });
}
</code></pre>
<p>Identifies required files and generates contextual data, much like scanning stars to locate a vital waypoint.</p>
<pre><code class="language-typescript">private async captureRepomixStdout(directories: string[], cwd: string, options: CliOptions): Promise&lt;string&gt; {
  return new Promise((resolve, reject) =&gt; {
    const args = [...directories, &#39;--style&#39;, options.style || &#39;markdown&#39;];
    if (options.compress) args.push(&#39;--compress&#39;);
    const repomix = spawn(&#39;npx&#39;, [&#39;repomix&#39;, ...args], { cwd, stdio: [&#39;pipe&#39;, &#39;pipe&#39;, &#39;pipe&#39;] });

    let stdout = &#39;&#39;;
    repomix.stdout.on(&#39;data&#39;, (data) =&gt; stdout += data.toString());
    repomix.on(&#39;close&#39;, (code) =&gt; code === 0 ? resolve(stdout) : reject(new Error(&#39;Repomix failed&#39;)));
  });
}
</code></pre>
<p>Launches a subprocess to interact with Repomix‚Äîsimilar to deploying a probe to collect stellar phenomena.</p>
<pre><code class="language-typescript">private validateProjectPath(projectPath: string): void {
  const trimmedPath = projectPath.trim();
  if (trimmedPath.includes(&#39;\0&#39;) || !fs.existsSync(trimmedPath)) {
    throw new Error(&#39;Invalid project path&#39;);
  }
}
</code></pre>
<p>Confirms that the path is safe and fits within the operational boundaries‚Äîakin to verifying celestial charts for anomalies before exploration!</p>
<hr>
<h3><span class="header-prefix">packages/core/src/llm/llm-client.ts:</span> Interface for large language models</h3>
<p>The <strong>LLMClient</strong> class powers communication between Codebreaker‚Äôs systems and external AI models, acting as the ship‚Äôs <strong>cosmic translator</strong> for its analytical journeys. The <code class="inline-code">generateResponse</code> method is a cornerstone, allowing prompts (parsed sensor data) to be converted into actionable insights. Essential configurations, such as API key management in <code class="inline-code">getApiKey</code> or determining the model‚Äôs type via <code class="inline-code">isAzureOpenAI</code>, establish secure and precise communication with external infrastructures. This AI processing infrastructure ensures mission success as the Codebreaker navigates complex stellar data.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLMClient.generateResponse</code> synthesizes prompts into actionable results using advanced AI systems.</li>
<li><code class="inline-code">LLMClient.constructor</code> manages essential setup, including client selection and error handling.</li>
<li><code class="inline-code">LLMClient.getApiKey</code> determines secure API key assignments for various systems.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/llm/llm-client.ts</h3>
<pre><code class="language-typescript">async generateResponse(prompt: string, options?: LLMRequestOptions): Promise&lt;LLMResponse&gt; {
  try {
    const requestParams = this.buildRequestParams(prompt, options);
    const completion = await this.executeRequest(requestParams);
    let content = this.validateResponse(completion);
    
    if (options?.responseFormat === &#39;json_object&#39;) {
      content = this.cleanJsonResponse(content);
    }
    
    this.logTokenUsage(completion);
    return { content };
  } catch (error) {
    throw new Error(`LLM request failed: ${error.message}`);
  }
}
</code></pre>
<p>Processes prompts like gathering cosmic signals, generating clear insights to guide the journey.</p>
<pre><code class="language-typescript">constructor() {
  this.model = LLM_MODEL;
  const apiKey = this.getApiKey();
  this.client = LLM_BASE_URL.includes(&#39;.azure.com&#39;) ? 
                new AzureOpenAI({...}) : new OpenAI({...});
}
</code></pre>
<p>Establishes the ship‚Äôs connection to AI-driven analyzers, ensuring secure computational navigation.</p>
<pre><code class="language-typescript">private getApiKey(): string {
  if (LLM_BASE_URL.includes(&#39;models.inference.ai.azure.com&#39;)) {
    if (!GITHUB_TOKEN) {
      throw new Error(&#39;GITHUB_TOKEN required for GitHub Models&#39;);
    }
    return GITHUB_TOKEN;
  }
  if (!LLM_API_KEY) throw new Error(&#39;LLM_API_KEY required&#39;);
  return LLM_API_KEY;
}
</code></pre>
<p>Secures an API endpoint, like opening a secure channel to communicate with intergalactic allies.</p>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Practical Tip</strong>: For <code class="inline-code">RepoAnalyzer</code>, ensure project directories are well-organized to improve output clarity.</li>
<li><strong>Exploration Recommendation</strong>: Optimize prompts sent to <code class="inline-code">LLMClient</code> for reduced token usage, much like fine-tuning starship resource allocation.</li>
<li><strong>Next Steps</strong>: Verify the AI outputs via <code class="inline-code">validateResponse</code> to avoid errors interrupting the mission‚Äôs flow.</li>
</ul>
<hr>
<p>The Repository Core awaits‚Äîventure onward, brave explorer, and connect cosmic dots for the galaxy!</p>
<p>Congratulations, Cosmic Commander‚ÄîQuest 3 is a stellar success, propelling your knowledge through the learning galaxy at warp speed‚Äî2 quests down, and your mission to mastery is shining brighter than a supernova! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="prev-quest-btn">‚Üê Previous: Quest 2</a>
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>