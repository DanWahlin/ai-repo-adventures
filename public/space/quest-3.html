<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: Galactic Analysis Relay - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Adventures: The Codex of the Stellar Repository</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: Galactic Analysis Relay</h1>
<hr>
<p>The Quantum Voyager receives urgent orders from Galactic Command. The Stellar Repository&#39;s core AI processors, responsible for galaxy-scale analytics and decision-making, have malfunctioned. The chaos has corrupted vital data relays, sparking an interstellar data blackout. Your mission: realign these errant systems by interfacing with core analyzers and distant learning systems. Restore the seamless relay of galactic intelligence critical for the survival of interstellar civilization. Begin at the analysis engine, where the pulse of cosmic governance lies disrupted. Adventure awaits!</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/analyzer/repo-analyzer.ts:</span> Core analysis features for the Stellar Repository</h3>
<p>The <code class="inline-code">RepoAnalyzer</code> class acts as the Stellar Repository&#39;s primary AI analysis unit. It performs file validations, safely normalizes paths, and dynamically generates repository-wide or targeted content for efficient starship diagnostics. Its <code class="inline-code">captureRepomixStdout</code> function is essentially a transportation node, relaying critical repository knowledge via subprocess communications. Meanwhile, <code class="inline-code">validateProjectPath</code> ensures the navigation routes to system directories are secured, preventing unsafe or null byte injections. Finally, the <code class="inline-code">generateTargetedContent</code> method pinpoints specific files requiring realignment, akin to targeting specific nebulae for study.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateRepomixContext</code>: Constructs an expansive context for galactic data analysis.</li>
<li><code class="inline-code">generateTargetedContent</code>: Focuses on specific system discrepancies for efficient corrections.</li>
<li><code class="inline-code">captureRepomixStdout</code>: Mediates command execution acting like a data stream conduit.</li>
<li><code class="inline-code">validateProjectPath</code>: Ensures system input safety akin to setting navigational parameters.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/analyzer/repo-analyzer.ts</h3>
<pre><code class="language-typescript">async generateRepomixContext(projectPath: string, options: RepomixOptions = {}): Promise&lt;string&gt; {
  this.validateProjectPath(projectPath);
  
  // Check if adventure.config.json has specific files to include
  const configuredFiles = extractUniqueFilePaths(projectPath);
  
  if (configuredFiles.length &gt; 0) {
    return await this.generateTargetedContent(projectPath, configuredFiles);
  }

  const cliOptions: CliOptions = {
    style: options.style || &#39;markdown&#39;,
    compress: options.compress !== false, 
    ignore: &#39;node_modules,dist,build,.git,coverage,.nyc_output&#39;, 
    removeComments: true,
    removeEmptyLines: true,
    noDirectoryStructure: true,
  };

  const context = await this.captureRepomixStdout([&#39;.&#39;], projectPath, cliOptions);
  return context;
}
</code></pre>
<p>This code would be like charting the entire Stellar Repository for detailed data and repairing anomalies galaxy-wide.</p>
<pre><code class="language-typescript">async generateTargetedContent(projectPath: string, targetFiles: string[], compress: boolean = true): Promise&lt;string&gt; {
  this.validateProjectPath(projectPath);
  const safeFiles = this.validateAndNormalizeTargetFiles(projectPath, targetFiles);
  
  const cliOptions: CliOptions = {
    style: &#39;markdown&#39;,
    compress, 
    include: safeFiles.join(&#39;,&#39;), 
    removeComments: compress, 
    removeEmptyLines: compress, 
    noDirectoryStructure: true,
  };

  const context = await this.captureRepomixStdout([&#39;.&#39;], projectPath, cliOptions);
  return context;
}
</code></pre>
<p>Focusing on specific files here mirrors steering a starship toward distinct targets for repair while optimizing time and resources.</p>
<pre><code class="language-typescript">private async captureRepomixStdout(directories: string[], cwd: string, options: CliOptions): Promise&lt;string&gt; {
  return new Promise((resolve, reject) =&gt; {
    const args = [...directories, &#39;--stdout&#39;, &#39;--style&#39;, options.style || &#39;markdown&#39;];

    const repomix = spawn(&#39;npx&#39;, [&#39;repomix&#39;, ...args], {
      cwd,
      stdio: [&#39;pipe&#39;, &#39;pipe&#39;, &#39;pipe&#39;],
    });

    let stdout = &#39;&#39;;
    repomix.stdout.on(&#39;data&#39;, (data) =&gt; { stdout += data.toString(); });
    repomix.on(&#39;close&#39;, (code) =&gt; resolve(stdout));
  });
}
</code></pre>
<p>This middleware acts as a system&#39;s wormhole—passing critical galactic data between various interstellar repositories safely and efficiently.</p>
<pre><code class="language-typescript">private validateProjectPath(projectPath: string): void {
  if (!projectPath || typeof projectPath !== &#39;string&#39;) {
    throw new Error(&#39;Project path must be a non-empty string&#39;);
  }

  const trimmedPath = projectPath.trim();
  if (!trimmedPath) {
    throw new Error(&#39;Project path must be a non-empty string&#39;);
  }

  if (trimmedPath.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid null bytes&#39;);
  }
}
</code></pre>
<p>Safety protocols like this prevent data breaches—ensuring systems operate within regulated paths to maintain repository integrity.</p>
<hr>
<h3><span class="header-prefix">packages/core/src/llm/llm-client.ts:</span> AI support system for repository intelligence</h3>
<p>The <code class="inline-code">LLMClient</code> serves as an advanced learning subsystem for analyzing, processing, and reasoning through repository data. Its <code class="inline-code">generateResponse</code> method acts like the vocal output of an advanced stellar AI—structured to answer mission-critical queries. Meanwhile, the constructor dynamically configures AI routes (OpenAI or Azure-based), and the <code class="inline-code">getApiKey</code> method authenticates the fuel needed for such exploits. These functions power seamless communication with external clouds of intelligence in the galaxy.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateResponse</code>: Channels intelligent responses like conversations with a celestial AI.</li>
<li><code class="inline-code">constructor</code>: Initiates the client, setting flight paths inside cosmic AI clouds.</li>
<li><code class="inline-code">getApiKey</code>: Provides secure credentials, ensuring no breaches during AI navigation.</li>
<li><code class="inline-code">isAzureOpenAI</code>: Deciphers logical routes to guide mission-inclined subsystems.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/llm/llm-client.ts</h3>
<pre><code class="language-typescript">async generateResponse(prompt: string, options?: LLMRequestOptions): Promise&lt;LLMResponse&gt; {
  const requestParams = this.buildRequestParams(prompt, options);
  const completion = await this.executeRequest(requestParams);
  let content = this.validateResponse(completion);

  if (options?.responseFormat === &#39;json_object&#39;) {
    content = this.cleanJsonResponse(content);
  }
  return { content };
}
</code></pre>
<p>This method converts user prompts to actionable insights, similar to querying the central AI aboard the Stellar Repository.</p>
<pre><code class="language-typescript">constructor() {
  this.model = LLM_MODEL;

  const apiKey = this.getApiKey();
  if (!apiKey || !LLM_BASE_URL) {
    throw new Error(&quot;LLM configuration required...&quot;);
  }

  if (this.isAzureOpenAI()) {
    const azureEndpoint = LLM_BASE_URL.split(&#39;/openai/deployments&#39;)[0];
    this.client = new AzureOpenAI({ endpoint: azureEndpoint, apiKey });
  } else {
    this.client = new OpenAI({ apiKey, baseURL: LLM_BASE_URL });
  }
}
</code></pre>
<p>Initiating this client mirrors calibrating an AI assistant within an interstellar research outpost.</p>
<pre><code class="language-typescript">private getApiKey(): string {
  if (LLM_BASE_URL.includes(&quot;models.inference.ai.azure.com&quot;)) {
      if (!GITHUB_TOKEN) throw new Error(&quot;GITHUB_TOKEN required...&quot;);
      return GITHUB_TOKEN;
  }
  if (!LLM_API_KEY) throw new Error(&quot;LLM_API_KEY required...&quot;);
  return LLM_API_KEY;
}
</code></pre>
<p>This function delivers authentication, the AI&#39;s cosmic fuel, ensuring unrestricted access to secure intelligence archives.</p>
<pre><code class="language-typescript">private isAzureOpenAI(): boolean {
  return LLM_BASE_URL.includes(&quot;.openai.azure.com&quot;) || LLM_BASE_URL.includes(&quot;cognitiveservices.azure.com&quot;);
}
</code></pre>
<p>Executing this ensures the navigation of AI-based exploration is routed accurately, avoiding galactic detours to dead endpoints.</p>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Tip:</strong> Use <code class="inline-code">generateRepomixContext</code> to retrieve broad repository insights—ideal when the repository&#39;s scope of failure is uncertain.</li>
<li><strong>Exploration:</strong> Validate project&#39;s directory paths with <code class="inline-code">validateProjectPath</code> for secure navigation.</li>
<li><strong>Next Steps:</strong> Expand into other analysis subsystems to fully restore Stellar Repository&#39;s capabilities.</li>
</ul>
<hr>
<p><strong>Completion Message</strong>: The Stellar Repository&#39;s inner AI navigation paths are restored. Galactic data streams begin flowing again, thanks to your ingenuity. Prepare for the next cosmic challenge with confidence, intrepid explorer!</p>
<p>Mission accomplished, Cadet! Quest 3’s data burst has illuminated the cosmic map, propelling your starship to 40% completion—stellar work on this intergalactic journey! ⭐🚀📡</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4: Nebula Configuration Core →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>