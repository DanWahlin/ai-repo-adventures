<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Astral Visualization Suite - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Galactic Adventures: Uncovering the Starship‚Äôs Codebase</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Astral Visualization Suite</h1>
<hr>
<p>The <em>Starship Codexus</em> approaches the outer edges of the Orion Nebula, where navigation grows increasingly complex. Stellar maps flicker on and off as the ship&#39;s visualization suite‚Äîthe system responsible for rendering cosmic data into usable charts‚Äîstruggles under the strain. To chart the next leg of the mission, you must repair the Astral Visualization Suite by investigating and synchronizing its configuration systems, theme settings, and validation routines. Will you restore the ship‚Äôs cosmic interface and guide the crew to safety?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Orbital Configurations</strong>: How are defaults for the visualization suite structured, and what environmental variables modify those defaults?</li>
<li>‚ö° <strong>Theme Harmonization</strong>: What role do themes play in customizing the suite, and how is this design future-proof?</li>
<li>üõ°Ô∏è <strong>Safety Shields</strong>: How do the validation functions enhance reliability and prevent malformed configurations?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Mission control for system defaults</h3>
<p>The <code class="inline-code">config.ts</code> file governs critical base configurations for the starship‚Äôs systems. It includes environment variable management, timeout settings, and other constants for the operational and analytical services on board. This file represents the foundational directives that influence system-wide behavior, including maximum file sizes, caching, and system limits. Understanding this file is crucial to adjusting parameters to stabilize the Astral Visualization Suite in extreme conditions.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">FILE_READ_TIMEOUT</code>: Sets how long the system waits to read a file, ensuring stability during large data operations.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Manages cache duration, crucial for optimizing resource loading in the visualization suite.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Prevents files exceeding this threshold from destabilizing the ship‚Äôs systems.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Galactic customization hub</h3>
<p>The <code class="inline-code">theme.ts</code> file orchestrates the theming system for the visualization suite. It defines pre-built themes (like &quot;Space Exploration&quot;) and provides methods to parse, validate, and display themes. This file is the key to harmonizing the suite‚Äôs cosmic charts and ensuring the display aligns with the user‚Äôs chosen theme.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A collection of all predefined themes, each with details like <code class="inline-code">id</code>, <code class="inline-code">key</code>, and <code class="inline-code">description</code>.</li>
<li><code class="inline-code">parseTheme</code>: Deciphers user input to match it with an appropriate theme, accounting for aliases and IDs.</li>
<li><code class="inline-code">isValidTheme</code>: Confirms that a parsed theme has valid credentials.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Cosmic safeguards for input integrity</h3>
<p>The <code class="inline-code">input-validator.ts</code> file provides essential input sanitation for the visualization suite. It ensures that commands, theme selections, and paths meet strict criteria before execution. This shield of validation ensures that no malformed data disrupts the Astral Visualization Suite‚Äôs operations.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Verifies user input for adventure selection, ensuring adherence to length rules.</li>
<li><code class="inline-code">validateTheme</code>: Ensures theme-related commands are sanitized and match known options.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips unsafe characters and limits display strings, protecting the interface from corruption.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">// File-related timeout settings 
export const FILE_READ_TIMEOUT = 10000; // 10 seconds for file reads to avoid hanging

// Cache settings 
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds cache using env

// Analysis limits 
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than 10 MB
</code></pre>
<ul>
<li>Establishes timeouts for file reads, ensuring responsiveness under varying conditions.</li>
<li>Adds flexibility by allowing cache duration to be environment-controlled.</li>
<li>Prevents destabilization due to oversized files through strict memory limits.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">// Single source of truth for all themes
export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  }
};

// Parse theme using custom matching logic
export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
}
  
// Verify theme validity
export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>Demonstrates clear organization of theme metadata, enabling intuitive customization.</li>
<li>Implements parsing logic to normalize input and improve matching reliability.</li>
<li>Simplifies validation with array-based lookup for better performance.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Enforces input constraints critical for operational integrity.</li>
<li>Provides user feedback by comparing themes to known values.</li>
<li>Sanitizes strings to harden against injection and prevent visual disruption.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>üõ†Ô∏è Adjust timeouts and cache settings in <code class="inline-code">config.ts</code> to stabilize performance during peak operations.</li>
<li>üé® Experiment with theming options in <code class="inline-code">theme.ts</code> to optimize usability for the crew.</li>
<li>üõ°Ô∏è Use validation helpers in <code class="inline-code">input-validator.ts</code> to debug input-related errors.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the <em>Starship Codexus</em>! Your adventure is complete.</p>
<p>You&#39;ve rocketed through the cosmic depths to master the Astral Visualization Suite, propelling your mission to 80% completion‚Äîstellar work, Captain! ‚≠êüöÄüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>