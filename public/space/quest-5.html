<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Foundation & Utilities - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Stellar Repository Expeditions</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Foundation &amp; Utilities</h1>
<hr>
<p>The starship‚Äôs inner workings depend on a reliable foundation and essential utilities to sustain interstellar code exploration. As captain, your task is to unlock the secrets of these utilities, ensuring smooth operation for the crew. This mission will focus on how configuration parsing, file path extraction, and data formatting shape the starship‚Äôs digital exploration capabilities. The cosmic voyage ahead requires close attention to these mechanisms to optimize the expedition for efficiency and precision.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Cosmic Map Parsing</strong>: How does the <code class="inline-code">parseAdventureConfig</code> function handle adventure data, and what patterns are evident in its error handling?</li>
<li>‚ö° <strong>Pathfinding Dynamics</strong>: How does <code class="inline-code">extractUniqueFilePaths</code> traverse and validate config data to identify existing file paths within the project scope?</li>
<li>üõ°Ô∏è <strong>Prompt Optimization</strong>: How does <code class="inline-code">formatAdventureConfigForPrompt</code> condense configuration details into a streamlined format for external use?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: Utilities for adventure config parsing and management</h3>
<p>The file establishes a robust foundation for adventure-related operations. Here, functions like <code class="inline-code">parseAdventureConfig</code> ensure reliable JSON parsing while preventing failures from invalid or missing input. <code class="inline-code">extractUniqueFilePaths</code> plays the role of a stellar navigator, traversing configuration objects to uncover valid file paths referenced in the adventure&#39;s configuration. Finally, <code class="inline-code">formatAdventureConfigForPrompt</code> transforms configuration data into a compact format suitable for external systems, ensuring compatibility and clarity.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Determining how adventure configs are parsed and validated.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Exploring unique paths extraction mechanisms in configuration data.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Investigating the reduction strategy for data formatting.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>Much like decoding star maps, this function attempts to parse the adventure config JSON while returning <code class="inline-code">null</code> for malformed input to avoid mission-critical failures.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<p>Much like charting a stellar orbit, this function recursively scans and validates file paths present in the config, ensuring all references are accurately mapped.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    const filePaths = quest.files
      .filter((f: any) =&gt; f.path)
      .map((f: any) =&gt; f.path);
    if (filePaths.length &gt; 0) {
      formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    }
    
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .filter((h: any) =&gt; h.name)
      .map((h: any) =&gt; h.name);
    if (functions.length &gt; 0) {
      formatted += `Functions: ${functions.join(&#39;, &#39;)}\n`;
    }
    
    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<p>This function condenses raw configuration data into a mission briefing, minimizing unnecessary details while preserving key structural information.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Use log messages or breakpoints to observe the recursive traversal within <code class="inline-code">extractUniqueFilePaths</code>.</li>
<li>Test the impact of various malformed input configurations on <code class="inline-code">parseAdventureConfig</code>.</li>
<li>Verify the formatting strategies in <code class="inline-code">formatAdventureConfigForPrompt</code> by comparing output against expected formats.</li>
</ul>
<hr>
<p>Captain, your understanding of these vital utilities will define success in future quests. With this foundation secured, the starship is ready for its next stellar journey.</p>
<p>Mission accomplished for Quest 5: Foundation &amp; Utilities‚Äîyour cosmic craftsmanship is building a stellar framework for the final frontier; onward to the stars, commander! ‚≠êüöÄ‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>