<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Harmonizing Galactic Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Cosmic Code Chronicles: Navigating the Nebula of Innovation</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Harmonizing Galactic Themes</h1>
<hr>
<p>The starship&#39;s engines hum with anticipation as you set a course for the most challenging and intricate layers of the codebase. Your mission is to harmonize the galaxy&#39;s themes, from their configuration to their seamless integration across the adventure system. These themes represent the heart of galactic exploration, shaping each quest&#39;s essence. As Captain, you‚Äôll investigate configuration settings, ensure theme validation, and master the interplay of these celestial constructs. The stellar crew awaits your precise navigation through this sector. Adventure demands mastery ‚Äì will you rise to the challenge?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Frequency Modulator</strong>: How are themes defined, validated, and accessed within the adventure system? </li>
<li>‚ö° <strong>Configuration Constellation</strong>: What patterns ensure proper configuration setup and environment-specific options for theme and timeout management?</li>
<li>üõ°Ô∏è <strong>Orbital Safety Protocols</strong>: How does the system guard against invalid inputs or missing configuration files during theme or path initialization?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Harness of the Galaxy</h3>
<p>This file stabilizes the systemic constants required for galactic navigation, such as timeout thresholds, analysis limits, and LLM-specific settings. Its simple structure eliminates unnecessary complexity, ensuring clarity and efficiency. The inclusion of environment variable fallbacks enhances adaptability across varied planetary environments (i.e., deployments). This file achieves a delicate balance between responsiveness and stability, ensuring missions remain sustainable.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Establishes the maximum timeout for processing requests to the LLM engine, ensuring the starship does not stall during complex story generation.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Defines file size limits to avoid resource exhaustion during quest processing, critical for maintaining ship integrity under load.</li>
<li><code class="inline-code">DEFAULT_THEME</code>: Specifies the default theme (&#39;space&#39;) to align the starship‚Äôs adventures to the cosmos when no external override is provided.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Thematic Nexus of Adventures</h3>
<p>This file is the source of truth for all themes, encapsulating their properties, validation mechanisms, and utility functions. It combines creative descriptors (e.g., emojis, keywords, and descriptions) with pragmatic methods to parse, validate, and retrieve themes. The well-structured, centralized dataset ensures consistent and dynamic theme coordination across the system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Defines all built-in themes, including attributes such as id, key, description, and emojis, providing a rich, interactive basis for galactic storytelling.</li>
<li><code class="inline-code">isValidTheme</code>: Confirms if a given theme key is valid, ensuring safe theme selection and integration.</li>
<li><code class="inline-code">parseTheme</code>: Analyzes user input to interpret it as a theme key, id, or keyword match, prioritizing intake flexibility and usability.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> Command Bridge for Theme Management</h3>
<p>This file acts as a command-line interface for theme-related operations, from parsing theme arguments to generating theme-specific assets. Its methods ensure themes are operationalized effectively by combining general-purpose utilities with CLI-specific requirements. The focus here is on efficient asset combination and robust core-to-CLI interaction.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseThemeArg</code>: Interprets theme-related user input, supporting both direct theme names and numeric IDs, enhancing accessibility for explorers of all interpretations.</li>
<li><code class="inline-code">generateThemeCSS</code>: Consolidates theme-related assets into a unified CSS file, streamlining the final presentation of galactic missions.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">// Extracted from packages/core/src/shared/config.ts
export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds for complex story generation
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues
export const DEFAULT_THEME = &#39;space&#39; as const;
</code></pre>
<ul>
<li>Guards the system against LLM request timeouts with an environment-configurable fallback.</li>
<li>Sets space as the default theme, providing alignment with the galactic storyline.</li>
<li>Prevents memory exhaustion by skipping files beyond a defined size, ensuring optimal performance.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">// Extracted from packages/core/src/shared/theme.ts
export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust...&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;sci-fi&#39;]
  },
  ...
};

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;

  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword))) {
      return theme.key as AdventureTheme;
    }
  }

  return null;
}
</code></pre>
<ul>
<li>The <code class="inline-code">THEMES</code> dataset defines the space theme, ensuring its availability across the system.</li>
<li><code class="inline-code">isValidTheme</code> prevents invalid theme keys from breaking the adventure flow.</li>
<li><code class="inline-code">parseTheme</code> increases the flexibility of theme selection for users.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">// Extracted from packages/generator/src/cli/theme-manager.ts
parseThemeArg(themeArg: string): AdventureTheme | &#39;all&#39; | null {
  if (themeArg === &#39;all&#39;) return &#39;all&#39;;
  
  const validThemes: AdventureTheme[] = [&#39;space&#39;, &#39;mythical&#39;, &#39;ancient&#39;, &#39;developer&#39;];
  
  if (validThemes.includes(themeArg as AdventureTheme)) {
    return themeArg as AdventureTheme;
  }
  
  const themeNum = parseInt(themeArg);
  if (themeNum &gt;= 1 &amp;&amp; themeNum &lt;= 4) {
    return validThemes[themeNum - 1];
  }

  return null;
}

generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];

  let combinedCSS = &#39;&#39;;
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });

  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li><code class="inline-code">parseThemeArg</code> provides user-friendly theme parsing for CLI, supporting name and ID resolution.</li>
<li><code class="inline-code">generateThemeCSS</code> efficiently creates a unified CSS file for the chosen theme, critical for styling completed missions.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>üõ∞Ô∏è To modify settings, adjust constants in <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>.</li>
<li>üåå To add new themes, define them in <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a> and update functions for validation and parsing.</li>
<li>üö¶ Explore generational assets thoroughly with <code class="inline-code">generateThemeCSS</code> to maintain consistency across stellar adventures.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the quest-generation engine&#39;s cosmos! Your adventure is complete.</p>
<p>Mission accomplished, star voyager! You&#39;ve successfully harmonized galactic themes in Quest 5, propelling your learning journey to stellar heights‚Äîkeep reaching for the stars as the final frontier awaits! üöÄ‚≠ê‚ö°üì°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>