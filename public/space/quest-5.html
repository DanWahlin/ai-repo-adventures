<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Orbital Utilities Control - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Repository Adventures</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Orbital Utilities Control</h1>
<hr>
<p>As the starship <em>Code Voyager</em> approaches the summit of its mission, the crew must harness the true potential of the cosmic configuration nexus - the adventure code repository. In this final quest, the Orbital Utilities Control module presents a stellar challenge: to decipher, streamline, and prepare adventure configurations for integration across the galaxy. With critical files in hand, the crew must ensure seamless navigation through intricate data paths, extract vital file references, and optimize output formats for future cosmic explorations. Success will solidify your legacy among the stars!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Pathway Discovery</strong>: How does <code class="inline-code">extractUniqueFilePaths</code> locate and validate referenced paths within the configuration structure?</li>
<li>‚ö° <strong>Data Stream Analysis</strong>: What steps does <code class="inline-code">parseAdventureConfig</code> take to parse raw config files and ensure compatibility with mission requirements?</li>
<li>üõ°Ô∏è <strong>Optimization Mechanics</strong>: How does <code class="inline-code">formatAdventureConfigForPrompt</code> restructure the configuration into a compact format for effective use in LLM workflows?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Managing Adventure Configuration</h3>
<p>The adventure configuration file is at the core of defining quest structure and file references for the repository galaxy. It includes utilities to read raw data, parse configuration files, extract referenced paths, and optimize the content for large language model prompts. Each function is designed to make configuration data accessible, reliable, and ready for intergalactic missions.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">readFileIfExists</code>: Reads files safely, ensuring the mission doesn&#39;t break due to missing resources. This foundational method handles errors to maintain system stability.</li>
<li><code class="inline-code">parseAdventureConfig</code>: Parses raw config files into structured objects, validating JSON syntax and ensuring the system avoids fatal errors during processing.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Identifies and extracts all unique file paths within the config, using a traversal algorithm to validate path existence and accessibility.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Streamlines quest configurations into a compact format for LLM usage, ensuring operational efficiency with reduced verbosity.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">function readFileIfExists(filePath: string): string | null {
  try {
    return fs.readFileSync(filePath, &#39;utf-8&#39;);
  } catch {
    // Missing or unreadable file is non-fatal
    return null;
  }
}
</code></pre>
<ul>
<li>Simplifies file reading by handling missing or unreadable files with a graceful fallback (<code class="inline-code">null</code>).</li>
<li>Relies on <code class="inline-code">fs.readFileSync</code>, a synchronous method ensuring immediate results during mission execution.</li>
<li>Shields the larger system from disruptions and ensures robust operations in less-controlled cosmic conditions.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Converts raw configuration data into structured objects using <code class="inline-code">JSON.parse</code> for efficient processing.</li>
<li>Handles errors gracefully, preventing mission-critical failures while maintaining adaptability for various input formats.</li>
<li>Enables downstream tasks (like path extraction and formatting) by providing validated and structured config data.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Implements a depth-first traversal technique using a stack to thoroughly inspect all nodes in the configuration structure.</li>
<li>Validates file paths efficiently with <code class="inline-code">fs.existsSync</code> to ensure referenced paths are accessible within the repository galaxy.</li>
<li>Produces a unique set of file paths, eliminating redundancy for cleaner exploration.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths, no verbose descriptions
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    // Just function names, no descriptions
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Reduces verbose quest configuration details into a compact format for streamlined LLM processing.</li>
<li>Uses structured looping (<code class="inline-code">for...of</code>) to extract meaningful data without unnecessary fluff, achieving up to 72% data reduction.</li>
<li>Focuses on file paths and function names to give clear yet efficient input for downstream generation tasks.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>To ensure cosmic reliability in your mission, verify that your <code class="inline-code">adventure.config.json</code> file follows valid JSON syntax before proceeding.</li>
<li>Check paths referenced in your config file against the actual directory structure to confirm their existence and accessibility.</li>
<li>When formatting for LLM prompts, focus on stripping unnecessary details to reduce payload without losing critical information.</li>
</ul>
<hr>
<p>You have mastered all the secrets of optimal configuration handling and intergalactic code orchestration! Your adventure is complete, and <em>Code Voyager</em> now sails fluently through the repository galaxy. Let the stellar legacy of your command ripple across the cosmos!</p>
<p>Mission Control reports a stellar success as Quest 5: Orbital Utilities Control is secured‚Äîyou&#39;re blazing a cosmic trail at 80% completion, commander, onward to the final frontier! üöÄ‚≠ê‚ö°üì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>