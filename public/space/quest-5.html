<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Data Navigation Core - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Codebase Chronicles</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Data Navigation Core</h1>
<hr>
<p>The <strong>Starship Repo Voyager</strong> braces itself for one final challenge: the <strong>Data Navigation Core</strong>, a labyrinth of configurations and exploratory protocols that powers the ship&#39;s ability to traverse the dense code nebulae. This system serves as the nerve center for parsing, validating, and refining the information pathways that guide the vessel. Deep within the cosmic routers lies the adventure configuration module, which ensures every mission begins with structured data and ends with clarity. Success means perfecting the efficiency of intergalactic quest navigation, safeguarding the future of deployed systems across the galaxy.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Config Map Logic</strong>: How does the system validate and extract file paths using <code class="inline-code">extractUniqueFilePaths</code> to ensure accurate navigation?</li>
<li>‚ö° <strong>Config Parsing Trail</strong>: What is the flow from loading raw configuration data to formatting it through <code class="inline-code">parseAdventureConfig</code> and <code class="inline-code">formatAdventureConfigForPrompt</code>?</li>
<li>üõ°Ô∏è <strong>Error Evasion Matrix</strong>: What mechanisms are in place to handle potential errors during configuration parsing and file validation?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> The Adventure Config Orchestrator</h3>
<p>This file is the cornerstone of the Repo Voyager&#39;s data navigation system. It manages the flow of quest configurations, from loading raw data to parsing and formatting it into actionable prompts. Key functions ensure the integrity of input data while extracting critical information such as file paths, reducing data clutter, and handling errors seamlessly. As the last bastion of validation, it arms the ship&#39;s systems with precision navigation aligned with each mission.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code>: Reads and retrieves the raw adventure configuration data as a text string or null. This function is significant because it operates as the first point of input for the system, handling missing files gracefully.</li>
<li><code class="inline-code">parseAdventureConfig</code>: Converts raw configuration text into a JSON object, providing a single point of truth for parsing and validation efforts. It ensures that the system operates on structured, actionable data.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Dives deeply into the adventure configuration to extract and validate all referenced file paths, essential for ensuring that every mission operates on real, existing data.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Compacts the structured configuration into an LLM-friendly format with reduced verbosity. This optimization improves performance and readability during mission planning.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">/**
 * Loads the raw adventure config text if present.
 * Pure file read - no parsing here.
 */
export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<ul>
<li>This function attempts to load the adventure configuration file using the provided project path.</li>
<li>Gracefully handles missing or unreadable files, returning <code class="inline-code">null</code> instead of throwing an error.</li>
<li>A common pattern is the use of <code class="inline-code">try-catch</code> blocks here to address the unpredictable nature of file system interactions.</li>
<li>Acts as the baseline for all further parsing and formatting operations in the system.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Parses the adventure config into an object (or null on error/missing).
 * Single point of JSON parsing and validation.
 */
export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Transforms the raw configuration data loaded by <code class="inline-code">loadAdventureConfig</code> into a structured object.</li>
<li>Includes error handling for invalid or corrupt JSON data, returning <code class="inline-code">null</code> in such cases.</li>
<li>Demonstrates the principle of a single responsibility by delegating lower-level tasks (file reads) to other functions.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Extracts all unique, existing file paths referenced by &quot;path&quot; fields anywhere in the config.
 */
export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Locates all unique file paths by traversing the parsed configuration object and validates whether they exist in the project directory.</li>
<li>Employs breadth-first traversal (using a stack) to explore nested structures, ensuring no path is overlooked.</li>
<li>Opts for <code class="inline-code">Set</code> to enforce the uniqueness of file paths.</li>
<li>Dynamically resolves relative paths against the project root for dependable validation.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Formats adventure config into a minimal format for LLM prompts
 */
export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths, no verbose descriptions
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    // Just function names, no descriptions
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>This function compacts the parsed configuration into a format suitable for efficient LLM consumption.</li>
<li>Omits verbose descriptions, focusing instead on essential data such as file paths and function names.</li>
<li>Demonstrates a clear understanding of optimization by reducing data size for more efficient downstream processing.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Remember the error handling patterns employed in <code class="inline-code">loadAdventureConfig</code> and <code class="inline-code">parseAdventureConfig</code>.</li>
<li>Analyze the traversal logic in <code class="inline-code">extractUniqueFilePaths</code> to understand how recursive and nested data is systematically navigated.</li>
<li>Consider how <code class="inline-code">formatAdventureConfigForPrompt</code> balances data reduction with retaining critical context.</li>
</ul>
<hr>
<p>You have mastered all the secrets of interstellar code navigation! The galaxy of files now stands illuminated by your effort. Your cosmic adventure is complete.</p>
<p>Mission accomplished, Star Navigator! Quest 5: Data Navigation Core is locked into the cosmic logbook, propelling you to 80% completion‚Äîstellar precision at warp speed toward final victory! üöÄ‚≠êüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>