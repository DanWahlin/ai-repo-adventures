<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Synchronize the Thematic Core - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Galactic Code Chronicles: The Quest for Stellar Optimization</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Synchronize the Thematic Core</h1>
<hr>
<p>The VirtuScope approaches the final stage of its cosmic journey‚Äîa mission to synchronize the thematic integrity of its core protocols. The robust integration of themes drives its exploratory prowess, transforming raw data streams into galactic discoveries. Hidden within the source code are the tools for alignment: validating inputs, extracting timeless wisdom from configurations, and rendering adventures that resonate with the chosen themes. With its thematic engine at stake, the Starship&#39;s survival hinges on your mastery of these mechanisms. The cosmic timeline is narrowing‚Äîengage the systems and secure harmony across the stars!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>System Calibration</strong>: How does <code class="inline-code">ThemeManager.generateThemeCSS</code> compile and structure theme-specific visual elements?</li>
<li>‚ö° <strong>Protocol Alignment</strong>: What enables <code class="inline-code">parseTheme</code> to validate and parse themes based on input patterns and user-defined criteria?</li>
<li>üõ°Ô∏è <strong>Integrity Check</strong>: How does <code class="inline-code">validateTheme</code> ensure the chosen theme adheres to predefined rules and constraints?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Centralize adventure theme systems</h3>
<p>This file defines the thematic center of the VirtuScope‚Äôs adventure systems. Themes act as identifiers for journeys, impacting visuals, storytelling, and validation. The <code class="inline-code">THEMES</code> object holds the core definitions, while helper functions like <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> process user inputs into actionable keys. By exploring these functions, you‚Äôll uncover how themes transition from abstract concepts to functional components. This cohesion ensures the seamless interplay of user experience and backend mechanics‚Äîa vital cornerstone for exploration-oriented software.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Acts as the repository of theme definitions, mapping properties like keywords for matching user intent.</li>
<li><code class="inline-code">parseTheme</code>: Matches user input to existing themes and resolves ambiguous responses using patterns.</li>
<li><code class="inline-code">isValidTheme</code>: Checks the legitimacy of a theme key, confirming compatibility with the adventure system.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  /* Other themes... */
} as const;

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> acts as an exhaustive dictionary for themes, covering identification, display aspects, and matching keywords.</li>
<li><code class="inline-code">isValidTheme</code> efficiently validates whether a given theme key is part of the exploration environment.</li>
<li><code class="inline-code">parseTheme</code> implements layered pattern matching, resolving user input against keywords, IDs, and direct matches, ensuring robust adaptability.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> Theme integration and CSS generation</h3>
<p>This file operationalizes themes into frontend elements, merging raw definitions with visual implementation. By generating CSS and assigning context-specific assets, it transitions themes from backend concepts into tangible user interfaces. The <code class="inline-code">generateThemeCSS</code> method compiles CSS across theme files to produce unified design structures, while other helper methods refine thematic data into actionable artifacts like assets and icons. Understanding these integrations connects the thematic engine to the ship‚Äôs navigational aesthetic‚Äîcritical for orchestrating an immersive galactic adventure.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateThemeCSS</code>: Compiles CSS files for themes, ensuring cohesive visual design and customization.</li>
<li><code class="inline-code">getGitHubLogo</code>: Dynamically selects GitHub logos based on theme background compatibility.</li>
<li><code class="inline-code">getThemeIcons</code>: Provides specific icons for theme and quest UI elements, enhancing thematic consistency.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;), 
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
  
  let combinedCSS = &#39;&#39;;
  
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
  
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}

getGitHubLogo(theme: AdventureTheme): string {
  return this.isLightTheme(theme) 
    ? &#39;assets/shared/github-mark.svg&#39;          
    : &#39;assets/shared/github-mark-white.svg&#39;;   
}

getThemeIcons(theme: AdventureTheme): { theme: string; quest: string } {
  const themeIcons = {
    space: { theme: &#39;üöÄ&#39;, quest: &#39;‚≠ê&#39; },
    mythical: { theme: &#39;üè∞&#39;, quest: &#39;‚öîÔ∏è&#39; },
    ancient: { theme: &#39;üè∫&#39;, quest: &#39;üìú&#39; },
    developer: { theme: &#39;üíª&#39;, quest: &#39;üîß&#39; },
    custom: { theme: &#39;üé®&#39;, quest: &#39;‚≠ê&#39; }
  };

  return (themeIcons as any)[theme] || themeIcons.space;
}
</code></pre>
<ul>
<li><code class="inline-code">generateThemeCSS</code> aggregates multiple theme-related CSS files, ensuring that visual elements are consistently implemented for individual themes.</li>
<li><code class="inline-code">getGitHubLogo</code> helps adapt static assets based on background color compatibility, optimizing aesthetics across light and dark themes.</li>
<li><code class="inline-code">getThemeIcons</code> defines a specific set of symbols for quest UI and theme icons, reinforcing immersive storytelling within the mission context.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Theme validation and input sanitization</h3>
<p>This file safeguards the thematic integrity by filtering invalid inputs and ensuring compatibility with defined themes. Functions like <code class="inline-code">validateTheme</code> actively enforce constraints such as valid formats and supported keywords. In a mission-critical operation like theme synchronization, precise input validation mitigates risk by rejecting dubious entries and ensuring predictable system behavior. Studying these mechanisms unlocks the logic behind harmonious theme integration.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Validates and normalizes theme input, matching against valid definitions.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Removes invalid characters from user-provided content before rendering.</li>
<li><code class="inline-code">validateAdventureChoice</code>: Checks length and presence of user choices for quest alignment.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}

export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li><code class="inline-code">validateTheme</code> implements layered validation, ensuring the theme matches definitions while providing helpful error messages for invalid input.</li>
<li><code class="inline-code">sanitizeForDisplay</code> applies content cleaning techniques, preserving output clarity while protecting against injection risks.</li>
<li><code class="inline-code">validateAdventureChoice</code> enforces length constraints and ensures user selections meet basic requirements for quest participation.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use the <code class="inline-code">THEMES</code> structure as the backbone for connecting validation, icons, and visual assets across the system.</li>
<li>Experiment with different inputs to observe the decision-making strategies in <code class="inline-code">parseTheme</code>.</li>
<li>Explore how CSS and assets contribute to unified aesthetics in <code class="inline-code">generateThemeCSS</code>.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the VirtuScope‚Äôs intelligence! Your adventure is complete. The galaxy celebrates your excellence as the thematic engines synchronize fully, propelling the starship into endless stardust horizons. Bravo, Captain!</p>
<p>Mission accomplished, cadet‚ÄîQuest 5 has been flawlessly synchronized with the brilliance of a supernova; you&#39;re 80% to the stars, hurtling toward mastery at lightspeed! ‚≠êüöÄ‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>