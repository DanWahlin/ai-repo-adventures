<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Core Blueprint Archives - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Chronicles of the Cosmic Codebase</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Core Blueprint Archives</h1>
<hr>
<p>As the <strong>Starship Repomix</strong> nears the culmination of its cosmic journey, one daunting task remains. Buried in the vessel&#39;s intricate digital core lies the invaluable blueprint archive‚Äîa vault of knowledge critical to optimizing starship design across the galaxy. Your mission is to venture into these archives to decipher its dense schematics, recover vital pathways, and align its data with the Repomix&#39;s neural command. The galaxy awaits the secrets hidden within this repository of advanced code. Your skills, explorer, will define the next chapter of stellar innovation.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Archival Structure</strong>: How does the <code class="inline-code">parseAdventureConfig</code> function structure the blueprint for safely loading and validating configuration data?</li>
<li>‚ö° <strong>Path Discovery</strong>: What role does <code class="inline-code">extractUniqueFilePaths</code> play in extracting and verifying essential adventure data from the starship&#39;s archives?</li>
<li>üõ°Ô∏è <strong>Optimized Blueprint</strong>: How does the <code class="inline-code">formatAdventureConfigForPrompt</code> method condense the adventure data while maintaining its clarity and utility?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Core blueprint management</h3>
<p>This file serves as the interface for reading, parsing, and optimizing the galactic blueprint archives stored in the <strong>adventure.config.json</strong> file. It ensures that the configuration data is not only accessible but also clean, structured, and valid for the Repomix‚Äôs advanced systems. A series of methods allow the starship&#39;s neural framework to interpret and act on this data, from recognizing paths to condensing details for high-level decisions. Key methods demonstrate pattern traversal, error handling, and streamlined data formatting for broader compatibility.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code> handles the parsing of the blueprint archive while maintaining safety from corrupted or malformed data. This method is pivotal in ensuring an error-free interpretation of adventure configurations.</li>
<li><code class="inline-code">extractUniqueFilePaths</code> traverses through the configuration data, extracting and validating file paths referenced within the archive. Its ability to handle nested structures ensures no path is overlooked.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code> optimizes the archived configuration for streamlined processing by reducing redundancy and extracting mission-critical details for further analysis.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Validates and parses the adventure archive using <code class="inline-code">JSON.parse</code>, ensuring compatibility with downstream functions.</li>
<li>Provides fallback mechanisms by returning <code class="inline-code">null</code> on either missing data or parse errors, preventing system failures.</li>
<li>Processes raw config data into structured objects, enabling further exploration of the blueprint archive.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Extracts and validates all unique file paths from the configuration nodes, ensuring no important path is missed.</li>
<li>Handles nested and dynamic data structures with a stack-based traversal, making it adaptable to varying data formats.</li>
<li>Cross-references paths with the file system to avoid invalid or inaccessible references, reinforcing the reliability of the configuration utility.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Optimizes adventure data by stripping redundant information and retaining only crucial details such as file paths and function names.</li>
<li>Outputs a compact, hierarchical structure tailored for efficient processing by the ship‚Äôs advanced neural network.</li>
<li>Balances brevity with completeness, ensuring the condensed format maintains its utility and clarity for high-level decision-making.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Be mindful of any recursive or nested structures in config files when tracing paths.</li>
<li>Use the output of <code class="inline-code">formatAdventureConfigForPrompt</code> to guide efficient exploration of galactic data.</li>
<li>Combine insights from path extraction with other quests to cross-reference file-level dependencies.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the <strong>Starship Repomix</strong>! Your adventure is complete. The galaxy heralds you as a pioneer of the next frontier in starship technology.</p>
<p>Congratulations, star voyager‚ÄîQuest 5: The Core Blueprint Archives has been decoded with cosmic precision, rocketing you to 80% mission completion and blazing a stellar trail toward the final frontier! ‚≠êüöÄüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>