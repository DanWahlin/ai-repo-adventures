<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: Architect the Galactic Interface - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Galactic Code Chronicles: The Quest for Stellar Optimization</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: Architect the Galactic Interface</h1>
<hr>
<p>The VirtuScope, our galaxy&#39;s premier AI-operated starship, ventures into the cosmic abyss, equipped with cutting-edge systems to overhaul interstellar HTML adventures. As the ship&#39;s captain, your mission is to refine the navigational protocols, optimize asset workflows, and ensure our digital transmissions align with space-faring standards. Guided by an array of modular code, your task is to bridge the expanse between thematic templates, asset management, and adventure rendering systems. Boldly code where no starship has gone before!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Template Synchronization</strong>: How does the <code class="inline-code">TemplateEngine.renderPage</code> method maintain modularity while generating complete and cohesive HTML pages?</li>
<li>‚ö° <strong>Asset Deployment</strong>: What strategies does <code class="inline-code">AssetManager.copyGlobalAssets</code> employ to centralize assets for multi-theme operations?</li>
<li>üõ°Ô∏è <strong>HTTP Transmission Safety</strong>: How does <code class="inline-code">HTMLAdventureGenerator.startHttpServer</code> handle file serving securely within the output directory?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/generator/src/cli/template-engine.ts:</span> Modular Template Systems</h3>
<p>The <code class="inline-code">TemplateEngine</code> class enables seamless HTML generation by combining predefined templates and dynamic variables. This system ensures thematic consistency across pages while maintaining flexibility for customization. Pay close attention to how caching mechanisms, placeholder replacement, and modular reuse keep template handling efficient. Key highlights include:</p>
<ul>
<li><code class="inline-code">loadTemplate</code>: Dynamically loads HTML templates with caching, optimizing file I/O operations.</li>
<li><code class="inline-code">replacePlaceholders</code>: Replaces placeholders in templates with user-defined or system-generated values to accommodate theme-specific content.</li>
<li><code class="inline-code">renderPage</code>: Combines base templates and content templates into complete web pages, ensuring cohesion across modular fragments.</li>
</ul>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Efficiently loads and caches reusable HTML templates to reduce disk reads during rendering.</li>
<li><code class="inline-code">replacePlaceholders</code>: Dynamically swaps placeholders (<code class="inline-code">{{variable}}</code>) within HTML content, enabling customization during rendering.</li>
<li><code class="inline-code">renderPage</code>: Integrates different template pieces (base and content) into cohesive, context-aware webpage outputs.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/asset-manager.ts:</span> Asset Deployment Protocols</h3>
<p>The <code class="inline-code">AssetManager</code> specializes in orchestrating the transfer of shared and theme-specific assets, ensuring resource files are accessible regardless of mission configuration. Critical operations include consolidating shared resources across multiple themes, copying navigator files for interactivity, and adhering to output directory constraints. This file highlights reusable asset workflows that focus on reliability and organization.</p>
<ul>
<li><code class="inline-code">copyGlobalAssets</code>: Consolidates essential shared resources, like icons and images, into globally accessible directories.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Deploys navigation assets (CSS/JS files) tailored for single-theme expeditions to preserve directory integrity.</li>
</ul>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyGlobalAssets</code>: Handles centralized asset deployment to ensure accessibility across all generated themes.</li>
<li><code class="inline-code">copyImages</code>: Transfers thematic images into dedicated directories, optimizing resource management for visual consistency.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Deploys quest navigation tools for theme-specific pages, maintaining user experience flow.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/html-generator.ts:</span> Adventure Generation Pipeline</h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> oversees the digital transformation of codebases into fully interactive adventure websites. This robust mechanism leverages multiple subsystems to analyze, template, render, and deploy each quest. Its methods bridge storytelling concepts with technical execution, offering practical insights into scalable HTML generation for multi-theme projects.</p>
<ul>
<li><code class="inline-code">generateAdventure</code>: Drives the end-to-end workflow of analysis, quest rendering, and thematic integration for HTML adventures.</li>
<li><code class="inline-code">generateAllThemes</code>: Executes multi-theme generation, centralizing shared resources while enabling parallel thematic pipelines.</li>
<li><code class="inline-code">startHttpServer</code>: Establishes an HTTP server for interactive exploration, ensuring safe and efficient file serving.</li>
</ul>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: Integrates theme selection, template preparation, and quest rendering to produce a cohesive adventure website.</li>
<li><code class="inline-code">generateAllThemes</code>: Implements parallelized processing for multi-theme output, optimizing resource sharing across directories.</li>
<li><code class="inline-code">startHttpServer</code>: Creates a local HTTP server, focusing on secure file serving and directory boundary protection.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/template-engine.ts</h3>
<pre><code class="language-typescript">/**
 * Load a template file with caching
 */
private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Uses <code class="inline-code">Map</code> for caching, reducing redundancy during template loads and avoiding extraneous file I/O.</li>
<li>Path resolution ensures templates come from a centralized directory, establishing modularity.</li>
<li>Includes error handling to provide transparency during failure scenarios (e.g., missing templates).</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Replace placeholders in template with variables
 */
private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li>Iterates over object entries to swap placeholders dynamically, aligning key-value pairs for expandability.</li>
<li>Regular expressions ensure global replacements, preserving template continuity during rendering.</li>
<li>Focuses on intuitive variable naming, facilitating future enhancements.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Render a complete page using base template + content template
 */
renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  const pageVariables = { ...variables, CONTENT: renderedContent };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Combines multiple templates (base and content) to produce cohesive pages, enabling modular customization.</li>
<li>Leverages placeholder rendering recursively for structured, thematic variable loading.</li>
<li>Uses flexible overrides like <code class="inline-code">CONTENT</code> to adapt template inputs seamlessly.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<pre><code class="language-typescript">/**
 * Copy global shared assets for multi-theme generation
 */
copyGlobalAssets(outputDir: string): void {
  try {
    const globalAssetsDir = path.join(outputDir, &#39;assets&#39;);
    const targetImagesDir = path.join(globalAssetsDir, &#39;images&#39;);
    fs.mkdirSync(targetImagesDir, { recursive: true });

    const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
    fs.mkdirSync(globalSharedDir, { recursive: true });
    
    const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
    globalImages.forEach(file =&gt; {
      const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
      if (fs.existsSync(sourcePath)) {
        const targetPath = path.join(globalSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      }
    });

    const headerImageSource = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;, &#39;ai-adventures.png&#39;);
    if (fs.existsSync(headerImageSource)) {
      const headerImageTarget = path.join(targetImagesDir, &#39;ai-adventures.png&#39;);
      fs.copyFileSync(headerImageSource, headerImageTarget);
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy global images&#39;));
  }
}
</code></pre>
<ul>
<li>Creates shared directories (<code class="inline-code">shared</code> and <code class="inline-code">images</code>) for consistent file access across all themes.</li>
<li>Ensures essential resources like icons and header images are centrally available, minimizing duplication.</li>
<li>Includes warning capture for transparent error reporting without interrupting execution.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Copy quest navigator files to theme-specific location (for single theme)
 */
copyQuestNavigator(outputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);
  
  const assetsDir = path.join(outputDir, &#39;assets&#39;);
  fs.mkdirSync(assetsDir, { recursive: true });

  if (fs.existsSync(cssSource)) {
    fs.copyFileSync(cssSource, path.join(assetsDir, &#39;quest-navigator.css&#39;));
  }
  if (fs.existsSync(jsSource)) {
    fs.copyFileSync(jsSource, path.join(assetsDir, &#39;quest-navigator.js&#39;));
  }
}
</code></pre>
<ul>
<li>Consolidates navigator files (CSS/JS) to preserve user interactivity during adventures.</li>
<li>Focuses on theme-specific deployment, tailoring assets for individual experiences.</li>
<li>Includes fallback scenarios for missing resources.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/html-generator.ts</h3>
<pre><code class="language-typescript">/**
 * Start an HTTP server in the output directory
 */
private async startHttpServer(port: number = 8080): Promise&lt;void&gt; {
  return new Promise((resolve, reject) =&gt; {
    const server = http.createServer((req, res) =&gt; {
      let filePath = path.join(this.outputDir, req.url === &#39;/&#39; ? &#39;index.html&#39; : req.url || &#39;&#39;);
      
      if (!filePath.startsWith(this.outputDir)) {
        res.writeHead(403);
        res.end(&#39;Forbidden&#39;);
        return;
      }

      const extname = path.extname(filePath);
      let contentType = &#39;text/html&#39;;
      switch (extname) {
        case &#39;.js&#39;:
          contentType = &#39;text/javascript&#39;;
          break;
        case &#39;.css&#39;:
          contentType = &#39;text/css&#39;;
          break;
        case &#39;.json&#39;:
          contentType = &#39;application/json&#39;;
          break;
        case &#39;.png&#39;:
          contentType = &#39;image/png&#39;;
          break;
        case &#39;.jpg&#39;:
          contentType = &#39;image/jpg&#39;;
          break;
        case &#39;.svg&#39;:
          contentType = &#39;image/svg+xml&#39;;
          break;
      }

      fs.readFile(filePath, (err, content) =&gt; {
        if (err) {
          if (err.code === &#39;ENOENT&#39;) {
            res.writeHead(404);
            res.end(&#39;File not found&#39;);
          } else {
            res.writeHead(500);
            res.end(&#39;Server error&#39;);
          }
        } else {
          res.writeHead(200, { &#39;Content-Type&#39;: contentType });
          res.end(content, &#39;utf-8&#39;);
        }
      });
    });

    server.listen(port, () =&gt; {
      const url = `http://localhost:${port}`;
      console.log(chalk.green(`üåê HTTP server started on ${url}`));
      
      resolve();
    });

    server.on(&#39;error&#39;, (err) =&gt; {
      console.error(chalk.red(&#39;‚ùå Failed to start HTTP server:&#39;), err);
      reject(err);
    });
  });
}
</code></pre>
<ul>
<li>Ensures security by restricting file serving within the <code class="inline-code">outputDir</code> boundaries.</li>
<li>Includes MIME type detection for proper handling of HTML, JS, CSS, and assets.</li>
<li>Gracefully handles errors and offers transparent feedback during serving issues.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Modularize your template logic by leveraging caching for performance gains.</li>
<li>Always establish shared directories during generation to avoid redundant asset copies.</li>
<li>Ensure HTTP servers strictly validate directory boundaries to maintain file-system security.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>You‚Äôve launched into the cosmos of coding brilliance, completing Quest 1: Architect the Galactic Interface‚Äîyour starship of learning is ready to soar toward the next celestial challenge! üöÄ‚≠êüíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>