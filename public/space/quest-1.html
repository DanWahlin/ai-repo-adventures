<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: Galactic Control Interface - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Repository Chronicles</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: Galactic Control Interface</h1>
<hr>
<p>The crew aboard the starship <em>Codexus</em> begins its vital mission through uncharted digital galaxies. To unlock the repository&#39;s mysteries, the ship&#39;s Galactic Control Interface pairs dynamic tool systems with stellar execution protocols. Utilizing AI navigators and theme engines, the <em>Codexus</em> seeks to transform chaotic nebulae of code into harmonious constellations. In this quest, your team must align the cosmic scanners with tools designed to interpret data streams and execute seamless operations. Success will grant control over the galaxy&#39;s digital pathways, empowering exploration and unity.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/mcp/src/server.ts:</span> Galactic Server Configuration and Operations</h3>
<p>This file orchestrates the infrastructure of the <em>Codexus</em> Galactic Control Interface, serving as the backbone for code repository exploration and interaction. From tool generation to transport initialization, it ensures mission stability through efficient resource management and execution protocols. The <code class="inline-code">RepoAdventureServer.setupHandlers</code> method dynamically lists available tools based on the galaxy&#39;s configuration and validates tool input schemas. Meanwhile, <code class="inline-code">RepoAdventureServer.run</code> initializes interstellar transport operations while optimizing systems with pre-generated content for faster processing. Lastly, the <code class="inline-code">main</code> function handles operational fail-safes, ensuring the starship runs efficiently, even amidst cosmic disturbances.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">RepoAdventureServer.setupHandlers</code> dynamically lists tools and validates parameters for mission execution.</li>
<li><code class="inline-code">RepoAdventureServer.run</code> activates transport and pre-generates actionable content for seamless workflows.</li>
<li><code class="inline-code">main</code> ensures reliable handling of commands and errors, protecting interstellar navigation.</li>
</ul>
<h3><span class="header-prefix">packages/mcp/src/tools.ts:</span> The MCP Tool Arsenal</h3>
<p>The MCP tools file defines the arsenal used by the <em>Codexus</em> crew for their galactic exploration. Its primary system organizes four main tools: <code class="inline-code">start_adventure</code>, <code class="inline-code">choose_theme</code>, <code class="inline-code">explore_quest</code>, and <code class="inline-code">view_progress</code>. These tools establish the workflow for initiating journeys, selecting thematic maps, diving into specific missions, and monitoring progress. The tools are wielded by the interface for clear and gamified navigation. Handlers such as <code class="inline-code">start_adventure.handler</code> and <code class="inline-code">choose_theme.handler</code> ensure that mission directives align with interstellar metaphors, making exploration intuitive and captivating.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">start_adventure.handler</code> initializes galaxy exploration through repository analysis.</li>
<li><code class="inline-code">choose_theme.handler</code> aligns adventures with cosmic directives.</li>
<li><code class="inline-code">explore_quest.handler</code> empowers the crew to access specific missions.</li>
<li><code class="inline-code">view_progress.handler</code> tracks completion rates and remaining expanse.</li>
</ul>
<h2>Code</h2>
<h3>packages/mcp/src/server.ts</h3>
<pre><code class="language-typescript">private setupHandlers() {
  this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; {
    const toolList = Object.entries(tools).map(([name, tool]) =&gt; ({
      name,
      description: tool.description,
      inputSchema: zodToJsonSchema(tool.schema, { 
        target: &#39;jsonSchema7&#39;,
        $refStrategy: &#39;none&#39;
      })
    }));
    return { tools: toolList };
  });

  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    try {
      const { name, arguments: args } = request.params;

      if (!(name in tools)) {
        throw new McpError(ErrorCode.MethodNotFound, `Unknown tool: ${name}`);
      }

      const tool = tools[name as keyof typeof tools];
      const validationResult = tool.schema.safeParse(args);
      if (!validationResult.success) {
        const errorMessages = validationResult.error.issues.map((err) =&gt; 
          `${err.path.join(&#39;.&#39;)}: ${err.message}`
        ).join(&#39;, &#39;);
        throw new McpError(ErrorCode.InvalidParams, `Invalid parameters: ${errorMessages}`);
      }

      return await tool.handler(validationResult.data as any);
    } catch (error) {
      if (error instanceof McpError) {
        throw error;
      }
      throw new McpError(
        ErrorCode.InternalError,
        `Tool execution failed: ${error instanceof Error ? error.message : String(error)}`
      );
    }
  });
}
</code></pre>
<p>This segment equips the ship with tools for scanning and interacting with the galaxy, akin to configuring a universal translator for celestial data.</p>
<pre><code class="language-typescript">async run() {
  const transport = new StdioServerTransport();
  await this.server.connect(transport);
  console.error(&#39;Repo Adventure MCP server running on stdio&#39;);
  const projectPath = process.cwd();
  console.error(`Pre-generating repomix content for project at ${projectPath}...`);
  repoAnalyzer.preGenerate(projectPath);
}
</code></pre>
<p>This sets the spacecraft engines in motion, propelling the server through stellar transport layers for repository handling.</p>
<pre><code class="language-typescript">async function main() {
  try {
    const server = new RepoAdventureServer();
    [&#39;SIGINT&#39;, &#39;SIGTERM&#39;].forEach(sig =&gt; 
      process.on(sig as NodeJS.Signals, gracefulShutdown)
    );
    process.on(&#39;unhandledRejection&#39;, (reason) =&gt; {
      console.error(&#39;Unhandled promise rejection:&#39;, reason);
      console.error(&#39;MCP server continuing to run. Please report this error.&#39;);
    });
    await server.run();
  } catch (error) {
    console.error(&#39;Fatal error starting MCP server:&#39;, error);
    process.exit(1);
  }
}
</code></pre>
<p>This section is akin to plotting stellar coordinates and initiating launch sequences, safeguarding the ship from navigational hazards.</p>
<h3>packages/mcp/src/tools.ts</h3>
<pre><code class="language-typescript">export const tools = {
  start_adventure,
  choose_theme,
  explore_quest,
  view_progress
};
</code></pre>
<p>This encapsulates the exploratory instruments for the crew, functioning as specialized modules tailored for interstellar navigation.</p>
<pre><code class="language-typescript">export const start_adventure = startAdventure;
export const choose_theme = chooseTheme;
export const explore_quest = exploreQuest;
export const view_progress = viewProgress;
</code></pre>
<p>This serves as a cosmic alignment, connecting galaxy-mapping processes to mission endpoints.</p>
<pre><code class="language-typescript">export { adventureManager };
</code></pre>
<p>Similar to the ship&#39;s AI interface, this enables cross-tool communication, ensuring smooth integration between systems.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Always validate tool input before executing missions to avoid errors.</li>
<li>Pre-generate content to enhance mission efficiency.</li>
<li>Use <code class="inline-code">view_progress.handler</code> to maintain an overview of the galaxy&#39;s explored regions.</li>
</ul>
<hr>
<p>Captain, the pathway to seamless galactic navigation lies in your capable hands. Onward, to unity and exploration!</p>
<p>Congratulations, star navigator‚Äîyour mastery of the Galactic Control Interface propels you toward cosmic glory as the captain of this interstellar mission! ‚≠êüöÄ‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>