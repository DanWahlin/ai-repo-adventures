<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Command Deck of the MCP Beacon - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Starship Codex: Chronicles of the Repo Nebula</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Command Deck of the MCP Beacon</h1>
<hr>
<p>The <em>Starship Codex</em> continues its daring mission to decode the mysteries of the repo nebula, drifting closer to the enigmatic MCP Beacon. This pivotal sector houses the control systems for the gamified storytelling that brings code repositories to life. As an elite crew member wielding tools like the <em>Repomix Scanner</em> and <em>LLM Navigator</em>, your task is to analyze the MCP Command Deck‚Äôs core files. With every line of code explored and every function understood, you move closer to unifying the galactic codebase. Brace yourself for a stellar adventure in deep space coding!</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/mcp/src/server.ts:</span> MCP Server Protocol Implementation</h3>
<p>This file serves as the powerhouse for hosting the adventure tools, effectively turning MCP (Model Context Protocol) into an interactive narrative platform for exploring code repositories. The <code class="inline-code">RepoAdventureServer</code> class manages critical operations, such as setting up MCP handlers and connecting to the communication transport layer. Within the <code class="inline-code">setupHandlers()</code> method, the server dynamically registers tools based on the content of the <code class="inline-code">tools</code> module, validating and executing user requests securely through schemas like <code class="inline-code">CallToolRequestSchema</code>. Meanwhile, the <code class="inline-code">run()</code> method establishes the transport connection and pre-generates Repomix content to enhance performance‚Äîan interstellar caching maneuver to ensure efficiency during quests. The meticulous attention to graceful shutdown in <code class="inline-code">main()</code> ensures galactic operations remain smooth, handling signals like <code class="inline-code">SIGINT</code> with the precision of a touring starship crew. </p>
<h4>Highlights</h4>
<ul>
<li>The <code class="inline-code">RepoAdventureServer</code> encapsulates core MCP operations for gamified storytelling.</li>
<li><code class="inline-code">setupHandlers()</code> dynamically integrates tools for secure and validated user interactions.</li>
<li><code class="inline-code">run()</code> initializes transport and warms up caches, prepping the server for high-speed processing.</li>
</ul>
<h3><span class="header-prefix">packages/mcp/src/tools.ts:</span> MCP Adventure Tools Interface</h3>
<p>This file is the nerve center of the interaction between users and the adventure system. It introduces tools like <code class="inline-code">start_adventure</code>, <code class="inline-code">choose_theme</code>, <code class="inline-code">explore_quest</code>, and <code class="inline-code">view_progress</code>, each catering to specific aspects of the space-themed exploration. For instance, the <code class="inline-code">start_adventure.handler()</code> kickstarts a journey by analyzing the repository and presenting customization themes. The <code class="inline-code">choose_theme.handler()</code> generates tailored narratives based on user selections, while <code class="inline-code">explore_quest.handler()</code> guides users through individual tasks with progress tracking. Finally, <code class="inline-code">view_progress.handler()</code> showcases status updates, ensuring users stay informed of their galactic achievements. Tools are exported systematically, maintaining clarity and consistency in how they integrate with the overarching adventure platform. </p>
<h4>Highlights</h4>
<ul>
<li>Provides tools enabling repository exploration and storytelling.</li>
<li><code class="inline-code">start_adventure.handler()</code> analyzes repositories to lay the foundation for galactic quests.</li>
<li><code class="inline-code">choose_theme.handler()</code> creates custom narratives for immersive adventures.</li>
</ul>
<h2>Code</h2>
<h3>packages/mcp/src/server.ts</h3>
<pre><code class="language-typescript">class RepoAdventureServer {
  private server: Server;

  constructor() {
    this.server = new Server(
      {
        name: &#39;repo-adventure&#39;,
        version: &#39;1.0.0&#39;,
        description: &#39;A gamified MCP server for exploring code repositories through interactive storytelling&#39;
      },
      {
        capabilities: {
          tools: {},
        },
      }
    );

    this.setupHandlers();
  }

  private setupHandlers() {
    this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; {
      const toolList = Object.entries(tools).map(([name, tool]) =&gt; ({
        name,
        description: tool.description,
        inputSchema: zodToJsonSchema(tool.schema, { 
          target: &#39;jsonSchema7&#39;,
          $refStrategy: &#39;none&#39;
        })
      }));

      return { tools: toolList };
    });
  }

  async run() {
    const transport = new StdioServerTransport();
    await this.server.connect(transport);
    console.error(&#39;Repo Adventure MCP server running on stdio&#39;);
    
    const projectPath = process.cwd();
    console.error(`Pre-generating repomix content for project at ${projectPath}...`);
    repoAnalyzer.preGenerate(projectPath);
  }
}
</code></pre>
<p>Much like assembling a starship system, this code harmonizes various modules into a unified command interface for seamless operation.</p>
<h3>packages/mcp/src/tools.ts</h3>
<pre><code class="language-typescript">export const tools = {
  start_adventure,
  choose_theme,
  explore_quest,
  view_progress
};

// Re-export tools with MCP naming convention
export { adventureManager };
export const start_adventure = startAdventure;
export const choose_theme = chooseTheme;
export const explore_quest = exploreQuest;
export const view_progress = viewProgress;
</code></pre>
<p>This piece organizes tools into a shared arsenal, akin to configuring the dashboard of a cosmic vessel with optimized navigation aids.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Consider exploring the dynamic tool listing mechanism in <code class="inline-code">setupHandlers()</code> to expand functionality further in future MCP iterations.</li>
<li>Refactor <code class="inline-code">start_adventure.handler()</code> to include caching mechanisms for faster analysis of large repositories.</li>
<li>Dive into Repomix integration to understand how cached context generation optimizes repository exploration.</li>
</ul>
<hr>
<p>Mission accomplished, Cadet! You&#39;ve successfully navigated the Command Deck of the MCP Beacon‚Äîlet the cosmic odyssey continue as you power up for the next stellar adventure! ‚≠êüöÄüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2: Navigating the Adventure Core ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>