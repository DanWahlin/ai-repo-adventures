<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Command Nexus - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Galactic Adventures: Uncovering the Starship‚Äôs Codebase</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Command Nexus</h1>
<hr>
<p>As the Starship Codexus ventures perilously close to the edge of the Orion Nebula, a failure emerges in the computational engine that governs the ship‚Äôs primary functions. The ship‚Äôs core systems, mired in cascading inefficiencies, threaten to leave you and the crew stranded in the vast galactic void. You, the reluctant yet ingenious engineer, must delve into the inner workings of the code powering the Command Nexus. Your target: restore order to the modular subsystems and initiate a reboot sequence before time runs out.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Template Harmony</strong>: How does the <code class="inline-code">TemplateEngine</code> manage templates for rendering consistent HTML pages across various themes and contexts?</li>
<li>‚ö° <strong>Asset Deployment</strong>: How is the <code class="inline-code">AssetManager</code> used to deploy shared and theme-specific assets to the correct locations during the site&#39;s generation pipeline?</li>
<li>üõ°Ô∏è <strong>System Resilience</strong>: What mechanisms ensure the <code class="inline-code">generateAdventure</code> function in <code class="inline-code">HTMLAdventureGenerator</code> handles errors gracefully during the adventure generation workflow?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/generator/src/cli/template-engine.ts:</span> Template managing system for consistent rendering</h3>
<p>The <code class="inline-code">TemplateEngine</code> is designed to load and process HTML templates. It ensures placeholders in templates can be dynamically replaced, enabling customization for different themes and sections of the generated site.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Responsible for reading and caching template files to reduce file system access. Critical to ensuring high performance in the template rendering pipeline.</li>
<li><code class="inline-code">replacePlaceholders</code>: Replaces placeholders in templates with actual values, enabling dynamic customization of content.</li>
<li><code class="inline-code">renderPage</code>: Combines base and content templates, filling in placeholders with required variables to generate complete HTML pages.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/template-engine.ts</h3>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Ensures efficient access to templates by implementing in-memory caching.</li>
<li>Mitigates performance bottlenecks caused by repetitive file system reads.</li>
<li>Throws errors with context-specific messages to simplify troubleshooting.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li>Dynamically constructs and replaces placeholders in templates using a regex.</li>
<li>Demonstrates safe and flexible handling of user-defined placeholders.</li>
<li>Avoids excess complexity while maintaining clear and reusable logic.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Integrates <code class="inline-code">base-template.html</code> with specific page templates, delivering uniform site structure.</li>
<li>Promotes modular design by separating overarching HTML structure from page-specific content.</li>
<li>Optimizes reusability via parameterized input of variables.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/asset-manager.ts:</span> Managing static and shared resources during generation</h3>
<p>The <code class="inline-code">AssetManager</code> handles asset organization, ensuring proper deployment of theme-specific and shared files during the adventure generation workflow.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyImages</code>: Copies theme-specific and shared images to the output directory. Essential for ensuring assets are correctly available for rendering.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Deploys assets necessary for quest navigation interfaces in both single and multi-theme modes.</li>
<li><code class="inline-code">copyGlobalAssets</code>: Ensures shared assets like header images and global icons are copied for site-wide consistency.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<pre><code class="language-typescript">copyImages(outputDir: string, isMultiTheme: boolean = false): void {
  const sourceImagesDir = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;);
  const sourceSharedDir = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;);
  const targetImagesDir = path.join(outputDir, &#39;assets&#39;, &#39;images&#39;);
  const targetSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);

  try {
    if (fs.existsSync(sourceImagesDir)) {
      fs.mkdirSync(targetImagesDir, { recursive: true });
      const imageFiles = fs.readdirSync(sourceImagesDir);
      imageFiles.forEach(file =&gt; {
        const sourcePath = path.join(sourceImagesDir, file);
        const targetPath = path.join(targetImagesDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      });
    }

    if (fs.existsSync(sourceSharedDir)) {
      fs.mkdirSync(targetSharedDir, { recursive: true });
      const sharedFiles = fs.readdirSync(sourceSharedDir);
      sharedFiles.forEach(file =&gt; {
        const sourcePath = path.join(sourceSharedDir, file);
        const targetPath = path.join(targetSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      });
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy images from source directory&#39;));
  }
}
</code></pre>
<ul>
<li>Centralizes image handling logic for both theme-specific and shared assets.</li>
<li>Leverages <code class="inline-code">fs</code> methods to validate and recursively generate output directories for efficient copying.</li>
<li>Includes warning logic to notify on potential asset copy failures without halting execution.</li>
</ul>
<hr>
<pre><code class="language-typescript">copyQuestNavigator(outputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const sourceAssetsDir = path.join(this.sourceDir, &#39;assets&#39;);
  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);
  const svgSource = path.join(templatesDir, &#39;compass-icon.svg&#39;);
  
  const themeToggleCssSource = path.join(sourceAssetsDir, &#39;theme-toggle.css&#39;);
  const themeToggleJsSource = path.join(sourceAssetsDir, &#39;theme-toggle.js&#39;);

  const assetsDir = path.join(outputDir, &#39;assets&#39;);
  fs.mkdirSync(assetsDir, { recursive: true });

  if (fs.existsSync(cssSource)) {
    fs.copyFileSync(cssSource, path.join(assetsDir, &#39;quest-navigator.css&#39;));
  }
  if (fs.existsSync(jsSource)) {
    fs.copyFileSync(jsSource, path.join(assetsDir, &#39;quest-navigator.js&#39;));
  }
  if (fs.existsSync(svgSource)) {
    fs.copyFileSync(svgSource, path.join(assetsDir, &#39;compass-icon.svg&#39;));
  }

  if (fs.existsSync(themeToggleCssSource)) {
    fs.copyFileSync(themeToggleCssSource, path.join(assetsDir, &#39;theme-toggle.css&#39;));
  }
  if (fs.existsSync(themeToggleJsSource)) {
    fs.copyFileSync(themeToggleJsSource, path.join(assetsDir, &#39;theme-toggle.js&#39;));
  }
}
</code></pre>
<ul>
<li>Deploys navigational assets that enrich quest interactivity and user experience.</li>
<li>Condition-based copying ensures graceful handling of varied asset configurations across single and multi-theme sites.</li>
<li>Consolidates shared assets in a logically structured output folder for predictable organization.</li>
</ul>
<hr>
<pre><code class="language-typescript">copyGlobalAssets(outputDir: string): void {
  try {
    const globalAssetsDir = path.join(outputDir, &#39;assets&#39;);
    const targetImagesDir = path.join(globalAssetsDir, &#39;images&#39;);
    fs.mkdirSync(targetImagesDir, { recursive: true });

    const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
    fs.mkdirSync(globalSharedDir, { recursive: true });
    
    const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
    globalImages.forEach(file =&gt; {
      const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
      if (fs.existsSync(sourcePath)) {
        const targetPath = path.join(globalSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      }
    });

    const headerImageSource = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;, &#39;ai-adventures.png&#39;);
    if (fs.existsSync(headerImageSource)) {
      const headerImageTarget = path.join(targetImagesDir, &#39;ai-adventures.png&#39;);
      fs.copyFileSync(headerImageSource, headerImageTarget);
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy global images&#39;));
  }
}
</code></pre>
<ul>
<li>Globally deploys assets like GitHub icons and adventure branding elements.</li>
<li>Distinguishes between shared assets and theme-specific content for modular site consistency.</li>
<li>Manages potentially failing file operations gracefully, ensuring robust execution.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/html-generator.ts:</span> Overseeing the adventure generation pipeline</h3>
<p>This file contains the <code class="inline-code">HTMLAdventureGenerator</code> class, a central orchestrator for generating fully functional HTML adventures. </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: Oversees the template rendering and asset management to create a consistent adventure output.</li>
<li><code class="inline-code">generateAllThemes</code>: Directs site generation for multiple themes in parallel, optimizing for speed and scalability.</li>
<li><code class="inline-code">startHttpServer</code>: Powers an optional local server to preview the results of the adventure generation.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/html-generator.ts</h3>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
  // Simplified description for brevity
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
  
  // Analyze project
  console.log(chalk.dim(&#39;üìä Analyzing codebase...&#39;));
  const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);
  const projectInfo = createProjectInfo(repomixContent);

  // Initialize adventure creation
  this.adventureManager = new AdventureManager();
  this.templateEngine = new TemplateEngine();

  // Rest of the method not shown due to size
}
</code></pre>
<ul>
<li>Entrypoint for executing all significant aspects of adventure generation.</li>
<li>Integrates analysis, theme configuration, and resource deployment.</li>
<li>Offers high-level insight into how content, templates, and assets align within the broader pipeline.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Ensure you understand the file caching logic in <code class="inline-code">loadTemplate</code> to optimize future enhancements.</li>
<li>Pay close attention to asset management practices to streamline theme-specific and shared content organization.</li>
<li>Review error-handling strategies for asset operations to strengthen the system&#39;s robustness.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Mission accomplished, Commander‚ÄîQuest 1: The Command Nexus is locked in the stardock of progress, igniting stellar momentum for the next cosmic adventure! üöÄ‚≠êüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>