<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: Navigating the HTML Nebula - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Galactic Repository Missions: The Codebase Chronicles</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: Navigating the HTML Nebula</h1>
<hr>
<p>The <em>RepoStar Matrix</em> begins its launch sequence, but a critical stage of preparation lies ahead. The Stellar Code Alliance has assigned you to ensure that the ship&#39;s HTML generation systems are fully operational. As the ship ventures into the uncharted expanse of cosmic code, its interactive mission logs, navigational interfaces, and stellar storytelling are crafted dynamically by the HTML Nebula pipeline. Your job is to navigate the intricate structures of this celestial engine, coordinate the Template Engine, Asset Manager, and HTML Generator, and ensure flawless integration that will illuminate the stars with structured adventure.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Nebula Patterns</strong>: How does the <code class="inline-code">TemplateEngine</code>&#39;s <code class="inline-code">replacePlaceholders</code> method handle dynamic content replacement, and what makes the system efficient for rendering?</li>
<li>‚ö° <strong>Galaxy Coordination</strong>: How does the <code class="inline-code">HTMLAdventureGenerator</code> determine and orchestrate the end-to-end adventure generation process through its <code class="inline-code">generateAdventure</code> method?</li>
<li>üõ°Ô∏è <strong>Orbital Assets</strong>: How does the <code class="inline-code">AssetManager</code> efficiently manage global assets and ensure universal availability through the <code class="inline-code">copyGlobalAssets</code> method?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/template-engine.ts</code></a>: Template logic for dynamic content</h3>
<p>This file defines the <code class="inline-code">TemplateEngine</code>, responsible for loading and rendering HTML templates. It applies key systems for placeholder replacement, caching, and template composition.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Caches and loads HTML templates from the file system, improving render efficiency by minimizing disk reads.</li>
<li><code class="inline-code">replacePlaceholders</code>: Dynamically replaces placeholders in a template string with provided variables, enabling adaptive content generation.</li>
<li><code class="inline-code">renderPage</code>: Composes a complete HTML page by combining a base template and content templates with injected data.</li>
</ul>
<h3>Code</h3>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }
  
  const templatePath = path.join(this.templatesDir, templateName);
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Caches templates for faster subsequent access.</li>
<li>Safely reads from the file system and gracefully handles errors.</li>
<li>Avoids redundant I/O, critical for high-output scenarios.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li>Uses a substitution pattern to replace <code class="inline-code">{{key}}</code> tokens with provided values.</li>
<li>Ensures robust processing by handling multiple tokens within a template.</li>
<li>Enables adaptable layout construction when used with <code class="inline-code">variables</code>.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  const pageVariables = { ...variables, CONTENT: renderedContent };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Merges data-rich content into a consistent base template.</li>
<li>Delegates placeholder injection through <code class="inline-code">replacePlaceholders</code>.</li>
<li>Provides a unified approach for generating both single and composite templates.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/html-generator.ts</code></a>: Core adventure pipeline</h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> orchestrates the entire adventure generation process, managing templates, assets, and file outputs.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: Main entry point for adventure creation, coordinating multiple subsystems for template rendering, content generation, and output.</li>
<li><code class="inline-code">buildQuestHTML</code>: Constructs dynamic HTML files for each quest, injecting navigational links and quest-specific content.</li>
<li><code class="inline-code">startHttpServer</code>: Launches an optional local server to review generated HTML files.</li>
</ul>
<h3>Code</h3>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
  
  const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);
  const projectInfo = createProjectInfo(repomixContent);

  const storyContent = await this.adventureManager.initializeAdventure(
    projectInfo, 
    this.selectedTheme, 
    this.projectPath,
    this.customThemeData
  );

  this.extractQuestInfo();

  this.generateThemeCSS();
  this.copyQuestNavigator();
  this.copyImages();
  this.generateIndexHTML();
  await this.generateQuestPages();
  await this.generateSummaryHTML();
}
</code></pre>
<ul>
<li>Centralizes all processes needed to create a complete HTML adventure.</li>
<li>Sequentially initializes adventure details, CSS, navigational elements, and pages.</li>
<li>Streamlines logic for modular adjustments and extensions.</li>
</ul>
<hr>
<pre><code class="language-typescript">private buildQuestHTML(quest: QuestInfo, content: string, questIndex: number): string {
  const prevQuest = questIndex &gt; 0 ? this.quests[questIndex - 1] : null;
  const nextQuest = questIndex &lt; this.quests.length - 1 ? this.quests[questIndex + 1] : null;

  const bottomNavigation = `
    &lt;div class=&quot;quest-navigation&quot;&gt;
      ${prevQuest ? `&lt;a href=&quot;${prevQuest.filename}&quot;&gt;‚Üê Previous&lt;/a&gt;` : &#39;&#39;}
      ${nextQuest ? `&lt;a href=&quot;${nextQuest.filename}&quot;&gt;Next ‚Üí&lt;/a&gt;` : &#39;&#39;}
    &lt;/div&gt;`;
  
  const variables = {
    PAGE_TITLE: this.stripHTML(quest.title),
    QUEST_CONTENT: this.formatMarkdown(content),
    BOTTOM_NAVIGATION: bottomNavigation
  };
  
  return this.templateEngine.renderPage(&#39;quest-template.html&#39;, variables);
}
</code></pre>
<ul>
<li>Dynamically constructs quest-specific HTML, including its navigation links.</li>
<li>Formats markdown content and uses placeholders for page-specific content.</li>
<li>Maintains a cohesive user experience by integrating theme consistency.</li>
</ul>
<hr>
<pre><code class="language-typescript">private async startHttpServer(port: number = 8080): Promise&lt;void&gt; {
  const server = http.createServer((req, res) =&gt; {
    let filePath = path.join(this.outputDir, req.url === &#39;/&#39; ? &#39;index.html&#39; : req.url || &#39;&#39;);
    fs.readFile(filePath, (err, content) =&gt; {
      if (err) {
        res.writeHead(err.code === &#39;ENOENT&#39; ? 404 : 500);
        res.end(err.code === &#39;ENOENT&#39; ? &#39;File not found&#39; : &#39;Server error&#39;);
      } else {
        res.writeHead(200);
        res.end(content);
      }
    });
  });

  server.listen(port, () =&gt; {
    console.log(chalk.green(`üåê HTTP server started on http://localhost:${port}`));
  });
}
</code></pre>
<ul>
<li>Provides a rapid way to preview generated projects by serving content locally.</li>
<li>Includes fallback handling for common file access errors.</li>
<li>Demonstrates simple yet effective server logic for single-directory hosting.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/asset-manager.ts</code></a>: Managing interstellar assets</h3>
<p>The <code class="inline-code">AssetManager</code> ensures assets (e.g., images, stylesheets) are copied to the correct locations for use in the HTML output.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyGlobalAssets</code>: Copies shared assets (e.g., logos, shared images) to a consolidated location for all themes.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Adds navigational scripts and styles to individual or multi-theme setups.</li>
<li><code class="inline-code">copyImages</code>: Handles image file organization and duplication avoidance during theme-specific generation.</li>
</ul>
<h3>Code</h3>
<pre><code class="language-typescript">copyGlobalAssets(outputDir: string): void {
  const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
  const globalAssetsDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
  const targetImagesDir = path.join(globalAssetsDir, &#39;images&#39;);

  fs.mkdirSync(targetImagesDir, { recursive: true });
  globalImages.forEach(file =&gt; {
    const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
    if (fs.existsSync(sourcePath)) {
      const targetPath = path.join(globalAssetsDir, file);
      fs.copyFileSync(sourcePath, targetPath);
    }
  });
}
</code></pre>
<ul>
<li>Consolidates globally reusable assets to specific directories.</li>
<li>Minimizes duplication and improves maintainability of static resources.</li>
<li>Creates necessary directories dynamically, ensuring seamless pipeline execution.</li>
</ul>
<hr>
<pre><code class="language-typescript">copyQuestNavigator(outputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);

  const assetsDir = path.join(outputDir, &#39;assets&#39;);
  fs.mkdirSync(assetsDir, { recursive: true });

  if (fs.existsSync(cssSource)) fs.copyFileSync(cssSource, path.join(assetsDir, &#39;quest-navigator.css&#39;));
  if (fs.existsSync(jsSource)) fs.copyFileSync(jsSource, path.join(assetsDir, &#39;quest-navigator.js&#39;));
}
</code></pre>
<ul>
<li>Adds quest navigation assets (CSS and JS) for enhanced user interactions.</li>
<li>Supports both single and multi-theme adventure setups.</li>
<li>Automatically ensures proper organization of navigation-related files.</li>
</ul>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Modular Focus</strong>: Investigate how the <code class="inline-code">TemplateEngine</code>, <code class="inline-code">AssetManager</code>, and <code class="inline-code">HTMLAdventureGenerator</code> interact to better understand the pipeline‚Äôs modularity.</li>
<li><strong>Dynamic Rendering</strong>: Pay attention to placeholder-based replacement for reusable templates.</li>
<li><strong>Testing Tips</strong>: Use the <code class="inline-code">startHttpServer</code> method to verify changes in the generated output in real-time.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Mission accomplished, Star Navigator‚Äîyour cosmic prowess has illuminated the HTML Nebula, setting your starship on course toward stellar mastery! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>