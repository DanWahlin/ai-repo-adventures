<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Bridge Interface - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Galactic Adventures: The Codex of the Stellar Repository</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Bridge Interface</h1>
<hr>
<p>The Quantum Voyager&#39;s crew hovered in anticipation as the ship exited warp space, coming into orbit near the Stellar Repository. Galactic Command‚Äôs message was brief: the core bridge interface of the MCP system‚Äîa nexus coordinating repositories‚Äîwas malfunctioning. Erratic commands and inconsistent data suggested a looming AI revolt or cosmic corruption. Your mission: penetrate the repository and stabilize the bridge interface, ensuring the galactic network‚Äôs harmony. Activate latent tools, decipher protocols, and restore the Repository&#39;s navigational command.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/mcp/src/server.ts:</span> MCP Server Configuration and Execution</h3>
<p>The <code class="inline-code">server.ts</code> file is pivotal, serving as the main entry point for initializing the MCP server used to host and handle the Repository bridge interface&#39;s interactions. The <code class="inline-code">RepoAdventureServer</code> class, alongside the <code class="inline-code">main</code> function, establishes the server&#39;s runtime environment and integrates critical components required to manage galactic tools dynamically. These tools allow incoming requests to activate or debug commands.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">RepoAdventureServer.setupHandlers</code>: Dynamically integrates and validates MCP tools.</li>
<li><code class="inline-code">RepoAdventureServer.run</code>: Establishes the Stellar Repository&#39;s interface and caches tool resources.</li>
<li><code class="inline-code">main</code>: Manages the program lifecycle, including error and signal handling.</li>
</ul>
<h2>Code</h2>
<h3>packages/mcp/src/server.ts</h3>
<pre><code class="language-typescript">private setupHandlers() {
  this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; {
    const toolList = Object.entries(tools).map(([name, tool]) =&gt; ({
      name,
      description: tool.description,
      inputSchema: zodToJsonSchema(tool.schema, {
        target: &#39;jsonSchema7&#39;,
        $refStrategy: &#39;none&#39;
      })
    }));

    return { tools: toolList };
  });

  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    try {
      const { name, arguments: args } = request.params;

      if (!(name in tools)) {
        throw new McpError(ErrorCode.MethodNotFound, `Unknown tool: ${name}`);
      }

      const tool = tools[name as keyof typeof tools];

      const validationResult = tool.schema.safeParse(args);
      if (!validationResult.success) {
        const errorMessages = validationResult.error.issues.map((err) =&gt; 
          `${err.path.join(&#39;.&#39;)}: ${err.message}`
        ).join(&#39;, &#39;);
        throw new McpError(ErrorCode.InvalidParams, `Invalid parameters: ${errorMessages}`);
      }

      return await tool.handler(validationResult.data as any);

    } catch (error) {
      if (error instanceof McpError) {
        throw error;
      }
      throw new McpError(
        ErrorCode.InternalError,
        `Tool execution failed: ${error instanceof Error ? error.message : String(error)}`
      );
    }
  });
}
</code></pre>
<p>This is like assigning crew roles on a starship‚Äîtools are verified, mapped, and prepared for operation, ensuring a smooth mission.</p>
<pre><code class="language-typescript">async run() {
  const transport = new StdioServerTransport();
  await this.server.connect(transport);
  console.error(&#39;Repo Adventure MCP server running on stdio&#39;);

  const projectPath = process.cwd();
  console.error(`Pre-generating repomix content for project at ${projectPath}...`);
  repoAnalyzer.preGenerate(projectPath);
}
</code></pre>
<p>Comparable to initializing your starship&#39;s mainframe, this function establishes connections and warms up resources.</p>
<pre><code class="language-typescript">async function main() {
  try {
    const server = new RepoAdventureServer();

    [&#39;SIGINT&#39;, &#39;SIGTERM&#39;].forEach(sig =&gt; 
      process.on(sig as NodeJS.Signals, gracefulShutdown)
    );

    process.on(&#39;unhandledRejection&#39;, (reason) =&gt; {
      console.error(&#39;Unhandled promise rejection:&#39;, reason);
    });

    await server.run();
  } catch (error) {
    console.error(&#39;Fatal error starting MCP server:&#39;, error);
    process.exit(1);
  }
}
</code></pre>
<p>This function is essentially the crew‚Äôs launch protocol‚Äîit activates the system and ensures all signals are covered for a safe journey.</p>
<hr>
<h3><span class="header-prefix">packages/mcp/src/tools.ts:</span> Tool Registration and Management</h3>
<p>This file contains the backbone of tool definitions, enabling dynamic interaction with the Stellar Repository‚Äôs systems. The <code class="inline-code">tools</code> module encompasses handlers that execute the essential operations forming the bridge interface protocol‚Äôs repair crew.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">start_adventure.handler</code>: Primary entrance for analyzing repositories and suggesting themes.</li>
<li><code class="inline-code">choose_theme.handler</code>: Generates bridge system contexts based on selected settings.</li>
<li><code class="inline-code">explore_quest.handler</code>: Handles operational commands tied to repository missions.</li>
<li><code class="inline-code">view_progress.handler</code>: Displays the Repository stabilization&#39;s current status.</li>
</ul>
<h2>Code</h2>
<h3>packages/mcp/src/tools.ts</h3>
<pre><code class="language-typescript">export const start_adventure = startAdventure;
</code></pre>
<p>This is like charting a navigation course‚Äîit lays the foundation for a grand journey through the repository.</p>
<pre><code class="language-typescript">export const choose_theme = chooseTheme;
</code></pre>
<p>Selecting this tool is akin to configuring the starship‚Äôs interface to adapt to the mission‚Äôs unique operational needs.</p>
<pre><code class="language-typescript">export const explore_quest = exploreQuest;
</code></pre>
<p>This represents the crew actively engaging with a particular subsystem, executing assignments to stabilize cosmic governance.</p>
<pre><code class="language-typescript">export const view_progress = viewProgress;
</code></pre>
<p>Think of this as your status monitor, providing real-time feedback on mission progress and completion rates.</p>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Gather a clear understanding of each tool&#39;s schema when exploring new repositories‚Äîthey are your galactic instruments.</li>
<li>Prioritize testing the bridge interface with various inputs to ensure normalization and command consistency.</li>
<li>Begin subsequent quests after confirming the Repository&#39;s tools pass Galactic Command inspection.</li>
</ul>
<hr>
<p>Prepare to face the unknown, explorer. Your actions protect the unity of an infinite galaxy!</p>
<p>Congratulations, Captain, Quest 1: The Bridge Interface is a stellar success‚Äîyour ship&#39;s navigation systems now gleam brighter than the stars, propelling your cosmic journey forward! üöÄ‚ö°‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2: The Stellar Engine ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>