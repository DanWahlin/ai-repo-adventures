<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Cosmic Code Chronicles</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Configuration &amp; Theme System</h1>
<hr>
<p>The <strong>Nebula Architect</strong> now ventures toward the heart of the Andromeda Cluster, where the <strong>Configuration &amp; Theme Core</strong> resides. This final system holds the power to synchronize your starship‚Äôs internal parameters and integrate the thematic designs essential for interstellar adaptability. It is said that this module mirrors the infinite diversity of the cosmos itself, blending utility and vision. Brave star traveler, your mission is to audit and decipher the celestial framework that supports dynamic configurations and thematic integration. You must ensure this system can sustain the galaxy‚Äôs explorers for eternity.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Parameter Stability Scan</strong>: What mechanisms ensure safe and scalable configuration handling across varying system conditions?</li>
<li>‚ö° <strong>Theme Selection Analysis</strong>: How does the system manage and validate themes to ensure compatibility with user input?</li>
<li>üõ°Ô∏è <strong>Input Validation Shielding</strong>: What safeguards protect against invalid or malicious user inputs for configuration and theme management?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Configuration constants for the system</h3>
<p>The <code class="inline-code">config.ts</code> file defines configuration parameters such as timeouts, limits, and API settings that govern the starship&#39;s operational systems. It houses the foundational constants needed for managing performance and reliability across cosmic-scale operations. Environment variables here are loaded dynamically, allowing flexibility between development and deployment states.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Specifies the maximum duration for LLM requests, ensuring operations do not freeze during prolonged tasks.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Defines the cache lifespan for repository mixes, balancing performance and memory usage.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Limits the file size processed, preventing resource exhaustion in memory-constrained environments.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li><strong>What it does</strong>: Configures timeouts and limits, critical for managing API operations and resource allocations.</li>
<li><strong>Patterns used</strong>: Environment-based configurability with default fallback values ensures robustness in varying deployments.</li>
<li><strong>Problems solved</strong>: Prevents resource overuse by imposing safe operational boundaries.</li>
<li><strong>Connections</strong>: Ties directly to the LLM system, ensuring seamless integration and stability in advanced story generation workflows.</li>
<li><strong>Important details</strong>: Encapsulation of constants in backticks like <code class="inline-code">parseInt(process.env.CONFIG_VAR || &#39;default&#39;)</code>.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Theme definitions and utilities</h3>
<p>This file provides a centralized repository of adventure themes alongside utilities for managing them. Themes like &quot;space&quot; or &quot;ancient&quot; are defined with id, key, displayName, emoji, and keywords that allow flexible and user-friendly identification. Helper methods enable efficient theme validation and retrieval, making the system dynamic and interactive.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A master definition of all available adventure themes, including IDs, keys, and user-facing details.</li>
<li><code class="inline-code">getAllThemes</code>: Retrieves all defined themes as an array, providing a simple interface for theme iteration.</li>
<li><code class="inline-code">isValidTheme</code>: Validates theme keys against the predefined list, ensuring system integrity.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  // Other themes omitted for brevity
} as const;
</code></pre>
<ul>
<li><strong>Core functionality</strong>: Defines the themes, including metadata and keywords for identification.</li>
<li><strong>Design choices</strong>: Uses readonly fields and a consistent structure for extensibility and safety.</li>
<li><strong>Benefits</strong>: Centralized theme management simplifies updates and validation.</li>
<li><strong>Connections</strong>: Themes feed directly into quest content and story generation utilities.</li>
<li><strong>Lessons learned</strong>: How to create self-documenting and extendable configurations using TypeScript.</li>
</ul>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li><strong>Purpose</strong>: Returns all available themes as an array.</li>
<li><strong>Implementation</strong>: Simplifies theme access while preserving immutability.</li>
<li><strong>Connected systems</strong>: Supports features like theme selection and display.</li>
<li><strong>Key detail</strong>: Relies on <code class="inline-code">THEMES_ARRAY</code> to iterate consistently without modifying the original <code class="inline-code">THEMES</code>.</li>
</ul>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li><strong>Role</strong>: Verifies if a given string corresponds to a valid theme key.</li>
<li><strong>Technique</strong>: Utilizes <code class="inline-code">some</code> for efficient lookups across the theme array.</li>
<li><strong>Problem addressed</strong>: Ensures only valid themes are processed, enhancing stability.</li>
<li><strong>Connections</strong>: Assists input validation functions for user customization.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Protecting inputs</h3>
<p>This module enforces strict input validation, ensuring robust and secure handling of user-provided data. Methods like <code class="inline-code">validateTheme</code> and <code class="inline-code">validateAdventureChoice</code> prevent errors and malicious inputs, ensuring smooth operations for the <strong>Nebula Architect</strong>.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Cross-references user input against available themes and ensures compliance.</li>
<li><code class="inline-code">validateAdventureChoice</code>: Normalizes and sanitizes user choices for safety and clarity.</li>
<li><code class="inline-code">validateProjectPath</code>: Prevents invalid or unsafe project path entries.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li><strong>Purpose</strong>: Verifies and normalizes theme inputs to match valid configurations.</li>
<li><strong>Key patterns</strong>: Normalization, validation via helper utilities, and detailed error messages.</li>
<li><strong>Errors mitigated</strong>: Prevents invalid data from disrupting the theme system.</li>
<li><strong>Connections</strong>: Interacts with <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> to deliver robust functionality.</li>
</ul>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li><strong>Functionality</strong>: Ensures adventure choices are valid and appropriately sized.</li>
<li><strong>Techniques</strong>: Length checks and error handling for user inputs.</li>
<li><strong>Relationship</strong>: Supports user-driven decision-making within the adventure system.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li><strong>Purpose</strong>: Prevents unsafe project paths during interactions.</li>
<li><strong>Patterns</strong>: Path normalization, validation, and fallback defaults.</li>
<li><strong>Concerns addressed</strong>: Path length, invalid characters, and undefined values.</li>
<li><strong>Connections</strong>: Integrated into analysis workflows requiring project paths.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>üåå <strong>Tip</strong>: Inspect shared constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> early, as configuration variables have far-reaching impacts.</li>
<li>üõ†Ô∏è <strong>Recommendation</strong>: Pay close attention to theme keyword matching logic in the <code class="inline-code">parseTheme</code> function to understand user input flexibility.</li>
<li>üåü <strong>Next Steps</strong>: Reflect on the structure of centralized configuration and its advantages for extensibility.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the galaxy&#39;s configuration and theme systems! Your adventure is complete.</p>
<p>Mission Control to Star Navigator: Quest 4 complete! You&#39;ve expertly charted the Configuration &amp; Theme System, rocketing your skills to 75% cosmic mastery‚Äîkeep climbing, you&#39;re nearly a galactic legend! ‚≠êüöÄ‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>