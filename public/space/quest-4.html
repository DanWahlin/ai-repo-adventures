<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Cosmic Odyssey of the Codebase</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Configuration &amp; Theme System</h1>
<hr>
<p>The <em>Codex Voyager</em> glides through the stellar vastness, its navigational arrays synchronizing with the configuration streams of the Cosmic Grid. Ahead lies an intricate lattice of data‚Äîyour task is to decode the signals governing the ship&#39;s themes and system configurations. These interconnected systems form the foundation of your galaxy-wide explorations, enabling seamless journeys through dynamic adventures. Traverse the filament-like pathways of the configuration matrix and uncover the logic shaping the spirit of innovation aboard the Voyager. </p>
<p>Prepare to calibrate your scanners and engage your analytical prowess‚Äîthe ship&#39;s successful operation depends on it.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these cosmic questions:</p>
<ul>
<li>üõ†Ô∏è <strong>Config Constellation</strong>: How is the configuration designed to balance simplicity and flexibility in managing adventure settings?</li>
<li>üåÄ <strong>Theme Nebula</strong>: How does the <code class="inline-code">theme.ts</code> file structure themes, and how does it support dynamic customization and validation of user inputs?</li>
<li>üöÄ <strong>Input Navigation</strong>: What safety mechanisms are implemented in input validation to safeguard against erroneous or malicious data?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Validation for Navigation Parameters</h3>
<p>Input validation serves as a protective shield for the <em>Codex Voyager</em>, ensuring smooth navigation through cosmic user inputs. This file contains functions that sanitize, validate, and process critical data before it interacts with the system, preventing unexpected failures or security breaches.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures adventure choices are non-empty, trimmed, and within the specified character limit. Critical for maintaining meaningful user inputs.</li>
<li><code class="inline-code">validateTheme</code>: Validates the selected theme using helper functions from the <code class="inline-code">theme.ts</code> file. Ensures only recognized themes or valid keywords are used.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips input data of undesirable characters to ensure safe display. Vital for preventing script injection in external communications.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Ensures user input is not empty and within acceptable length limits, avoiding arbitrary or harmful data.</li>
<li>Patterns like <code class="inline-code">.trim()</code> enforce uniformity in inputs.</li>
<li>Throws errors with clear messages for invalid cases, guiding user correction effectively.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Utilizes a helper ecosystem from <code class="inline-code">theme.ts</code> for validation, promoting modularity and reusability.</li>
<li>Normalizes inputs for case- and format-insensitive matching.</li>
<li>Provides users immediate feedback with contextually rich error messages.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Sanitization removes potentially dangerous characters‚Äîcritical for preventing XSS vulnerabilities.</li>
<li><code class="inline-code">.slice()</code> caps output length to ensure display-safe data flow.</li>
<li>Ensures consistent formatting for end-user views, building a secure and dependable user interface.</li>
</ul>
<hr>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Galactic Themes Management</h3>
<p>This file defines the thematic essence of the <em>Codex Voyager</em>, shaping the user&#39;s multiverse experience. Themes are the backbone of adventure customization, ensuring each journey is vibrant and engaging. Here, themes are structured, validated, and prepared for use through straightforward yet versatile utilities.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Central repository of theme definitions, each rich with metadata. Powers theme-driven adventures.</li>
<li><code class="inline-code">parseTheme</code>: Handles user input to seamlessly match themes by ID, key, or keywords, bridging user input with system understanding.</li>
<li><code class="inline-code">getAllThemes</code>: Retrieves the defined themes in an easily iterable structure, ensuring straightforward integration across the codebase.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  // Additional themes omitted for brevity...
} as const;
</code></pre>
<ul>
<li>Defines core themes with metadata crucial for dynamic adventure generation.</li>
<li>Elastic keyword matching ensures user-friendly theme selection.</li>
<li>Design ensures easy expansion to include new themes without infrastructure overhaul.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Implements several matching strategies (key, ID, keywords) for comprehensive input resolution.</li>
<li>Demonstrates effective use of functional programming techniques (array methods).</li>
<li>Ensures robust input handling, allowing intuitive user theme selection.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li>Provides a pre-normalized list of themes for integration throughout the system.</li>
<li>Promotes modularity by creating a separation of concerns between storage and retrieval.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Cosmic Configuration Coordinates</h3>
<p>This file contains universal constants defining operational parameters for the <em>Codex Voyager</em>. Balancing performance and functionality, it ensures reliable settings for core features like timeouts, limits, and default behaviors.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Controls API call durations, preventing the system from stalling.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Ensures efficient memory usage by skipping overly large files.</li>
<li><code class="inline-code">DEFAULT_THEME</code>: Establishes the fallback theme to maintain operational consistency.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
</code></pre>
<ul>
<li>Sets a timeout ensuring operations remain responsive.</li>
<li>Optimized for balancing runtime complexity with user experience.</li>
<li>Establishes bounds for long-running processes, safeguarding system reliability.</li>
</ul>
<hr>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>Protects the system against memory overflows by capping file analysis size.</li>
<li>Prioritizes operational focus on meaningful content over exhaustive inclusion.</li>
</ul>
<hr>
<pre><code class="language-typescript">export const DEFAULT_THEME = &#39;space&#39; as const;
</code></pre>
<ul>
<li>Specifies a fallback to ensure graceful theme management under all conditions.</li>
<li>Aligns with the codebase&#39;s user-centric design principles.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Remember to trace relationships between <code class="inline-code">theme.ts</code> and <code class="inline-code">input-validator.ts</code> to fully grasp the modularity of theme validation.</li>
<li>Experiment by introducing a new theme in <code class="inline-code">THEMES</code> to explore the adaptive design in action.</li>
<li>Use various edge cases to test <code class="inline-code">sanitizeForDisplay</code> and see how it shields the system.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the <em>Codex Voyager</em> and the cosmic code repository it traverses.</p>
<p>Congratulations, star voyager! With Quest 4 successfully completed, your configuration and theme system mastery propels your cosmic mission to 60%‚Äîlighting up the universe with stellar brilliance ‚≠êüöÄ!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>