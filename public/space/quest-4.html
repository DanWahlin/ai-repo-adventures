<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Stellar Configuration Database - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Chronicles of the Cosmic Codebase</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Stellar Configuration Database</h1>
<hr>
<p>The <strong>Starship Repomix</strong> hums with energy as it ventures deeper into the galactic expanse of its own advanced systems. This time, the mission is twofold: decode the intricate settings that govern its neural pathways and harmonize its stellar configuration database. You are summoned to explore its foundational files‚Äîensuring alignment across data, validating critical input flows, and unraveling the mystery behind its cosmic themes system. With every adjustment to the starship‚Äôs luminous structure, you‚Äôll edge closer to perfect synthesis. Prepare to navigate the most foundational layer of the ship‚Äôs logic yet‚Äîyour precision is critical for the remaining journey.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Mapping Constellation</strong>: How does the system define and organize themes, and how does this approach support modularity and extensibility?  </li>
<li>‚ö° <strong>Validation Thrusters</strong>: How does the input validation system ensure safe and accurate data flows throughout the starship‚Äôs operations?  </li>
<li>üõ°Ô∏è <strong>Configuration Shields</strong>: What safeguards exist in the configuration module to mitigate potential errors or misconfigurations, and how do they ensure reliability for the Repomix systems?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Core theme management repository</h3>
<p>The <code class="inline-code">theme.ts</code> file acts as the central hub for theme configurations, supporting the Starship Repomix‚Äôs role as a vessel for diverse adventures. It defines a unified structure for encoding themes, provides functionality to retrieve themes by various parameters, validates theme integrity, and even formats options for display. By centralizing all theme logic, it ensures modular, reusable, and consistent processing across systems. The file introduces an effective mix of clear types and utility functions to make adding, retrieving, or validating themes straightforward.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A central object defining the core structure and metadata of supported themes, such as &quot;space&quot; or &quot;custom.&quot;</li>
<li><code class="inline-code">isValidTheme</code>: A utility to verify whether a given theme is valid, ensuring only approved configurations are used.</li>
<li><code class="inline-code">parseTheme</code>: A method that resolves input into a valid theme by checking against keys, ids, or keywords.</li>
<li><code class="inline-code">getAllThemes</code>: A helper to retrieve all available themes for iteration or display in configuration menus.</li>
<li><code class="inline-code">formatThemeOption</code>: Formats themes for display, enhancing interactive user selection.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  // Other themes...
} as const;
</code></pre>
<ul>
<li>Defines the structure and metadata of themes, ensuring consistent access across systems.</li>
<li>Metadata like <code class="inline-code">emoji</code> and <code class="inline-code">keywords</code> provide rich user interaction and make configurations intuitive.</li>
<li>The design supports extensibility through simple additions to the <code class="inline-code">THEMES</code> object.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>Verifies the validity of a theme using an array-based lookup to ensure lightweight iterations.</li>
<li>Enables modules to confirm theme consistency before performing operations or setting configurations.</li>
<li>Demonstrates a simple and effective type guard for error prevention.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;

  const normalized = input.trim().toLowerCase();

  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  // Additional checks by ID or keywords...
  return null;
}
</code></pre>
<ul>
<li>Illustrates a stepwise approach to resolving inputs into valid themes, ensuring robustness in unpredictable environments.</li>
<li>Combines key matching, numeric parsing, and keyword checks for comprehensive validation.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Ensuring data integrity</h3>
<p>This file ensures the safety and correctness of inputs used in the adventure system. By sanitizing and validating critical data pathways‚Äîlike user choices and project paths‚Äîit prevents malformed inputs from disrupting the starship‚Äôs operations. Each function here is purpose-built to handle specific input types, enhancing both stability and user experience.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures user-provided choices are non-empty and of reasonable length to prevent crashes.</li>
<li><code class="inline-code">validateTheme</code>: Validates themes against both defined and dynamic options, leveraging theme utilities for accuracy.</li>
<li><code class="inline-code">validateProjectPath</code>: Secures file paths, removing invalid characters and applying sensible defaults in ambiguous cases.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Sanitizes text for safe display, stripping problematic characters and limiting overall length.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }

  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);

  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }

  return parsedTheme;
}
</code></pre>
<ul>
<li>Integrates theme utilities (<code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code>) to ensure themes are both valid and normalized.</li>
<li>Provides sharp error messages to guide user adjustments without ambiguity.</li>
<li>Ensures early error detection, contributing to overall system resilience.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Sanitizes potentially unsafe file paths by stripping problematic characters.</li>
<li>Includes sensible defaults (current working directory) for missing values.</li>
<li>Prevents corruption or invalid data from propagating across the system.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;

  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Strips dangerous or malformed characters before text is displayed to users.</li>
<li>Reduces risks of injection-type attacks or visual distortions caused by improper formatting.</li>
<li>Limits display length to maintain interface clarity.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Universal configuration storage</h3>
<p>The <code class="inline-code">config.ts</code> file holds constants and settings, acting as a central source for environmental parameters and operational limits. It governs key behaviors like API timeouts, cache lifespans, and error messages, ensuring consistency and reliability across all modules. This file defines global variables that shape the starship‚Äôs performance in every quest.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Standardizes max response time for the AI system, ensuring real-time constraints are met.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Controls cache lifetimes to balance efficiency with freshness.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Prevents resource exhaustion by enforcing file size limits during scans and uploads.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>Defines globally enforced limits to ensure performance stability.</li>
<li>Introduces flexibility by allowing environment-driven adjustments to key parameters.</li>
<li>Detects and prevents edge cases like timeouts during long operations or large file processing.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use the <code class="inline-code">getAllThemes</code> function to familiarize yourself with the available cosmic themes.</li>
<li>Step through validation logic carefully‚Äîeach mechanism ensures the starship operates without interference.</li>
<li>Check the configuration file for any adjustable parameters you might want to test during exploration.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Congratulations, Star Navigator, you&#39;ve charted the Stellar Configuration Database with cosmic precision‚Äîyour mission is now 60% complete, shining brighter than a supernova! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>