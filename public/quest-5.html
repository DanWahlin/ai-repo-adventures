<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Nexus Chronicle: Central Systems and Pathways - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">Operation Starlight: Mapping the Galactic Code Nexus</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Nexus Chronicle: Central Systems and Pathways</h1>
<hr>
<p>The <em>Prometheus Array</em> drifted silently in the Orbital Rim of the Cygnus Fragment Cluster. Twinkling strands of cosmic filaments surrounded the vessel as the crew set their sights on the Central Systems—the nerve center of the Experimental Code Nexus. The ECN was pulsing erratically with corrupted pathways and staggered responses to queries, threatening to destabilize the fragile harmony that the <em>Prometheus Array</em> had fought to restore. It was here that legendary pathways merged, converging into the repository’s heart. The crew&#39;s mission: to decipher the wild path diversity and unlock the systemic gate to the galaxy&#39;s survival. With the hum of Repomix modules echoing in the control deck, the adventure to decode the untamed chaos began.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Centralized Adventure Configuration Logic</h3>
<p>The <code class="inline-code">adventure-config.ts</code> file plays a pivotal role in managing the inputs and outputs required for creating tailored storylines during the <em>Prometheus Array</em>&#39;s missions. It acts as the repository&#39;s &quot;cosmic atlas,&quot; ensuring every piece of the galaxy&#39;s repository yields its hidden paths for the crew&#39;s analysis. The file performs three essential operations: it loads existing adventure configuration files, validates their contents, and extracts unique file paths referenced across the data. Using <code class="inline-code">loadAdventureConfig()</code> to retrieve raw configurations, and <code class="inline-code">parseAdventureConfig()</code> to parse and validate JSON data, these methods lay the foundation for the starship&#39;s command systems to interrogate repository nodes. The robust design includes sanitization to guard against invalid or hostile data that might disrupt interstellar exploration.</p>
<p>Another marvel lies in <code class="inline-code">extractUniqueFilePaths()</code>, which meticulously scans configuration objects for &quot;path&quot; values and validates the existence of referenced files. This ensures that only nodes with valid coordinates in the repository galaxy are included in subsequent missions. Finally, <code class="inline-code">formatAdventureConfigForPrompt()</code> ensures configuration data is transformed into highly structured prompts for logical decision-making via large language models. This file acts as the logic guidebook sitting at the crossroads of user input, repo processing, and AI systems for adventure generation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig()</code>: Retrieves raw JSON configuration files for parsing.</li>
<li><code class="inline-code">parseAdventureConfig()</code>: Parses and validates the contents of configuration files.</li>
<li><code class="inline-code">extractUniqueFilePaths()</code>: Gathers and validates all unique file references in the configuration.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code>: Generates formatted prompts for efficient processing by AI systems.</li>
<li>Robust error handling ensures compatibility with missing or corrupted data.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<p>This function is designed like a galactic navigator, retrieving a star chart (configuration file) if it exists, or returning nothing if there is no map to follow.</p>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>This method transforms raw star charts (JSON files) into a readable schematic for the journey, ensuring navigation droids receive consistent data.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<p>This function operates like a stellar beacon detection system, scanning coordinates for valid celestial bodies (file paths) and triaging invalid or false signals.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure Guidelines\n\n`;
  formatted += `**CRITICAL: Each quest MUST include dedicated file analysis sections**\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    formatted += `${quest.description}\n\n`;
    formatted += `**Required File Analysis Sections:**\n`;

    for (const file of quest.files) {
      if (!file.path || !file.description) continue;

      formatted += `\n**File: \`${file.path}\`**\n`;
      formatted += `- Description: ${file.description}\n`;
      
      if (Array.isArray(file.highlights)) {
        formatted += `- Key Functions/Areas to Highlight:\n`;
        for (const highlight of file.highlights) {
          if (highlight.name &amp;&amp; highlight.description) {
            formatted += `  • **${highlight.name}**: ${highlight.description}\n`;
          }
        }
      }
    }
    formatted += `\n`;
  }

  formatted += `\n**FORMATTING INSTRUCTIONS:**\n`;
  formatted += `- Each file mentioned in the quest structure above MUST have its own dedicated analysis section\n`;
  formatted += `- **MANDATORY**: Include at least 2-3 separate code snippet sections (## filename) with real code blocks\n`;
  formatted += `- Show actual function signatures, imports, class definitions, or key methods from the files\n`;
  formatted += `- Provide practical explanations using real-world analogies\n`;
  formatted += `- End with helpful hints and next steps\n`;

  return formatted;
}
</code></pre>
<p>This function works like an engineer composing a technical flight itinerary for pilots, ensuring every detail is preloaded for smooth travel.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Modularize your repository beyond what is strictly necessary—better segmentation eases the starship&#39;s repository traversal.</li>
<li>Investigate the orchestration files (<code class="inline-code">adventure-manager.ts</code>, <code class="inline-code">story-generator.ts</code>) for deeper integrations tied to the <code class="inline-code">adventure-config.ts</code> logic.</li>
<li>Consider enhancing the <code class="inline-code">extractUniqueFilePaths()</code> function to handle case sensitivity in path validations across diverse systems.</li>
</ul>
<hr>
<p>Mission accomplished, star voyager! You&#39;ve charted the intricate cosmic pathways of Quest 5 with precision, igniting thrusters for the final frontier—your brilliance lights up the galaxy! 🚀 ⭐ 💎</p>

</div>


    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>