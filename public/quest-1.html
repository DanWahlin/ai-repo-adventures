<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 Quest 1: Cosmic Tools of the MCP Command Deck - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">🚀 Galactic Codex: The MCP Discovery Mission</a>
        </div>
    </nav>
    
    <div class="container">
        <h1>🚀 Quest 1: Cosmic Tools of the MCP Command Deck</h1>
        
        
      <div class="quest-navigation">
        
        <a href="quest-2.html">Next: 🛰️ Quest 2: Stellar Algorithm Analysis of the Repomix Pipeline →</a>
      </div>
    
        
        <div class="quest-content">
            <p><strong>🚀 Quest 1: Cosmic Tools of the MCP Command Deck</strong></p>
<p>The Cosmic Voyager crew, led by Captain Vega, pressed forward in their mission aboard the MCP Command Deck—an interconnected starship system capable of simulating, analyzing, and optimizing cosmic tools for deep space exploration. In the last chapter, they had initiated contact with the MCP and used it to coordinate suborbital tasks with the galactic repository analyzer. Now, their immediate focus was to master the use of dynamic tools onboard, crucial for refining data streams from nearby nebulae and charting uncharted sectors of the galaxy. The stakes had risen; without proper utilization of the ship&#39;s cosmic tools, their journey remained perilously incomplete.</p>
<p>─── ⚡ Dynamic Cosmic Tools ───</p>
<p>The file <code class="inline-code">src/server.ts</code> showcases the backbone of the MCP Command Deck&#39;s operations. This component houses the <strong>RepoAdventureServer class</strong>, the framework responsible for commanding tools dynamically. The server integrates high-level protocols from the Model Context Protocol (MCP) SDK, enabling it to interact with tools via structured commands. Through this system, crew members on the vessel can efficiently list tools available and invoke them with precision—representing a digital toolkit for navigating cosmic data.</p>
<p>The <code class="inline-code">ListToolsRequestSchema</code> handler exemplifies an essential feature of this starship—a mechanism akin to a digital AI assistant listing capabilities within an exploratory toolkit. It dynamically generates schema mappings for JSON compatibility, ensuring seamless communication between tools onboard. Meanwhile, the <code class="inline-code">CallToolRequestSchema</code> handler validates data inputs before executing any stellar commands, acting as the ship&#39;s equivalent to airlocks for cosmic navigation—ensuring safety before activating critical mechanisms.</p>
<p>The file also features ample safeguards, such as graceful shutdown protocols via signals like <code class="inline-code">SIGINT</code> and <code class="inline-code">SIGTERM</code>, mirroring emergency procedures aboard a starship. In space-faring terms, this is akin to maintaining operational stability in turbulent regions of a galaxy.</p>
<p>─── 🔗 Stellar Connections ───</p>
<p>Additional technologies intertwined here include the <code class="inline-code">StdioServerTransport</code> for establishing communication pipelines between systems, and the <code class="inline-code">repoAnalyzer.preGenerate()</code> method, which acts as a cache pre-warm tool to prepare the starship for its next leg of exploration, ensuring no cosmic files remain unprepared for analysis.</p>
<p><strong>📜 Code Discoveries:</strong>
<strong>File: src/server.ts:</strong>
<div class="code-block"><div class="code-header">typescript</div><pre><code class="language-typescript"><span class="keyword">class</span> RepoAdventureServer {
  private server: Server;

  <span class="function">constructor</span>() {
    ...
  }

  private <span class="function">setupHandlers</span>() {
    this.<span class="property">server</span>.<span class="function">setRequestHandler</span>(ListToolsRequestSchema, <span class="keyword">async</span> () => {
      <span class="keyword">const</span> toolList = Object.<span class="function">entries</span>(tools).<span class="function">map</span>(([name, tool]) => ({
        name,
        description: tool.<span class="property">description</span>,
        inputSchema: <span class="function">zodToJsonSchema</span>(tool.<span class="property">schema</span>, {
          target: <span class="string">'jsonSchema7'</span>,
          $refStrategy: <span class="string">'none'</span>
        })
      }));

      <span class="keyword">return</span> { tools: toolList };
    });

    this.<span class="property">server</span>.<span class="function">setRequestHandler</span>(CallToolRequestSchema, <span class="keyword">async</span> (request) => {
      try {
        <span class="keyword">const</span> { name, arguments: args } = request.<span class="property">params</span>;

        <span class="keyword">if</span> (!(name in tools)) {
          throw new <span class="function">McpError</span>(ErrorCode.<span class="property">MethodNotFound</span>, `Unknown tool: ${name}`);
        }

        <span class="keyword">const</span> tool = tools[name as keyof typeof tools];
        <span class="keyword">const</span> validationResult = tool.<span class="property">schema</span>.<span class="function">safeParse</span>(args);
        <span class="keyword">if</span> (!validationResult.<span class="property">success</span>) {
          <span class="keyword">const</span> errorMessages = validationResult.<span class="property">error</span>.<span class="property">issues</span>.<span class="function">map</span>((err) =>
            `${err.<span class="property">path</span>.<span class="function">join</span>(<span class="string">'.'</span>)}: ${err.<span class="property">message</span>}`
          ).<span class="function">join</span>(<span class="string">', '</span>);
          throw new <span class="function">McpError</span>(ErrorCode.<span class="property">InvalidParams</span>, `Invalid parameters: ${errorMessages}`);
        }

        <span class="keyword">return</span> <span class="keyword">await</span> tool.<span class="function">handler</span>(validationResult.<span class="property">data</span> as <span class="type">any</span>);
      } <span class="function">catch</span> (error) {
        <span class="keyword">if</span> (error instanceof McpError) {
          throw error;
        }
        throw new <span class="function">McpError</span>(
          ErrorCode.<span class="property">InternalError</span>,
          `Tool execution failed: ${error instanceof Error ? error.<span class="property">message</span> : <span class="function">String</span>(error)}`
        );
      }
    });
  }

  <span class="keyword">async</span> <span class="function">run</span>() {
    <span class="keyword">const</span> transport = new <span class="function">StdioServerTransport</span>();
    <span class="keyword">await</span> this.<span class="property">server</span>.<span class="function">connect</span>(transport);
    console.<span class="function">error</span>(<span class="string">'Repo Adventure MCP server running on stdio'</span>);
    <span class="keyword">const</span> projectPath = process.<span class="function">cwd</span>();
    console.<span class="function">error</span>(`Pre-generating repomix content <span class="keyword">for</span> project at ${projectPath}...`);
    repoAnalyzer.<span class="function">preGenerate</span>(projectPath);
  }
}</code></pre></div>
<em>⚡ <strong>Real-World Analogy:</strong><br>Imagine this class as the operations control room of a starship. Each handler functions like specialized control panels on the deck—one panel lists available exploratory instruments (tools), while another executes them only when the right inputs (validated parameters) are provided. Every process is tightly safeguarded, akin to strict launch protocols to ensure no harm comes to the ship or crew during interstellar activities.</em></p>
<p><strong>💡 Helpful Hints:</strong>
• Use the MCP&#39;s tools list function strategically to map available operations for future tasks.
• Study the JSON schema integration deeply—it’s essential for understanding how inputs flow from crew members to the MCP system.
• Always validate tool arguments thoroughly to avoid malfunctions on live operations.</p>
<hr>
<p>🌌 Stellar job completing 🚀 Quest 1: Cosmic Tools of the MCP Command Deck—your command skills have ignited like supernovae, setting the course for an epic 9-quest odyssey through the galaxies of mastery! 🌠</p>

        </div>
        
        
      <div class="quest-navigation">
        
        <a href="quest-2.html">Next: 🛰️ Quest 2: Stellar Algorithm Analysis of the Repomix Pipeline →</a>
      </div>
    
    </div>
</body>
</html>