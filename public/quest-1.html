<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Quest 1: The Core Command Deck - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <script>
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">üöÄ Starship Infinity: The Lost Code Chronicles</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1><strong>Quest 1: The Core Command Deck üöÄ</strong></h1>
<hr>
<p>The <em>Starship Infinity</em> approached the fragmented nebula known as &quot;Harbinger&#39;s Veil,&quot; its command deck alive with anticipation. Captain Aelira stood before the main navigation console, her voice steady: ‚ÄúWe have detected the pulse again‚Äîstronger this time. This is our chance to access the first layer of the Lost Code Pulse.‚Äù The crew‚Äôs mission was clear: interface with the ship&#39;s systems, analyze critical files, and extract the encoded coordinates. To find clarity within chaos, they needed to master their tools‚Äîand their understanding of Infinity‚Äôs engines of computation. The anomaly grew closer. ‚ÄúBrace yourselves,‚Äù she commanded, fingers gliding across the controls, ‚Äúactivate the core systems.‚Äù </p>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/mcp-repo-adventure/blob/main/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/server.ts</code></a>: MCP Server Protocol Implementation</h3>
<p>This file serves as the beating heart of the adventure system‚Äôs operational interface aboard the <em>Infinity</em>. It defines and executes the MCP server that handles communications between the user&#39;s commands and the adventure tools. The <code class="inline-code">RepoAdventureServer</code> class is responsible for orchestrating tool registration, executing user requests, and managing error handling. Specifically, its <code class="inline-code">setupHandlers</code> function dynamically registers tools like <code class="inline-code">explore_quest</code> and <code class="inline-code">view_progress</code>, acting as the ship&#39;s intersystem translator, while the <code class="inline-code">run</code> function establishes communications via stdio (the ‚Äúconsole radio‚Äù) and pre-generates analytical data for operations. The file‚Äôs <code class="inline-code">main</code> function ensures graceful shutdowns‚Äîessential for maintaining stability during mission-critical anomalies. </p>
<h4>Highlights</h4>
<ul>
<li>The <code class="inline-code">RepoAdventureServer.setupHandlers</code> function acts as the main conduit for converting MCP requests into tangible outcomes.</li>
<li>The <code class="inline-code">run</code> function showcases proactive pre-generation of repomix content for efficiency in exploration missions.</li>
<li>Advanced error recovery in <code class="inline-code">main</code> ensures operations continue seamlessly without catastrophic failure events.</li>
</ul>
<h3><a href="https://github.com/danwahlin/mcp-repo-adventure/blob/main/src/tools/tools.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/tools.ts</code></a>: MCP Adventure Tools Module</h3>
<p>This file is where the adventure tools come alive, encapsulating the interactive systems used to engage advanced coding quests. It hosts the machinery behind four primary tools: <code class="inline-code">start_adventure</code>, <code class="inline-code">choose_theme</code>, <code class="inline-code">explore_quest</code>, and <code class="inline-code">view_progress</code>. Each of these tools performs specialized tasks, from analyzing the codebase to monitoring quest completion metrics. For instance, the <code class="inline-code">start_adventure</code> handler boots up the system‚Äôs analytical core and aligns the theme, much like initializing the starship‚Äôs primary computer systems for an imminent mission. This file provides the foundation for handling crew inputs and generating clear outputs to enable the quest journey.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">start_adventure.handler</code> initializes starship diagnostics by analyzing repository data.</li>
<li>The <code class="inline-code">explore_quest.handler</code> drives individual adventures, keeping the crew focused on achieving objectives.</li>
<li>The structure allows seamless expansion, making it adaptable for future mission upgrades.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/mcp-repo-adventure/blob/main/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/server.ts</code></a></h3>
<pre><code class="language-typescript">private setupHandlers() {
  this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; {
    const toolList = Object.entries(tools).map(([name, tool]) =&gt; ({
      name,
      description: tool.description,
      inputSchema: zodToJsonSchema(tool.schema, { 
        target: &#39;jsonSchema7&#39;,
        $refStrategy: &#39;none&#39;
      })
    }));

    return { tools: toolList };
  });

  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    try {
      const { name, arguments: args } = request.params;

      if (!(name in tools)) {
        throw new McpError(ErrorCode.MethodNotFound, `Unknown tool: ${name}`);
      }

      const tool = tools[name as keyof typeof tools];
      
      const validationResult = tool.schema.safeParse(args);
      if (!validationResult.success) {
        const errorMessages = validationResult.error.issues.map((err) =&gt; 
          `${err.path.join(&#39;.&#39;)}: ${err.message}`
        ).join(&#39;, &#39;);
        throw new McpError(ErrorCode.InvalidParams, `Invalid parameters: ${errorMessages}`);
      }

      return await tool.handler(validationResult.data as any);

    } catch (error) {
      if (error instanceof McpError) {
        throw error;
      }
      throw new McpError(
        ErrorCode.InternalError,
        `Tool execution failed: ${error instanceof Error ? error.message : String(error)}`
      );
    }
  });
}
</code></pre>
<p>This setup acts like the neural hub of a starship, translating commands into concrete actions while flagging invalid operations before they can disrupt critical systems.</p>
<h3><a href="https://github.com/danwahlin/mcp-repo-adventure/blob/main/src/tools/tools.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/tools.ts</code></a></h3>
<pre><code class="language-typescript">export const tools = {
  start_adventure,
  choose_theme,
  explore_quest,
  view_progress
};
</code></pre>
<p>The tools module serves as the mission toolkit, ensuring that all capabilities are neatly compartmentalized and ready for deployment during high-stakes galactic exploration.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <code class="inline-code">setupHandlers</code> dynamically registers tools; this process is efficient and scalable for expanding system functionality.</li>
<li>Consider diving into how <code class="inline-code">start_adventure</code> and <code class="inline-code">explore_quest</code> interact to link analysis and quest progression.</li>
<li>Next, explore the <code class="inline-code">adventure-manager</code> file to better understand how storylines and progress tracking are tied together in the backend.</li>
</ul>
<hr>
<p>Stellar work, Cadet! You&#39;ve successfully navigated the Core Command Deck‚Äîyour first milestone on this epic cosmic voyage!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="next-quest-btn">Next: üåå Quest 2: The Stellar Story Forge ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/mcp-repo-adventure" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>