<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Ritual of Rendering - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Pyramid of Lost Codes</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Ritual of Rendering</h1>
<hr>
<p>Emerging from the jungle-draped ruins of the Pyramid of Lost Codes, you stand before an ominous entrance carved with cryptic logograms of an ancient civilization. The holographic carvings illustrate the &quot;Ritual of Rendering,&quot; a testament to their mastery over synthesizing digital artifacts into living knowledge. Your task is to awaken dormant mechanisms deep within the pyramid: to rebuild the sacred systems that construct vivid displays of their buried wisdom. Small beams of light from above hint at the labyrinth of encoded treasures that lie ahead. Are you prepared to decipher the first layer of their eternal ritual?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Cache Reliquary</strong>: How does the system use cached templates to reduce redundant operations during rendering?</li>
<li>‚ö° <strong>Render Flow</strong>: What is the step-by-step process of integrating a base template with dynamic content in <code class="inline-code">TemplateEngine</code>?</li>
<li>üõ°Ô∏è <strong>Placeholder Resilience</strong>: How does the template engine ensure placeholders are replaced efficiently without breaking the output?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/template-engine.ts</code></a>: Template rendering and placeholder replacement</h3>
<p>This file encapsulates the &quot;engine&quot; responsible for rendering HTML templates by combining reusable structures (base templates) with dynamic content. It handles placeholder replacement (<code class="inline-code">{{variable}}</code>) and caches templates to improve runtime efficiency. The <code class="inline-code">TemplateEngine</code> is integral to transforming the narrative of each quest into rich, interactive pages.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code> ensures reusable templates are cached for optimal performance and manages retrieval errors gracefully. Without this, every rendering operation would redundantly reload templates from disk, drastically reducing efficiency during quest generation.</li>
<li><code class="inline-code">replacePlaceholders</code> binds placeholders (<code class="inline-code">{{placeholders}}</code>) in the template with actual content. This function&#39;s flexibility ensures that templates are effectively customized without manual HTML editing.</li>
<li><code class="inline-code">renderPage</code> is the crown jewel of the module. It combines content-specific templates with a base HTML layout to produce a complete quest page, ensuring modularity and a consistent layout.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/template-engine.ts</code></a></h3>
<pre><code class="language-typescript">/**
 * Load a template file with caching
 */
private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>This code caches templates using <code class="inline-code">Map</code> to avoid repeatedly reading files from disk. This improves the efficiency of generating multiple quests.</li>
<li>Caching is particularly useful when the same base or content templates are necessary for multiple pages.</li>
<li>If a template file is missing or fails to load, the error management ensures the issue is clearly reported without crashing the entire system.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Replace placeholders in template with variables
 */
private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li>This function efficiently replaces placeholders in a template using a simple key-value mapping, enabling dynamic content injection.</li>
<li>Regular expressions ensure multiple instances of the same placeholder (e.g., <code class="inline-code">{{CONTENT}}</code>) are replaced correctly, and missing variables are substituted with an empty string to avoid display anomalies.</li>
<li>The method is highly modular, allowing for flexible use across different templates and variable sets.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Render a complete page using base template + content template
 */
renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  // First render the content template
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  
  // Then render the base template with the content
  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>This method constructs full HTML pages by stitching a content-specific template into a broader layout defined by the base template.</li>
<li><code class="inline-code">renderPage</code> calls <code class="inline-code">replacePlaceholders</code> twice: first on the content template, then on the base template, to ensure complete and dynamic customization.</li>
<li>Following the &quot;separation of concerns&quot; design principle, it decouples content injection from layout structure, simplifying future template edits.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>If you encounter rendering issues in <code class="inline-code">renderPage</code>, debug by inspecting how <code class="inline-code">replacePlaceholders</code> processes critical placeholders like <code class="inline-code">{{CONTENT}}</code>.</li>
<li>Try modifying a base template to see how it dynamically impacts quest layouts without altering the content templates.</li>
<li>Investigate caching behavior in <code class="inline-code">loadTemplate</code> by rendering the same template multiple times and observing performance.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>With the sacred Ritual of Rendering fulfilled, thou hast unlocked the hallowed path to wisdom&#39;s temple and set the cosmos alight with thy victorious star! ‚≠ê‚ö°üó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>