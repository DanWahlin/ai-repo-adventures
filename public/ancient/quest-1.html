<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Chamber of Ritual Tools - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Codex of Computational Enlightenment</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Chamber of Ritual Tools</h1>
<hr>
<p>In the heart of the jungle&#39;s labyrinth, the Chamber of Ritual Tools beckons brave adventurers to unlock its mysteries. The chamber, flanked by towering obelisks, houses ancient glyphs that whisper the secrets of interactivity and navigation. Hidden within are relics that craft code repositories into enchanting narratives, bridging human creativity with computational logic. To succeed, one must decipher the Chamber&#39;s ancient inscriptions before harnessing its treasures: artifacts that define tools, triggers, and quests for uncovering wisdom buried deep within the Vault of Algorithmia.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Ritual Glyph Mapping</strong>: How does <code class="inline-code">setupHandlers</code> dynamically construct tool behaviors and schemas?</li>
<li>‚ö° <strong>Invocation of Ancient Powers</strong>: What is the flow of <code class="inline-code">run</code> in initializing the server and pre-generating repository content?</li>
<li>üõ°Ô∏è <strong>Safety of Rituals</strong>: How does <code class="inline-code">main</code> handle errors during server lifecycle events to ensure reliability?</li>
</ul>
<h3>Ritual Tools Interface</h3>
<p>The source files below reveal the chamber&#39;s interface for invoking tools and constructing quests:</p>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/server.ts</code></a>: Implements the MCP server for managing tools and narratives.</h3>
<p>This file serves as the primary entry point for the MCP server that powers the thematic storytelling experience. It defines the <code class="inline-code">RepoAdventureServer</code> class, responsible for setting up tools dynamically and managing their execution. By examining its <code class="inline-code">setupHandlers</code> method, we can uncover how tools are defined and validated. The <code class="inline-code">run</code> method gives insight into server flow initialization, while <code class="inline-code">main</code> shows lifecycle management and error handling mechanisms during server operations, highlighting reliability and graceful shutdown strategies.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">RepoAdventureServer.setupHandlers</code>: Handles dynamic tool listing and execution using schemas for validation.</li>
<li><code class="inline-code">RepoAdventureServer.run</code>: Launched the MCP server and pre-generates repository data in the background.</li>
<li><code class="inline-code">main</code>: Coordinates server startup and manages shutdown signals and unhandled exceptions.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/tools.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/tools.ts</code></a>: Defines and exports interactive tools for repository exploration.</h3>
<p>This file orchestrates the magical tools available for adventurers to traverse codebases. The tools are modularized with their handlers‚Äîconnecting ancient computations to modern applications. Studying this file reveals how specific tools like <code class="inline-code">start_adventure</code>, <code class="inline-code">choose_theme</code>, <code class="inline-code">explore_quest</code>, and <code class="inline-code">view_progress</code> are defined and registered for usage. These tools embody the Chamber&#39;s essence, allowing adventurers to interact with codebases as if solving ancient puzzles.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">start_adventure.handler</code>: Begins the repository exploration journey by analyzing codebases and theme selection.</li>
<li><code class="inline-code">choose_theme.handler</code>: Creates tailored adventures and quests based on a selected theme.</li>
<li><code class="inline-code">explore_quest.handler</code>: Uncovers specific quests and their story elements dynamically.</li>
<li><code class="inline-code">view_progress.handler</code>: Displays completion progress, providing clarity for the adventurer‚Äôs path.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/server.ts</code></a></h3>
<pre><code class="language-typescript">private setupHandlers() {
  this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; {
    const toolList = Object.entries(tools).map(([name, tool]) =&gt; ({
      name,
      description: tool.description,
      inputSchema: zodToJsonSchema(tool.schema, { 
        target: &#39;jsonSchema7&#39;,
        $refStrategy: &#39;none&#39;
      })
    }));
    return { tools: toolList };
  });

  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    const { name, arguments: args } = request.params;
    const tool = tools[name as keyof typeof tools];
    const validationResult = tool.schema.safeParse(args);
    if (!validationResult.success) {
      throw new McpError(ErrorCode.InvalidParams, `Invalid parameters: ${validationResult.error.issues.map((err) =&gt; `${err.path.join(&#39;.&#39;)}: ${err.message}`).join(&#39;, &#39;)}`);
    }
    return await tool.handler(validationResult.data as any);
  });
}
</code></pre>
<p>The glyph constructs a map of tools and verifies their invocations, akin to temple engravings guiding ritual practices.</p>
<pre><code class="language-typescript">async run() {
  const transport = new StdioServerTransport();
  await this.server.connect(transport);
  console.error(&#39;Repo Adventure MCP server running on stdio&#39;);
  repoAnalyzer.preGenerate(process.cwd());
}
</code></pre>
<p>This invocation calls forth the jungle&#39;s spirits, preparing the Chamber&#39;s treasures in anticipation of interaction.</p>
<pre><code class="language-typescript">async function main() {
  const server = new RepoAdventureServer();
  [&#39;SIGINT&#39;, &#39;SIGTERM&#39;].forEach(sig =&gt; process.on(sig as NodeJS.Signals, gracefulShutdown));
  process.on(&#39;unhandledRejection&#39;, (reason) =&gt; {
    console.error(&#39;Unhandled promise rejection:&#39;, reason);
  });
  await server.run();
}
</code></pre>
<p>The ritual&#39;s protective wards ensure safe entry into the Chamber, guarding against unforeseen curses.</p>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/tools.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/tools.ts</code></a></h3>
<pre><code class="language-typescript">export const start_adventure = startAdventure;
export const choose_theme = chooseTheme;
export const explore_quest = exploreQuest;
export const view_progress = viewProgress;

export const tools = {
  start_adventure,
  choose_theme,
  explore_quest,
  view_progress
};
</code></pre>
<p>This sequence creates entryways into thematic quests as inscriptions guide adventurous souls through multiple chambers.</p>
<pre><code class="language-typescript">export const start_adventure = startAdventure;
</code></pre>
<p>The first glyph initiates understanding, unlocking wisdom within Algorithmia‚Äôs archives.</p>
<pre><code class="language-typescript">export const choose_theme = chooseTheme;
</code></pre>
<p>This inscription constructs mystical paths tailored to the chosen storyline.</p>
<pre><code class="language-typescript">export const explore_quest = exploreQuest;
</code></pre>
<p>These glyphs descend deeper into hidden narratives, revealing treasures through thematic exploration.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Ensure schemas within <code class="inline-code">setupHandlers</code> remain updated to align with tool handlers.</li>
<li>Use the <code class="inline-code">run</code> method&#39;s initialization logic to pre-cache repomix contents effectively.</li>
<li>Exploring <code class="inline-code">tools.ts</code> reveals deeper context about the modular design of quests.</li>
</ul>
<hr>
<p>The Chamber of Ritual Tools awaits your exploration. Clarity resides in deciphering its glyphs!</p>
<p>By the sacred wisdom of the ancients, thou hast triumphed in reclaiming the hallowed Chamber of Ritual Tools, forging thy path through the temple‚Äôs trials with valor and celestial purpose‚Äîonward to the next quest! ‚≠ê‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>