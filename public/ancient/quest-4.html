<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Temples of Configuration and Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Repository of Wisdom</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Temples of Configuration and Themes</h1>
<hr>
<p>In the heart of the jungle, where time seems frozen within layers of ancient stone, rise the celebrated Temples of Configuration and Themes. These sacred halls, adorned with carvings of arcane symbols, were said to house the secrets that harmonize a quest‚Äîbalancing structure and purpose. Explorers like you, daring and curious, seek the wisdom contained within these temples to unlock the mysteries of efficient design, adaptability, and validation within the mystical framework of adventure creation. Will you decipher their knowledge?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üåü <strong>Temple Alignment</strong>: How does the configuration system ensure quests remain within defined functional bounds, such as timeouts and file size limits?  </li>
<li>üîß <strong>Theme Inscription</strong>: How does the system define and validate themes, mapping user inputs to structured outputs?  </li>
<li>üõ°Ô∏è <strong>Ritual Precision</strong>: What safeguards exist within the validation logic to prevent invalid inputs from disturbing the adventure?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration as a Foundation</h3>
<p>This file serves as the cornerstone of the system, providing essential constants and configurations that shape quest parameters. It defines API settings, timeout limits, cache policies, and file processing constraints, all of which ensure the system operates reliably within its designed bounds. These configurations act as unwavering ordinances, guiding the mechanics behind quests with clarity and foresight.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> sets the maximum time for processing large language model queries, vital for responsive user interactions.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> specifies a size limit for files, preventing inefficiencies and excessive memory consumption.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code> defines directories and files to be excluded during exploration, streamlining processing and maintaining focus.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">// Timeouts in milliseconds
export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts

// Maximum file size to prevent resource exhaustion
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues

// Directory patterns to ignore during scanning
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;.nuxt&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;coverage&#39;,
  &#39;.nyc_output&#39;,
  &#39;logs&#39;,
  &#39;*.log&#39;,
  &#39;.env&#39;,
  &#39;.DS_Store&#39;,
  &#39;Thumbs.db&#39;,
] as const;
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> ensures large prompts do not overwhelm the system by capping request durations to 60 seconds.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> prevents inefficient memory usage by skipping files larger than 10MB, encouraging focus on source code.  </li>
<li><code class="inline-code">IGNORE_PATTERNS</code> helps maintain smooth processing by excluding irrelevant or noisy directories like <code class="inline-code">node_modules</code>.  </li>
<li>These safeguards collectively enhance processing efficiency and maintain resource stability.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Ancient Knowledge of Themes</h3>
<p>Thematic integrity forms the foundation of the adventure‚Äîfacilitated by the careful design within this file. It acts as the master codex of themes, registering their metadata, validation, and mapping logic. Here, the mystical power of themes organizes user intentions into a structured journey.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> provides a comprehensive catalog of pre-defined adventure themes, including identifiers, keywords, and descriptions.  </li>
<li><code class="inline-code">getAllThemes</code> generates an accessible list of all defined themes, centralizing options for navigation and clarity.  </li>
<li><code class="inline-code">parseTheme</code> interprets user input, mapping keywords and identifiers to specific themes for seamless integration.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
} as const;

// Extract the theme type from the keys
export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}

// Simple theme parser using basic string matching
export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>The <code class="inline-code">THEMES</code> object serves as the canonical data source for adventure themes, ensuring consistent descriptions and keywords.  </li>
<li><code class="inline-code">getAllThemes</code> simplifies the retrieval of theme data, promoting reusability across the adventure system.  </li>
<li><code class="inline-code">parseTheme</code> interprets a variety of input formats, improving accessibility for adventurers exploring thematic options.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> The Gatekeeper of Precision</h3>
<p>As the temple&#39;s unmatched guardian, this file ensures inputs meet strict criteria before proceeding further. These functions prevent disruption by validating user choices for themes or paths, providing a flawless ritual experience.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code> accepts user inputs, normalizes them, validates against known themes, and handles errors gracefully.  </li>
<li><code class="inline-code">validateProjectPath</code> enforces path constraints, such as length limits and valid character sets.  </li>
<li><code class="inline-code">sanitizeForDisplay</code> strips potentially unsafe characters from user input, ensuring a clean display format.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><code class="inline-code">validateTheme</code> ensures user inputs align with known options, throwing descriptive errors for invalid themes.  </li>
<li><code class="inline-code">validateProjectPath</code> guarantees safe, well-formatted paths by limiting length and excluding null characters.  </li>
<li><code class="inline-code">sanitizeForDisplay</code> cleanses inputs for harmless display, minimizing potential security risks and improving presentation.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Familiarize yourself with <code class="inline-code">parseTheme</code> to understand input normalization and mapping.  </li>
<li>Compare the robustness of <code class="inline-code">validateTheme</code> and <code class="inline-code">validateProjectPath</code> to identify reusable validation patterns.  </li>
<li>Observe how configuration constants like <code class="inline-code">IGNORE_PATTERNS</code> influence overarching system behavior.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>With sacred wisdom unveiled and the Temples of Configuration conquered, thou art a seeker of triumph now three-fifths ascended upon the path of luminous mastery‚Äîforge onward with divine fervor! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>