<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Tomes of Configuration and Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codebase Chronicles: Secrets of the Lost Repository</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Tomes of Configuration and Themes</h1>
<hr>
<p>Through the crumbling pathways of Codexia, you venture deeper into the ancient Repository. Here, hidden within dusty archives and mechanical ruins, lie the Tomes of Configuration and Themes. These hallowed pages once dictated the flow of every adventure, shaping the wisdom of explorers and the settings of their trials. Yet, much of this knowledge is fragmented. By studying these tomes, you aim to recover the rules of thematic design and the configuration machinations that once powered Codexia&#39;s adventures.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Key Discovery</strong>: What structure and logic dictate how the ancient Repository defines and retrieves adventure themes?</li>
<li>‚ö° <strong>Configuration Rituals</strong>: How does the system manage and utilize configurations, such as timeouts and cache policies, to maintain stability?</li>
<li>üõ°Ô∏è <strong>Entrance Validation</strong>: What safeguards ensure incoming user choices, themes, or paths are accepted or rejected properly?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Input validation for user choices</h3>
<p>This file offers tools to validate explorers&#39; offerings before accessing the Repository. It ensures that adventurers provide valid themes, paths, and selections. Designed as a gatekeeper, this module sanitizes input to preserve the safety and integrity of operations.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Ensures that a theme choice aligns with the available options.</li>
<li><code class="inline-code">validateAdventureChoice</code>: Confirms the validity of user-provided adventure choices with length and character checks.</li>
<li><code class="inline-code">validateProjectPath</code>: Supervises the correctness of repository paths, rejecting unsafe values.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Central definition of themes</h3>
<p>This file contains Codexia‚Äôs thematic definitions. From cosmic journeys to ancient ruins, these themes are designed as gateways into unique explorations. The module also includes logic for theme parsing, validation, and user keyword matching through its repository treasures.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A catalog of all available adventure themes with details like names, descriptions, and keywords.</li>
<li><code class="inline-code">parseTheme</code>: A decoding mechanism for user input to align with a valid theme using keywords, exact matches, or IDs.</li>
<li><code class="inline-code">getFormattedThemeOptions</code>: Formats all themes into a presentable list for adventurers making their selection.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Repository configuration and constants</h3>
<p>Housed here are the foundational rules governing the Repository‚Äôs behavior, such as timeouts, error handling, and limits. These parameters ensure Codexia operates efficiently and securely, enabling seamless interaction with the Repository‚Äôs mechanisms.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines how long the system will wait for lore generation tasks before failing.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Restricts file size for analysis to optimize memory usage.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Specifies how long content remains cached for rapid re-use.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Ensures that user-selected themes match a recognized adventure theme.</li>
<li>Uses normalization for case-insensitivity, improving user experience.</li>
<li>Calls <code class="inline-code">isValidTheme</code> to validate the parsed data against the sacred thematic catalog.</li>
<li>Provides descriptive error messages to guide the adventurer.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Ensures user input is not empty and within a reasonable length.</li>
<li>Trims extraneous whitespace to prevent accidental validation failures.</li>
<li>Throws clear, actionable errors for user guidance.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Defaults to the current working directory if no path is provided.</li>
<li>Protects system integrity by blocking unsafe input like null characters.</li>
<li>Includes logical size limits to avoid excessive or malformed paths.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  ...
};
</code></pre>
<ul>
<li>Defines all themes with attributes like <code class="inline-code">id</code>, <code class="inline-code">description</code>, and connected keywords.</li>
<li>Protects emotional immersion by retaining theme consistency across the adventure.</li>
<li>Includes emojis to visually differentiate options.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Translates user input into a resolvable theme key using normalization techniques.</li>
<li>Supports multiple pathways for validation, including exact match, numeric ID, or keyword match.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getFormattedThemeOptions(): string {
  return getAllThemes()
    .sort((a, b) =&gt; a.id - b.id)
    .map(formatThemeOption)
    .join(&#39;\n&#39;);
}
</code></pre>
<ul>
<li>Formats themes cleanly for user selection, combining emoji, names, and descriptions.</li>
<li>Ensures themes are presented in a consistent and legible order.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>Configures upper bounds for request duration and caching policies.</li>
<li>Enforces size limits on file processing to maintain performance.</li>
<li>Includes environment variable overrides for flexible customization.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how themes are parsed and validated to create seamless, secure user interactions.</li>
<li>Examine how universal constants, like <code class="inline-code">LLM_REQUEST_TIMEOUT</code>, enhance stability and mitigate risks during execution.</li>
<li>Compare how validation functions support modularity and reusability across the adventure system.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Hail, seeker of sacred wisdom, for thou hast unearthed the hallowed Tomes of Configuration and Themes; thy journey ascends with triumphant purpose, now guided by celestial brilliance toward the completion of thy noble odyssey! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>