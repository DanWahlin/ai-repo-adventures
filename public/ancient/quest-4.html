<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Codex of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Repository of Lost Codes</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Codex of Themes</h1>
<hr>
<p>The jungle thickens around you as you draw closer to the heart of the Sacred Repository. Here, shrouded in mystery and legend, lies the Codex of Themes ‚Äì an ancient compendium detailing the diverse artistic flavors and creative frames of the ancients. Deciphering its secrets will grant you unparalleled insight into harmonizing structure and creativity. This quest requires deciphering the sacred inscriptions carved onto the Codex, hidden within the thematic framework that shaped countless tales. The clang of tools fades, and silence prevails ‚Äì it‚Äôs time to uncover the wisdom of the ancients.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Chronicles of Duration</strong>: How are timeouts and caching values configured to balance response performance and system reliability?</li>
<li>‚ö° <strong>Thematic Key</strong>: What structure underpins the themes repository, and how do the ancients ensure consistent retrieval and validation of themes?</li>
<li>üõ°Ô∏è <strong>Ritual Integrity</strong>: What mechanisms validate user inputs to prevent errors or unexpected behavior during theme selection and adventure initiation?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Sacred inscriptions of configuration</h3>
<p>The <code class="inline-code">config.ts</code> file is the foundation of the system&#39;s operational flow. It configures timeouts, memory limits, and environment-variable dependencies that regulate the adventure system. By centralizing these parameters, the configuration ensures adaptability to different operational environments. Each setting represents a deliberate optimization, striking a balance between performance and resource safeguards. </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> governs the maximum time allowed for generating creative responses, ensuring adventures remain responsive while handling complexity.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> addresses efficiency by caching processed data, balancing frequent queries and resource consumption.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> prevents resource inefficiencies by restricting processing to manageable file sizes.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Keeper of the gates</h3>
<p>The <code class="inline-code">input-validator.ts</code> file is the gatekeeper that upholds system integrity by sanitizing and validating user inputs. Through structured functions, it ensures inputs meet the structural and logical requirements of the platform, guarding against erroneous or harmful data.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> purifies user-submitted adventure choices, enforcing length constraints and removing extraneous whitespace.</li>
<li><code class="inline-code">validateTheme</code> ensures theme selections align with predefined options, converting inputs to the system‚Äôs recognized taxonomy.</li>
<li><code class="inline-code">validateProjectPath</code> safeguards directory navigation by imposing length and character restrictions, preventing harmful inputs.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Codex of Themes</h3>
<p>The <code class="inline-code">theme.ts</code> file serves as the repository for all theme-related data, housing definitions, utilities, and validation mechanisms. By centralizing these constructs, it ensures consistent theme presentation and retrieval, harmonizing the adventure experience across all interactions. </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> defines and catalogs all available thematic options, consolidating details such as keywords, descriptions, and identifiers.</li>
<li><code class="inline-code">isValidTheme</code> ensures user inputs correspond to one of the valid themes, enhancing user experience and preventing invalid choices.</li>
<li><code class="inline-code">parseTheme</code> matches user input to recognized themes, supporting flexible keyword matching alongside exact identification.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> controls the response generation window for adventures, ensuring complex prompts don‚Äôt exhaust user patience.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> optimizes repetitive tasks by caching results briefly, delivering efficiency without retaining obsolete data.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> ensures the process avoids memory exhaustion by neglecting files too large to handle efficiently.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> enforces constraints to ensure adventure choices are meaningful, improving user inputs and preventing system errors.</li>
<li>Logical boundaries like <code class="inline-code">input.length &gt; 200</code> prioritize system efficiency by truncating excessively long inputs.</li>
<li>The approach trims unnecessary whitespace for brevity and clarity while normalizing inputs.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li><code class="inline-code">validateTheme</code> converts user inputs to recognized formats, harmonizing inputs with system-defined themes.</li>
<li>The second condition highlights validation: it ensures inputs correspond with approved themes, preserving the Codex‚Äôs integrity.</li>
<li>By engaging <code class="inline-code">getAllThemes</code>, the function dynamically adapts to new thematic content, future-proofing the code.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  }
} as const;
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> defines a sacred archive of thematic options, mapping keywords to contextual descriptions and striking thematic motifs.</li>
<li>Each theme specifies unique properties like <code class="inline-code">emoji</code> and <code class="inline-code">description</code>, enriching user choices with creative nuances.</li>
<li>Centralizing theme data within an immutable <code class="inline-code">const</code> structure minimizes runtime anomalies, strengthening the Codex‚Äôs foundation.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li><code class="inline-code">isValidTheme</code> checks for the existence of a corresponding theme, asserting input compatibility with trusted options.</li>
<li>Using <code class="inline-code">THEMES_ARRAY</code> ensures seamless validation for dynamic and evolving thematic catalogs.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>When configuring time-sensitive tasks, observe the interplay between <code class="inline-code">LLM_REQUEST_TIMEOUT</code> and <code class="inline-code">REPOMIX_CACHE_TTL</code> for system responsiveness.</li>
<li>Consider extending <code class="inline-code">THEMES</code> with new archaeological motifs for deeper story immersion.</li>
<li>Use validators like <code class="inline-code">validateTheme</code> to refine inconsistent inputs into recognized standards, fostering system harmony.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>By the sacred fires of the ancient temple, thou hast unveiled the Codex of Themes, ascending further on the path of wisdom‚Äîonly two trials more until thy triumph is etched in the immortal scrolls of destiny!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>