<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Glyphs of Configuration - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Codex of Computational Wisdom</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Glyphs of Configuration</h1>
<hr>
<p>Through the dense jungle foliage, you unearth a buried chamber. The air hums faintly with arcane energy, carrying the scent of earth and ancient stone. At your feet lies a pedestal engraved with <strong>Glyphs of Configuration</strong>, shimmering faintly with the light of forgotten wisdom. You realize these glyphs hold the keys to shaping adventures, bending complex systems to your will. But their inscriptions are guarded by cryptic mechanisms. To wield their power, you must decode the interplay of themes and configurations hidden in the Codex.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Keystone Triggers</strong>: How is timeout behavior managed across different settings, and why might it be customized for various scenarios?</li>
<li>‚ö° <strong>Configuration Gateway</strong>: In what ways does the code ensure that vital inputs like themes and paths are validated before proceeding further?</li>
<li>üõ°Ô∏è <strong>Runic Completeness</strong>: How does the theme system ensure coherence and consistency across supported adventure settings?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Glyphs of the Repository</h3>
<p>The <code class="inline-code">config.ts</code> file establishes critical constants and settings for managing the infrastructure of the system. Acting as the foundation, it translates environment variables into actionable configuration values, defines timeout limits, and sets essential parameters for controlling processing resources. This file is essential for maintaining balance between performance, error prevention, and resource management.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Configures the maximum time permitted for generating immersive adventures.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Defines the lifespan of cached data for reusability and efficiency.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Sets limits to prevent processing excessively large files, avoiding performance degradation.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>The <code class="inline-code">LLM_REQUEST_TIMEOUT</code> aids in regulating execution to prevent delays during adventure crafting.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> allows flexibility by enabling configuration via environment variables, ensuring responsiveness.</li>
<li>Setting <code class="inline-code">MAX_FILE_SIZE_MB</code> emphasizes the importance of managing assets carefully for an optimized experience.</li>
</ul>
<hr>
<h4><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Safeguarding Rituals of Input</h4>
<p>This file ensures all provided inputs are sanitized and conform to strict rules before execution. It minimizes the risk of errors and vulnerabilities by performing key checks, such as validating adventure choices and project paths.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures meaningful and valid selections for adventures.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Protects outputs by removing damaging characters and restricting their length.</li>
<li><code class="inline-code">validateTheme</code>: Cross-verifies themes to ensure they match existing configuration standards.</li>
</ul>
<h3>Code</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }

  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }

  return input.trim();
}
</code></pre>
<ul>
<li>Ensures selected adventures are provided, sanitized, and formatted appropriately.</li>
<li>Prevents excessively long or empty inputs that could disrupt workflows.</li>
<li>Highlights the importance of trimming and validating strings effectively.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;

  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Sanitizes output to eliminate potentially harmful characters such as <code class="inline-code">&lt;</code> or <code class="inline-code">&quot;</code>.</li>
<li>Applies truncation (<code class="inline-code">slice</code>) to maintain legibility and safety for display outputs.</li>
<li>Demonstrates attention to user-facing details for clarity and security.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }

  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);

  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }

  return parsedTheme;
}
</code></pre>
<ul>
<li>Guarantees that only valid themes from <code class="inline-code">getAllThemes</code> are selected.</li>
<li>Converts and normalizes input for flexible handling of capitalization and extra spaces.</li>
<li>Uses error messages to enhance user guidance when invalid data is provided.</li>
</ul>
<hr>
<h4><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Thematic Pillars of Configuration</h4>
<p>This file defines the structure of adventure themes and provides tools for interacting with these definitions. By centralizing theme-related logic, it ensures consistency and simplifies expansions or modifications.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getAllThemes</code>: Retrieves a list of supported themes, ensuring canonical references.</li>
<li><code class="inline-code">isValidTheme</code>: Confirms the legitimacy of a theme through strict type checking.</li>
<li><code class="inline-code">formatThemeOption</code>: Prepares theme details for use in outputs like user prompts.</li>
</ul>
<h3>Code</h3>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li>Provides a simple, centralized method for accessing all available themes.</li>
<li>Maintains immutability by relying on predefined constants (<code class="inline-code">THEMES_ARRAY</code>).</li>
<li>Essential for ensuring theme availability in other modules.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>Implements type guard logic to confirm whether a given theme exists.</li>
<li>Relies on iteration through canonical <code class="inline-code">THEMES_ARRAY</code> for accuracy.</li>
<li>Protects the system from encountering invalid or unsupported themes.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatThemeOption(theme: ThemeDefinition): string {
  return `${theme.emoji} **${theme.id}. ${theme.displayName}** - ${theme.description}`;
}
</code></pre>
<ul>
<li>Constructs visually pleasing and informative representations of themes.</li>
<li>Combines identifiers, emojis, and descriptions for user clarity.</li>
<li>Leverages formatted outputs to simplify selection during interactions.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>To modify timeout values dynamically, adjust corresponding environment variables like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> via <code class="inline-code">.env</code> files.</li>
<li>Pay close attention to how <code class="inline-code">sanitizeForDisplay</code> handles potentially unsafe characters for secure, user-friendly outputs.</li>
<li>Study the <code class="inline-code">formatThemeOption</code> behavior to understand how artifacts like descriptions are assembled for enriched feedback.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Sacred Codex. The final challenge awaits, adventurer.</p>
<p>Hark, seeker of wisdom, thou hast unveiled the sacred Glyphs of Configuration, a triumph etched in the scrolls of eternity‚Äîthy journey emboldens the cosmic tapestry of knowledge; press on, for the Temple of Mastery awaits thy glorious return! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>