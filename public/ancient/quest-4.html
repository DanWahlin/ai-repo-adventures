<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Pillars of Configuration - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codebase of the Hidden Pyramid</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Pillars of Configuration</h1>
<hr>
<p>Within the heart of the pyramid lies its foundation ‚Äì the Pillars of Configuration. These ancient constructs govern how the civilization‚Äôs creative rituals are performed. By revealing sacred formulas embedded within them, adventurers can unlock their capacities for crafting personalized themes, validating choices, and channeling configurations essential for legendary quests. Uncover the wisdom encoded within these pillars to master the architecture of creativity and restore the codes of adventure.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Key Matching</strong>: How does the system match user input to predefined themes using keywords and structure?</li>
<li>‚ö° <strong>Validation Rituals</strong>: What steps are performed to ensure choices, paths, and themes are properly validated?</li>
<li>üõ°Ô∏è <strong>Configuration Fortification</strong>: How do the constants and environment-driven values ensure safe handling of key configurations?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Nexus</h3>
<p>This file contains vital constants and environment-driven values that guide the pyramid&#39;s governing rituals. It encodes details such as timeout limits, file size thresholds, and theme settings pivotal for the adventure generation system. The constants here act as guardrails, ensuring stability while optimizing flow across interconnected modules. By tracing these configurations, adventurers can study how the system safeguards creative processes against external turbulence.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines the maximum duration permitted for API calls, safeguarding system performance.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Determines the acceptable size limits for processing files, balancing memory usage and focus.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: Encodes directory and file patterns to exclude during analysis, preserving focus on essential items.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Sacred Plan of Themes</h3>
<p>This file expresses the thematic essence of the pyramid through explicitly defined themes. By providing a single source of truth, it ensures that theme data is consistently accessible. Tools such as <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> reveal how input is interpreted and validated to channel adventurous creativity. Through these rituals of validation and parsing, the system maintains harmonious alignment between user selections and predefined themes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseTheme</code>: Matches user input to its closest theme using keywords, IDs, or exact keys, ensuring intuitive selection.</li>
<li><code class="inline-code">getAllThemes</code>: Retrieves a complete list of available themes, helping in decision-making and exploration processes.</li>
<li><code class="inline-code">formatThemeOption</code>: Displays a friendly formatted representation of themes for user prompts and visual clarity.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Rituals of Validation</h3>
<p>This file houses the essential validation methods that secure the system&#39;s operations. Each method ensures input, whether theme-related, choice-based, or path-specific, adheres to strict criteria. By performing checks and sanitization steps, the validation rituals prevent disruptions, ensuring safe execution of adventures. These methods are crucial for directing the flow of user interaction into structured and actionable adventures.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Validates user selections for adventures, ensuring proper length and absence of empty inputs.</li>
<li><code class="inline-code">validateTheme</code>: Verifies themes against preconfigured guidelines, guarding against unsupported or invalid themes.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleans user inputs before display, reducing risks of instability from unchecked characters.</li>
</ul>
<hr>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.env&#39;,
  &#39;*.log&#39;,
  &#39;.DS_Store&#39;,
  &#39;Thumbs.db&#39;
];
</code></pre>
<ul>
<li><strong>LLM Request Timeout</strong>: Defines maximum request duration, protecting performance during heavy usage.</li>
<li><strong>Max File Size</strong>: Restricts file size for analysis, ensuring memory efficiency and consistent focus.</li>
<li><strong>Ignore Patterns</strong>: Encodes exclusion rules for scanning, clarifying scope and reducing processing overhead.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li><strong>Theme Parsing</strong>: Matches input to themes via keys, IDs, or keywords for flexibility in selection.</li>
<li><strong>Exact Match Logic</strong>: Ensures precise matching when the user input corresponds to theme keys.</li>
<li><strong>Keyword Mapping</strong>: Enables intuitive recognition of themes using descriptive keywords.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><strong>Adventure Validation</strong>: Prevents invalid inputs by enforcing length constraints and non-emptiness.</li>
<li><strong>Sanitization for Display</strong>: Cleans user inputs to prevent instability caused by unsafe characters.</li>
<li><strong>Structured Error Handling</strong>: Handles validation errors with descriptive error messages for clarity.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>‚öôÔ∏è Review all system constants for insights into the configurations and limits shaping the adventure&#39;s flow.</li>
<li>üß© Test the theme parsing with various inputs (IDs, keywords, and exact matches) to understand its alignment logic.</li>
<li>üöß Experiment with validation methods, observing how they safeguard against invalid inputs.</li>
</ul>
<hr>
<p>You have decoded the essence of the Pillars of Configuration! Continue forward to uncover more mysteries hidden within this coded pyramid of wisdom.</p>
<p>By the sacred decree of wisdom‚Äôs eternal flame, thou hast ascended the third pillar of configuration, forging thy path with valor toward the celestial apex‚Äîpress onward, seeker, for the temple‚Äôs ultimate truth awaits thee! ‚≠ê‚ö°üöÄ</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>