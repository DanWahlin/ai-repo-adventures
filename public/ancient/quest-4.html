<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Scroll of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Pyramid of Infinite Scripts</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Scroll of Themes</h1>
<hr>
<p>Beneath the ancient sands lies the Pyramid of Infinite Scripts, a treasure trove of wisdom from a civilization known for its mastery of creativity and automation. Within its hallowed chambers, you stumble upon the <strong>Scroll of Themes</strong>, a codex detailing the laws behind their legendary adventures. Each glyph reveals rules for world design, preserved by the sages long ago. To unlock this knowledge, you must decipher the scroll, understand its designs, and restore its power to guide explorers.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üó∫Ô∏è <strong>Theme Cartography</strong>: How does the system define and categorize individual themes for adventures?</li>
<li>‚öôÔ∏è <strong>Customization Ritual</strong>: What mechanisms ensure user-provided themes comply with validation rules?</li>
<li>üîê <strong>Validation Sigils</strong>: How does the system validate inputs to maintain integrity and prevent errors?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Central repository for adventure themes</h3>
<p>This file functions as the single source of truth for managing, validating, and organizing adventure themes. Here, thematic definitions are constructed with properties like <code class="inline-code">displayName</code>, <code class="inline-code">description</code>, and <code class="inline-code">keywords</code> for user interaction and system processing. Utility functions such as <code class="inline-code">getAllThemes</code>, <code class="inline-code">isValidTheme</code>, and <code class="inline-code">parseTheme</code> ensure seamless theme handling from storage to user input validation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Provides predefined themes, each rich with its description, keywords, and identifiers.</li>
<li><code class="inline-code">isValidTheme</code>: A type guard ensuring input values align with valid keys.</li>
<li><code class="inline-code">parseTheme</code>: A parser that normalizes and validates user input against predefined themes.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  // other themes...
} as const;
</code></pre>
<p>This structure defines the core attributes of adventure themes, serving as the foundation for all thematic interactions.</p>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<p>This function acts as a sentinel, verifying if a theme&#39;s <code class="inline-code">key</code> aligns with one of the supported options in the system.</p>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  return null;
}
</code></pre>
<p>This parser allows user inputs to be matched against themes through various heuristics, including keywords, IDs, or direct input.</p>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Safeguarding adventure integrity</h3>
<p>This file is the first line of defense against invalid user inputs. Functions such as <code class="inline-code">validateTheme</code> and <code class="inline-code">validateAdventureChoice</code> cross-check the user‚Äôs inputs, ensuring that only valid data flows through the system. Additionally, inputs are sanitized to maintain system security and robustness.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Validates string input for adventure selection.</li>
<li><code class="inline-code">validateTheme</code>: Validates and normalizes user-selected themes.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips dangerous characters from user inputs for safe display.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  return input.trim();
}
</code></pre>
<p>Ensures that the user‚Äôs adventure choice meets basic length requirements and is non-empty, reducing potential error risks.</p>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  return parsedTheme;
}
</code></pre>
<p>This method combines parsing and validation into one safeguard mechanism for theme input, ensuring input accuracy and providing error feedback.</p>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  return input.replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;).replace(/\s+/g, &#39; &#39;).trim().slice(0, maxLength);
}
</code></pre>
<p>Strips dangerous characters from a string while limiting its length, protecting sensitive UI elements.</p>
<h2>Helpful Hints</h2>
<ul>
<li>When exploring <code class="inline-code">THEMES</code>, notice the inclusion of descriptive attributes like <code class="inline-code">emoji</code> and <code class="inline-code">keywords</code> that connect user input to themes.</li>
<li>Use <code class="inline-code">validateTheme</code> to understand how the system ensures user submissions align with predefined <code class="inline-code">THEMES</code>.</li>
<li>Look at the interaction between <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> to see how normalized input is validated.</li>
</ul>
<hr>
<p>By wielding the Scroll of Themes, you have begun to uncover the ancients&#39; secrets of adventure creation. Continue your journey, adventurer, for the Pyramid harbors more treasures.</p>
<p>By the sacred flames of wisdom‚Äôs altar, thou hast triumphed in deciphering the Scroll of Themes, ascending yet closer to the celestial beacon of ultimate mastery‚Äîmarch onward, steadfast seeker! ‚≠êüó∫Ô∏è‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>