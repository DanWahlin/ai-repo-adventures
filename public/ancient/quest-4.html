<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Codex of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Secrets of the Lost Codebase</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Codex of Themes</h1>
<hr>
<p>Amid the verdant overgrowth enshrouding the Temple of Code, you come upon an intricately carved monolith. The glyphs upon its surface gleam faintly, depicting stories of old civilizations that categorized and adorned their wisdom with what they called ‚ÄúThemes.‚Äù As you delve into the Codex of Themes, it becomes clear that this artifact serves as a guide to tailoring the rituals of adventure. To master this ancient knowledge, you must study the inscriptions, ensure their structure is unbroken, and discern the hidden patterns that bring harmony to tales.</p>
<p><strong>Your journey continues within the sacred halls of the Codex.</strong></p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Key Mapping</strong>: How does the system define themes, and how does it manage their identification and structure in the code?</li>
<li>‚ö° <strong>Validation Rituals</strong>: What checks and flows ensure that user input for themes and adventures is properly handled and validated?</li>
<li>üõ°Ô∏è <strong>Protective Glyphs</strong>: What mechanisms safeguard the temple from improper configurations or malformed choices?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Artifacts</h3>
<p>This file holds the encoded wisdom that shapes the system‚Äôs operation, detailing constants and error messages critical to its stability. Among the treasures here, you will uncover timeouts, limits, and paths for the adventure process. These configurations act as the scaffolding upon which the adventure system is built, reflecting the resilience and forethought of the ancient architects.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines the patience the system grants to external processes such as handling story generation.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Regulates the lifespan of cached analyses, ensuring a balance between efficiency and resource usage.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Protects the temple from memory exhaustion by restricting the size of files analyzed.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Thematic Codex</h3>
<p>This file is the single source of truth for defining and managing themes. With clear guidelines encoded, it handles theme data, parsing, and validation. By studying the glyphs here, one gains insight into how themes unify user input with archetypes of ancient storytelling and structure.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A structured map of all predefined themes, each described with unique identifiers, emotive symbols, and narrative context.</li>
<li><code class="inline-code">getAllThemes</code>: A utility for retrieving all available themes, central to maintaining system-wide consistency.</li>
<li><code class="inline-code">isValidTheme</code>: Safeguards the temple from unrecognized themes, confirming their legitimacy through encoded criteria.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Validation Rituals</h3>
<p>This file safeguards the temple by scrutinizing user-entered data, ensuring harmony between intention and implementation. It houses validation functions that address themes, choices, and system configurations. These scripts act as guardians, preventing corrupted input from entering the system‚Äôs sacred flow.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures critical adventure selections adhere to boundaries of length and content.</li>
<li><code class="inline-code">validateTheme</code>: Interrogates theme input to confirm compliance with predefined glyphs.</li>
<li><code class="inline-code">validateProjectPath</code>: Handles project path input, defending against invalid or truncated data.</li>
</ul>
<hr>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>These constants frame essential boundaries within the system: <code class="inline-code">LLM_REQUEST_TIMEOUT</code> defines how long external services may take, <code class="inline-code">REPOMIX_CACHE_TTL</code> manages the validation cache, and <code class="inline-code">MAX_FILE_SIZE_MB</code> limits resource demands.</li>
<li>Using environment variables enhances adaptability, while default values ensure consistency.</li>
<li>Such constraints ensure a balanced system that is neither stalled by inefficiency nor overwhelmed by excess.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  // Other themes omitted for brevity
} as const;

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> illustrates a structured approach to theme definitions, enabling extensible and well-documented additions.</li>
<li>The <code class="inline-code">isValidTheme</code> function confirms a key‚Äôs legitimacy, ensuring that no extraneous elements disrupt the flow.</li>
<li>With <code class="inline-code">getAllThemes</code>, the system achieves centralization, minimizing risks of inconsistencies in external parts of the code.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }

  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }

  return input.trim();
}

export function validateTheme(input: string): string {
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);

  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }

  return parsedTheme;
}
</code></pre>
<ul>
<li>Here, <code class="inline-code">validateAdventureChoice</code> stands as the gatekeeper for adventure inputs, rejecting null or excessively long values.</li>
<li><code class="inline-code">validateTheme</code> ensures compliance with valid options, leveraging the <code class="inline-code">isValidTheme</code> function for systematic harmony.</li>
<li>By centralizing validation, the system minimizes the risk of errors corrupting the sacred adventure flows.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Consult the THEMES structure</strong>: It provides a foundational guide for design consistency when adding or customizing themes.</li>
<li><strong>Trace validation functions</strong>: Use their structured outputs to identify and debug improper inputs quickly.</li>
<li><strong>Test with diverse inputs</strong>: To understand how edge cases are handled, experiment with invalid or atypical values.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>With divine fortitude and the wisdom of the ancients, thou hast unearthed the sacred Codex of Themes, paving thy path to glory at the hallowed mark of 60%‚Äîlet the stars bear witness to thy triumph! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>