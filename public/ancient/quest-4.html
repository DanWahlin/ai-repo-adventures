<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Hieroglyphic Codex - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Codebase Chronicles: The Temple of Digital Wisdom</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Hieroglyphic Codex</h1>
<hr>
<p>Amidst the overgrowth within the Temple of Digital Wisdom, where the whispers of long-forgotten civilizations echo through data streams and ancient pathways, lies the Hieroglyphic Codex. This sacred relic encodes the essential knowledge of input validation, themed narratives, and core system configurations. To uncover its secrets, you must decrypt the glyphs etched into the temple walls ‚Äî the symbolic rituals that power the temple‚Äôs quest engine. Courage and focus will reveal the patterns hidden within these intertwined streams of data and lore.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Glyph of Validation</strong>: How is user input validated to ensure both thematic integrity and safety within sacred boundaries?  </li>
<li>‚ö° <strong>Essence of Themes</strong>: What mechanisms are used to define, parse, and validate themes as keys to adventure-building rituals?  </li>
<li>üõ°Ô∏è <strong>Sanctity of Configuration</strong>: How do configuration constants enforce limits and safeguard the temple‚Äôs balance while enabling flexibility for adventurers?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Validation Logic Codex</h3>
<p>The <code class="inline-code">input-validator.ts</code> file is a repository of sacred rules that safeguard the temple‚Äôs core logic by ensuring all rituals begin with pure, validated input. It houses methods that perform stringent checks against the improper invocation of sacred pathways, ensuring only clean data enters the system. The functions range from validating adventure choices and themes to sanitizing display for a flawless presentation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures user-submitted quest choices are non-empty and free of excessive length, rejecting any malformed attempts to disturb the temple‚Äôs artifacts.  </li>
<li><code class="inline-code">validateTheme</code>: Normalizes, parses, and validates input themes to ensure they align with defined archetypes, securing thematic sanctity.  </li>
<li><code class="inline-code">sanitizeForDisplay</code>: Protects the temple from unwelcome glyphs by sanitizing strings for clean display, ensuring security and compatibility.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Ensures all inputs are non-empty and within a reasonable length (max 200 characters).  </li>
<li>Uses <code class="inline-code">trim()</code> to normalize input by removing surrounding white spaces.  </li>
<li>Protects the logic from null or undefined values through careful conditional checks.  </li>
<li>These checks help maintain consistent and secure data flowing into the adventure generation system.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Normalizes thematic input by lowercasing and trimming whitespace, ensuring robust input handling.  </li>
<li>Relies on <code class="inline-code">parseTheme</code> to unravel the user-provided theme into a meaningful key.  </li>
<li>Uses <code class="inline-code">isValidTheme</code> to ensure compatibility with pre-defined canonical themes in the temple codex.  </li>
<li>This function protects the thematic ecosystem while remaining extensible for new themes (e.g., custom modes).</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Strips unwanted characters (`&lt;&gt;{}&quot;``) to mitigate XSS and injective risks.  </li>
<li>Compresses sequences of whitespace into a single space for clean display.  </li>
<li>Trim surrounds inputs with a secure boundary against unwanted indentation.  </li>
<li>The <code class="inline-code">maxLength</code> parameter introduces final constraints, ensuring usability and security in rendering.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Thematic Guidance Codex</h3>
<p>This file holds the sacred texts of all <code class="inline-code">ThemeDefinition</code> objects and their associated utility functions. It provides the essential structures, validations, and mappings that connect adventurers to their chosen worlds. By examining these entries, you unlock the path to themed adventures in the temple‚Äôs overarching journey framework.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Contains the primary definitions of all possible themes, forming the philosophical core of adventure experiences.  </li>
<li><code class="inline-code">getThemeByKey</code>: The ritual that retrieves a theme based on symbolic keys, translating user input into actionable theme archetypes.  </li>
<li><code class="inline-code">parseTheme</code>: Converts raw user-provided theme data into validated and canonical forms.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  CUSTOM: {
    id: 5,
    key: &#39;custom&#39;,
    displayName: &#39;Custom Theme&#39;,
    emoji: &#39;üé®&#39;,
    description: &#39;Design your own adventure! You\&#39;ll be prompted to provide theme name, description, and keywords&#39;,
    keywords: [&#39;custom&#39;, &#39;personalized&#39;, &#39;unique&#39;, &#39;creative&#39;, &#39;personal&#39;]
  }
} as const;
</code></pre>
<ul>
<li>Encodes the symbolic details of the <code class="inline-code">ANCIENT</code> theme, including its ID, human-readable name, and description.  </li>
<li>Maintains extensibility by defining a flexible <code class="inline-code">CUSTOM</code> theme, empowering adventurers to shape unique experiences.  </li>
<li>Keywords map directly to user inputs, ensuring a rich matching system for parsing and interpreting intent.  </li>
<li>Acts as the canonical source, referred to for all thematic configurations across the temple system.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getThemeByKey(key: string): ThemeDefinition | null {
  return THEMES_ARRAY.find(theme =&gt; theme.key === key) || null;
}
</code></pre>
<ul>
<li>Utilizes the <code class="inline-code">THEMES_ARRAY</code> to locate themes by their symbolic <code class="inline-code">key</code>.  </li>
<li>Performs rigid checks, returning <code class="inline-code">null</code> when an unknown key is provided, ensuring robustness in flow control.  </li>
<li>Centralizes the key retrieval logic for consistent usage across multiple temple functions.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Normalizes input text into a lowercased version, facilitating a case-insensitive matching process.  </li>
<li>Integrates three matching strategies: direct key lookup, numeric ID parsing, and keyword inference.  </li>
<li>Ensures flexible parsing via keyword inclusivity, enabling broad input interpretations.  </li>
<li>Returns <code class="inline-code">null</code> for unprocessable inputs, a safeguard against invalid data polluting the system.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Codex</h3>
<p>The configuration file encodes the ancient settings that regulate the temple rituals. Here, constants dictate timeouts, file limits, analysis depth, and predefined error messages, ensuring balance within the system. These parameters form the delicate underpinnings ensuring the temple operates smoothly.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines the ritual duration for LLM-based (Large Language Model) requests, ensuring the ceremony ends gracefully.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Balances the weight of artifacts analyzed to prevent overwhelming the temple‚Äôs resources.  </li>
<li><code class="inline-code">ERROR_MESSAGES</code>: Encodes system-wide messages to guide adventurers when rituals go awry.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
export const ERROR_MESSAGES = {
  LLM_UNAVAILABLE: &#39;LLM service is currently unavailable. Please check your configuration.&#39;,
  ANALYSIS_FAILED: &#39;Failed to analyze the project. Please ensure the path is valid.&#39;,
  THEME_INVALID: &#39;Invalid theme specified. Using default theme.&#39;,
  FILE_NOT_FOUND: &#39;The requested file could not be found.&#39;,
  PERMISSION_DENIED: &#39;Permission denied accessing the specified path.&#39;,
} as const;
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> sets a clear limit on processing duration, ensuring timely response even for complex operations.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> enforces constraints on file size, effectively managing temple resources.  </li>
<li>Standardized <code class="inline-code">ERROR_MESSAGES</code> provide clarity during error states, essential for debugging and user assistance.  </li>
<li>These constants enforce ritualistic discipline while preserving the temple‚Äôs sacred equilibrium.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Review how theme keywords allow for flexible recognition of user intents during thematic validation.  </li>
<li>Observe the error-handling mechanisms in validation to understand how improper inputs are gracefully handled.  </li>
<li>Explore the configuration constants to identify how key properties support stability, performance, and scalability.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>By the sacred stars and eternal wisdom of the temple scribes, thou hast unlocked the ancient secrets of the Hieroglyphic Codex and ascended closer to the pinnacle of enlightenment‚Äîmay thy journey continue with the brilliance of a divine artifact! ‚ö°üíéüëÅÔ∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>