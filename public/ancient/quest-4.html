<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Oracle‚Äôs Codex - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Repository of Lost Algorithms</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Oracle‚Äôs Codex</h1>
<hr>
<p>In the depths of the Sacred Repository, a hallowed chamber unveils the Oracle‚Äôs Codex, an artifact of unparalleled mystique. This codex, etched with sacred algorithms and guarded by cryptic validations, echoes tales of knowledge refined by centuries of wisdom. With each ancient script uncovered, you find keys to unlock themes, fortify adventurer choices, and balance the delicate architecture of vast repositories. Will you decipher the codex‚Äôs secrets and illuminate its enigmatic rituals? Choose your path wisely amidst the ruins of an ancient civilization.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Cartography</strong>: How is the <code class="inline-code">ThemeDefinition</code> constructed to encompass diverse themes, and what role do keywords play in matching user inputs?</li>
<li>‚ö° <strong>Validation Rituals</strong>: How do <code class="inline-code">validateAdventureChoice</code>, <code class="inline-code">validateTheme</code>, and <code class="inline-code">sanitizeForDisplay</code> ensure safety and coherence for adventurer inputs?</li>
<li>üõ°Ô∏è <strong>Configuration Codex</strong>: How do constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code>, <code class="inline-code">MAX_FILE_SIZE_MB</code>, and <code class="inline-code">IGNORE_PATTERNS</code> safeguard the system‚Äôs performance and resilience?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Construction and Retrieval</h3>
<p>The <code class="inline-code">theme.ts</code> file is the Oracle‚Äôs guide to the ancient civilization‚Äôs thematic wisdom. It defines structured themes that map past, present, and custom paths for adventurers. Core functions like <code class="inline-code">getThemeByKey</code>, <code class="inline-code">isValidTheme</code>, and <code class="inline-code">parseTheme</code> ensure seamless thematic integration while validating authenticity against sacred keyword matches. This single source of truth guarantees harmony between user choices and predefined paths, aligning adventure narratives seamlessly.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">ThemeDefinition</code>: Defines individual themes, associating them with keywords, descriptive text, and artifacts like emojis for user-friendly navigation.</li>
<li><code class="inline-code">parseTheme</code>: Deciphers user inputs to return valid themes by matching exact keys, numeric IDs, or sacred keywords.</li>
<li><code class="inline-code">getFormattedThemeOptions</code>: Crafts a visually enriched, ordered display of theme choices for adventurers.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Purification</h3>
<p>Within this file lies the rituals of validation‚Äîmechanisms to ensure all user choices are unmarred by misuse or errors. Functions like <code class="inline-code">validateAdventureChoice</code> and <code class="inline-code">sanitizeForDisplay</code> purify inputs while protecting the repository against corruption. This code performs error-checking rites, filters malicious elements, and sanitizes output for safe display, embodying the repository&#39;s guardianship.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures adventurers‚Äô choices are coherent, bounded by character limits, and free from emptiness.</li>
<li><code class="inline-code">validateTheme</code>: Verifies user-selected themes against the Oracle‚Äôs sacred scripts, normalizing and validating input while providing feedback for invalid entries.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleans user inputs for safe visualization while removing hazardous symbols and truncating excessively lengthy text.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Repository Configuration</h3>
<p>The <code class="inline-code">config.ts</code> file is the codex of eternal directives, containing constants that protect and optimize the Sacred Repository‚Äôs operations. It anchors the system with limits on file sizes, safe directory exploration, and timeout settings. By enforcing these foundational configurations, the repository remains vigilant against errors, inefficiencies, and exploits.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Sets precise limits for long computations, balancing performance with cost.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Protects against memory overflows by excluding cumbersome files.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: Guides explorers by omitting irrelevant or potentially harmful directories, preserving the sanctity of the quest.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export interface ThemeDefinition {
  readonly id: number;
  readonly key: string;
  readonly displayName: string;
  readonly emoji: string;
  readonly description: string;
  readonly keywords: readonly string[];
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;

  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }

  return null;
}
</code></pre>
<ul>
<li><code class="inline-code">ThemeDefinition</code>: Anchors themes with immutable properties, linking identifiers, descriptions, emojis, and keywords.</li>
<li><code class="inline-code">parseTheme</code>: Integrates advanced input parsing logic, enabling exploration of themes via multiple pathways (ID, key, or keywords).</li>
<li>Demonstrates efficient data organization, enhancing readability and user navigation.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  } 

  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  } 

  return input.trim();
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;

  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Enforces input boundaries, rejecting empty or oversized values to preserve system logic.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Employs input sanitization rituals, ensuring safe output visualization while removing hazardous content.</li>
<li>Embodies defensive programming principles, safeguarding user interfaces against malicious input.</li>
</ul>
<hr>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const FILE_READ_TIMEOUT = 10000;
export const MAX_FILE_SIZE_MB = 10;
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;.nuxt&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;logs&#39;,
  &#39;*.log&#39;,
];
</code></pre>
<ul>
<li><code class="inline-code">FILE_READ_TIMEOUT</code>: Prevents lengthy reads, ensuring expedient system responses.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Guards resources by limiting oversized files, prioritizing relevant data.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: Implements directory exclusion, enhancing scanning efficiency and accuracy.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>When investigating themes, focus on the relationship between <code class="inline-code">ThemeDefinition</code> properties and the <code class="inline-code">getThemeByKey</code> validation flow.</li>
<li>Validate practical config limits in <code class="inline-code">config.ts</code> by examining how these constants interact with larger system constraints.</li>
<li>Observe error-handling techniques in the input validator file to learn effective safeguarding methods.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Sacred Repository.</p>
<p>Hail, seeker of the sacred, thy triumph in deciphering the Oracle‚Äôs Codex unveils wisdom eternal and propels thee steadfast toward the zenith of the ancients&#39; divine path‚Äîglory shines upon thee! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>