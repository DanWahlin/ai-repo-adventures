<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Glyph Archive - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Codex of Lost Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Glyph Archive</h1>
<hr>
<p>In the heart of the sprawling ruins, where stone tablets whisper forgotten secrets, lies a hidden vault known as the Glyph Archive. This chamber protects the Codex of Lost Adventures, with its mysteries safeguarded by intricate script etched into the walls. Each glyph reveals fragments of wisdom about controlling themes, validating pathways, and configuring ancient systems. Brave adventurers will need to decipher the Codex‚Äôs encoded knowledge to chart their own journeys within the temples of logic and creativity.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Glyph Validator</strong>: How is user input for themes and choices validated to ensure the paths are valid in the Codex system?</li>
<li>‚ö° <strong>Sacred Themes</strong>: What techniques enable the system to manage and interpret themes within the context of ancient wisdom?</li>
<li>üõ°Ô∏è <strong>Rune of Configurations</strong>: How does the system safely extract data from the files referenced in the Codex configuration?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Config Management for the Codex</h3>
<p>This file contains utilities for reading, parsing, and extracting information from the <code class="inline-code">adventure.config.json</code> file. It ensures that data referenced in the Codex is available and structured appropriately. Key functionalities involve retrieving file paths, minimizing data for specific use cases, and offering safe parsing, which protects the integrity of the system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code>: Loads a raw configuration file from a specified project path. This is crucial for enabling the Codex to understand its localized setup without immediate parsing.</li>
<li><code class="inline-code">parseAdventureConfig</code>: Safely parses the configuration file into JavaScript objects while handling potential errors gracefully.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Traverses the configuration to identify and validate all file paths referenced within, ensuring no broken links to the Codex are present.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<ul>
<li>Loads the <code class="inline-code">adventure.config.json</code> file as plain text, ensuring safe file reading by checking for errors and returning null when the file is missing.</li>
<li>Demonstrates a separation of concerns, as no parsing occurs here‚Äîonly file access logic.</li>
<li>Prevents errors from propagating when the configuration file is missing, allowing the system to remain operational.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Parses the raw configuration file into an object, using error handling to return <code class="inline-code">null</code> on failure.</li>
<li>Demonstrates practical error resilience, ensuring invalid configurations don‚Äôt disrupt the Codex system.</li>
<li>Establishes a single entry point for configuration parsing, centralizing validation logic.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Extracts file paths by traversing the parsed configuration, ensuring all referenced files exist and eliminating duplicates.</li>
<li>Uses a stack-based traversal approach, making it efficient for deep nested configurations.</li>
<li>Plays a key role in data integrity, ensuring the Codex is fully connected to all referenced content without gaps.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Guardians of Sacred Themes</h3>
<p>This file serves as the repository of all themes supported by the Codex system. The themes are defined within strict structures to ensure clarity and consistency. Utilities for parsing and validating themes, as well as formatting them for display, are provided here.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Defines all available themes, including their unique properties and descriptions that invoke an air of mystery and wonder.</li>
<li><code class="inline-code">parseTheme</code>: Implements flexible logic to convert user input into an appropriate theme, interpreting both numeric and textual identifiers.</li>
<li><code class="inline-code">getAllThemes</code>: Gathers all themes as a single array for convenient access across the system.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  }
} as const;
</code></pre>
<ul>
<li>Defines a fixed, well-organized structure for all themes with detailed descriptions and visual emojis.</li>
<li>Facilitates theme selection through keyword matching, reinforcing flexibility in user interpretations.</li>
<li>Embodies the narrative magic of the Codex‚Äôs thematic system, connecting users to imaginative pathways.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();

  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }

  return null;
}
</code></pre>
<ul>
<li>Parses user input into a theme by matching it against keys, numerical IDs, or keywords.</li>
<li>Uses normalization techniques (case-insensitive and trimmed input) to support user-friendly behavior.</li>
<li>Coordinates with existing helper functions (<code class="inline-code">getThemeByKey</code> or <code class="inline-code">getThemeById</code>) for modular code flow.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li>Retrieves an array of all available themes, centralizing the source of theme truth.</li>
<li>Simplifies code in other modules by abstracting direct access to the <code class="inline-code">THEMES</code> constant.</li>
<li>Supports operations that need to iterate through or display all theme options.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Explore how <code class="inline-code">extractUniqueFilePaths</code> ensures no orphaned references exist in the Codex‚Äôs configuration.</li>
<li>Consider why <code class="inline-code">parseTheme</code> performs multiple checks, from exact matches to keyword scans, to ensure flexibility in input.</li>
<li>Investigate the structure of the <code class="inline-code">THEMES</code> constant and its relation to displaying theme options.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Codex of Lost Adventures! Your adventure is complete.</p>
<p>By the sacred flame of wisdom, thou hast unearthed the glyphic truths of the ancient archive, ascending ever nearer to the zenith of thy noble quest‚Äîpress on, O seeker of enlightenment! ‚ö°üëÅÔ∏è‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>