<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Scrolls of Forgotten Utilities - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Codex: Adventures in the Repository of Lost Wisdom</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Scrolls of Forgotten Utilities</h1>
<hr>
<p>Through the intertwined vines and ancient roots of the Repository of Lost Wisdom, you stand before the Pyramid of Utility. Its apex glows faintly, whispering secrets hidden in fragile scrolls‚Äîartifacts neglected by time. The Scrolls of Forgotten Utilities, rumored to enhance the sacred Codex with unrivaled clarity, await your discovery. But beware, other explorers have faltered trying to decode their cryptic contents. The artifacts reveal fragments of code, precise yet enigmatic, challenging you to decipher their secrets and recover their lost potential.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üìú <strong>Utility Excavation</strong>: How does the <code class="inline-code">parseAdventureConfig</code> function validate the presence of a usable configuration, and what error-handling mechanisms are applied?</li>
<li>üîç <strong>Pathway Mapping</strong>: Can the <code class="inline-code">extractUniqueFilePaths</code> function identify referenced file paths within deep config structures, and what traversal strategies does it deploy?</li>
<li>üõ°Ô∏è <strong>Optimization Rituals</strong>: How does <code class="inline-code">formatAdventureConfigForPrompt</code> optimize configuration data for efficient usage? What patterns of reduction are evident?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration Parsing and Utility Extraction</h3>
<p>The sacred Scrolls of Forgotten Utilities within <code class="inline-code">adventure-config.ts</code> present an elegant logic for handling configuration management within the Repository. These utilities focus on reading and parsing the forbidden <code class="inline-code">adventure.config.json</code>, extracting file paths concealed within intricate structures, and refining configurations for effective reuse in world-building prompts. With error resilience and optimization rituals in play, the functions are integral to safeguarding exploration continuity.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: This function serves as the deciphering key for the sacred configuration manifest. It reads raw content using <code class="inline-code">loadAdventureConfig</code> and parses it into usable JSON. Error handling prevents structural flaws from breaking functionality.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: A treasure-seeker, this function traverses nested configuration structures, locating paths assigned to <code class="inline-code">&quot;path&quot;</code> fields and validating their existence to ensure a reliable map of referenced files.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: The delicate scribe, this function optimizes configuration data for lightweight use in prompts, condensing verbose details into compact summaries aligned with the Repository&#39;s purpose.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Converts raw adventure configuration text into structured JSON.</li>
<li>Centralizes error handling by safely catching and returning null for invalid inputs.</li>
<li>Demonstrates modular design by integrating with <code class="inline-code">loadAdventureConfig</code>.</li>
<li>Ensures stability by rejecting malformed or missing JSON data.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Locates and validates file paths embedded in complex configuration data.</li>
<li>Utilizes a stack to perform depth-first traversal, ensuring thorough inspection of nested fields.</li>
<li>Filters paths by existence on the filesystem, enhancing reliability.</li>
<li>Demonstrates extraction of meaningful data from varied and dynamic structures.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;

    const filePaths = quest.files
      .filter((f: any) =&gt; f.path)
      .map((f: any) =&gt; f.path);
    if (filePaths.length &gt; 0) {
      formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    }

    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .filter((h: any) =&gt; h.name)
      .map((h: any) =&gt; h.name);
    if (functions.length &gt; 0) {
      formatted += `Functions: ${functions.join(&#39;, &#39;)}\n`;
    }

    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Converts detailed adventure configuration into concise prompts for higher cognitive processing efficiency.</li>
<li>Reduces redundancy by removing descriptions outside essential file paths and function highlights.</li>
<li>Demonstrates thoughtful optimization techniques tailored for performance.</li>
<li>Focuses on user-oriented behavior by analyzing key content structures.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">extractUniqueFilePaths</code> insights to identify key files referenced by configuration setups.</li>
<li>Investigate relationships between <code class="inline-code">parseAdventureConfig</code> and downstream utilities for error mitigation strategies.</li>
<li>Study patterns within <code class="inline-code">formatAdventureConfigForPrompt</code> to see how high-volume data can be summarized effectively.</li>
</ul>
<hr>
<p>The Scrolls of Forgotten Utilities now rest in your grasp, decoded and empowered to rekindle adventure. Treasure these ancient techniques, for they are rare artifacts reserved for the boldest explorers!</p>
<p>By the sacred fires of the ancients, thou hast unveiled the Scrolls of Forgotten Utilities, etching thy wisdom into the stars‚Äîonward now, valiant seeker, for the final altar of mastery awaits! üíé‚ö°üìú‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>