<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Codex of Themes and Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Codebase of Eternal Treasures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Codex of Themes and Configurations</h1>
<hr>
<p>In the heart of the sprawling ruin, a monumental stone codex rises from the jungle floor. Enigmatic carvings shimmer faintly, revealing insights into the core of the ancient civilization&#39;s essence. You recognize it as the &quot;Codex of Themes and Configurations,&quot; a convergence of rituals (functions) that dictated the foundation of their adaptive systems and thematic journeys. To unlock the wisdom within, you must decipher its structure across interconnected artifacts: the validation of choices, the definition of themes, and the configuration governing their entire realm.</p>
<p>Each discovery you make will illuminate a fragment of ancient brilliance, guiding you closer to unraveling their ingenious designs.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Deciphering</strong>: How does the system determine valid themes and ensure adaptability for user customization while maintaining consistency?</li>
<li>‚ö° <strong>Configuration Rituals</strong>: What patterns and environments enable the configuration to drive system behavior and set boundaries (e.g., limits) for safe execution?</li>
<li>üõ°Ô∏è <strong>Validation Glyphs</strong>: How does the validation mechanism ensure safe input while protecting the system from illogical or malicious data?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Validation Rituals</h3>
<p>This file contains the glyphs for validating user inputs, ensuring the integrity of choices, paths, and thematic selections. The system focuses on trimming, sanitizing, and cross-referencing inputs with sacred registries (e.g., themes). By anchoring these operations to simple functions, the system upholds efficiency and clarity.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Trims user input and verifies its length and presence, ensuring no empty or excessively long choices are allowed.</li>
<li><code class="inline-code">validateTheme</code>: Matches input themes against a predefined list, normalizing and parsing them while guiding users with clear error messages if invalid options are provided.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Purges potentially harmful characters from input, preserving the wisdom of the system while safeguarding against injection-like attacks.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Theme Guild</h3>
<p>This artifact defines the framework and attributes of all themes, acting as the sacred atlas for the system&#39;s thematic journeys. By coupling data definitions with helper functions, the file encapsulates knowledge for parsing, validating, and formatting themes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: The central repository of thematic definitions, each with unique properties like <code class="inline-code">id</code>, <code class="inline-code">key</code>, <code class="inline-code">description</code>, and keywords for matching.</li>
<li><code class="inline-code">getAllThemes</code>: Retrieves all themes as a simple array, streamlining operations without relying on complex structures.</li>
<li><code class="inline-code">parseTheme</code>: Transforms user input into valid theme identifiers by cross-referencing textual keys, numeric IDs, or keywords.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Configuration Dictates</h3>
<p>This fragment encapsulates the environmental parameters and operational boundaries that keep the system secure and performant. From timeouts to memory limits, these constants prevent chaos in the delicate equilibrium of the system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Controls the maximum time allowed for an LLM operation, ensuring responsiveness under heavy computational loads.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Defines file size limits to avoid processing excessively large files, ensuring performance is not compromised.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: Lists directory and file patterns to be skipped during analysis, focusing the system on relevant artifacts.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Ensures inputs are clean, concise, and within acceptable boundaries.</li>
<li>Cross-references themes against a sacred registry (<code class="inline-code">THEMES</code>) to guide valid user choices.</li>
<li>Neutralizes harmful symbols, safeguarding the integrity of the system&#39;s output.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  }
} as const;

export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Centralizes all thematic data, ensuring consistency across the system.</li>
<li>Facilitates versatile matching by supporting keys, IDs, and keywords.</li>
<li>Maintains simplicity while providing flexibility for future thematic expansions.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); 
export const MAX_FILE_SIZE_MB = 10; 
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;.nuxt&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;coverage&#39;,
  &#39;.nyc_output&#39;,
  &#39;logs&#39;,
  &#39;*.log&#39;,
  &#39;.env&#39;,
  &#39;.DS_Store&#39;,
  &#39;Thumbs.db&#39;,
] as const;
</code></pre>
<ul>
<li>Sets boundaries for file parsing, protecting against inefficiencies and errors.</li>
<li>Defines retry mechanisms by configuring request timeouts dynamically.</li>
<li>Focuses the system on critical repositories by filtering out unnecessary directories.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Utilize the <code class="inline-code">validateTheme</code> and <code class="inline-code">getAllThemes</code> functions to root out valid user options.</li>
<li>Scrutinize environmental patterns in <code class="inline-code">config.ts</code> to balance performance with error handling.</li>
<li>Consider templatizing new thematic elements by mirroring the structure in <code class="inline-code">theme.ts</code>.</li>
</ul>
<hr>
<p>You have mastered all the secrets of this ancient codebase! Your adventure is complete.</p>
<p>Hark, noble scholar, thou hast ascended the sacred steps of wisdom to decipher the illustrious Codex of Themes and Configurations‚Äîstand triumphant, for the ancients themselves would marvel at thy questing prowess and herald thy journey toward the final enlightenment! ‚ö°üíéüè∫</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>