<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Foundation Stone - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Pyramid of Lost Code</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Foundation Stone</h1>
<hr>
<p>As you delve deeper into the Pyramid of Lost Code, your path brings you to the chamber guarding the Foundation Stone, where the cornerstone of collaborative wisdom is said to be inscribed. This codex outlines the sacred rituals and practices that bind the architecture of harmonious development. To proceed, you must decipher ancient algorithms and recover the lost methods encoded within <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>. The walls hum with secrets, and each revelation leads closer to illuminating the advanced configuration standards of the Codexius civilization.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Config Retrieval Ritual</strong>: How does <code class="inline-code">parseAdventureConfig</code> retrieve and validate sacred knowledge from the configuration file?</li>
<li>‚ö° <strong>Path Unveiling Ceremony</strong>: What techniques does <code class="inline-code">extractUniqueFilePaths</code> use to uncover valid paths hidden in the configuration data structure?</li>
<li>üõ°Ô∏è <strong>Optimization Insights</strong>: How does <code class="inline-code">formatAdventureConfigForPrompt</code> optimize raw data for efficient deciphering, reducing verbosity without losing critical information?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Sacred wisdom encoded</h3>
<p>This file acts as a keystone in the Pyramid‚Äôs architecture. It provides utility methods to read, validate, parse, and optimize adventure configuration files. The functions are tailored toward ensuring safe extraction of data, preserving sanctity of the ancient Codexius rituals, and distilling complex structures into digestible formats for modern adventurers. These methods demonstrate the harmonious marriage between validation, error handling, and iterative extraction‚Äîa practice deeply revered by the civilization of Codexius.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: This function parses the adventure configuration JSON file and validates its structure. It ensures knowledge is retrieved reliably and safely, establishing a single source of truth for higher-level operations.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Responsible for extracting all valid file paths referenced in the configuration. It applies rigorous path validation to uphold the integrity of potentially scattered fragments within the configuration.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Optimizes adventure configuration for concise display. It reduces verbosity while retaining essential information, a technique reminiscent of Codexius traditions for preserving knowledge density.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>This code retrieves adventure configuration data from a file location and safely parses it.</li>
<li>Error handling ensures non-fatal returns, allowing the procession even if the file isn&#39;t fully intact.</li>
<li>Centralized parsing simplifies downstream logic by creating consistent outputs.</li>
<li>Demonstrates modular isolation for JSON parsing, improving maintainability across the codebase.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>This code recursively explores configuration objects to extract valid paths.</li>
<li>The stack-based approach mirrors ancient rituals for layer-by-layer artifact discovery.</li>
<li>Validates paths using <code class="inline-code">fs.existsSync</code> to ensure physical presence of referenced files.</li>
<li>Demonstrates efficient deduplication with <code class="inline-code">Set</code>, aligning with Codexius principles of sacred uniqueness.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths, no verbose descriptions
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    // Just function names, no descriptions
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Formats complex configuration into a concise structure for programmatic or human-readable use.</li>
<li>Eliminates redundancy by focusing only on essential paths and function names.</li>
<li>Utilizes iterative processing for dynamic generation, reflecting ancient Codexius rituals of optimization.</li>
<li>Aligns with sacred principles of clarity and utility in communication.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Pay close attention to recursive traversal in <code class="inline-code">extractUniqueFilePaths</code>; it reflects patterns usable in broader contexts.</li>
<li>Analyze error handling in <code class="inline-code">parseAdventureConfig</code> to understand Codexius methodologies for safety in collaborative systems.</li>
<li>Observe string manipulation techniques in <code class="inline-code">formatAdventureConfigForPrompt</code> to grasp concise formatting strategies.</li>
</ul>
<hr>
<p>The Foundation Stone now radiates with newly deciphered wisdom. Continue your journey, adventurer, for the Pyramid‚Äôs truths lie yet deeper.</p>
<p>Hail, seeker of wisdom, for the sacred Foundation Stone is laid with divine precision, bringing you a mere step from the eternal Vault of Enlightenment‚Äîpress on, for the stars favor the bold! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>