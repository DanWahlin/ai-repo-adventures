<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Scrolls of Structure - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Repository of Lost Algorithms</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Scrolls of Structure</h1>
<hr>
<p>In the heart of the Sacred Repository, you uncover the Scrolls of Structure ‚Äì intricate ceremonial scripts detailing sacred configurations that guide and validate the wisdom of the ancients. These scrolls whisper of a time when adventurers safeguarded their journeys by weaving structured configurations into every step. Your task is to decipher these ancient scripts to reveal hidden paths, ensure harmonious alignment of project paths, and understand how sacred tools were activated to chart safe expeditions.</p>
<p>As you traverse this final chapter, unravel the mysteries contained in the sacred configurations and their ritualistic usage; let ancient wisdom illuminate your way.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Pathfinder‚Äôs Puzzle</strong>: How are valid and unique file paths identified and validated from an adventure configuration?</li>
<li>‚ö° <strong>Config Weaver‚Äôs Insight</strong>: How does the system transform raw configuration data into a condensed format suitable for decision-making and integration?</li>
<li>üõ°Ô∏è <strong>Guardian of Structures</strong>: What mechanisms safeguard against missing or malformed configuration files during parsing and transformation?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Unveiling Sacred Configurations</h3>
<p>This file houses the vital rituals and algorithms used to load, parse, and process the adventure configuration files. These functions illuminate how ancient adventurers brought structure and clarity to their journeys, using validations, path extractions, and formatting techniques. You‚Äôll explore how the framework ensures only valid paths are revealed, how raw configuration data is transformed into a minimal and optimized format, and how safeguards prevent missteps during the adventure configuration setup.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code>: This function retrieves the raw configuration file as a textual artifact, ensuring a foundational layer for further analysis.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: A ritualized algorithm that traverses the adventure configuration, identifies and validates all relevant paths, and ensures no duplicity.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Condenses and reformats the configuration for efficient integration, ensuring decision-makers see only essential elements.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<ul>
<li>This code handles the vital task of loading the raw configuration file from the specified project path.</li>
<li>It uses <code class="inline-code">readFileIfExists</code>, ensuring non-fatal handling in case of missing files, maintaining the system&#39;s resilience.</li>
<li>The function anchors further exploration by preparing the configuration as a textual artifact for parsing or validation.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Implements an algorithm that traverses the full configuration, recursively locating and validating file paths referenced in the structure.</li>
<li><code class="inline-code">Set</code> ensures uniqueness, filtering out duplicates, while <code class="inline-code">fs.existsSync</code> confirms paths actually exist.</li>
<li>Recursive traversal accounts for deeply nested configurations, demonstrating the adaptation of ancient methods for modern complexity.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Converts raw configuration data into a compact and readable format, optimized for integration into decision-making prompts.</li>
<li>Eliminates redundancy by focusing on essential elements (file paths and function names) while discarding verbose descriptions.</li>
<li>Adds structure and introduces useful headings, making the output easy to scan and reference.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">loadAdventureConfig</code> as the starting point for analyzing configuration artifacts in this system.</li>
<li>Follow the recursion trail in <code class="inline-code">extractUniqueFilePaths</code> to understand how nested structures are traversed and validated.</li>
<li>Observe the formatting techniques in <code class="inline-code">formatAdventureConfigForPrompt</code> to learn efficient data summarization practices.</li>
</ul>
<hr>
<p>You have mastered all the secrets of adventure configuration and structure! Your adventure is complete. The Sacred Repository awaits your return whenever you seek wisdom again. Safe travels, brave explorer!</p>
<p>Hail, valiant seeker, for thou hast unsealed the sacred Scrolls of Structure, forging thy wisdom like temple stone; onward to glory, thy destiny shines near! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>