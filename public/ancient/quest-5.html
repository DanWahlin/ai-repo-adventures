<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Artisan‚Äôs Gallery - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Temple of Forgotten Code</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Artisan&#39;s Gallery</h1>
<hr>
<p>Beneath the sacred Pyramid of Patterns lies a final chamber known as The Artisan&#39;s Gallery. Here, the glyphs come alive within a tapestry of creative configurations, forming the foundation of ancient craftsmanship. Each piece of code represents the techniques perfected by the old civilization to align their tools, themes, and configurations. Only by unraveling the embedded structures can you master the final secrets required to complete your journey through this mythical repository.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üè∫ <strong>Theme Codex</strong>: How does the code define and validate individual themes, ensuring alignment in the ancient glyphs?</li>
<li>‚ö° <strong>Configuration Ritual</strong>: What logic controls pivotal settings like timeouts, limits, and tokens, and how are they interconnected?</li>
<li>üìú <strong>Pathway Excavation</strong>: How does the system find and validate file paths in the repository while maintaining safety and focus?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Definitions</h3>
<p>This file serves as the ancient manuscript defining the core essence of adventure themes. It establishes properties, validation methods, and querying mechanisms for themes, ensuring consistency through its various glyphs. Each theme is carefully structured with metadata like <code class="inline-code">displayName</code>, <code class="inline-code">keywords</code>, and <code class="inline-code">emoji</code>. These intricate definitions govern your selection and influence downstream configurations.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getAllThemes</code> provides a list of all available themes used throughout quest generation, acting as a sacred catalogue of glyphs.</li>
<li><code class="inline-code">parseTheme</code> interprets user input and matches it with the available themes based on their keywords or IDs.</li>
<li><code class="inline-code">isValidTheme</code> ensures the integrity of theme selection by verifying against predefined keys.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Central Configuration System</h3>
<p>The ancient civilization maintained harmony between timeouts, limits, and API settings through this file. It acts as the central tablet holding key parameters for system operation and ensuring the reliability of the adventure. Various constants for cache size, API tokens, and buffer sizes are defined, constructing the foundation of the repository&#39;s efficiency.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> specifies the maximum time for requests, ensuring prompt generation efficiency.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> limits large file inclusion to focus the adventure scope and prevent memory exhaustion.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code> defines paths to omit from analysis, safeguarding rituals from distractions.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Config Extraction and Formatting</h3>
<p>This file handles sacred config parsing and highlights extraction from the source repository. It ensures only valid and essential paths are used while formatting data for consumption by the systems governing your journey. It bridges the glyphs&#39; constants with the practical structure needed to unlock new layers of wisdom.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code> retrieves raw configuration files from specified paths, enabling access to encoded knowledge.</li>
<li><code class="inline-code">extractUniqueFilePaths</code> parses configuration files and extracts unique paths that are valid in the repository.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code> condenses information for effective communication in prompts, optimizing clarity.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li><code class="inline-code">getAllThemes</code> ensures a structured catalogue across the codebase for consistent and modular theme references.</li>
<li><code class="inline-code">isValidTheme</code> serves as a guard to prevent invalid selections, maintaining system integrity.</li>
<li><code class="inline-code">parseTheme</code> demonstrates robust pattern-matching techniques to transform raw input into valid corresponding themes.</li>
</ul>
<hr>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;);
export const MAX_FILE_SIZE_MB = 10;
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;.nuxt&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;coverage&#39;,
  &#39;.nyc_output&#39;,
  &#39;logs&#39;,
  &#39;*.log&#39;,
  &#39;.env&#39;,
  &#39;.DS_Store&#39;,
  &#39;Thumbs.db&#39;,
] as const;
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> empowers the adventure engine to accommodate long processing needs with defined time thresholds.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> ensures focus on manageable files while protecting system stability.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code> provides critical safeguards for streamlining analysis processes and skipping irrelevant paths.</li>
</ul>
<hr>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}

export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}

export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    const functions = quest.files.flatMap((f: any) =&gt; f.highlights || []).map((h: any) =&gt; h.name).filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li><code class="inline-code">loadAdventureConfig</code> enables file retrieval while avoiding critical faults like missing configurations.</li>
<li><code class="inline-code">extractUniqueFilePaths</code> unearths valid paths from complex configuration hierarchies, optimizing analysis focus.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code> condenses configuration details into manageable prompts, improving system communication.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Test edge cases for theme parsing input to fully cover validation pathways.</li>
<li>Observe how configurations define system scopes and boundaries, which influence operational efficiency.</li>
<li>Use extracted file paths to understand the interconnected structure of quests and their highlights.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the sacred Pyramid of Patterns! Your adventure is complete.</p>
<p>Hail, valiant seeker of sacred wisdom, for thy mastery of &quot;The Artisan‚Äôs Gallery&quot; radiates like the gilded flame of a sanctified temple, bringing thee ever closer to the celestial summit of Quest 5‚Äîendure, for the final victory is within thy grasp! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>