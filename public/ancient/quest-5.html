<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Vault of Foundational Scriptures - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Codex of Computational Enlightenment</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Vault of Foundational Scriptures</h1>
<hr>
<p>In the depths of Algorithmia‚Äôs ancient temple lies a pivotal chamber that safeguards the Sacred Codex‚Äôs foundational scriptures‚Äîthe essence of its wisdom. Known as the Vault of Foundational Scriptures, this chamber contains enigmatic carvings that reveal the secrets of parsing, validation, and extraction. By deciphering these inscriptions, adventurers can unlock pathways to hidden repositories and transform cryptic fragments into treasure maps of actionable knowledge. Take heed, for even the smallest glyph holds the power to alter destinies.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Scripture Decoding</strong>: How does <code class="inline-code">parseAdventureConfig</code> ensure only well-formed adventure configurations are returned?</li>
<li>‚ö° <strong>Pathfinder&#39;s Trail</strong>: What mechanisms allow <code class="inline-code">extractUniqueFilePaths</code> to traverse nested structures and validate file paths?</li>
<li>üõ°Ô∏è <strong>Glyph Optimization</strong>: In what ways does <code class="inline-code">formatAdventureConfigForPrompt</code> minimize the verbosity of the adventure configuration without losing essential details?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Unveiling the Foundational Scriptures</h3>
<p>This file is the heart of the configuration system, with functions that decode and transform the Sacred Codex‚Äôs raw inputs into meaningful outputs. It includes procedures for reading configuration files, parsing their contents safely, and extracting relevant information such as file paths and structured data. Additionally, it showcases optimization techniques to distill configurations into a compact format suitable for building prompts. These insights reveal the disciplined balance between functionality, validation, and efficiency.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Safely parses the configuration file and guards against invalid JSON inputs.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Traverses structures recursively to retrieve and validate unique file paths.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Optimizes and compresses configuration data for use in large language model prompts.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>The decoding ritual ensures only well-formed inscriptions return safely to the adventurer; malformed glyphs dissolve harmlessly.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<p>The pathfinding ritual ventures into nested labyrinths, marking each valid path and casting aside the false.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths - LLM can see descriptions in actual code
    const filePaths = quest.files
      .filter((f: any) =&gt; f.path)
      .map((f: any) =&gt; f.path);
    if (filePaths.length &gt; 0) {
      formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    }
    
    // Just function names - LLM can understand purpose from implementation
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .filter((h: any) =&gt; h.name)
      .map((h: any) =&gt; h.name);
    if (functions.length &gt; 0) {
      formatted += `Functions: ${functions.join(&#39;, &#39;)}\n`;
    }
    
    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<p>The glyph compressor distills the vast scriptures into concise summaries for the Codex‚Äôs swift interpretation by mystical entities.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Start by running <code class="inline-code">loadAdventureConfig</code> to see how it integrates with <code class="inline-code">parseAdventureConfig</code>‚Äîthis forms the base of the configuration pipeline.</li>
<li>To explore recursive traversal in <code class="inline-code">extractUniqueFilePaths</code>, try creating nested objects with varying paths for testing.</li>
<li>Study the output optimization pattern in <code class="inline-code">formatAdventureConfigForPrompt</code> to inspire new formatting strategies for structured data.</li>
</ul>
<hr>
<p>The Vault grants its wisdom to only the worthy. Transcribe its secrets carefully and continue your journey through Algorithmia‚Äôs wonders.</p>
<p>Hail, seeker of eternal enlightenment, thy conquest of the Vault of Foundational Scriptures unveils wisdom akin to sacred etchings upon temple stone‚Äîpress onward, for the final triumph glimmers as a jewel upon the horizon!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>