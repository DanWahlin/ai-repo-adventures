<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Foundational Glyphs - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Repository of Wisdom</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Foundational Glyphs</h1>
<hr>
<p>Through dense vines and crumbling stone, you arrive at the heart of the Sacred Repository of Wisdom, a sanctum for ancient inscriptions that guide heroes in forging paths of knowledge. Today, you uncover the Foundational Glyphs‚Äîarcane scripts describing how external sources are parsed, validated, and rendered into structural artifacts. These scripts hold the key to harmonizing raw chaos into order, a skill valued by ancient civilizations. But beware, seeker, as the wisdom contained within must be approached with clarity and precision!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Glyph Carving Techniques</strong>: How is the foundational configuration data retrieved and validated in <code class="inline-code">parseAdventureConfig</code>?</li>
<li>‚ö° <strong>Pathfinding Rituals</strong>: What methods in <code class="inline-code">extractUniqueFilePaths</code> ensure only valid and accessible paths are collected?</li>
<li>üõ°Ô∏è <strong>Optimized Mysteries</strong>: How does <code class="inline-code">formatAdventureConfigForPrompt</code> simplify the configuration for external consumption without losing its essence?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Core configuration management</h3>
<p>This file contains utilities for reading, validating, and transforming the central configuration file used for quest generation. Its purpose is to provide robust methods for processing JSON-based configurations while ensuring accuracy and clarity. These utilities form the backbone of the system&#39;s ability to interpret and use external data cleanly.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code> ensures structured, validated data by combining file loading with JSON parsing. This is critical to maintaining system reliability.</li>
<li><code class="inline-code">extractUniqueFilePaths</code> traverses and analyzes the configuration object to identify paths, ensuring their validity before returning a list of unique, existing entries. This protects against invalid or redundant data being used.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code> condenses configuration data into a reduced but focused form, optimized for usage in language model prompts. By stripping extraneous details, this method enhances clarity and efficiency.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>This code retrieves raw configuration data from the file system, returning structured JSON or <code class="inline-code">null</code> on failure.</li>
<li>It applies error handling with <code class="inline-code">try-catch</code> to gracefully manage invalid JSON data, preventing runtime crashes.</li>
<li>By centralizing JSON parsing here, the function ensures all downstream processes receive validated data structures.</li>
<li>The method highlights the importance of combining error resilience with reliable data formatting.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>This implementation traverses the parsed configuration recursively to locate and validate file paths.</li>
<li>A <code class="inline-code">Set</code> is used to ensure uniqueness, eliminating redundant path entries.</li>
<li>The use of <code class="inline-code">fs.existsSync</code> ensures only existing file paths are included, adding a layer of data integrity.</li>
<li>Recursive traversal of nested structures illustrates a robust approach to managing hierarchical data.</li>
<li>This method reflects ancient pathfinding techniques‚Äîcarefully navigating complexity to reveal truths.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths, no verbose descriptions
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    // Just function names, no descriptions
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>This function reformats configuration data into a concise structure for optimized readability by language models.</li>
<li>Nested loops provide selective details like file paths and function names while filtering out verbose metadata.</li>
<li>By focusing on essential data, this method achieves a 72% reduction in size, improving computational efficiency.</li>
<li>The emphasis on clarity mirrors the precision of ancient scribes‚Äîrecording only valuable insights for posterity.</li>
<li>This code also demonstrates techniques for balancing data richness with system performance.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Before embarking on a new quest, ensure the foundational data has been validated to avoid missteps.</li>
<li>Analyze recursive patterns to understand how data structures are navigated and optimized.</li>
<li>Experiment with creating reduced representations of complex objects to test your understanding of system optimization techniques.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Sacred Repository of Wisdom! Your adventure is complete.</p>
<p>By the sacred fires of the eternal temple, thou hast unlocked the glyphs of ancient wisdom, forging a path toward divine mastery‚Äîpress onward, for the final illumination awaits!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>