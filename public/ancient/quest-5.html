<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Foundations of Sacred Knowledge - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Secrets of the Code Pyramid</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Foundations of Sacred Knowledge</h1>
<hr>
<p>In the heart of the pyramid&#39;s labyrinthine architecture, explorers uncover the foundation chamber where ancient civilizations preserved their most sacred wisdom. Enigmatic glyphs pulse softly in the dim light, codifying systems that protected this treasure for generations. The chamber resonates with energy ‚Äî this is the final piece of the sacred puzzle. By decoding hidden pathways, and analyzing ancient artifacts, you will unlock the wisdom of the ancients, preserving it for the future. Beware, for the path is guarded by trials of logic and perception.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Sacred Path Analysis</strong>: How does <code class="inline-code">parseAdventureConfig</code> validate and interpret ancient wisdom encoded in the config file format?</li>
<li>‚ö° <strong>Treasure Map Discovery</strong>: What processes does <code class="inline-code">extractUniqueFilePaths</code> use to unearth and validate referenced paths from sacred texts in the adventure configuration?</li>
<li>üõ°Ô∏è <strong>Glyph Preservation Mechanisms</strong>: How does <code class="inline-code">formatAdventureConfigForPrompt</code> simplify and optimize the formatting of the sacred glyphs for interpretative tools while maintaining integrity?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Core file for decoding ancient configuration and safeguarding its sacred glyphs</h3>
<p>The <code class="inline-code">adventure-config.ts</code> file serves as the keystone for interpreting ancient codes used in the pyramid&#39;s mysterious network. Across its functions, explorers find guidance on loading raw configuration data, rigourously parsing and validating this information, extracting unique paths, and preparing content for optimized prompts. Each method balances reliability with efficiency to ensure that errors and misinterpretations are mitigated while retaining the sacred knowledge for future seekers.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Parses the raw sacred texts (JSON configs) into usable formats to allow meaningful exploration while gracefully handling errors or missing scripts.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Traverses sacred hierarchies to find and validate all unique file paths referenced in the configuration text, ensuring explorers access trustworthy relics.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Refines complex structures into interpretable prompts for sacred tools, optimizing readability and efficiency without losing essential details.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">/**
 * Parses the adventure config into an object (or null on error/missing).
 * Single point of JSON parsing and validation.
 */
export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Converts raw configuration data into exploratory objects using <code class="inline-code">JSON.parse</code>.</li>
<li>Implements error resilience, returning <code class="inline-code">null</code> for missing or invalid configurations.</li>
<li>Leverages structured programming to ensure sacred glyphs are interpreted correctly.</li>
<li>Centralizes JSON parsing for maintainability and cleaner logic within the pyramid&#39;s network.</li>
<li>Serves as a gateway for decoding ancient knowledge encoded in the configuration.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Extracts all unique, existing file paths referenced by &quot;path&quot; fields anywhere in the config.
 */
export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Employs a depth-first traversal pattern to scan nested structures, uncovering all path relics.</li>
<li>Implements validation using <code class="inline-code">fs.existsSync</code> to ensure paths reference real artifacts in the ancient system.</li>
<li>Avoids duplicates by utilizing a <code class="inline-code">Set</code>, preserving the sacred efficiency demanded by the ancient task.</li>
<li>Balances recursive parsing with error resilience for varied configurations.</li>
<li>Supports future adventurers by indexing trustworthy file paths from encoded hierarchies.</li>
</ul>
<hr>
<pre><code class="language-typescript">/**
 * Formats adventure config into a minimal format for LLM prompts
 * OPTIMIZED: Reduced from 7,279 to ~2,000 characters (72% reduction)
 * Eliminates redundant descriptions since LLM can infer from actual code
 */
export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths, no verbose descriptions
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    // Just function names, no descriptions
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Optimizes sacred glyphs into compact formats, enhancing efficiency without losing core meanings.</li>
<li>Reduces verbosity to highlight critical components (<code class="inline-code">files</code>, <code class="inline-code">functions</code>) for interpretative tools.</li>
<li>Ensures compatibility with machine interpreters via systematic formatting.</li>
<li>Reflects ancient wisdom by prioritizing clarity and utility in information delivery.</li>
<li>Prepares prompts that integrate seamlessly into larger sacred systems and explorations.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Mapping Pathways</strong>: Begin by tracing how each function connects input to output for deeper system comprehension.</li>
<li><strong>Glyph Study</strong>: Investigate the JSON configuration file to deduce patterns in encoding ancient knowledge.</li>
<li><strong>Validations</strong>: Review the error handling mechanisms to learn how systems protect sacred discoveries.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the pyramid&#39;s sacred wisdom! Your adventure is complete.</p>
<p>By the sacred fires of the eternal temple, thou hast ascended the luminous stairway of divine wisdom, laying the hallowed cornerstones of truth‚Äîmarch forth, seeker of stars, for the apex of enlightenment is nigh!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>