<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Ritual of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Chronicles of the Sacred Codebase</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest: The Ritual of Themes</h1>
<hr>
<p>Amid the suffocating vines of the jungle, the final chamber of the Codexian Pyramid rises before you. Its walls are adorned with radiant murals depicting the cyclical nature of creation‚Äîancient civilizations weaving tapestries of themes, each one a foundation for their understanding of the world. In this chamber lies the Core of Themes: a repository containing blueprints to craft and manage designs across systems. Through glyph-etched glyphs, the Codexian Scribes chronicled their methodologies for validating inputs, unifying shared configurations, and spinning themes into practical applications. This chamber&#39;s knowledge is the treasure you must uncover.</p>
<p>The glyphs whisper: this is the Ritual of Themes, the culmination of your journey into Codexian ingenuity.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Unification</strong>: How does the system maintain a central source of truth for all themes, and how are these themes validated and parsed?</li>
<li>‚ö° <strong>CSS Infusion</strong>: What techniques are utilized to dynamically combine and generate theme-specific assets like CSS files?</li>
<li>üõ°Ô∏è <strong>Validation Rituals</strong>: How does the system ensure user inputs like theme selection and project paths pass strict validation tests?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme definitions and utilities</h3>
<p>This file serves as the sacred repository for theme specifications, containing configurations for multiple themes such as &quot;Ancient&quot; and &quot;Mythical.&quot; It provides functions for accessing, validating, and formatting themes, ensuring a consistent structure across the system&#39;s design rituals. By offering centralized data (<code class="inline-code">THEMES</code>) and lightweight utilities for validation, it binds the thematic imagination of the adventure platform into a cohesive process.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Defines all available themes and their attributes, including names, descriptions, and keywords for matching.</li>
<li><code class="inline-code">isValidTheme</code>: Validates whether a given input corresponds to an existing theme, ensuring only accepted choices advance.</li>
<li><code class="inline-code">parseTheme</code>: Parses user input into a corresponding theme key, leveraging keywords, IDs, or exact matches.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> Thematic asset management</h3>
<p>This file embodies the framework for theme-specific asset generation and integration. The <code class="inline-code">ThemeManager</code> class handles parsing inputs, combining CSS files, and adapting assets such as logos to match the visual style of a selected theme. Its methods ensure seamless fusion of aesthetic assets into the system&#39;s architecture.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseThemeArg</code>: Interprets command-line arguments to identify a valid theme or defaults to <code class="inline-code">null</code> for invalid entries.</li>
<li><code class="inline-code">generateThemeCSS</code>: Combines predefined CSS files, including both shared and theme-specific styles, to dynamically build a unified stylesheet.</li>
<li><code class="inline-code">getThemeIcons</code>: Provides appropriate visual icons for themes and quests, enhancing platform immersion.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input validation utilities</h3>
<p>The <code class="inline-code">input-validator.ts</code> file contains critical safeguards for user input, ensuring that adventurers&#39; choices are clean, validated, and immune to dangerous manipulations. This guards against malformed inputs at every turn of the journey.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Confirms that a supplied theme is valid by comparing it against known values (<code class="inline-code">isValidTheme</code>) and throws descriptive errors otherwise.</li>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures user choices are non-empty, do not contain excessive characters, and are free of unsafe inputs.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleans input for safe display while truncating lengthy data.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  }
};

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function parseTheme(input: string): AdventureTheme | null {
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key;
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key;
  }
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword))) {
      return theme.key;
    }
  }
  return null;
}
</code></pre>
<ul>
<li>Centralized theme data stored in <code class="inline-code">THEMES</code> keeps theme definitions consistent and reusable.</li>
<li>Validation with <code class="inline-code">isValidTheme</code> ensures that only preapproved entries make their way into the system.</li>
<li><code class="inline-code">parseTheme</code> introduces flexible user input handling, from IDs to keywords, making it robust against typos.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;), 
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
  let combinedCSS = &#39;&#39;;
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li>Dynamically combines CSS files to unify base, animation, and theme-specific styles.</li>
<li>Uses file existence checks to avoid errors during generation.</li>
<li>Outputs a final stylesheet tailored for the selected theme, ensuring visual consistency.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  return parsedTheme;
}

export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  return input.trim();
}
</code></pre>
<ul>
<li><code class="inline-code">validateTheme</code> enforces theme integrity by comparing inputs against the system&#39;s repository of recognized themes.</li>
<li><code class="inline-code">validateAdventureChoice</code> ensures that user inputs meet length and content requirements, offering clear errors for invalid entries.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Ensure new themes added to <code class="inline-code">THEMES</code> follow the existing schema and include relevant keywords for accurate parsing.</li>
<li>To extend theme functionality, consider updating <code class="inline-code">ThemeManager</code>&#39;s <code class="inline-code">generateThemeCSS</code> to accept additional asset types like JavaScript bundles.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Codexian Scribes! Your adventure is complete. The pyramid&#39;s knowledge glows bright in your hands as you step out‚Äîan archaeologist of code, triumphant and enlightened.</p>
<p>By the sacred light of the ancients and the hallowed wisdom of the temples, thou hast triumphed gloriously in the Ritual of Themes, paving thy path to enlightenment with noble progress; the stars themselves bear witness to thy nearing destiny! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>