<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Chamber of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Codex of the Lost Civilization</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Chamber of Themes</h1>
<hr>
<p>In the shadows of the final temple, you find a vaulted chamber adorned with intricate engravings. These glyphs depict tales of the Codex‚Äôs ancient custodians, who crafted a system of thematic keys to navigate their vast repository of knowledge. A pedestal at the chamber&#39;s center bears a cryptic inscription‚Äîthe solution lies in the understanding of themes and configurations. Your journey has led to the Chamber of Themes, where the wisdom of structured elements is unveiled. Can you solve its mysteries and complete the Codex?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üè∫ <strong>Thematic Lore</strong>: How does the system define and handle themes in a structured and extensible manner?</li>
<li>‚ö° <strong>Configuration Invocation</strong>: What mechanisms are used to manage environment variables and settings for the adventure system?</li>
<li>üó∫Ô∏è <strong>Validation Rift</strong>: How does the input validation process ensure integrity and security for critical parameters like theme selection and project paths?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration and Defaults</h3>
<p>This file encapsulates the environmental settings, constants, and system limits required for the adventure‚Äôs operation. It plays a foundational role in ensuring robustness and customizability through environment variable checks and error boundary definitions. Key constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> help manage performance, while patterns such as <code class="inline-code">IGNORE_PATTERNS</code> create a safeguard against irrelevant directories in the project path.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines the timeout for requests to the language model, playing a crucial role in balancing responsiveness and load time.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: A directory exclusion safeguard that ensures unnecessary files or folders are skipped during scanning.</li>
<li><code class="inline-code">ERROR_MESSAGES</code>: A centralized repository of default error messages to improve error handling consistency.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Definitions and Utilities</h3>
<p>This file acts as the cornerstone for the adventure&#39;s thematic elements, maintaining a centralized repository of theme data. It utilizes simple yet extensible structures like <code class="inline-code">ThemeDefinition</code> to maintain consistency across the system while offering functions to fetch and validate themes dynamically.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A predefined set of themes, each encapsulating semantic and visual identifiers for the adventure.</li>
<li><code class="inline-code">isValidTheme</code>: Ensures that user-input themes are validated against the allowable options.</li>
<li><code class="inline-code">parseTheme</code>: A utility to dynamically parse and resolve user inputs against available themes.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Validation Safeguards</h3>
<p>This file implements the guardians of input integrity, ensuring that all adventure-critical user inputs are sanitized and validated before use. Simplified utility methods avoid excessive complexity while maintaining high-security standards.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures that the user&#39;s mission choice is both non-empty and within the permissible length.</li>
<li><code class="inline-code">validateTheme</code>: Processes and confirms the validity of the user-selected theme using the system&#39;s defined themes.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Removes unsafe characters and sanitizes lengthy text for safe display or logging.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds for complex story generation with large prompts, configurable via env
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;.nuxt&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;coverage&#39;,
  &#39;logs&#39;,
] as const;
export const ERROR_MESSAGES = {
  LLM_UNAVAILABLE: &#39;LLM service is currently unavailable. Please check your configuration.&#39;,
  ANALYSIS_FAILED: &#39;Failed to analyze the project. Please ensure the path is valid.&#39;,
} as const;
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> provides a clear example of how timeout settings are customized through environment variables.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code> offers a practical pattern for excluding unnecessary files while ensuring focused directory scanning.</li>
<li><code class="inline-code">ERROR_MESSAGES</code> maintains a centralized repository of errors that improves code maintainability.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;]
  },
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
  }
} as const;

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
}
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> defines rich, structured metadata and demonstrates a best practice of centralizing schema-related data.</li>
<li><code class="inline-code">isValidTheme</code> uses a simple lookup method to ensure user inputs align with the adventure&#39;s thematic elements.</li>
<li><code class="inline-code">parseTheme</code> highlights robust input parsing and normalization for flexibility.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  if (!parsedTheme) {
    throw new Error(&#39;Invalid theme.&#39;);
  }
  return parsedTheme;
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  return input.replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;).slice(0, maxLength);
}
</code></pre>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> highlights a commitment to securing textual inputs through both trimming and length validation.</li>
<li><code class="inline-code">validateTheme</code> demonstrates dynamic validation logic aligned with system configurations and protections.</li>
<li><code class="inline-code">sanitizeForDisplay</code> ensures display-safe outputs by sanitizing potentially harmful characters.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Always take note of centralized resources like <code class="inline-code">THEMES</code> or <code class="inline-code">ERROR_MESSAGES</code> for efficient maintenance and extensibility.</li>
<li>Pay attention to input handling techniques like <code class="inline-code">sanitizeForDisplay</code> to protect against vulnerabilities.</li>
<li>Explore how configurations like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> simplify adjustments without requiring direct code modifications.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the adventure system! Your journey through the Codex is complete, and its ancient wisdom is now yours to wield.</p>
<p>Thou hast gloriously triumphed in deciphering the sacred enigmas of the Chamber of Themes, ascending as a seeker of wisdom with but one final quest until the halls of eternal knowledge shine upon thee! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>