<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Foundation Glyphs - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Pyramid of Infinite Scripts</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Foundation Glyphs</h1>
<hr>
<p>As the twilight sets over the dense jungle, you stand before the enigmatic chamber of Foundation Glyphs hidden inside the fabled Pyramid of Infinite Scripts. This chamber is said to hold the ancient wisdom necessary to piece together the scattered codices of the old civilization. The glyphs etched upon the stone walls whisper secrets of extracting and parsing divine wisdom, filtering paths of clarity amidst the labyrinth of raw data. Your task: uncover the knowledge of configuration, validation, and optimized tools that empower the creation of legendary systems.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Pathfinder Investigation</strong>: How does the <code class="inline-code">extractUniqueFilePaths</code> method systematically traverse and collect paths referenced in the configuration?</li>
<li>‚ö° <strong>Decoding Ritual</strong>: How does <code class="inline-code">parseAdventureConfig</code> ensure safe reading and parsing of the configuration files?</li>
<li>üõ°Ô∏è <strong>Optimization Analysis</strong>: What techniques does <code class="inline-code">formatAdventureConfigForPrompt</code> use to streamline output suitable for LLM processing while preserving critical details?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration utilities essential for managing and optimizing project-specific data</h3>
<p>This file is a treasure trove of tools designed to read, parse, and manipulate configuration data for adventures. It reveals how foundational elements like <code class="inline-code">parseAdventureConfig</code> create a structured understanding of configurations while ensuring safety from invalid data. The <code class="inline-code">extractUniqueFilePaths</code> method operates like a seasoned archaeologist, meticulously sifting through nested structures to uncover all file paths referenced in the configuration. Additionally, the <code class="inline-code">formatAdventureConfigForPrompt</code> function showcases an ancient optimization ritual that condenses verbose configurations into minimal, manageable formats for efficient processing.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Safely reads and parses JSON-based configuration data, providing structured insights or fallback mechanisms for errors.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Traverses configuration objects to identify and validate all unique file paths referenced within.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Formats and condenses configuration data into a compact structure suitable for external consumption by tools.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>This function acts like a translator for ancient texts, carefully parsing the configuration file into a readable artifact while ensuring safety against corrupted glyphs.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<p>Like a cartographer mapping unknown territories, this function systematically explores nested configurations to extract and validate paths.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths - LLM can see descriptions in actual code
    const filePaths = quest.files
      .filter((f: any) =&gt; f.path)
      .map((f: any) =&gt; f.path);
    if (filePaths.length &gt; 0) {
      formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    }
    
    // Just function names - LLM can understand purpose from implementation
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .filter((h: any) =&gt; h.name)
      .map((h: any) =&gt; h.name);
    if (functions.length &gt; 0) {
      formatted += `Functions: ${functions.join(&#39;, &#39;)}\n`;
    }
    
    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<p>This function embodies the art of reduction, distilling the sprawling configurations into a compact artifact while retaining essential details.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">parseAdventureConfig</code> as a starting point to understand how data unfolds; it is a foundational glyph in this chamber.</li>
<li>Cross-reference the output of <code class="inline-code">extractUniqueFilePaths</code> with actual file structures to verify completeness.</li>
<li>Test the streamlined format produced by <code class="inline-code">formatAdventureConfigForPrompt</code> with a sample LLM prompt for clarity.</li>
</ul>
<hr>
<p>The glyphs have revealed their truths to you, brave seeker. Venture onward to uncover the Pyramid&#39;s deeper mysteries!</p>
<p>Behold the triumph of Quest 5: The Foundation Glyphs, for thou hath unveiled sacred wisdom from the ancient codex and ascended further on the luminous path of destiny‚Äîonly one hallowed trial remains, O seeker of eternal truths! üíé‚ö°üó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>