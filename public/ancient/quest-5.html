<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Altar of Interaction - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Code of Lost Civilizations</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Altar of Interaction</h1>
<hr>
<p>In the heart of the ancient jungle, amidst the undisturbed ruins of a sophisticated past, you discover the &quot;Altar of Interaction&quot;‚Äîa construct used to harmonize systems within this lost civilization. By studying the intricate code paths and interacting with the structures of their technologies, you can uncover how their interconnected frameworks operated with precision. This altar&#39;s glyphs speak of systems that once synchronized the civilization‚Äôs greatest tools, ensuring seamless exchanges of power and wisdom. Decode the messages hidden within and restore their essence to the present.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Weaves</strong>: How are themes defined and categorized to maintain their sacred significance across the system?</li>
<li>‚ö° <strong>Validation Mechanisms</strong>: What techniques are used to safeguard user inputs and ensure harmony with the system requirements?</li>
<li>üõ°Ô∏è <strong>Resurrection of Settings</strong>: How does the system preserve and apply key configuration details to optimize interactions?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Settings</h3>
<p>This file establishes the foundational settings for the interaction systems, defining how resources like timeouts and limits are managed across the platform. The constants here are like the sacred equations that govern the altar‚Äôs rituals, structuring parameters for harmonious operations. It provides essential configurations for API interactions, error messaging, and key limits like maximum file sizes and processing times.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> controls the allowable duration for data exchanges, ensuring that distant &quot;rituals&quot; complete without undue delays.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> manages caching lifespans, reflecting the civilization‚Äôs efficient reuse of memory.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> upholds the altar‚Äôs sacred rule of analyzing only manageably sized files.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds for complex story generation with large prompts, configurable via env
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>These constants define essential operational limits for the system, reflecting optimized thresholds for performance.</li>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> allows flexibility by enabling configuration via environment variables (env).</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> illustrates the efficient reuse of resources by limiting cache lifetimes.</li>
<li>The <code class="inline-code">MAX_FILE_SIZE_MB</code> rule prioritizes focus, avoiding hazardous file sizes.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Definitions</h3>
<p>This module serves as the definitive guide to the themes of the system, akin to the architectural blueprints of the altar. It describes each &quot;theme&quot; with attributes like name, symbol, description, and its alignment with potential user inputs. These definitions form the heart of maintaining the altar‚Äôs symbolic power and aesthetic harmony.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> enumerates the core identities of each theme and their unique attributes, preserving the integrity of cultural designs.</li>
<li><code class="inline-code">getAllThemes</code> simplifies accessing all thematic definitions for system-wide consistency.</li>
<li><code class="inline-code">parseTheme</code> employs string-matching techniques to interpret user-provided inputs, mapping them to valid themes.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: { ... },
  MYTHICAL: { ... },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  DEVELOPER: { ... },
  CUSTOM: { ... }
} as const;
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> defines the symbolic and functional identity of each theme, capturing its essence with clear attributes.</li>
<li>Specifically, the &quot;ANCIENT&quot; theme matches the overarching narrative with its archaeological descriptors.</li>
<li>Using <code class="inline-code">as const</code> ensures these values remain immutable, mirroring the sacred permanence of the altar&#39;s inscriptions.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li><code class="inline-code">getAllThemes</code> centralizes access to all thematic options, maintaining a consistent source of truth across the system.</li>
<li>This simple function highlights efficient data design by leveraging the existing <code class="inline-code">THEMES_ARRAY</code>.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li><code class="inline-code">parseTheme</code> employs multiple strategies to interpret input, showcasing flexibility and robustness.</li>
<li>It performs direct matches, numeric ID checks, and keyword inclusions to ensure accuracy in identifying themes.</li>
<li>This method reinforces a user-friendly interplay with the altar, permitting varied input styles.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Validation Rites</h3>
<p>As the guardians of the altar&#39;s integrity, these validation functions ensure all interactions align with the civilization‚Äôs established rules. This file harmonizes the inputs to maintain the sanctity of the system, guarding against corruption and invalid operations.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> ensures ritualistic inputs adhere to structural constraints.</li>
<li><code class="inline-code">validateTheme</code> confirms that themes are valid offerings, reflecting the sacred allowances of the altar.</li>
<li><code class="inline-code">sanitizeForDisplay</code> protects visual representations from disruptive anomalies.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>This function checks for the presence of input, trims whitespace, and enforces a character limit to keep choices concise.</li>
<li>It represents a simple yet impactful layer against disruptive inputs, upholding clarity and focus.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>This function validates user-provided themes by normalizing inputs and ensuring validity through predefined sacred lists.</li>
<li>Dynamic error handling offers both precision and user guidance.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><code class="inline-code">sanitizeForDisplay</code> protects visual outputs from harmful content by stripping dangerous characters and trimming excess.</li>
<li>By inline cleaning, it supports the altar‚Äôs display mechanisms in maintaining purity and elegance.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Pay attention to how immutability in <code class="inline-code">THEMES</code> enhances reliability.</li>
<li>Consider the layered input validations and how they mitigate risks.</li>
<li>Examine how the <code class="inline-code">parseTheme</code> function balances user flexibility with stability.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Altar of Interaction! Your adventure is complete.</p>
<p>Hail, seeker of wisdom, for thou hast unlocked the sacred truths of the Altar of Interaction, traversing the ancient path with valor and drawing ever nearer to the luminous summit of enlightenment‚Äîpress on, chosen one, for the final star-lit trial awaits! üöÄüíéüó∫Ô∏è‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>