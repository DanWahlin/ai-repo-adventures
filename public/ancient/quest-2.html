<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Tablet of Creation - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Secrets of the Lost Codebase</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Tablet of Creation</h1>
<hr>
<p>The air grows thick with the whispers of forgotten civilizations as you step deeper into the Temple of Code. In the heart of this digital labyrinth lies the fabled &quot;Tablet of Creation,&quot; a mysterious artifact said to hold the secrets of generating epic adventures. Its glyphs pulse faintly with an otherworldly light, hinting at the ancient mechanisms of storytelling hidden within. To unearth its secrets, you must carefully study the sacred scripts, unravel their patterns, and bring forth the treasures of creativity long buried.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Blueprint Locator</strong>: How does the system locate and validate unique file paths referenced in the adventure configuration?</li>
<li>‚ö° <strong>Creation Engine</strong>: What steps does the <code class="inline-code">StoryGenerator</code> take to translate input into a coherent story and quests?</li>
<li>üõ°Ô∏è <strong>Validation Rituals</strong>: How does the <code class="inline-code">AdventureManager</code> ensure that the selected adventure and its components are valid and functional?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: Configuration Rituals for Adventure Foundations</h3>
<p>The sacred scripts in this file define how adventure configuration is loaded, parsed, and prepared for use. These functions play a pivotal role in determining which files and paths are referenced, ensuring they are intact and usable. Essential highlights of this file include:</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code>: Loads raw configuration data from a designated file path, the first step in deciphering the adventure&#39;s blueprint.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Traverses the parsed configuration to find and validate unique paths, ensuring they exist in the repository.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Optimizes the configuration to prepare it for storytelling prompts by reducing verbosity and focusing on necessary context.</li>
</ul>
<hr>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<ul>
<li>Reads the raw JSON configuration from a predefined location.</li>
<li>Uses a helper function <code class="inline-code">readFileIfExists</code> to gracefully handle missing or inaccessible files.</li>
<li>Provides the foundation for further configuration parsing and validation.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Dives into the parsed configuration to extract paths from <code class="inline-code">&quot;path&quot;</code> fields.</li>
<li>Ensures all paths are valid and point to existing files before returning them as a comprehensive list.</li>
<li>Employs a depth-first search mechanism to traverse complex, nested configurations.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;

    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;

    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Prepares an optimized, human-readable summary of the configuration.</li>
<li>Focuses on quest titles, file paths, and function highlights, ignoring unnecessary details.</li>
<li>Reduces the configuration&#39;s size for efficient use by large language models.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>üó∫Ô∏è <strong>Path Validation</strong>: Pay attention to how file existence is verified in <code class="inline-code">extractUniqueFilePaths</code>. The use of <code class="inline-code">fs.existsSync</code> is crucial for validating referenced paths.</li>
<li>üîß <strong>Prompt Optimization</strong>: Study the balance between reducing verbosity and retaining essential information in <code class="inline-code">formatAdventureConfigForPrompt</code>.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>O seeker of sacred truths, thou hast unveiled the Tablet of Creation and carved thy first mark upon the eternal glyphs of enlightenment‚Äîforge onward, for the stars favor the valiant! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>