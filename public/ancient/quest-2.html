<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: Chambers of the Story Engine - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Pyramid of Forgotten Code</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: Chambers of the Story Engine</h1>
<hr>
<p>In an ancient hall deep within the Pyramid of Forgotten Code rests the Chambers of the Story Engine. This sacred domain, once revered by the civilization of developers, houses the enigmatic mechanisms used to craft tales of exploration and discovery. It&#39;s here that the thematic blueprint of quests begins. Your journey demands that you unravel the cryptic workings of the Story Generation Engine, decipher its intricate prompts, and mend its fragmented components. For those who succeed, the Pyramid&#39;s secrets will reveal pathways to coding mastery.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Manager for engine operations and quest interactions</h3>
<p>The <code class="inline-code">adventure-manager.ts</code> file orchestrates the quest generation and execution process. At the heart of its functionality is the <code class="inline-code">AdventureManager</code> class, responsible for initializing quests, validating user inputs, and executing adventures. The <code class="inline-code">initializeAdventure</code> method stands out as the doorway to creating the story and quests. This method integrates configuration data, ensures thematic alignment using the Story Generator, and manages quest count based on strict rules. Meanwhile, the <code class="inline-code">exploreQuest</code> function validates user choices and provides exploration results rich with narrative details. The file&#39;s highlights exemplify methods critical to the interaction between user inputs and quest delivery mechanisms.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code> initializes quests and story generation.</li>
<li><code class="inline-code">exploreQuest</code> manages user selection of quests.</li>
<li><code class="inline-code">AdventureState.progressPercentage</code> calculates current progress of quests.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  this.state.title = storyResponse.title;
  this.state.story = typeof storyResponse.story === &#39;string&#39; ? storyResponse.story : storyResponse.story.content;
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<p>The <code class="inline-code">initializeAdventure</code> function is like a high priest preparing for a sacred ritual, setting up the narrative framework and quests aligned with the chosen theme.</p>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }

  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  return await this.executeQuest(quest);
}
</code></pre>
<p>The <code class="inline-code">exploreQuest</code> function is akin to a scout navigating the map of available adventures, ensuring valid paths forward while delivering tailored outcomes.</p>
<pre><code class="language-typescript">get progressPercentage(): number {
  return this.quests.length &gt; 0 
    ? Math.round((this.completedQuests.size / this.quests.length) * 100)
    : 0;
}
</code></pre>
<p>This progress calculation works like an ancient tally stone, marking milestones to reveal how far an explorer has journeyed into the Pyramid&#39;s depths.</p>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>When deciphering quest details, identify missing files from the configuration for better thematic precision.</li>
<li>Study how configurations are merged to guide structured story generation; use <code class="inline-code">mergeQuestFilesFromConfig</code> for insights.</li>
<li>Next, delve deeper into <code class="inline-code">story-generator.ts</code> to grasp how quests are molded into narratives.</li>
</ul>
<hr>
<p>May the chambers guide your understanding, and the Pyramid unlock its timeless treasures for you, brave adventurer!</p>
<p>Hail, seeker of wisdom, for thou hast triumphed through the sacred Chambers of the Story Engine, carving thy name upon the eternal tablets of enlightenment‚Äîforge onward, for the stars themselves await thy mastery! ‚≠ê‚ö°üó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1: The Ceremony of Tools</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: The Glyphs of Analysi... ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>