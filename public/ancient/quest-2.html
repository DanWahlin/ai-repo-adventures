<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Glyph of Eternal Stories - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Pyramid of Ancient Algorithms</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Glyph of Eternal Stories</h1>
<hr>
<p>Beneath the sweltering canopy of the jungle, you find yourself scaling the vine-laden outer walls of the Codex Obscurum. A foreboding sense of destiny weighs heavy as you approach the chamber of the second glyph. Inscribed upon an ancient pedestal is what the scholars called the Glyph of Eternal Stories. This glyph is said to contain the esoteric understanding of how tales are formed and delivered. To uncover its secret, you must explore the quest generation mechanisms within the pyramid‚Äôs structure.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>The Power of Initialization</strong>: How does the <code class="inline-code">AdventureManager.initializeAdventure</code> method construct and prepare a new adventure for interpretation and execution?</li>
<li>‚ö° <strong>The Energy of Exploration</strong>: What does the <code class="inline-code">AdventureManager.exploreQuest</code> method reveal about selecting and navigating individual quests?</li>
<li>üõ°Ô∏è <strong>The Technique of Story Generation</strong>: How does the <code class="inline-code">StoryGenerator.generateStoryAndQuests</code> method gather project details and theme context to craft adventures?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Core adventure management</h3>
<p>This file governs the overall logic for initializing adventures, tracking progress, and executing quests. Central to this is the <code class="inline-code">AdventureManager</code> class, which acts as the guide for the adventurer‚Äôs exploration within the pyramid.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Constructs a new adventure from the depths of the project‚Äôs context, resetting the state and applying thematic elements to create a rich exploratory experience. </li>
<li><code class="inline-code">exploreQuest</code>: Orchestrates the execution of a chosen quest, validating input, fetching quest-specific details, and marking progress along the journey.</li>
<li><code class="inline-code">AdventureState.progressPercentage</code>: Offers insight on how much of the current adventure has been completed, providing clarity on the adventurer‚Äôs progress.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  // Reset state for new adventure
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  // Set custom theme data if provided
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  // Generate the overall story and quests using LLM
  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;
  
  // Merge files from adventure config into the generated quests
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  
  // Enforce quest count from adventure.config.json if it exists
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  // Return the story with available quests
  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<ul>
<li>This method resets the current state, essentially clearing out any residue from past adventures, ensuring a clean slate.</li>
<li>It utilizes the <code class="inline-code">storyGenerator.generateStoryAndQuests</code> to craft the narrative, highlighting its dependency on the <code class="inline-code">StoryGenerator</code> class.</li>
<li>Data merging via <code class="inline-code">mergeQuestFilesFromConfig</code> integrates quest-related information directly from the configuration.</li>
<li>Theming options, including custom data, enhance immersion by tailoring the story to the adventurer‚Äôs preferences.</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  
  // Check if this is a progress request
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }
  
  // Find the quest based on the choice
  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  // Execute the quest
  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li>This function interprets the user‚Äôs choice, ensuring its validity through <code class="inline-code">validateAndSanitizeChoice</code>.</li>
<li>By identifying if the choice pertains to progress or quest details, it adapts its response dynamically.</li>
<li>Quest execution is offloaded to <code class="inline-code">executeQuest</code> once a specific quest is identified, showcasing modularized logic.</li>
</ul>
<hr>
<pre><code class="language-typescript">get progressPercentage(): number {
  return this.quests.length &gt; 0 
    ? Math.round((this.completedQuests.size / this.quests.length) * 100)
    : 0;
}
</code></pre>
<ul>
<li>Calculates the ratio of completed quests to total quests, expressed as a percentage.</li>
<li>Provides a concise metric-driven overview of the adventurer‚Äôs progress within the narrative arc.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Consider the use of the <code class="inline-code">state.reset()</code> method before new initialization. It is key to ensuring a pristine state for fresh adventures.</li>
<li>Pay attention to the integration between <code class="inline-code">mergeQuestFilesFromConfig</code> and <code class="inline-code">enforceConfigQuestCount</code>. These demonstrate how configuration input shapes quest availability.</li>
<li>Study the modularity and flow central to <code class="inline-code">exploreQuest</code>. Its simplicity belies the intricate mechanisms at play.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Hark, seeker of wisdom, thou hast unveiled the illustrious Glyph of Eternal Stories‚Äîan arcane testament to thy growing mastery, guiding thee ever closer to the sanctified altar of knowledge! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>