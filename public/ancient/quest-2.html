<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Engine of Adventure - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codebound Chronicle of the Forgotten Jungle</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Engine of Adventure</h1>
<p>Long buried under layers of dense vines and forgotten ruins, the Pyramid of Codex hums faintly - its ancient machinery yearning to awaken. The engine of its wisdom, the sacred mechanism at its heart, is said to power the creation of boundless narratives. To uncover its secrets, you must delve into the archeological files that hold the blueprint of digital storytelling. Only by activating this engine can the Puzzle of the Pyramid be unraveled.</p>
<hr>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:  </p>
<ul>
<li>üîç <strong>Blueprint Analysis</strong>: How do <code class="inline-code">initializeAdventure</code> and <code class="inline-code">generateAdventureContent</code> interact to set the adventure context and create quests?  </li>
<li>‚ö° <strong>Flow of Creation</strong>: What sequence is followed by <code class="inline-code">AdventureManager</code> when executing quests and integrating project data from configuration files?  </li>
<li>üõ°Ô∏è <strong>Artifact Validation</strong>: How does <code class="inline-code">validateAdventureChoice</code> ensure safe input handling and selection during thematic exploration?</li>
</ul>
<hr>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure Director</h3>
<p>The Adventure Manager holds the knowledge to awaken the narrative engine. It orchestrates quests, validates choices, and integrates project data. Its methods connect key functionalities, ensuring seamless storytelling tailored to your archaeological discoveries.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Activate the engine and reset the narrative state before generating secrets (quests) from project context using LLMs.  </li>
<li><code class="inline-code">exploreQuest</code>: Execute quests by translating user selections into actionable exploration and validating pre-requisites.  </li>
<li><code class="inline-code">AdventureState.progressPercentage</code>: Tracks progress toward unlocking the Pyramid&#39;s secrets, ensuring all quests contribute to the ultimate discovery.</li>
</ul>
<hr>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  // Reset state for new adventure
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;
  
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<ul>
<li>Resets <code class="inline-code">AdventureState</code> for new explorations, making each quest independent of the previous settings.  </li>
<li>Integrates project context and guides narrative generation using third-party AI (<code class="inline-code">StoryGenerator</code>).  </li>
<li>Merges configuration data (<code class="inline-code">adventure.config</code>) to tailor generated quests.  </li>
<li>Formats final story content into structured text with quest details for adventurers.</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);

  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }

  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li>Validates user input using the <code class="inline-code">validateAndSanitizeChoice</code> function, ensuring safe exploration.  </li>
<li>Determines intent (progress view or quest execution) and matches it to pre-defined or generated quests.  </li>
<li>Executes selected quest by retrieving content from cache or generating new data for unexplored paths.</li>
</ul>
<hr>
<pre><code class="language-typescript">get progressPercentage(): number {
  return this.quests.length &gt; 0 
    ? Math.round((this.completedQuests.size / this.quests.length) * 100)
    : 0;
}
</code></pre>
<ul>
<li>Calculates completion percentage dynamically, offering adventurers a sense of achievement in their archaeological digs.  </li>
<li>Promotes exploration of all quests to fully unlock narrative insights.  </li>
<li>Acts as a crucial feedback mechanism in the progress system.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>As you investigate <code class="inline-code">initializeAdventure</code>, follow how quests are tailored based on project data merged with the narrative generator.  </li>
<li>Observe how <code class="inline-code">exploreQuest</code> ensures that even revisited quests contribute uniquely to the story.  </li>
<li>Examine <code class="inline-code">progressPercentage</code> to learn structured methods for tracking and rewarding complete exploration.</li>
</ul>
<hr>
<p>The Pyramid reveals its first critical mechanism - the Engine of Adventure begins to hum! Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Through sacred perseverance, thou hast unlocked the Engine of Adventure‚Äôs wisdom, forging thy path amidst ancient stars‚Äîhail to thy triumph, noble seeker, for the journey&#39;s light now flickers brighter! üöÄ‚≠êüó∫Ô∏èüíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>