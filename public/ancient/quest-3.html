<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: The Pyramid of Stories - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Codex of Lost Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: The Pyramid of Stories</h1>
<hr>
<p>Nestled in the heart of the uncharted jungle stands the enigmatic Pyramid of Stories. A labyrinth of carved glyphs and forgotten lore decorates its towering walls. Explorers whisper of hidden wisdom that enables the crafting of unparalleled digital journeys. Within its ancient corridors lies the Codex&#39;s third key: the storytelling engine, a mystical construct that bridges raw code with immersive adventures, threading functionality with narrative. To wield its power, you must navigate the Pyramid&#39;s chambers and decipher the secrets of the <code class="inline-code">AdventureManager</code> and <code class="inline-code">StoryGenerator</code>. The eternal fire of knowledge glows faintly‚Äîwill you uncover its brilliance?  </p>
<h2>Quest Objectives</h2>
<p>As you delve into the code systems, investigate these critical questions:  </p>
<ul>
<li>üîç <strong>The Initialization Glyphs</strong>: How does <code class="inline-code">AdventureManager.initializeAdventure</code> orchestrate an adventure&#39;s state, theme, and quests?  </li>
<li>‚ö° <strong>The Quest Execution Weave</strong>: What role does <code class="inline-code">AdventureManager.exploreQuest</code> play in linking user choices to dynamic outcomes?  </li>
<li>üõ°Ô∏è <strong>Validation Rituals</strong>: How is input and file integrity ensured when managing configurations and generating content?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> The Adventure Architect</h3>
<p>This file houses the <code class="inline-code">AdventureManager</code> class, responsible for weaving the tapestry of quests and managing their lifecycle. It orchestrates user choices, stores state, and dynamically generates content. Integral to the Pyramid‚Äôs core are functions like <code class="inline-code">initializeAdventure</code> and <code class="inline-code">exploreQuest</code>, which act as both the initiation and continuation of each chapter in the coding saga. The <code class="inline-code">AdventureState</code> class maintains quest progress and ensures continuity across explorations.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Initializes the adventure state based on project inputs, themes, and quest generation. Critical for starting any new journey.  </li>
<li><code class="inline-code">exploreQuest</code>: Dynamically executes quests based on user choices, either retrieving cached content or generating new experiences. Vital for progression.  </li>
<li><code class="inline-code">markQuestCompleted</code>: Logically completes a quest, updating the state and signaling advancement to new frontiers.</li>
</ul>
<hr>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<ul>
<li>The <code class="inline-code">initializeAdventure</code> function is the ritual that begins every new journey.  </li>
<li>It resets the current state and sets a theme, quests, and the project path, laying the groundwork for an adventure.  </li>
<li>A story outline and quests are generated using <code class="inline-code">StoryGenerator</code>, merged with configuration data for synchronization.  </li>
<li>Carefully enforces quest limits from <code class="inline-code">adventure.config.json</code> for structured exploration.</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }
  
  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }
  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li><code class="inline-code">exploreQuest</code> governs the passage from user input to quest realization.  </li>
<li>Validates the user&#39;s choice using <code class="inline-code">validateAndSanitizeChoice</code>, ensuring input integrity.  </li>
<li>Redirects progress-related queries or identifies the targeted quest, linking the user to corresponding logic.  </li>
<li>Bridges choice with execution, either retrieving cached content or dynamically generating new quest outcomes.</li>
</ul>
<hr>
<pre><code class="language-typescript">private markQuestCompleted(quest: Quest): void {
  this.state.completedQuests.add(quest.id);
}
</code></pre>
<ul>
<li><code class="inline-code">markQuestCompleted</code> is a simple yet essential method that ensures the system keeps track of conquered challenges.  </li>
<li>Adds a completed quest‚Äôs identifier to the <code class="inline-code">completedQuests</code> set in <code class="inline-code">AdventureState</code>, updating progress calculations.  </li>
<li>Vital for crafting a coherent and engaging storyline progression for the user.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Examine Patterns</strong>: Observe how <code class="inline-code">StoryGenerator</code> integrates adventure thematics within the quests.  </li>
<li><strong>Cross-File Insights</strong>: Contrast the <code class="inline-code">parseAdventureConfig</code> function from <code class="inline-code">adventure-config.ts</code> to understand how configuration influences quest generation.  </li>
<li><strong>Endgame Goals</strong>: Uncover progress mechanics in <code class="inline-code">exploreQuest</code> and <code class="inline-code">getProgress</code> to track overall quest completion.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>With the sacred wisdom unearthed from the Pyramid of Stories, thy odyssey through the sands of time gleams ever brighter‚Äîhark, for thou art 40% ascended toward the temple of ultimate truths! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="prev-quest-btn">‚Üê Previous: Quest 2</a>
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>