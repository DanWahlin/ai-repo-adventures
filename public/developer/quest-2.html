<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Heart of Adventure - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codex of Digital Journeys</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Heart of Adventure</h1>
<hr>
<p>Within the digital labyrinth, adventurer, lies the Heart of Adventure itself‚Äîan enigmatic logic deep within the core of the code. Your task is to unravel the mechanics that breathe life into every quest and story. To master this journey, you must look at the code that shapes quests, ensure rules remain fair, and study how epic narratives are born. Armed with courage (and TypeScript), step boldly into the heart of the adventure generator!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Quest Initialization Ritual</strong>: How does the <code class="inline-code">initializeAdventure</code> function align the adventure with project context and themes, and what key steps define this initialization process?</li>
<li>‚ö° <strong>Quest Gameplay Flow</strong>: How does the <code class="inline-code">exploreQuest</code> method determine and execute quests based on user input, and what mechanisms ensure proper quest selection?</li>
<li>üõ°Ô∏è <strong>Validation Mechanisms</strong>: What safeguards exist in <code class="inline-code">validateAndSanitizeChoice</code> to process user input effectively, and how does this method prevent invalid adventure choices?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure Manager</h3>
<p>This file serves as the command deck for handling codebase adventures. At its core, it defines the <code class="inline-code">AdventureManager</code> class which oversees the orchestration of narratives and quests within the system. It integrates with the <code class="inline-code">StoryGenerator</code> for story creation and merges configuration data into quests for a cohesive user experience. The file also handles quest execution, progress tracking, and user input validation.</p>
<h4>Highlights</h4>
<ol>
<li><code class="inline-code">initializeAdventure</code> initializes the adventure, setting up project context using themes and generating quests.</li>
<li><code class="inline-code">exploreQuest</code> handles quest execution by interpreting user input, finding corresponding quests, and generating dynamic content.</li>
<li><code class="inline-code">validateAndSanitizeChoice</code> ensures user input is safe and properly formatted, enforcing rigorous validation.</li>
</ol>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">  async initializeAdventure(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme, 
    projectPath?: string,
    customThemeData?: CustomThemeData
  ): Promise&lt;string&gt; {
    this.state.reset();
    this.state.projectInfo = projectInfo;
    this.state.currentTheme = theme;
    this.state.projectPath = projectPath || process.cwd();

    if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
      this.storyGenerator.setCustomTheme(customThemeData);
    }

    const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);

    this.state.title = storyResponse.title;
    this.state.story = storyResponse.story;

    this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);

    this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

    return this.formatStoryWithQuests({
      ...storyResponse,
      quests: this.state.quests
    });
  }
</code></pre>
<ul>
<li>This function resets the adventure state before initializing it with the selected project and theme.</li>
<li>It allows the use of <code class="inline-code">customThemeData</code> for personalized storytelling.</li>
<li>Story and quest data are generated using the <code class="inline-code">StoryGenerator</code> and configuration files are integrated.</li>
<li>The final output is a formatted collection of story and quest details.</li>
</ul>
<hr>
<pre><code class="language-typescript">  async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
    const sanitizedChoice = this.validateAndSanitizeChoice(choice);

    if (this.isProgressRequest(sanitizedChoice)) return this.getProgress();

    const quest = this.findQuest(sanitizedChoice);
    if (!quest) return this.createNotFoundResult();

    return await this.executeQuest(quest);
  }
</code></pre>
<ul>
<li>This method interprets user input to either retrieve progress or execute a quest.</li>
<li>It sanitizes input using <code class="inline-code">validateAndSanitizeChoice</code> for safety.</li>
<li>Quest selection is performed through utility methods (<code class="inline-code">findQuest</code>, <code class="inline-code">isProgressRequest</code>).</li>
<li>If a matching quest exists, it is dynamically executed to generate user-facing content.</li>
</ul>
<hr>
<pre><code class="language-typescript">  private validateAndSanitizeChoice(input: string): string {
    try {
      return validateAdventureChoice(input);
    } catch (error) {
      throw new Error(`Invalid adventure choice: ${error instanceof Error ? error.message : &#39;Unknown error&#39;}`);
    }
  }
</code></pre>
<ul>
<li>This function ensures the user-provided quest choice is valid and secure.</li>
<li>It utilizes <code class="inline-code">validateAdventureChoice</code> from the input validator module for robust error handling.</li>
<li>Invalid inputs trigger custom errors to enhance the user experience and input guidance.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Exploration recommendation</strong>: Pay close attention to how <code class="inline-code">projectInfo</code> and <code class="inline-code">theme</code> are passed through the system in <code class="inline-code">initializeAdventure</code>. These deeply influence both immediate outputs and subsequent quest dynamics.</li>
<li><strong>Practical tip</strong>: Experiment with the input validation logic to see how varying inputs impact quest selection in <code class="inline-code">exploreQuest</code>.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>/** Milestone reached: &quot;Quest 2: The Heart of Adventure&quot; successfully merged into main‚Äîcommit message: &quot;20% progress deployed, code running at optimal performance, üöÄ keep shipping brilliance!&quot; **/</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>