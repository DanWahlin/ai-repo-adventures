<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: Quest Generation Engine - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Developer Documentation Generator for Repository Analysis</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: Quest Generation Engine</h1>
<h2>Technical Overview</h2>
<p>The Quest Generation Engine is responsible for creating and managing quests based on project data and selected themes. It leverages a StoryGenerator for generating narrative-driven content and integrates configuration files to adjust quest properties dynamically. This engine acts as the core logic for transforming technical information into interactive, structured quests.</p>
<h2>Key Components</h2>
<ul>
<li><strong>AdventureManager</strong>:<ul>
<li>Central manager for state and operations related to quests and the adventure lifecycle.</li>
<li>Interfaces with the StoryGenerator and handles quest initialization, execution, progress management, and state reset.</li>
<li>Provides methods for validating user inputs and caching quest content.</li>
</ul>
</li>
<li><strong>AdventureState</strong>:<ul>
<li>Maintains application state, such as quests, completed quests, current theme, and progress percentage.</li>
<li>Provides utility methods like <code class="inline-code">reset()</code> and dynamic progress computation via <code class="inline-code">progressPercentage</code>.</li>
</ul>
</li>
<li><strong>StoryGenerator</strong>:<ul>
<li>Responsible for generating quest narratives, story structure, and completion summaries using an LLM (Language Model).</li>
<li>Implements methods for parsing markdown responses and constructing prompts for the LLM.</li>
</ul>
</li>
<li><strong>Adventure Config Handling</strong>:<ul>
<li>Config file parsing through <code class="inline-code">parseAdventureConfig</code> and <code class="inline-code">formatAdventureConfigForPrompt</code>.</li>
<li>Handles merging external configuration files into dynamically generated quests.</li>
</ul>
</li>
</ul>
<h2>Implementation Details</h2>
<h3>Architectural Patterns</h3>
<ul>
<li><strong>Stateful Design</strong>: The <code class="inline-code">AdventureState</code> object is used to encapsulate the current adventure&#39;s state and is managed centrally by the <code class="inline-code">AdventureManager</code>.</li>
<li><strong>LLM Integration</strong>: Leveraging the Language Model (via <code class="inline-code">LLMClient</code>) allows for dynamic storytelling, quest descriptions, and progression summaries. Prompts are formatted and validated rigorously before sending to the LLM.</li>
<li><strong>Configuration-Driven Customization</strong>: Config files (e.g., <code class="inline-code">adventure.config.json</code>) are parsed to influence quest generation, including specific files, custom instructions, and quest counts.</li>
<li><strong>Content Caching</strong>: Completed quest data is cached using a <code class="inline-code">Map</code> to avoid redundant API calls and improve performance during quest revisits.</li>
</ul>
<h3>Key Design Decisions</h3>
<ol>
<li><strong>Quest Object Structure</strong>: Standardized objects (e.g., <code class="inline-code">Quest</code> and <code class="inline-code">QuestContent</code>) allow consistent handling across the engine.</li>
<li><strong>Integration Points</strong>: The engine merges dynamically generated quest content with pre-defined configurations from project files, ensuring flexibility and extensibility.</li>
<li><strong>Validation and Error Handling</strong>: Input sanitization in <code class="inline-code">validateAndSanitizeChoice()</code> guarantees robust handling of user interactions.</li>
</ol>
<h2>Code Examples</h2>
<h3>Initializing Adventure and Loading Quests</h3>
<pre><code class="language-typescript">const adventureManager = new AdventureManager();
const story = await adventureManager.initializeAdventure(projectInfo, &#39;developer&#39;, &#39;/path/to/project&#39;);

console.log(&#39;Story:&#39;, story); // Returns formatted story with available quests
console.log(&#39;Quests:&#39;, adventureManager.getAllQuests()); // Access all generated quests
</code></pre>
<h3>Exploring a Quest</h3>
<pre><code class="language-typescript">const result = await adventureManager.exploreQuest(&#39;quest-1&#39;);
console.log(&#39;Quest Narrative:&#39;, result.narrative);
console.log(&#39;Progress Update:&#39;, result.progressUpdate);
</code></pre>
<h3>Handling Cache for Completed Quests</h3>
<pre><code class="language-typescript">// Access cached content for a completed quest
if (adventureManager.state.completedQuests.has(&#39;quest-1&#39;)) {
  const cachedContent = adventureManager.state.questContentCache.get(&#39;quest-1&#39;);
  console.log(&#39;Cached Quest:&#39;, cachedContent?.content.adventure);
}
</code></pre>
<h3>Merging Configuration Files into Quests</h3>
<pre><code class="language-typescript">const quests = adventureManager.mergeQuestFilesFromConfig(generatedQuests, &#39;/path/to/project&#39;);
console.log(&#39;Configured Quests:&#39;, quests); // Includes file paths from adventure.config.json
</code></pre>
<h2>Integration Points</h2>
<ul>
<li><strong>LLMClient</strong>:<ul>
<li>Provides API calls to generate story content (<code class="inline-code">generateStoryAndQuests</code>) and detailed quest content.</li>
<li>Facilitates prompt-based generation of narrative and technical responses.</li>
</ul>
</li>
<li><strong>Repo Analyzer</strong>:<ul>
<li>Analyzes project directories and generates targeted content for specific files or overall project summaries.</li>
<li>Utility methods like <code class="inline-code">generateTargetedContent</code> enhance quest engagement by focusing on meaningful sections of code.</li>
</ul>
</li>
<li><strong>Adventure Config Parser</strong>:<ul>
<li>Parses <code class="inline-code">adventure.config.json</code> to impose constraints like quest count or highlight specific files.</li>
<li>Formats configuration for LLM prompts, ensuring context is aligned with user-defined settings.</li>
</ul>
</li>
</ul>
<h2>Best Practices &amp; Considerations</h2>
<ul>
<li><strong>State Management</strong>:<ul>
<li>Use <code class="inline-code">AdventureState.reset()</code> method to cleanly initialize state for new adventures.</li>
<li>Avoid directly modifying the state properties outside of the <code class="inline-code">AdventureManager</code> methods.</li>
</ul>
</li>
<li><strong>Input Validation</strong>:<ul>
<li>Always use <code class="inline-code">validateAndSanitizeChoice()</code> to sanitize user inputs and prevent injection risks.</li>
</ul>
</li>
<li><strong>Error Handling</strong>:<ul>
<li>Ensure fallback mechanisms for missing or malformed configurations‚Äîalways validate <code class="inline-code">adventure.config.json</code>.</li>
</ul>
</li>
<li><strong>Content Caching</strong>:<ul>
<li>Leverage cached content for revisited quests to minimize LLM API call costs and maximize efficiency.</li>
</ul>
</li>
<li><strong>Quest Customization</strong>:<ul>
<li>Use <code class="inline-code">customThemeData</code> for creating unique story themes. Ensure keywords align with documentation constraints.</li>
</ul>
</li>
<li><strong>Config Enforcement</strong>:<ul>
<li>Use <code class="inline-code">enforceConfigQuestCount()</code> to ensure quest list complies with user-defined limits specified in the project configuration.</li>
</ul>
</li>
<li><strong>LLM Prompt Design</strong>:<ul>
<li>Maintain strict formatting standards for LLM prompts to achieve reliable and deterministic results.</li>
</ul>
</li>
</ul>
<p>Congratulations on successfully deploying the Quest Generation Engine for Quest 2‚Äîyour codebase is generating adventures at 20% completion efficiency; keep iterating towards the ultimate ‚≠êüöÄ milestone!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-1.html" class="prev-quest-btn">‚Üê Previous: Quest 1</a>
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>