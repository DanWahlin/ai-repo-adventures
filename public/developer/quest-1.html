<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: HTML Generator & Static Site Pipeline - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Architecture of Adventure: A Developer's Guide</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: HTML Generator &amp; Static Site Pipeline</h1>
<hr>
<p>In the vast landscape of static site generation, the seamless orchestration of HTML generation pipelines marks the backbone of content delivery. In this quest, we delve into the developer-centric modules powering a dynamic and meticulously crafted adventure site. Here, we unravel the intricacies of the <code class="inline-code">HTMLAdventureGenerator</code>, the foundational utilities within the <code class="inline-code">TemplateEngine</code>, and the asset management prowess of <code class="inline-code">AssetManager</code>. Together, these mechanisms form the cornerstone of a modular and flexible system for generating tailored website content.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Pipeline Dynamics</strong>: How does the method <code class="inline-code">startHttpServer</code> facilitate the serving of the final HTML content to users, and what mechanisms ensure security while doing so?</li>
<li>‚ö° <strong>Adventure Assembly</strong>: In what ways does <code class="inline-code">generateAdventure</code> orchestrate the generation of the adventure site, and how does it utilize dependencies like <code class="inline-code">TemplateEngine</code> and <code class="inline-code">AssetManager</code>?</li>
<li>üõ°Ô∏è <strong>Template Rendering</strong>: How does <code class="inline-code">TemplateEngine.renderPage</code> transform placeholders into fully rendered HTML pages, and what strategies are employed for template caching?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/html-generator.ts</code></a>: Central Coordinator for Static Site Creation</h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> class encapsulates the primary workflows for generating HTML files, coordinating between components such as the <code class="inline-code">TemplateEngine</code> and <code class="inline-code">AssetManager</code>. It governs theme handling, directory setup, and interactions within the static generation lifecycle, ensuring smooth execution from initialization to delivery.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: Oversees the construction of the entire adventure site, managing theme-specific assets, templates, and quest pages.</li>
<li><code class="inline-code">generateAllThemes</code>: Handles the creation of multi-themed versions of the site, ensuring modularity suited for unique user experiences.</li>
<li><code class="inline-code">startHttpServer</code>: Spins up a lightweight HTTP server to serve the generated HTML content, incorporating headers for security.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/html-generator.ts</code></a></h3>
<pre><code class="language-typescript">private async generateAdventure(): Promise&lt;void&gt; {
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
  console.log();

  console.log(chalk.dim(&#39;üìä Analyzing codebase...&#39;));
  const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);
  const projectInfo = createProjectInfo(repomixContent);

  console.log(chalk.dim(&#39;‚ú® Generating themed story and quests...&#39;));
  const storyContent = await this.adventureManager.initializeAdventure(
    projectInfo, 
    this.selectedTheme, 
    this.projectPath,
    this.customThemeData
  );

  this.extractQuestInfo();
  this.generateThemeCSS();
  this.copyQuestNavigator();
  this.copyImages();
  this.generateIndexHTML();
  await this.generateQuestPages();
  await this.generateSummaryHTML();
}
</code></pre>
<ul>
<li>Coordinates system-level operations to ensure the orderly creation of all components of the static site.</li>
<li>Uses the <code class="inline-code">AdventureManager</code> to initialize themes and quests, demonstrating dependency inversion principles.</li>
<li>Invokes helper functions like <code class="inline-code">generateIndexHTML</code> and <code class="inline-code">generateQuestPages</code> to maintain modularity.</li>
</ul>
<hr>
<pre><code class="language-typescript">private async generateAllThemes(args: Map&lt;string, string&gt;): Promise&lt;void&gt; {
  console.log(chalk.green(&#39;‚úÖ Generating all themes&#39;));
  this.isMultiTheme = true;
  await Promise.all(themes.map(async (theme, index) =&gt; {
    const themeDir = path.join(this.outputDir, theme);
    const themeGenerator = new HTMLAdventureGenerator();
    themeGenerator[&#39;selectedTheme&#39;] = theme;
    themeGenerator[&#39;outputDir&#39;] = themeDir;
    themeGenerator[&#39;isMultiTheme&#39;] = this.isMultiTheme;
    await themeGenerator.generateAdventure();
  }));
}
</code></pre>
<ul>
<li>Demonstrates parallel processing by generating multiple themes simultaneously to optimize performance.</li>
<li>Employs separate generator instances to prevent state conflicts, adhering to thread-safety principles.</li>
<li>Scales effectively for multi-theme sites, enabling flexibility across different user contexts.</li>
</ul>
<hr>
<pre><code class="language-typescript">private async startHttpServer(port: number = 8080): Promise&lt;void&gt; {
  const server = http.createServer((req, res) =&gt; {
    let filePath = path.join(this.outputDir, req.url === &#39;/&#39; ? &#39;index.html&#39; : req.url || &#39;&#39;);
    if (!filePath.startsWith(this.outputDir)) {
      res.writeHead(403);
      res.end(&#39;Forbidden&#39;);
    }
    fs.readFile(filePath, (err, content) =&gt; {
      if (err) res.end(err.code === &#39;ENOENT&#39; ? &#39;&lt;h1&gt;404&lt;/h1&gt;&#39; : &#39;Server error&#39;);
      else res.end(content);
    });
  });
  server.listen(port, () =&gt; console.log(`Server running at http://localhost:${port}`));
}
</code></pre>
<ul>
<li>Sets up a basic HTTP server to preview content locally during development phases.</li>
<li>Includes essential security measures to restrict file access to the intended directory.</li>
<li>Demonstrates best practice in modular and quick-deployment server setup.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Tip</strong>: Investigate how the <code class="inline-code">AssetManager</code> ensures dependencies like images are organized correctly for multi-theme adventures.</li>
<li><strong>Recommendation</strong>: Trace how environment-specific configurations (e.g., <code class="inline-code">process.cwd()</code> and paths) are managed across functions for flexibility.</li>
<li><strong>Next Steps</strong>: Proceed to understand the <code class="inline-code">TemplateEngine</code> to see how templates are processed and cached effectively.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Congratulations on deploying a robust HTML generator and static site pipeline‚Äîyour codebase just executed its first ‚≠ê milestone with precision; keep shipping greatness!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>