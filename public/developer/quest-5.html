<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Forge of Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Repository Chronicles: Tales of the Codecraft</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Forge of Configurations</h1>
<hr>
<p>In the vibrant Realm of Repositories, the Adventure Engine has whispered clues about the next quest. Developers are tasked to delve into the mystical <strong>Forge of Configurations</strong>, where the essence of customizable adventures is crafted. Beware, brave adventurers; the raw energy of configurations is both powerful and delicate. To navigate the Forge, you must master the art of reading, parsing, and extracting paths from its enigmatic configurations. Unravel these mysteries and sharpen your tools for the adventures ahead!</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration Parsers and Utilities</h3>
<p>The <code class="inline-code">adventure-config.ts</code> file is the central forge for handling adventure configuration. It transforms the raw <code class="inline-code">adventure.config.json</code> file into actionable formats, enabling developers to discern file paths, adventure quests, and highlights. It contains functionality for reading configuration files, parsing them into structured objects, and extracting vital elements like file paths. Additionally, it optimizes the formatting of configurations for easier processing. This file is critical for ensuring that the Adventure Engine operates seamlessly within a repository&#39;s structure.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Manages reading and safely parsing JSON configurations.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Extracts and validates file paths encoded in the configuration.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Optimizes configuration formatting for interactions with AI systems.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>This function acts as the alchemist, converting raw JSON data into structured objects, which form the foundation of the Forge‚Äôs knowledge.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<p>This function acts as the blacksmith, forging a complete list of valid and unique file paths from the configuration‚Äôs depths.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    const filePaths = quest.files
      .filter((f: any) =&gt; f.path)
      .map((f: any) =&gt; f.path);
    if (filePaths.length &gt; 0) {
      formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    }
    
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .filter((h: any) =&gt; h.name)
      .map((h: any) =&gt; h.name);
    if (functions.length &gt; 0) {
      formatted += `Functions: ${functions.join(&#39;, &#39;)}\n`;
    }
    
    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<p>This function refines and condenses the raw configuration data into a compact, readable format‚Äîready for AI-driven insights.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Ensure <code class="inline-code">adventure.config.json</code> exists and is formatted correctly before attempting to parse or extract data.</li>
<li>Use <code class="inline-code">extractUniqueFilePaths</code> to confirm all paths in your configuration align with the existing file structure.</li>
<li>Optimize your workflow by leveraging <code class="inline-code">formatAdventureConfigForPrompt</code> when working with AI-powered tools.</li>
</ul>
<hr>
<p>You have cracked the Forge of Configurations! The Adventure Engine hums in satisfaction, and new pathways beam bright on your journey toward mastering the Realm of Repositories. Well done, adventurer!</p>
<p>Congratulations, developer! You successfully committed the updates to your skill repository, refactored your problem-solving logic, and deployed an 80% complete mastery pipeline‚Äîyou&#39;re iterating toward ‚≠êfinal production-ready prowess! üöÄüíé</p>

</div>


    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>