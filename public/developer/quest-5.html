<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Repository Chronicles</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to dark mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Configuration &amp; Theme System</h1>
<hr>
<p>The intricate configuration and dynamic theme system power the core of the adventure platform. Together, they ensure seamless customization, robust safety measures, and immersive user experiences. Developers exploring these systems will uncover how themes are defined, validated, and used throughout the application. Investigate the interaction between configuration constants, theme functionality, and user inputs. By diving into this modular architecture, developers will appreciate its simplicity, scalability, and adaptability.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Parsing Mechanism</strong>: How are themes parsed and validated to ensure user input maps to a predefined or custom theme?</li>
<li>‚ö° <strong>Configuration Connection</strong>: How do environment variables and constants influence system limits and performance behaviors?</li>
<li>üõ°Ô∏è <strong>Validation Logic</strong>: What safeguards are implemented to handle invalid inputs, oversized files, or misconfigured settings?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration constants and timeouts</h3>
<p>This file defines critical configuration constants and ensures the system operates within specified limits. Key environment settings, timeouts, and cache settings are included to optimize performance and stability. These constants help maintain control over resource usage, prevent errors, and maintain usability.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> specifies the timeout for LLM API requests, allowing flexibility via environment variables.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> defines the maximum allowable file size to prevent memory-related issues during processing.</li>
<li><code class="inline-code">DEFAULT_THEME</code> sets a fallback adventure theme, ensuring valid defaults in case user preferences are invalid.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme definitions and utility functions</h3>
<p>This file is the single source of truth for theme data, offering definitions and helper functions for theme validation and formatting. It simplifies selecting and parsing themes while maintaining a consistent user experience.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getAllThemes</code> retrieves the complete list of valid themes for reference or display.</li>
<li><code class="inline-code">parseTheme</code> processes user input and matches it with a theme based on key, description, or keywords.</li>
<li><code class="inline-code">isValidTheme</code> determines whether a given theme key aligns with the predefined theme set.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> Theme-specific style management</h3>
<p>The <code class="inline-code">ThemeManager</code> class manages customization details like styles and icons. It ensures the seamless integration of themes within the generated content and adjusts assets according to the visual and functional requirements.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateThemeCSS</code> combines base, homepage, and theme-specific CSS to create a unified stylesheet.</li>
<li><code class="inline-code">getThemeIcons</code> retrieves theme-specific emoji/icons for enhancing the adventure UI.</li>
<li><code class="inline-code">isLightTheme</code> determines if a theme requires adjustments for light or dark mode assets.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds for story generation
export const MAX_FILE_SIZE_MB = 10; // Maximum file size (10MB) to avoid memory issues
export const DEFAULT_THEME = &#39;space&#39; as const; // Default to &quot;space&quot; theme if none specified
</code></pre>
<ul>
<li>The <code class="inline-code">LLM_REQUEST_TIMEOUT</code> defines an adjustable API timeout, providing flexibility for projects with varying performance needs.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> helps maintain system reliability by skipping oversized files.</li>
<li>Setting a <code class="inline-code">DEFAULT_THEME</code> prevents failures due to missing or invalid theme selection.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;

  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }

  return null;
}

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li><code class="inline-code">getAllThemes</code> simplifies access to the full theme list, ensuring consistency across the system.</li>
<li><code class="inline-code">parseTheme</code> demonstrates multiple strategies for matching user input to defined themes, including numeric IDs.</li>
<li><code class="inline-code">isValidTheme</code> enforces theme integrity through a type-safe verification process.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;),
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];

  let combinedCSS = &#39;&#39;;
  
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });

  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}

getThemeIcons(theme: AdventureTheme): { theme: string; quest: string } {
  const themeIcons = {
    space: { theme: &#39;üöÄ&#39;, quest: &#39;‚≠ê&#39; },
    mythical: { theme: &#39;üè∞&#39;, quest: &#39;‚öîÔ∏è&#39; },
    ancient: { theme: &#39;üè∫&#39;, quest: &#39;üìú&#39; },
    developer: { theme: &#39;üíª&#39;, quest: &#39;üîß&#39; },
    custom: { theme: &#39;üé®&#39;, quest: &#39;‚≠ê&#39; }
  };

  return themeIcons[theme] || themeIcons.space;
}

isLightTheme(theme: AdventureTheme): boolean {
  const lightThemes: AdventureTheme[] = [&#39;mythical&#39;];
  return lightThemes.includes(theme);
}
</code></pre>
<ul>
<li><code class="inline-code">generateThemeCSS</code> creates a cohesive stylesheet for each theme, ensuring a polished user interface.</li>
<li><code class="inline-code">getThemeIcons</code> enriches the user experience by offering theme-appropriate visual elements.</li>
<li><code class="inline-code">isLightTheme</code> adjusts asset requirements based on the theme‚Äôs visual characteristics.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Consider extending <code class="inline-code">MAX_FILE_SIZE_MB</code> and other configurable constants for larger-scale projects.</li>
<li>Explore the <code class="inline-code">ThemeManager</code> class to implement additional themes or icons.</li>
<li>Use <code class="inline-code">parseTheme</code> as an adaptable model for handling diverse user inputs.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the adventure system! Your adventure is complete.</p>
<p>With the Configuration &amp; Theme System implemented, your codebase now boasts dynamic adaptability and a polished UX foundation‚Äîpushing your developer prowess to 80% completion ‚≠êüíéüöÄ!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>