<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Configuration and Theming System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Repository Exploration: The Architecture Chronicles</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Configuration and Theming System</h1>
<hr>
<p>In the final stretch of our technical journey, we delve into the system&#39;s configuration and theming modules that enable a fully customizable and scalable adventure generation system. These components effectively decouple aesthetics and core functionality, allowing seamless adaptation to different themes and environments. Through dynamic validation, centralized theme definitions, and robust configuration handling, this system empowers developers to maintain flexibility and consistency while meeting user preferences.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Coordination</strong>: How are themes structured and validated to ensure compatibility across components?</li>
<li>‚ö° <strong>Adaptation in Action</strong>: What mechanisms are used to generate and manage theme-specific assets dynamically?</li>
<li>üõ°Ô∏è <strong>Configuration Integrity</strong>: How does the configuration system maintain error resilience while handling external inputs?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Centralized Theme Management</h3>
<p>This file serves as the single source of truth for all theme definitions. It provides structures, helper functions, and parsers that ensure coherent theme data across the application.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getAllThemes</code>: Returns all available themes, ensuring uniform access to theme information.</li>
<li><code class="inline-code">isValidTheme</code>: Validates if a given theme key matches any registered theme.</li>
<li><code class="inline-code">parseTheme</code>: Parses user input to derive an appropriate theme key using normalization and context matching.</li>
<li><code class="inline-code">formatThemeOption</code>: Formats themes into a text-friendly structure for displaying options to users.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li>This code provides access to all theme definitions in a simple array format.</li>
<li>Ensures developers can easily iterate over theme data without complex accessors.</li>
<li>Centralized data access helps maintain consistency in theming logic.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>Validates a theme key by checking against existing definitions.</li>
<li>Uses a type guard to enhance type safety when working with themes.</li>
<li>Prevents invalid or unknown themes from propagating through the system.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Parses user inputs into valid theme keys using normalization and pattern matching.</li>
<li>Provides support for both numeric IDs and keyword-based theme identification.</li>
<li>Enhances user experience by offering flexible input options while ensuring validity.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatThemeOption(theme: ThemeDefinition): string {
  return `${theme.emoji} **${theme.id}. ${theme.displayName}** - ${theme.description}`;
}
</code></pre>
<ul>
<li>Formats theme data into a user-friendly string for display purposes.</li>
<li>Includes IDs, display names, descriptions, and emojis, making options appealing and easy to understand.</li>
<li>Useful in interactive terminal or web-based adventure clients.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> Dynamic Theme Integration</h3>
<p>This file handles the dynamic aspects of theme management, like generating theme-specific assets and customizing content based on selected themes. It bridges static definitions with runtime functionality.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateThemeCSS</code>: Combines CSS files into a single output for a given theme.</li>
<li><code class="inline-code">getThemeIcons</code>: Retrieves theme-specific icons for use in UI templates.</li>
<li><code class="inline-code">parseThemeArg</code>: Parses the theme argument passed via the CLI, enabling user-defined theme selection.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">public generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;), 
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
  
  let combinedCSS = &#39;&#39;;
  
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
  
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li>Dynamically generates CSS for a given theme by combining multiple source files.</li>
<li>Validates file existence to handle missing assets gracefully.</li>
<li>Centralizes theme styling logic, simplifying customizability for developers.</li>
</ul>
<hr>
<pre><code class="language-typescript">public getThemeIcons(theme: AdventureTheme): { theme: string; quest: string } {
  const themeIcons = {
    space: { theme: &#39;üöÄ&#39;, quest: &#39;‚≠ê&#39; },
    mythical: { theme: &#39;üè∞&#39;, quest: &#39;‚öîÔ∏è&#39; },
    ancient: { theme: &#39;üè∫&#39;, quest: &#39;üìú&#39; },
    developer: { theme: &#39;üíª&#39;, quest: &#39;üîß&#39; },
    custom: { theme: &#39;üé®&#39;, quest: &#39;‚≠ê&#39; }
  };

  return (themeIcons as any)[theme] || themeIcons.space;
}
</code></pre>
<ul>
<li>Provides theme and quest icons specific to the selected adventure theme.</li>
<li>Includes fallback logic for unmatched themes, ensuring continuity in UI rendering.</li>
<li>Simplifies the integration of visual elements across components.</li>
</ul>
<hr>
<pre><code class="language-typescript">public parseThemeArg(themeArg: string): AdventureTheme | &#39;all&#39; | null {
  if (themeArg === &#39;all&#39;) return &#39;all&#39;;
  
  const validThemes: AdventureTheme[] = [&#39;space&#39;, &#39;mythical&#39;, &#39;ancient&#39;, &#39;developer&#39;];
  
  if (validThemes.includes(themeArg as AdventureTheme)) {
    return themeArg as AdventureTheme;
  }
  
  const themeNum = parseInt(themeArg);
  if (themeNum &gt;= 1 &amp;&amp; themeNum &lt;= 4) {
    return validThemes[themeNum - 1];
  }
  
  return null;
}
</code></pre>
<ul>
<li>Parses CLI inputs to determine the selected theme or apply default logic.</li>
<li>Supports both numerical IDs and direct theme names, providing flexibility.</li>
<li>Ensures robust handling of invalid or unexpected arguments.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">getAllThemes</code> and <code class="inline-code">isValidTheme</code> from <code class="inline-code">theme.ts</code> to validate or enumerate themes in new modules.</li>
<li>Leverage the <code class="inline-code">ThemeManager</code> class when integrating theme-specific assets for extensibility.</li>
<li>Refer to <code class="inline-code">generateThemeCSS</code> logic in <code class="inline-code">theme-manager.ts</code> if adding new styles or themes.</li>
</ul>
<hr>
<p>You have mastered all the secrets of this project! Your adventure is complete.</p>
<p>You&#39;ve refactored the core logic of Quest 5 like a master architect, implementing a dynamic Configuration and Theming System that shines with modular precision‚Äîyour stack is üîß‚ö° 80% complete, and the final deployment is within reach! üöÄ</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>