<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Repository Exploration: Developer's Blueprint</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Configuration &amp; Theme System</h1>
<hr>
<p>The final quest leads you to the foundational elements of the system that unify its flexibility and customization capabilities: Configuration and Theme management. These components ensure adaptive behavior for diverse user specifications, enabling a seamless thematic adventure. To uncover the inner workings of this system, you&#39;ll explore key files that implement environment-based configuration, theme handling, and robust input validation. By the end, you&#39;ll understand how configuration constants and theme definitions are woven into the larger technical infrastructure.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Input Security Check</strong>: How does the system validate user input for safety and correctness?</li>
<li>‚ö° <strong>Theme Application Flow</strong>: What mechanisms support flexible and consistent theme management across generation pipelines?</li>
<li>üõ°Ô∏è <strong>Resilience in Configuration</strong>: How does the system handle invalid or missing configuration and theme data?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/config.ts</h3>
<p>The <code class="inline-code">config.ts</code> file defines critical constants that control operational parameters such as API timeouts, cache limits, and source file restrictions. These configurable elements, loaded from environment variables or default values, ensure flexibility and reliability in various setups.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Sets a maximum wait time for responses, ensuring pipeline stability against prolonged processing delays.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Limits file size for analysis, optimizing memory use and runtime performance.</li>
<li><code class="inline-code">DEFAULT_THEME</code>: Defines the fallback theme, guaranteeing consistency when user input is invalid.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/theme.ts</h3>
<p>The <code class="inline-code">theme.ts</code> file consolidates all theme-related logic, serving as the single source of truth for themes. It provides utility functions for theme validation, retrieval, parsing, and formatting, ensuring seamless theme application across the system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Central repository of predefined themes, with unique identifiers, display properties, and keywords.</li>
<li><code class="inline-code">getAllThemes</code>: Retrieves an array of all themes for enumeration or validation purposes.</li>
<li><code class="inline-code">isValidTheme</code>: Confirms if a theme input matches any predefined theme keys.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/input-validator.ts</h3>
<p>The <code class="inline-code">input-validator.ts</code> file offers lightweight validation utilities that enforce input safety and correctness. It ensures input data adheres to expected formats and restrictions, minimizing the risk of runtime errors or security vulnerabilities.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures user selections are not empty, overly long, or improperly formatted.</li>
<li><code class="inline-code">validateTheme</code>: Verifies theme inputs, normalizing and cross-checking against predefined or custom themes.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips potentially unsafe characters from strings, preparing inputs for safe display without injection risks.</li>
</ul>
<hr>
<h2>Code</h2>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
export const DEFAULT_THEME = &#39;space&#39; as const;
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> enforces a ceiling on latency for external model requests, crucial for maintaining responsiveness.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> prevents excessive memory use during analysis by skipping oversized files, which is vital for stability in larger repositories.</li>
<li><code class="inline-code">DEFAULT_THEME</code> ensures fallback functionality, preventing empty or invalid themes from breaking the system.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  DEVELOPER: {
    id: 4,
    key: &#39;developer&#39;,
    displayName: &#39;Developer Documentation&#39;,
    emoji: &#39;üìñ&#39;,
    description: &#39;Technical documentation approach with clear explanations, best practices, and code analysis&#39;,
    keywords: [&#39;developer&#39;, &#39;code&#39;, &#39;technical&#39;, &#39;debug&#39;, &#39;guide&#39;, &#39;tutorial&#39;, &#39;binary&#39;]
  }
} as const;

export function getAllThemes(): ThemeDefinition[] {
  return Object.values(THEMES);
}

export function isValidTheme(theme: string): theme is AdventureTheme {
  return getAllThemes().some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>The <code class="inline-code">THEMES</code> definition assigns each theme unique properties, enabling easy identification and user selection integration.</li>
<li><code class="inline-code">getAllThemes</code> abstracts theme array retrieval for enhanced flexibility in theme-related operations.</li>
<li><code class="inline-code">isValidTheme</code> performs validation checks on theme inputs, ensuring reliability and consistency across user interactions.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> ensures the choice strings are both non-empty and within allowable length, improving data integrity.</li>
<li><code class="inline-code">validateTheme</code> guarantees correctness by normalizing, parsing, and cross-referencing user-provided themes against predefined values.</li>
<li><code class="inline-code">sanitizeForDisplay</code> strengthens front-end security by filtering out potential code injection vectors from input strings.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Tip</strong>: Use <code class="inline-code">getAllThemes</code> whenever you need a complete theme list to simplify further operations.</li>
<li><strong>Recommendation</strong>: When extending the adventure system, always define new themes in <code class="inline-code">theme.ts</code> for maintainable consistency.</li>
<li><strong>Next Steps</strong>: Investigate error handling strategies in validators to further improve input robustness.</li>
</ul>
<hr>
<p>You have mastered all the secrets of this project‚Äôs configuration architecture! Your adventure is complete.</p>
<p>Congratulations on successfully implementing the Configuration &amp; Theme System‚Äîyour codebase has leveled up to an 80% completion breakpoint; next stop, Quest 5 deployment üöÄ‚ö°!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>