<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Architecture of Adventure: A Developer's Guide</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Configuration &amp; Theme System</h1>
<hr>
<p>Within the intricate layers of the Adventure Repository lies its core configuration and theme management system, a fundamental element supporting adaptability. Here, key components work together to define themes, enforce validation, and generate configurations. This quest unveils these mechanisms, empowering developers to customize adventures and ensure smooth management of dynamic inputs, while offering insights into modular design and implementation principles.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Validation Patterns</strong>: How is input validation handled to secure configuration and theme settings?</li>
<li>‚ö° <strong>Theme Architecture</strong>: What methods are used to define and access themes? How does the system ensure consistency in theme data?</li>
<li>üõ°Ô∏è <strong>Configuration Dynamics</strong>: How do timeouts, limits, and other constants interact within the adventure system?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Settings</h3>
<p>This file establishes global constants and configurations for both system limits and behavior settings. It prioritizes simplicity with straightforward definitions that avoid unnecessary complexity, ensuring readability and ease of modification. Key highlights include timeouts tailored to specific tasks, adjustable limits for file analysis, and environment-aware settings for error handling. The modular design creates flexibility and prevents pitfalls like infinite recursion, memory exhaustion, or verbosity overloads.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: This constant configures the timeout duration for LLM requests, ensuring smooth communication without holding up operations indefinitely.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Defines the maximum file size allowed for processing within the system, preventing memory issues and focusing attention on manageable files.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: Specifies common directory and file patterns to skip during repository scanning, optimizing performance and reducing clutter.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Definitions</h3>
<p>This file forms a unified structure for all theme-related data, acting as a single source of truth. It introduces comprehensive helper functions to retrieve themes by IDs or keywords, validate inputs, and format themes for display. Its modular structure encourages extensibility, with a mix of predefined and custom themes like developer-focused &quot;Documentation&quot; or user-generated &quot;Custom&quot;.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A static object mapping theme data, including identifiers, display names, emojis, and keywords, ensuring consistency across functionality.</li>
<li><code class="inline-code">isValidTheme</code>: A type guard used to verify the validity of user-inputted themes, defending against invalid or unsupported values.</li>
<li><code class="inline-code">parseTheme</code>: A simple parsing function to normalize input strings, enabling seamless compatibility across diverse formats.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> Theme Manager</h3>
<p>The <code class="inline-code">ThemeManager</code> class handles practical theme functions, such as parsing input, generating combined CSS for styling, and managing assets for specific themes. Its elegant structure simplifies operations like updating visual assets or integrating templates, while keeping the design modular to support future scalability.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateThemeCSS</code>: Dynamically combines theme-specific CSS files and writes consolidated output for seamless styling integration.</li>
<li><code class="inline-code">getThemeIcons</code>: Provides theme-specific icons for use in templates, enhancing visual consistency and thematic immersion.</li>
<li><code class="inline-code">parseThemeArg</code>: Parses user-provided theme arguments from the command line, accepting inputs through direct keywords or numeric IDs.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Validation</h3>
<p>This file focuses on secure and precise validation of user inputs related to adventure choices, themes, and project paths. Its minimalist functions are optimized to ensure reliability without adding complexity, with strict enforcement of input rules to avoid errors or misuse.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Confirms the validity of the user&#39;s adventure choice while enforcing length restrictions and trimming whitespace.</li>
<li><code class="inline-code">validateTheme</code>: Normalizes and validates user-provided themes using helper functions like <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code>.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Resolves common issues with potentially unsafe display content by removing special characters and truncating excessive input.</li>
</ul>
<hr>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); 
export const MAX_FILE_SIZE_MB = 10;
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;.env&#39;,
];
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> establishes a balance between performance and reliability for external API calls.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> safeguards against large file processing to ensure system efficiency and avoid memory problems.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code> excludes common directories and files, streamlining analysis processes for relevant content.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: { id: 1, key: &#39;space&#39;, displayName: &#39;Space Exploration&#39;, ... },
  DEVELOPER: { id: 4, key: &#39;developer&#39;, displayName: &#39;Developer Documentation&#39;, ... }
};

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  ...
}
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> defines reusable metadata for themes, ensuring consistent data retrieval and display.</li>
<li><code class="inline-code">isValidTheme</code> prevents invalid theme usage, supporting robust validation for user input.</li>
<li><code class="inline-code">parseTheme</code> enables string normalization and keyword-based matching, accommodating diverse inputs.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
  let combinedCSS = &#39;&#39;;
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li>Combines multiple CSS files into a single output, streamlining web styling for specific themes.</li>
<li>Uses <code class="inline-code">fs</code> operations to verify files and store the consolidated result securely.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme... Valid themes: ${validThemes}`);
  }
  return parsedTheme;
}
</code></pre>
<ul>
<li>Ensures inputs are sanitized and checked against known themes, preventing invalid arguments.</li>
<li>Centralizes the usage of <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> for clean integration.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">IGNORE_PATTERNS</code> for optimizing repository scans and avoiding irrelevant files.</li>
<li>Test <code class="inline-code">THEMES</code> modifications in isolation to ensure minimal disruption across the system.</li>
<li>Experiment with custom themes using consistent structure in <code class="inline-code">THEMES</code> for smooth integration.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Adventure Repository! Your adventure is complete.</p>
<p>Congratulations, developer! You‚Äôve deployed the Configuration &amp; Theme System with precision, propelling your project architecture to new heights‚Äîyour codebase is now 80% optimized and ready to üöÄ toward the final frontier!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>