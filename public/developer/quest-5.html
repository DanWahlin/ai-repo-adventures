<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Scrolls of Configuration – Charting the Path to Adventure - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'developer' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Codex of the Infinite Adventures</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Scrolls of Configuration – Charting the Path to Adventure</h1>
<hr>
<p>The adventurers venture deeper into the realm of the Codex, discovering the ancient &quot;Scrolls of Configuration.&quot; These scrolls hold the secrets to navigating the vast coding universes by defining pathways and setting the rules of exploration. Each configuration file they uncover is a critical piece of the puzzle, shedding light on how themed adventures are structured and revealing the intricacies of validating inputs, parsing JSON, and extracting highlights. The path ahead is fraught with challenges, yet brimming with the promise of mastery.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration system for guided adventures</h3>
<p>The <code class="inline-code">adventure-config.ts</code> file serves as the backbone for setting up and managing configurations within the adventure system. Its primary role is to load, parse, and validate the JSON-based <code class="inline-code">adventure.config.json</code> file, ensuring adventurers have structured guidance for their quests. With its elegant implementation, it streamlines the process of extracting insights from config files, such as unique file paths explicitly referenced within the configuration data. The file also provides functionality to format parsed configurations into structured prompts, enabling proper integration with language models for consistent narrative creation. Designed for resilience, its <code class="inline-code">readFileIfExists()</code> method gracefully handles missing or unreadable configurations without causing issues for adventurers. Additionally, its traversal logic through the configuration enables it to intelligently collect path details while ensuring security validation and prevention of system directory misuse.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">- </code>Handles missing or corrupted config files safely with <code class="inline-code">readFileIfExists()</code>.</li>
<li><code class="inline-code">- </code>Extracts and validates paths from configurations using <code class="inline-code">extractUniqueFilePaths()</code>.</li>
<li><code class="inline-code">- </code>Formats configuration data into LLM prompts via <code class="inline-code">formatAdventureConfigForPrompt()</code>.</li>
<li><code class="inline-code">- </code>Centralized parsing of JSON data with error handling in <code class="inline-code">parseAdventureConfig()</code>.</li>
<li><code class="inline-code">- </code>Supports secure traversal of nested configuration objects.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Security and input validation</h3>
<p>The <code class="inline-code">input-validator.ts</code> file plays a critical role in safeguarding the adventure system from invalid inputs or malicious exploits. It features robust validation logic, making sure user choices and paths conform to strict whitelists, preventing any attempts at accessing unauthorized directories or injecting bad data. The <code class="inline-code">validateAdventureChoice()</code> function scrutinizes user-provided adventure inputs to ensure compatibility and alignment with predefined options, while <code class="inline-code">validateProjectPath()</code> enforces strict path validation, guarding against accidental or malicious errors. Serving as the system&#39;s gatekeeper, this file lays down an impregnable foundation for secure interactions, making it impossible for adventurers to derail the adventure&#39;s integrity.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">- </code>Input sanitization enabled by <code class="inline-code">validateAdventureChoice()</code> ensures safety in user selection.</li>
<li><code class="inline-code">- </code>Protects project directories with <code class="inline-code">validateProjectPath()</code> to block unauthorized access.</li>
<li><code class="inline-code">- </code>Preventative measures implemented to halt injection attacks in <code class="inline-code">InputValidator</code>.</li>
<li><code class="inline-code">- </code>Centralized validation logic supports streamlined error handling.</li>
<li><code class="inline-code">- </code>Ensures adherence to predefined settings with whitelist-based input handling.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Centralized configuration for system-wide settings</h3>
<p>The <code class="inline-code">config.ts</code> file is the nerve center for managing global settings and constraints across the adventure system. It defines critical constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code>, controlling the behavior of language model requests; <code class="inline-code">REPOMIX_CACHE_TTL</code>, ensuring efficient caching; and <code class="inline-code">MAX_FILE_SIZE_MB</code>, setting file size limits to prevent memory overflow. Each configuration variable simplifies the maintenance of system-wide thresholds, allowing the adventure tools to function seamlessly. This file demonstrates a clean separation of concerns, providing a unified source for shared settings while exposing structured options for controlling environment variables.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">- </code>Configures timeout limits for LLM requests via <code class="inline-code">LLM_REQUEST_TIMEOUT</code>.</li>
<li><code class="inline-code">- </code>Supports caching optimization with <code class="inline-code">REPOMIX_CACHE_TTL</code>.</li>
<li><code class="inline-code">- </code>Prevents memory issues using <code class="inline-code">MAX_FILE_SIZE_MB</code> file size constraints.</li>
<li><code class="inline-code">- </code>Centralized structure enhances maintainability of global settings.</li>
<li><code class="inline-code">- </code>Facilitates scalability for adventures with cross-environment configuration.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">import * as fs from &#39;fs&#39;;
import * as path from &#39;path&#39;;

const ADVENTURE_CONFIG_FILE = &#39;adventure.config.json&#39;;

function readFileIfExists(filePath: string): string | null {
  try {
    return fs.readFileSync(filePath, &#39;utf-8&#39;);
  } catch {
    return null;
  }
}

export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = readFileIfExists(path.join(projectPath, ADVENTURE_CONFIG_FILE));
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}

export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];
  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];
  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; fs.existsSync(path.resolve(projectPath, node.path.trim()))) {
      unique.add(node.path.trim());
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }
  return [...unique];
}
</code></pre>
<p>This code is like a map reader, decoding instructions and safely extracting the landmarks to visit in your adventure.</p>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export class InputValidator {
  static validateAdventureChoice(choice: string, validChoices: string[]): boolean {
    return validChoices.includes(choice.trim().toLowerCase());
  }

  static validateProjectPath(path: string): boolean {
    const forbiddenPaths = [&#39;/etc&#39;, &#39;/bin&#39;, &#39;/usr&#39;];
    return !forbiddenPaths.some(forbidden =&gt; path.startsWith(forbidden));
  }
}
</code></pre>
<p>This code acts like a vigilant border guard, checking credentials before granting access to specific areas.</p>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 5000;
export const REPOMIX_CACHE_TTL = 60000;
export const MAX_FILE_SIZE_MB = 5;

export default {
  LLM_REQUEST_TIMEOUT,
  REPOMIX_CACHE_TTL,
  MAX_FILE_SIZE_MB,
};
</code></pre>
<p>This piece of code is like setting house rules before hosting a party, ensuring limits keep everything under control.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Validate configuration files thoroughly before diving into adventures—missing data can cause unexpected detours.</li>
<li>Test input validation logic extensively to ensure adequate security and avoid boundary errors.</li>
<li>Explore other system-level configurations for optimization, such as caching tiers or timeout policies.</li>
</ul>
<hr>
<p>Adventure completed successfully—prepare for the next discovery within the Codex of the Infinite Adventures!</p>
<p>Congratulations on successfully resolving the dependencies in Quest 5: The Scrolls of Configuration – your codebase of adventure is now 80% built, running with ⚡ efficiency, and primed for the final deploy to legendary status!</p>

</div>


    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>