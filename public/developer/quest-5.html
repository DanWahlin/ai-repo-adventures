<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Archivist‚Äôs Codex - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Adventures in the Repository Realms</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Archivist‚Äôs Codex</h1>
<hr>
<p>In the Repository Realms, the essence of the Archive lies in its intricate web of adventure configurations, where each line of code weaves together stories and quests. As an Archivist Adventurer, mastering the art of understanding and refining the <code class="inline-code">adventure-config</code> is your charge. Today, you must explore the patterns, paths, and parsing mechanisms hidden within its structure. Together, we will decode the mysteries of the Archive&#39;s configuration and ensure its stability for future adventures.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Explorer‚Äôs Map</strong>: How is the <code class="inline-code">adventure.config.json</code> file located and loaded within the system?</li>
<li>‚ö° <strong>Parsing Puzzle</strong>: What techniques are used to read and safely parse the configuration file into an object?</li>
<li>üõ°Ô∏è <strong>Pathfinder‚Äôs Check</strong>: How does the extraction of unique file paths ensure only existing files are included?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: Core adventure configuration utilities</h3>
<p>This file contains the functions responsible for handling the Archive&#39;s adventure configuration. It includes mechanisms for reading raw configuration data, safely parsing its content, and efficiently extracting usable file paths. By understanding these functions, you‚Äôll gain insight into how the configuration supports adaptable and modular quest creation.</p>
<h4>Highlights</h4>
<ul>
<li><strong><code class="inline-code">loadAdventureConfig</code></strong>: Handles the reading of the raw configuration file from a specific project path.</li>
<li><strong><code class="inline-code">parseAdventureConfig</code></strong>: Parses the raw configuration into a usable object and gracefully handles JSON errors.</li>
<li><strong><code class="inline-code">extractUniqueFilePaths</code></strong>: Extracts validated, unique file paths referenced within the configuration.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<p>This function acts as a map reader, locating and retrieving the configuration file‚Äôs content if it exists.</p>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>Like an archivist decrypting ancient scrolls, this method converts raw configuration into an intelligible object while avoiding fatal errors from malformed data.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<p>This utility is akin to a pathfinder, meticulously validating and gathering file paths to ensure only those that exist are used.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">console.log</code> for debugging file paths during runtime to verify correctness.</li>
<li>Cross-check the <code class="inline-code">adventure.config.json</code> structure to better understand its fields and their implications in the functions.</li>
<li>Explore how error handling in <code class="inline-code">parseAdventureConfig</code> maintains resilience in the overall system.</li>
</ul>
<hr>
<p>The secrets of the Archive‚Äôs configuration are now yours to wield, brave Archivist! Your mastery secures the system‚Äôs modularity and adaptability. Adventure forth!</p>
<p>Congratulations on closing the function on &#39;Quest 5: The Archivist‚Äôs Codex,&#39; committing stellar insight to the repository of your knowledge‚Äîyou&#39;re just one deploy away from achieving the endgame goal! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>