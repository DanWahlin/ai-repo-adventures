<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Altar of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Repository Chronicles: Tales of the Codecraft</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Altar of Themes</h1>
<hr>
<p>In the depths of the fabled <strong>Adventure Engine</strong>, the Altar of Themes represents the beating heart of the system, where imagination intertwines with structure. Serving as the single source of truth for all themes, this altar crafts the identities of adventures and guides each developer&#39;s journey. Ahead lies the exploration of configuration, validation, and the mystic array of predefined themes. Only those who harness these tools can breathe life into their unique quests. Step forth and uncover the essence of thematic storytelling.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Quest Configuration Parameters</h3>
<p>This file provides the essential parameters that define how the Adventure Engine operates. It establishes constants for API integration, timeout thresholds for analysis processes, and thematic defaults for adventures. With its structured configuration, developers ensure adventures remain streamlined, scalable, and adaptable to various environments. The <code class="inline-code">DEFAULT_THEME</code> serves as the anchor for all adventures, while timeout settings, such as <code class="inline-code">LLM_REQUEST_TIMEOUT</code>, ensure system stability during content generation. By shaping these parameters, one can optimize adventure generation performance and customize the player&#39;s journey.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> controls the maximum time allocated for processing large prompts.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> defines caching mechanisms to maintain efficient adventure generation.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> prevents overwhelming the system by excluding oversized files.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
</code></pre>
<p>This acts as a failsafe timer for handling large story-generation prompts, ensuring no infinite processing occurs.</p>
<pre><code class="language-typescript">export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
</code></pre>
<p>Caching content reduces redundant calculations and accelerates repeat adventure plays.</p>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<p>This enforces file size limits to maintain system focus and prevent memory issues during repository scanning.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Defining the Themes</h3>
<p>The <code class="inline-code">theme.ts</code> file is a cornerstone of the Adventure Engine, home to the foundational <code class="inline-code">THEMES</code> object and associated helper functions. It maps out both predefined and custom themes, delineating their attributes and allowing developers to integrate new ideas seamlessly. Each theme brings a unique flavor, defined by its <code class="inline-code">id</code>, <code class="inline-code">key</code>, <code class="inline-code">emoji</code>, and <code class="inline-code">description</code>. Functions like <code class="inline-code">isValidTheme</code> and <code class="inline-code">parseTheme</code> ensure validated inputs while delivering flexible customization for thematic development. As the ultimate reference for all themed adventures, the file ensures users embark on fitting journeys.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> defines the built-in themes, complete with identifiers, display attributes, and descriptions.</li>
<li><code class="inline-code">isValidTheme</code> checks if user inputs align with acceptable themes.</li>
<li><code class="inline-code">getAllThemes</code> returns a structured list of theme definitions.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  ...
};
</code></pre>
<p>Thematic definitions provide an immersive experience, linking user journeys to predefined narratives and descriptors.</p>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<p>This ensures user-provided inputs match one of the predefined or available themes, preventing errors during theme validation.</p>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<p>This fetches a complete list of all themes, making it a helpful resource for displaying options or setting up configuration menus.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Validating User Input</h3>
<p>In <code class="inline-code">input-validator.ts</code>, user inputs for quests, themes, and file paths are meticulously examined. Functions like <code class="inline-code">validateTheme</code> confirm that chosen themes adhere to the predefined options, while <code class="inline-code">validateAdventureChoice</code> ensures valid user input for various selections. The sanitization logic further protects against injection attacks and excessive input lengths. This file acts as the gatekeeper, allowing only well-formatted and safe inputs to proceed into the Adventure Engine.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> ensures users enter valid selections, throwing errors when conditions aren&#39;t met.</li>
<li><code class="inline-code">validateTheme</code> checks themes against the available list while providing feedback on invalid options.</li>
<li><code class="inline-code">validateProjectPath</code> manages safe and efficient project path normalization.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<p>This safeguards the core user decision-making process, requiring meaningful input while limiting excessive characters.</p>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<p>This guarantees selected themes exist in the predefined collection, providing detailed feedback for invalid cases.</p>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<p>This manages user-provided file paths or defaults to the current working directory, ensuring paths are valid and secure.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Optimize <code class="inline-code">LLM_REQUEST_TIMEOUT</code> and <code class="inline-code">REPOMIX_CACHE_TTL</code> values to match the complexity of your adventures.</li>
<li>Use <code class="inline-code">getAllThemes</code> to retrieve a user-friendly list of options for dynamic interfaces.</li>
<li>Validate all user inputs rigorously to prevent unexpected errors and preserve the Adventure Engine&#39;s integrity.</li>
</ul>
<hr>
<p>The Altar of Themes has bestowed its wisdom upon you, adventurer! Go forth with this knowledge and weave tales that will inspire worlds.</p>
<p>Congratulations, developer! You&#39;ve successfully refactored your journey through Quest 4: The Altar of Themes, committing another milestone to your repository of victories‚Äîkeep debugging life with precision and drive as you‚Äôre now 60% closer to deployment! üöÄ‚ö°üéâ</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5: The Forge of Configurations ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>