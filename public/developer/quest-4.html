<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Tome of Themes and Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codebase Chronicles: An Ancient Repository</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Tome of Themes and Configurations</h1>
<hr>
<p>In the sprawling tapestry of the Repository Adventure Engine, the secrets to themes and configurations lay hidden within the fabled Tome. This artifact, created to unify adventure settings, governs the parameters that infuse life into quests. The pages reverberate with the power of choices, validation, and customization. Brave seeker, you are called forth to study this cornerstone, to uncover how the code transforms mere data into immersive narratives. Beware ‚Äì the Tome demands precision, for its spells are sensitive to error.</p>
<p><strong>Adventure Awaits</strong> ‚Äì Master the technical alchemy of themes and configurations.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üìö <strong>Config Construction</strong>: How does the configuration system define defaults and manage environment variables effectively?</li>
<li>üé® <strong>Theme Mastery</strong>: How does the theme system parse inputs and validate theme selections dynamically?</li>
<li>üõ°Ô∏è <strong>Validation Guard</strong>: What techniques ensure input safety and prevent invalid data from disrupting the system?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Fundamentals</h3>
<p>This file provides a centralized configuration system for the Repository Adventure Engine. It relies on environment variables to allow customization, defines constants critical to adventure behavior, and includes default thresholds for various processes. By using straightforward constants instead of deeply nested objects, the configuration remains readable and efficient.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Configures the timeout value for LLM requests, ensuring stability during heavy analysis workloads.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Defines cached data expiration time for the Repomix subsystem, balancing performance with memory usage.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Specifies the maximum allowable file size in megabytes, preventing oversized inputs from causing performance issues.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Thematic Adventures</h3>
<p>This file governs the entire theme subsystem, including predefined themes, input matching, and validation logic. It provides helper methods for extracting, formatting, and validating themes, ensuring user inputs are translated into meaningful configurations for adventures. </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A predefined collection of adventure themes, complete with display metadata, ensuring a consistent narrative tone.</li>
<li><code class="inline-code">getAllThemes</code>: Retrieves an array of all theme definitions for use in listings and validation.</li>
<li><code class="inline-code">parseTheme</code>: Dynamically matches user inputs against theme IDs, keys, or keywords, enabling flexible adventure customization.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Integrity</h3>
<p>The validators in this file ensure that user input adheres to system requirements. From preventing empty or overly long inputs to sanitizing strings for display, this code protects the engine from invalid or malicious data.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Validates a user‚Äôs quest selection, ensuring it&#39;s non-empty and within acceptable length.</li>
<li><code class="inline-code">validateTheme</code>: Checks the validity of a given theme against predefined keys or keywords.</li>
<li><code class="inline-code">validateProjectPath</code>: Normalizes and sanitizes project paths, ensuring compatibility with the application.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>This configuration defines critical thresholds for the system, ensuring stability and responsiveness.</li>
<li>The use of <code class="inline-code">process.env</code> allows for runtime overrides, enabling flexibility in different environments.</li>
<li>Constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> are set with reasonable defaults to handle time-sensitive operations.</li>
<li>Size limitations (<code class="inline-code">MAX_FILE_SIZE_MB</code>) protect against excessive memory consumption during analysis.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  DEVELOPER: {
    id: 4,
    key: &#39;developer&#39;,
    displayName: &#39;Developer Documentation&#39;,
    emoji: &#39;üìñ&#39;,
    description: &#39;Technical documentation approach with clear explanations, best practices, and code analysis&#39;,
    keywords: [&#39;developer&#39;, &#39;code&#39;, &#39;technical&#39;, &#39;debug&#39;, &#39;guide&#39;, &#39;tutorial&#39;, &#39;binary&#39;]
  },
  CUSTOM: {
    id: 5,
    key: &#39;custom&#39;,
    displayName: &#39;Custom Theme&#39;,
    emoji: &#39;üé®&#39;,
    description: &#39;Design your own adventure! You\&#39;ll be prompted to provide theme name, description, and keywords&#39;,
    keywords: [&#39;custom&#39;, &#39;personalized&#39;, &#39;unique&#39;, &#39;creative&#39;, &#39;personal&#39;]
  }
} as const;

export function getAllThemes(): ThemeDefinition[] {
  return Object.values(THEMES);
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>The <code class="inline-code">THEMES</code> object provides predefined adventure settings, including metadata for presentation.</li>
<li>The <code class="inline-code">parseTheme</code> function matches user input dynamically, checking keys, IDs, and keywords.</li>
<li><code class="inline-code">getAllThemes</code> delivers a comprehensive list of themes, simplifying theme integration elsewhere.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> ensures input is valid, non-empty, and within a reasonable length.</li>
<li><code class="inline-code">validateTheme</code> leverages <code class="inline-code">parseTheme</code> to match inputs against predefined themes or reject invalid data.</li>
<li>Error messages guide users to provide correct, actionable inputs without system failures.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">process.env</code> wisely to configure runtime behavior without modifying the source code.</li>
<li>Explore <code class="inline-code">parseTheme</code> to understand how flexible parsing mechanisms enhance user experience.</li>
<li>Review validation techniques for ideas on input cleansing and protection in your projects.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>üéâ Congratulations, developer! You‚Äôve successfully refactored your skillset with Quest 4: The Tome of Themes and Configurations, achieving a deploy-ready mastery of thematic styling and configuration management‚Äîkeep iterating toward that 100% milestone! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>