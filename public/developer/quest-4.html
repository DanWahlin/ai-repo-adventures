<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Repository Chronicles: Crafting a Dynamic Adventure Framework</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Configuration &amp; Theme System</h1>
<hr>
<p>This stage of the adventure delves into the flexible and robust configuration and theme system powering the repository&#39;s narrative generator. These systems ensure adaptability and creativity, allowing the framework to tailor its behavior while adhering to developer expectations. By examining the files below, you will uncover how configurations influence system behavior and how themes enrich the narrative with structured customization options. Brace yourself for a comprehensive unveiling of constants, validation, and theme logic.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üõ†Ô∏è <strong>Configuration Limits</strong>: How do the configuration constants define system limits and behavior? What patterns ensure flexibility and safety, such as in <code class="inline-code">MAX_FILE_SIZE_MB</code> and <code class="inline-code">REPOMIX_CACHE_TTL</code>?</li>
<li>üé® <strong>Theme Logic</strong>: How are themes structured (<code class="inline-code">ThemeDefinition</code>), and what mechanisms (<code class="inline-code">getAllThemes</code>, <code class="inline-code">isValidTheme</code>) validate and enforce theme integrity?</li>
<li>üõ°Ô∏è <strong>Input Verification</strong>: How do validation functions like <code class="inline-code">validateTheme</code> and <code class="inline-code">validateProjectPath</code> prevent errors and ensure safe inputs?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> System Configuration</h3>
<p>This file defines critical constants responsible for managing system resources and behavior. These configurations include API limits, performance boundaries, and data processing rules. The constants support environment variable overrides, ensuring the system can adapt to various deployment scenarios. Performance-focused settings, such as <code class="inline-code">LLM_REQUEST_TIMEOUT</code> and <code class="inline-code">REPOMIX_CACHE_TTL</code>, prevent resource overloads. </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines the timeout for language model API calls, ensuring long-running operations are controlled.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Specifies the time-to-live (TTL) for cache data, enabling configurable short-term storage.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Sets an upper limit for file sizes during analysis to safeguard resources.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Definitions</h3>
<p>This file acts as the central hub for theme management. It contains definitions for preconfigured themes, including their attributes like <code class="inline-code">id</code>, <code class="inline-code">description</code>, and associated keywords. Functions like <code class="inline-code">getAllThemes</code> retrieve available themes, while methods like <code class="inline-code">parseTheme</code> interpret user inputs into theme identifiers.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Defines various themes (e.g., space, mythical, developer) and their attributes.</li>
<li><code class="inline-code">getAllThemes</code>: Provides all defined themes in an array format for easy iteration.</li>
<li><code class="inline-code">isValidTheme</code>: Validates whether a theme key represents a legitimate theme.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Validation</h3>
<p>This file ensures that inputs to the system are valid and sanitized. It prevents malformed or overly long inputs, invalid themes, and unsafe paths. By centralizing validation logic, it ensures consistent safeguards across the application.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Checks theme input against the available themes while handling malformed inputs gracefully.</li>
<li><code class="inline-code">validateAdventureChoice</code>: Verifies that user choices meet length and syntax requirements.</li>
<li><code class="inline-code">validateProjectPath</code>: Ensures the project path is a valid and secure string.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>These constants control critical runtime parameters, ensuring smooth and predictable behavior.</li>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> bounds operations involving external language models, preventing excessive delays.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> highlights the use of default and environment-specific overrides for flexibility.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> prevents performance bottlenecks caused by processing overly large files.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  DEVELOPER: {
    id: 4,
    key: &#39;developer&#39;,
    displayName: &#39;Developer Documentation&#39;,
    emoji: &#39;üìñ&#39;,
    description: &#39;Technical documentation approach with clear explanations, best practices, and code analysis&#39;,
    keywords: [&#39;developer&#39;, &#39;code&#39;, &#39;technical&#39;, &#39;debug&#39;, &#39;guide&#39;, &#39;tutorial&#39;, &#39;binary&#39;]
  }
} as const;

export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}

export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> showcases the versatility of structured theme data through attributes like <code class="inline-code">keywords</code> and <code class="inline-code">emoji</code>.</li>
<li><code class="inline-code">getAllThemes</code> centralizes theme access, benefiting functions across the system.</li>
<li><code class="inline-code">isValidTheme</code> demonstrates the use of array methods to validate user inputs, fostering simplicity and consistency.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li><code class="inline-code">validateTheme</code> enforces theme validity, leveraging functions from <code class="inline-code">theme.ts</code> for reusable logic.</li>
<li><code class="inline-code">validateProjectPath</code> guards against potential vulnerabilities, such as null bytes or excessively long paths.</li>
<li>These validations ensure safe and meaningful inputs, protecting the system from user-generated errors.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">config.ts</code> for understanding runtime resource constraints and flexibility.</li>
<li>Explore <code class="inline-code">theme.ts</code> for insights into structuring modular, thematic data.</li>
<li>Study <code class="inline-code">input-validator.ts</code> to learn strategies for sanitizing and verifying diverse inputs.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Commit successful: Quest 4: Configuration &amp; Theme System has been merged into your skillset master branch‚Äîyou&#39;re 60% synchronized with your learning roadmap; onward to shipping greatness! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>