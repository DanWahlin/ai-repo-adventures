<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Developer Documentation Generator for Repository Analysis</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Configuration &amp; Theme System</h1>
<h2>Technical Overview</h2>
<p>The Configuration &amp; Theme System provides centralized management for application settings and ensures uniform control of user-defined or environment-derived options. This includes handling global constants, environment variables, theme definitions, and input validation for adventure customization. It plays a vital role in maintaining operational consistency and validating user inputs throughout the adventure generation process.</p>
<h2>Key Components</h2>
<ul>
<li><strong>Configuration Settings</strong> (<a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>): Centralized constants and settings derived from environment variables or application defaults.</li>
<li><strong>Input Validation</strong> (<a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>): Functions for validating user inputs such as theme selections and file paths.</li>
<li><strong>Theme Definitions</strong> (<a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>): Provides a single source of truth for available themes, their metadata, and helper functions for parsing and validation.</li>
</ul>
<h2>Implementation Details</h2>
<h3>Configuration Management</h3>
<ul>
<li>The configuration file (<code class="inline-code">config.ts</code>) loads environment variables using <code class="inline-code">dotenv</code>. It defines constants for API settings, timeout values, caching parameters, and error handling. This modular approach ensures that changing a value is straightforward and localized.</li>
<li>Architectural decisions include breaking configurations into manageable constants and avoiding complex nested structures for easier debugging and maintenance.</li>
</ul>
<h3>Input Validation</h3>
<ul>
<li>Input validation methods (<code class="inline-code">input-validator.ts</code>) check values against constraints such as maximum string lengths, valid themes, and sanitization rules. Themes are validated through simple helpers that test against the predefined <code class="inline-code">THEMES</code> object.</li>
<li>The validation logic avoids unnecessary complexity by using utility functions (e.g., <code class="inline-code">trim()</code>, <code class="inline-code">slice()</code>) for input sanitization.</li>
</ul>
<h3>Theme System</h3>
<ul>
<li>Theme definitions (<code class="inline-code">theme.ts</code>) store metadata for each adventure theme, including IDs, display names, emojis, descriptions, and keywords. This allows dynamic theme matching based on user input or keywords.</li>
<li>Parsing and validation functions like <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> use lightweight logic to ensure high performance, especially for frequent operations such as validating theme choices or displaying formatted theme options.</li>
</ul>
<h2>Code Examples</h2>
<h3>Configuration Constants</h3>
<p><strong>File:</strong> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></p>
<pre><code class="language-typescript">// Environment-derived constants
export const LLM_API_KEY = process.env.LLM_API_KEY || &#39;&#39;;
export const LLM_BASE_URL = process.env.LLM_BASE_URL || &#39;https://api.openai.com/v1&#39;;
export const DEFAULT_THEME = &#39;space&#39;;

// Timeout values
export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds
export const FILE_READ_TIMEOUT = 10000;

// Analysis limits
export const MAX_FILE_SIZE_MB = 10;

// Ignored directory patterns
export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;, &#39;.git&#39;, &#39;dist&#39;, &#39;coverage&#39;
];
</code></pre>
<p>This demonstrates clearly defined constants for easy configuration and reuse across the codebase.</p>
<h3>Input Validation Example</h3>
<p><strong>File:</strong> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></p>
<pre><code class="language-typescript">import { parseTheme, isValidTheme } from &#39;./theme.js&#39;;

export function validateTheme(input: string): string {
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);

  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }

  return parsedTheme;
}
</code></pre>
<p>This snippet showcases how user input for themes is normalized, parsed, and validated against a predefined list.</p>
<h3>Theme Helper Example</h3>
<p><strong>File:</strong> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></p>
<pre><code class="language-typescript">export function formatThemeOption(theme: ThemeDefinition): string {
  return `${theme.emoji} **${theme.id}. ${theme.displayName}** - ${theme.description}`;
}

export function getFormattedThemeOptions(): string {
  return getAllThemes()
    .sort((a, b) =&gt; a.id - b.id) // Sorting by ID for consistent display
    .map(formatThemeOption)
    .join(&#39;\n&#39;);
}
</code></pre>
<p>This utility enables formatted display of all theme options for user interfaces or prompts.</p>
<h2>Integration Points</h2>
<ul>
<li><strong>Adventure Generation Engine</strong>: Utilizes theme parsing and validation (<code class="inline-code">validateTheme</code>, <code class="inline-code">getFormattedThemeOptions</code>) when generating adventure content and enforcing user theme preferences.</li>
<li><strong>Code Analysis &amp; Content Pipeline</strong>: References configuration constants like <code class="inline-code">MAX_FILE_SIZE_MB</code> and <code class="inline-code">IGNORE_PATTERNS</code> during repository scanning and file handling.</li>
<li><strong>MCP Tool Interface</strong>: Uses <code class="inline-code">DEFAULT_THEME</code> and error messages (<code class="inline-code">ERROR_MESSAGES</code>) to maintain consistent interaction with users during adventure creation and validation processes.</li>
</ul>
<h2>Best Practices &amp; Considerations</h2>
<ul>
<li><strong>Centralized Configuration</strong>: Keep all global constants and settings in a single file for maintainability. Use environment variables for sensitive settings like API keys.</li>
<li><strong>Input Validation</strong>: Robust input validation prevents unexpected errors or security concerns. Avoid overcomplicated validation logic to ensure performance efficiency.</li>
<li><strong>Theme Management</strong>: Use descriptive metadata for themes for better integration with UI components and user prompts.</li>
<li><strong>Error Handling</strong>: Define concise and user-friendly error messages, avoiding developer jargon whenever errors are exposed to end-users.</li>
<li><strong>Environment Variables</strong>: Always provide default values to avoid crashing the application in environments lacking certain configurations.</li>
<li><strong>Modular Design</strong>: Break down helper functions for themes and validation into small, focused utilities for better testability and reuse.</li>
</ul>
<p>Adopting these practices will ensure the code remains reliable, scalable, and easy to maintain.</p>
<p>Congratulations, Developer! You&#39;ve successfully refactored your skillset with Quest 4: Configuration &amp; Theme System—🎉 you&#39;re now dynamically rendering progress at 60% complete toward mastery with stellar performance optimization! 🚀⚡💎</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">← Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>