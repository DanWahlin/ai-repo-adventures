<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Council of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Adventures in the Repository Realms</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Council of Themes</h1>
<hr>
<p>In the Repository Realms, where snippets of wisdom breathe life into countless systems, the Council of Themes convenes. These enchanted configurations define the essence of your adventures: from voyages through cosmic APIs to exploring ancient algorithms of lost civilizations. As an Archivist Adventurer, your duty is to interpret these themes, validate their integrity, and customize them to unlock new paths across the realms. In this quest, you will investigate the mystical foundations that guide the Archive&#39;s thematic alignment and ensure harmony within the Council.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Continuum</strong>: How are themes structured and validated in the codebase, and what properties unify the system?  </li>
<li>‚ö° <strong>Validation Rituals</strong>: What methods verify user input when selecting themes, and how are errors managed?  </li>
<li>üõ°Ô∏è <strong>Configuration Anchors</strong>: What safeguards exist for critical configuration parameters like timeouts and caching?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Validation logic for user inputs</h3>
<p>This file contains core validation methods ensuring inputs are sanitized, valid, and secured. Focus on how the <code class="inline-code">validateTheme</code> method ensures chosen themes are legitimate, relying on helper functions from the <code class="inline-code">theme.ts</code> module. Error handling differentiates between invalid inputs and malformed data, while utility methods like <code class="inline-code">sanitizeForDisplay</code> enhance safety and formatting of outputs.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Validates text input for user choices with length and presence checks.  </li>
<li><code class="inline-code">validateTheme</code>: Normalizes and validates theme input using helper functions.  </li>
<li><code class="inline-code">validateProjectPath</code>: Ensures paths do not include invalid characters and apply safety limits.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<p>This ensures user input meets length constraints and is not empty before proceeding.</p>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<p>Maps user input to a valid theme, leveraging <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> for accuracy while throwing contextual errors for clarity.</p>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<p>Prevents invalid paths and substitutes a default when none is provided, maintaining repository integrity.</p>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Centralized theme data and utilities</h3>
<p>This file houses the definitive collection of themes, alongside utilities for validation, parsing, and formatting. It ensures themes are extensible and retrievable via key, ID, or associated keywords. The <code class="inline-code">getThemeByKey</code> and <code class="inline-code">getAllThemes</code> functions form its backbone, enabling user input to be mapped precisely to corresponding themes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Core data structure containing pre-defined themes with metadata.  </li>
<li><code class="inline-code">getAllThemes</code>: Retrieves all themes as an array for iteration and validation.  </li>
<li><code class="inline-code">parseTheme</code>: Maps input to themes using key, ID, or keyword matches.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  // Other themes omitted for brevity...
} as const;
</code></pre>
<p>Defines the core library of adventure themes as an immutable object indexed by meaningful keys.</p>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<p>Provides a straightforward method to retrieve all available themes for display or validation.</p>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<p>Applies a tiered approach to accurately map user inputs to themes, supporting keys, IDs, and keyword matching.</p>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Centralized system configuration</h3>
<p>This file configures critical parameters like request timeouts, limits, and environment variables. Its constants establish boundaries for performance and reliability, while default values ensure that the system operates even without configuration overrides. Special attention should be given to values like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> and <code class="inline-code">REPOMIX_CACHE_TTL</code>, which directly influence the quest&#39;s runtime dynamics.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Configures request timeout values for the language model.  </li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Sets the lifespan of cached Repomix data, optimizing retrievals.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Establishes file size limits for analysis, keeping system behaviors predictable.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
</code></pre>
<p>Dictates how long the system waits for large, complex prompts before considering them timeout errors.</p>
<pre><code class="language-typescript">export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
</code></pre>
<p>Determines cached data validity duration, ensuring fresh content for quests without overloading resources.</p>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<p>Enforces a strict upper file size limit to balance memory use with meaningful results.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Validate theme flow by stepping through the <code class="inline-code">validateTheme</code> and <code class="inline-code">parseTheme</code> methods carefully.  </li>
<li>Use <code class="inline-code">THEMES</code> as a single source of truth for any new theme additions or modifications.  </li>
<li>Adjust configuration values in <code class="inline-code">config.ts</code> responsibly to suit your environment and resource constraints.</li>
</ul>
<hr>
<p>Your traversal of the Council of Themes has strengthened your understanding of input validation, theme governance, and configuration stability. Press onward to bend these elements to your will in future quests!</p>
<p>Quest 4: The Council of Themes has successfully compiled without errors‚Äîyour codebase of learning is now optimized at 60%, proving your algorithms for growth and persistence are running flawlessly! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>