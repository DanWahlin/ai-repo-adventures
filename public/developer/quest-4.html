<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Vault of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Repository of Infinite Adventures</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Vault of Themes</h1>
<hr>
<p>You stand before the towering shelves of the Vault of Themes, where the essence of every possible adventure is meticulously cataloged and bound in shimmering scrolls of data. This is the heart of thematic operations, housing the intricate configurations and robust validation schemas that breathe life into the adventures of countless explorers. Embrace your role as the Keeper of Code and traverse this repository of boundless imagination. Decode the logic, analyze the structures, and harness the power of the Vault to customize or rectify the realms of narrative exploration.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:  </p>
<ul>
<li>üîç <strong>Thematic Threads</strong>: How are themes structured and retrieved? What makes the theme system maintainable and extensible?  </li>
<li>‚ö° <strong>Validation Nexus</strong>: How does the <code class="inline-code">validateTheme</code> function ensure user inputs align with existing themes? What patterns make this mechanism robust?  </li>
<li>üõ°Ô∏è <strong>Defensive Coding</strong>: How do <code class="inline-code">validateTheme</code> and <code class="inline-code">sanitizeForDisplay</code> ensure safe and proper handling of user inputs?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input validation for themes</h3>
<p>This file handles validating user input for theme selection and project paths, ensuring they conform to defined expectations. The logic uses structured error handling and leverages imported data about themes to ensure a valid selection. Functions like <code class="inline-code">validateTheme</code> integrate with theme definitions to allow for seamless validation and normalization. Additionally, <code class="inline-code">sanitizeForDisplay</code> prevents unsafe characters from being displayed by removing potential malicious input.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Ensures user-specified themes exist and are valid.  </li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleans potentially unsafe strings for display.  </li>
<li><code class="inline-code">validateAdventureChoice</code>: Normalizes and validates input for adventure selection.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<p>This function ensures the chosen theme is valid by normalizing inputs, parsing them for matching a theme, and throwing errors for invalid choices.  </p>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<p>This function makes string data safe to display by removing potentially harmful characters or unnecessary whitespace.  </p>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<p>This function validates user input for adventure choices, ensuring mandatory requirements like length and presence.  </p>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Centralized theme handling</h3>
<p>This file defines all themes, their structure, and logic for interacting with them throughout the system. It maintains extensibility through easily structured definitions and provides utility functions like <code class="inline-code">isValidTheme</code> and <code class="inline-code">parseTheme</code> for input processing. Each theme encapsulates its unique identifiers, a description, display name, emoji, and matching keywords used to validate user choices effectively.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Core theme definitions holding critical properties.  </li>
<li><code class="inline-code">getAllThemes</code>: Retrieves all theme options for iteration or validation.  </li>
<li><code class="inline-code">isValidTheme</code>: Verifies if an input string corresponds to a defined theme.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  // Additional themes truncated for brevity
};
</code></pre>
<p>This object serves as the single source of truth, housing the metadata for all predefined themes.  </p>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<p>This function retrieves all themes by processing the <code class="inline-code">THEMES</code> object for easy iteration.  </p>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<p>This function validates whether a given string matches one of the predefined theme keys.  </p>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration constants</h3>
<p>This file provides constants for the system. It includes runtime settings like API timeouts, maximum file sizes, and default values. For the theme system, it houses the <code class="inline-code">DEFAULT_THEME</code>, used as a fallback for invalid or missing inputs.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">DEFAULT_THEME</code>: Specifies the fallback or initial theme.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Restricts file size for analysis.  </li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Configures caching duration.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const DEFAULT_THEME = &#39;space&#39; as const;
</code></pre>
<p>Defines the default theme as <code class="inline-code">space</code>, ensuring a consistent fallback for adventure generation.  </p>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10;
</code></pre>
<p>Limits the file size for analysis to focus resources on manageable input.  </p>
<pre><code class="language-typescript">export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
</code></pre>
<p>Sets the cache expiration period to improve performance and allow configuration via environment variables.  </p>
<h2>Helpful Hints</h2>
<ul>
<li>Investigate how <code class="inline-code">THEMES</code> enables centralized and maintainable theme management.  </li>
<li>Consider edge cases covered by <code class="inline-code">validateTheme</code> and how errors surface user-friendly messages.  </li>
<li>Explore using <code class="inline-code">sanitizeForDisplay</code> for broader safety in user-facing features.</li>
</ul>
<hr>
<p>You have successfully unlocked the secrets of the Vault of Themes! Your newfound clarity will serve you well in deciphering and wielding the thematic powers of the adventure system.</p>
<p>Congratulations on debugging your way through Quest 4: The Vault of Themes‚Äîyour commitment to iterating on complex challenges is deploying success at 60% completion; keep pushing towards the final milestone! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>