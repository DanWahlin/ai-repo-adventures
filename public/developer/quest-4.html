<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Configurator‚Äôs Codex - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Adventures of the Repository Chronicles</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Configurator‚Äôs Codex</h1>
<hr>
<p>In a world where context is key and structure reigns supreme, precision becomes your greatest ally. The Configurator‚Äôs Codex holds the secrets to the algorithms that power dynamic adventures. Your mission: decode the intricate relationships between configuration constants, input validation techniques, and theme systems. This quest focuses on configuration files that define settings, constraints, theme generation, and safety mechanisms. Navigate through crucial snippets and implementation details to master the repository&#39;s foundation.  </p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:  </p>
<ul>
<li>üîç <strong>Pathfinder‚Äôs Clarity</strong>: How is the <code class="inline-code">validateProjectPath</code> function ensuring valid directory input while handling edge cases in <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>?  </li>
<li>‚ö° <strong>Theme Alignment</strong>: What patterns does <code class="inline-code">parseTheme</code> leverage to match user input with valid themes in <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>?  </li>
<li>üõ°Ô∏è <strong>Fortress Parameters</strong>: How are constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> and <code class="inline-code">MAX_FILE_SIZE_MB</code> protecting system integrity while ensuring optimal performance in <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Validation</h3>
<p>Input validation ensures reliable user input processing across the codebase. This file features streamlined methods to validate adventure choices, themes, project paths, and sanitize data for safe display.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Enforces basic constraints, including length limits and mandatory input, protecting against malformed data.  </li>
<li><code class="inline-code">validateTheme</code>: Matches input against preconfigured themes while providing feedback for invalid entries.  </li>
<li><code class="inline-code">validateProjectPath</code>: Ensures directory paths are formatted correctly and free of prohibited characters.  </li>
<li><code class="inline-code">sanitizeForDisplay</code>: Eliminates harmful characters and trims excess whitespace for secure rendering.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {  
  if (!input?.trim()) {  
    throw new Error(&#39;Choice is required&#39;);  
  }  
  
  if (input.length &gt; 200) {  
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);  
  }  
  
  return input.trim();  
}  

export function validateTheme(input: string): string {  
  if (!input?.trim()) {  
    throw new Error(&#39;Theme is required&#39;);  
  }  
  
  const normalized = input.toLowerCase().trim();  
  const parsedTheme = parseTheme(normalized);  
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {  
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);  
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);  
  }  
  
  return parsedTheme;  
}  

export function validateProjectPath(input?: string): string {  
  if (!input?.trim()) {  
    return process.cwd();  
  }  
  
  if (input.length &gt; 500) {  
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);  
  }  
  
  if (input.includes(&#39;\0&#39;)) {  
    throw new Error(&#39;Project path contains invalid characters&#39;);  
  }  
  
  return input.trim();  
}  
</code></pre>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> ensures user-entered data aligns with expected length and presence, preventing rogue input.  </li>
<li><code class="inline-code">validateTheme</code> normalizes user input, matches it with valid themes, and raises descriptive errors for invalid options.  </li>
<li><code class="inline-code">validateProjectPath</code> handles default cases, trims input, and validates against special characters. By safeguarding paths, it prevents misuse and errors tied to file system configuration.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Management</h3>
<p>Themes are the backbone of adventure generation, enabling alignment between user choices and preconfigured stories. This file contains centralized definitions, helper functions, and validation implementations for handling themes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseTheme</code>: Analyzes user input against theme structures, handling edge cases like numeric IDs and keyword inclusion.  </li>
<li><code class="inline-code">getAllThemes</code>: Provides a complete list of available themes for selection validation and display.  </li>
<li><code class="inline-code">formatThemeOption</code>: Formats theme properties for user-friendly display during adventure customization.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {  
  if (!input) return null;  
  
  const normalized = input.trim().toLowerCase();  
  
  const exactMatch = getThemeByKey(normalized);  
  if (exactMatch) return exactMatch.key as AdventureTheme;  
  
  const numericId = parseInt(normalized, 10);  
  if (!isNaN(numericId)) {  
    const byId = getThemeById(numericId);  
    if (byId) return byId.key as AdventureTheme;  
  }  
  
  for (const theme of THEMES_ARRAY) {  
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {  
      return theme.key as AdventureTheme;  
    }  
  }  
  
  return null;  
}  

export function getAllThemes(): ThemeDefinition[] {  
  return THEMES_ARRAY;  
}  

export function formatThemeOption(theme: ThemeDefinition): string {  
  return `${theme.emoji} **${theme.id}. ${theme.displayName}** - ${theme.description}`;  
}  
</code></pre>
<ul>
<li><code class="inline-code">parseTheme</code> employs a multi-step matching mechanism combining direct identification, numeric parsing, and keyword scanning. This ensures flexibility and robustness in theme validation.  </li>
<li><code class="inline-code">getAllThemes</code> acts as a Single Source of Truth, returning a full theme array for iteration and validation.  </li>
<li><code class="inline-code">formatThemeOption</code> renders theme data with emojis, IDs, and descriptions, making it accessible for end-user selection during adventure setup.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> System Configuration</h3>
<p>This file defines constants and parameters used to configure settings like API limits, timeouts, and project constraints. It emphasizes simplicity and readability for critical defaults.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: A timeout setting for API requests, ensuring prompt responses under load.  </li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Controls cache duration, balancing performance and resource use.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Protects analysis systems by capping file sizes to prevent memory exhaustion during processing.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds  
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env  
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues  
</code></pre>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> enforces accessibility by bounding request intervals to safeguard against service delays.  </li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> ensures cache consistency, striking a balance between performance enhancements and resource constraints.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> implements defensive programming against oversized files to ensure predictable, secure application behavior.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>üõ†Ô∏è Note the centralized management principles in theme data for ease of validation and extension.  </li>
<li>üöÄ When configuring timeouts and limits, focus on balancing performance needs with edge-case protection.  </li>
<li>üìñ Use formatted options (<code class="inline-code">formatThemeOption</code>) to simplify theme visualization during user interaction.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Congratulations on committing &quot;Quest 4: The Configurator‚Äôs Codex&quot; to the master branch of your skills repository‚Äîyour refactor of knowledge is 60% complete, keep building that codebase toward 100%! üöÄüíé‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>