<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Codex of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Repository Chronicles: Tales of the Automation Guild</a>
            </div>
            <div class="nav-middle">
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="../index.html" class="nav-link">Change Theme</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Codex of Themes</h1>
<hr>
<p>In a realm governed by the Automation Guild, adventurers seeking to wield the Codex of Themes must navigate through its intricate layers of theme-based definitions and validations. Crafted from the essence of diverse adventures, the Codex unifies divergent paths, structuring quests around universal narratives. To master this arcane artifact, one must delve into theme initialization, validation mechanisms, and the architecture behind theme-driven functionalities. Let your exploration guide the interplay between choice, validation, and design as you unlock the secrets of thematic adventures.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Arcane Alignment</strong>: How does the system validate and normalize user input for themes, ensuring consistency across adventures?</li>
<li>‚ö° <strong>Empowered Classification</strong>: What structural patterns are used to define themes, and how are they retrieved or matched dynamically?</li>
<li>üõ°Ô∏è <strong>Guarded Entrance</strong>: How does the system handle errors during theme validation and normalization, preventing invalid inputs from derailing adventures?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input handling and validation</h3>
<p>This file provides essential validation mechanisms, ensuring user-provided inputs are properly sanitized and normalized before being processed by the system. It encompasses choices validation, theme validation, and project path management to ensure smooth operations. Its connection to <code class="inline-code">theme.ts</code> allows for dynamic validation against predefined theme structures. The logic here reinforces the reliability of adventure initialization, preventing invalid and potentially hazardous inputs from entering the core system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures user adventure selections are trimmed, limited in length, and non-empty.</li>
<li><code class="inline-code">validateTheme</code>: Normalizes input theme choice, validates against available themes, and provides helpful feedback for invalid entries.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips potentially harmful characters to prevent UI injection and ensures concise output formatting.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Ensures the input is non-empty by trimming whitespace and checking for null values.</li>
<li>Restricts input length to 200 characters, emphasizing UX design considerations of concise choice handling.</li>
<li>Avoids expensive operations by relying on direct string manipulation for performance.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Normalizes input by converting it to lowercase and trimming whitespace.</li>
<li>Utilizes <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> from <code class="inline-code">theme.ts</code> to tightly integrate theme validation workflows.</li>
<li>Ensures invalid themes are handled gracefully, providing users with a helpful list of valid options.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Filters potentially malicious characters to prevent scripting attacks or unintended behavior in UI rendering.</li>
<li>Trims extra whitespace for cleaner rendering while slicing inputs at a manageable length for readability.</li>
<li>Provides versatile sanitization useful across different UI components of the adventure system.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme definitions and access</h3>
<p>This file centralizes all theme definitions with detailed properties to streamline adventure generation. The structure ensures keywords, IDs, and descriptions are well-organized, and retrieval methods simplify access to themes by keys, IDs, or keywords. The modular design supports dynamic customization, enabling new thematic content to be seamlessly integrated into the system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Provides detailed theme definitions, encapsulating IDs, keys, and associated descriptions.</li>
<li><code class="inline-code">getThemeByKey</code>: Retrieves themes by their unique keys, aiding validation and access in other modules.</li>
<li><code class="inline-code">formatThemeOption</code>: Formats rich theme descriptions for display, simplifying user selection processes.</li>
</ul>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  DEVELOPER: {
    id: 4,
    key: &#39;developer&#39;,
    displayName: &#39;Developer Documentation&#39;,
    emoji: &#39;üìñ&#39;,
    description: &#39;Technical documentation approach with clear explanations, best practices, and code analysis&#39;,
    keywords: [&#39;developer&#39;, &#39;code&#39;, &#39;technical&#39;, &#39;debug&#39;, &#39;guide&#39;, &#39;tutorial&#39;, &#39;binary&#39;]
  },
  CUSTOM: {
    id: 5,
    key: &#39;custom&#39;,
    displayName: &#39;Custom Theme&#39;,
    emoji: &#39;üé®&#39;,
    description: &#39;Design your own adventure! You\&#39;ll be prompted to provide theme name, description, and keywords&#39;,
    keywords: [&#39;custom&#39;, &#39;personalized&#39;, &#39;unique&#39;, &#39;creative&#39;, &#39;personal&#39;]
  }
} as const;
</code></pre>
<ul>
<li>Centralizes theme properties for consistent usage and clear referencing across modules.</li>
<li>Ensures keywords are exhaustive yet specific, promoting effective user input matching.</li>
<li>Descriptions are crafted for thematic immersion while being informative and concise.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getThemeByKey(key: string): ThemeDefinition | null {
  return THEMES_ARRAY.find(theme =&gt; theme.key === key) || null;
}
</code></pre>
<ul>
<li>Simplifies theme retrieval by matching a unique key, ensuring precise alignment for user inputs.</li>
<li>Avoids iterating cyclic structures by leveraging concise array traversal.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatThemeOption(theme: ThemeDefinition): string {
  return `${theme.emoji} **${theme.id}. ${theme.displayName}** - ${theme.description}`;
}
</code></pre>
<ul>
<li>Builds formatted strings combining ID, display name, and description for clear user interaction.</li>
<li>Introduces emojis for thematic immersion, making adventures visually appealing.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">validateTheme</code> to quickly verify any user input before proceeding with deeper adventure logic.</li>
<li>Reference the <code class="inline-code">THEMES</code> object as a single source of truth for all standard theme properties.</li>
<li>Combine sanitization techniques from <code class="inline-code">sanitizeForDisplay</code> with validations to ensure smooth operations across the system.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>System.out.println(&quot;üéâ Congratulations, Developer! You&#39;ve successfully refactored Quest 4: &#39;The Codex of Themes&#39; into your skill stack‚Äî60% progress unlocked on this epic ‚≠ê runtime journey! üöÄ&quot;);</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>