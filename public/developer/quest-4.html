<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Pillars of Guidance - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codex of Computational Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Pillars of Guidance</h1>
<hr>
<p>In the intricate software kingdom, the ancient Codex guides adventurers to create immersive experiences across lines of code and innovative themes. In this quest, focus turns to the configuration and theme systems, pillars supporting vast adventure landscapes. These silently power theme selection, input validation, and environment configuration. Seek clarity within them to unearth the pathways for software storytelling.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üå™Ô∏è <strong>Timeout Tuning</strong>: How are timeout values configured in <code class="inline-code">config.ts</code>, and what flexibility do they provide for adventure performance?</li>
<li>üõ†Ô∏è <strong>Theme Design</strong>: What structure is used to define themes in <code class="inline-code">theme.ts</code>, and how are they validated or adapted in runtime scenarios?</li>
<li>üß© <strong>Input Validation Reliability</strong>: What mechanisms in <code class="inline-code">input-validator.ts</code> ensure that user inputs like choices and paths maintain reliability without impacting system integrity?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configurations for the foundation of the system</h3>
<p>This file defines constants and environmental values, forming the base configuration for the Codex. It covers LLM interaction details, error handling settings, cache behaviors, and timeout limits.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> specifies the maximum time allowed for AI calls, ensuring responsiveness in dynamic environments.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> defines cache expiry for subprocesses, reducing redundant computations.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> limits the size of files processed during analysis, preventing performance bottlenecks.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Dynamic theme definitions and utilities</h3>
<p>This file provides a centralized location for theme data and the logic for parsing, validating, and displaying themes. It ensures that adventures align with developer-selected narratives.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> contains predefined themes with specifics like <code class="inline-code">key</code>, <code class="inline-code">emoji</code>, and validation <code class="inline-code">keywords</code>.</li>
<li><code class="inline-code">isValidTheme</code> ensures user-provided themes align with valid options to avoid misconfigurations.</li>
<li><code class="inline-code">parseTheme</code> converts user input into a valid theme, supporting customization and flexibility.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Essential input validation for safe user inputs</h3>
<p>This file ensures that inputs provided by developers, such as choices or paths, conform to system requirements. It aims to maintain security and predictability.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> ensures choice inputs are within permissible length and formatting constraints.</li>
<li><code class="inline-code">validateProjectPath</code> sanitizes and validates the project path, providing sensible defaults where needed.</li>
<li><code class="inline-code">sanitizeForDisplay</code> removes malicious or unsafe characters from text inputs, improving safety for rendering.</li>
</ul>
<hr>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">// LLM timeout for requests
export const LLM_REQUEST_TIMEOUT = 60000;

// Cache expiration
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds

// File size restriction
export const MAX_FILE_SIZE_MB = 10; // Skip giant files
</code></pre>
<ul>
<li><strong>Purpose</strong>: Defines limits and prevents over-allocation during analysis or LLM responses.</li>
<li><strong>Patterns</strong>: Environmental overrides ensure configurability.</li>
<li><strong>Relationship</strong>: Works with analysis algorithms to keep inputs manageable.</li>
<li><strong>Key insight</strong>: Balances performance and capability for diverse environments.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">// Available themes list
export const THEMES = {
  SPACE: {
    id: 1, key: &#39;space&#39;, displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases...&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;]
  },
  MYTHICAL: {
    id: 2, key: &#39;mythical&#39;, displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms...&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;]
  }
};

// Validation utilities for themes
export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}

// Parse unstructured theme input
export function parseTheme(input: string): AdventureTheme | null {
  const normalized = input.trim().toLowerCase();
  return getThemeByKey(normalized)?.key || null;
}
</code></pre>
<ul>
<li><strong>Purpose</strong>: Defines and validates adventure themes with flexibility in input handling.</li>
<li><strong>Structure</strong>: Uses simple objects and arrays for manageability.</li>
<li><strong>Validation</strong>: Protects against invalid or unsupported themes.</li>
<li><strong>Adaptability</strong>: Allows user input to match themes from multiple angles.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">// Validate user choices for adventures
export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) throw new Error(&#39;Choice is required&#39;);
  if (input.length &gt; 200) throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  return input.trim();
}

// Validate project paths
export function validateProjectPath(input?: string): string {
  if (!input?.trim()) return process.cwd();
  if (input.length &gt; 500) throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  if (input.includes(&#39;\0&#39;)) throw new Error(&#39;Path contains invalid characters&#39;);
  return input.trim();
}

// Sanitize unsafe inputs
export function sanitizeForDisplay(input: string): string {
  return input.replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;).replace(/\s+/g, &#39; &#39;).trim();
}
</code></pre>
<ul>
<li><strong>Purpose</strong>: Guards against problematic inputs that could cause crashes or vulnerabilities.</li>
<li><strong>Flexibility</strong>: Offers sensible options when no input is provided.</li>
<li><strong>Sanitation</strong>: Ensures rendered data avoids injection risks.</li>
<li><strong>Resilience</strong>: Prepares the system to handle invalid or malicious input gracefully.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Check the dependency of <code class="inline-code">validateTheme()</code> on the theme definitions for validation logic.</li>
<li>Investigate how <code class="inline-code">LLM_REQUEST_TIMEOUT</code> impacts integration with external AI models.</li>
<li>Start replaying an adventure by altering <code class="inline-code">THEMES</code> to observe different narrative outcomes.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries within the Codex of Computational Adventures.</p>
<p>Congratulations on successfully deploying the robust architecture of Quest 4: The Pillars of Guidance‚Äîyour algorithmic journey is now 60% complete, proving your codebase of perseverance is primed for scalability and innovation üöÄüíé‚ö°!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>