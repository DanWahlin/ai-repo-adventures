<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Theme Enclave - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codex of Intelligent Adventures</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Theme Enclave</h1>
<hr>
<p>You arrive at the gates of The Theme Enclave, an arcane repository of design paradigms and configuration knowledge. This sacred space governs the essence of each adventure, wielding themes, validations, and structured configurations as its tools. To unlock its secrets, you must decipher the interplay of precise validations, intricate theme definitions, and adaptable configurations. Step carefully between the lines of code, brave adventurer, for the clarity of these systems holds the key to forging meaningful digital landscapes.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:  </p>
<ul>
<li>üîç <strong>Theme Mapping Mysteries</strong>: How does the <code class="inline-code">getAllThemes</code> function organize and extract theme data?  </li>
<li>‚ö° <strong>Validation Crusade</strong>: How does the <code class="inline-code">validateTheme</code> function ensure themes are parsed and checked for validity?  </li>
<li>üõ°Ô∏è <strong>Config Fortifications</strong>: What safety measures are embedded in configurations like <code class="inline-code">REPOMIX_CACHE_TTL</code> and <code class="inline-code">MAX_FILE_SIZE_MB</code> to prevent system overloads?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Validation Logic</h3>
<p>This file contains critical validation functions that ensure adventurers&#39; choices and input paths align with repository requirements. The highlight includes how these validations avoid dangerous inputs, enforce constraints, and provide helpful error messages.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> prevents empty or oversized adventure inputs.  </li>
<li><code class="inline-code">validateTheme</code> ensures valid themes by parsing input and cross-checking theme definitions.  </li>
<li><code class="inline-code">validateProjectPath</code> sanitizes project paths to avoid invalid characters like <code class="inline-code">\0</code>.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {  
  if (!input?.trim()) {  
    throw new Error(&#39;Choice is required&#39;);  
  }  
  if (input.length &gt; 200) {  
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);  
  }  
  return input.trim();  
}  
</code></pre>
<p>Enforces a strict upper limit to maintain system stability during adventure initialization.  </p>
<pre><code class="language-typescript">export function validateTheme(input: string): string {  
  if (!input?.trim()) {  
    throw new Error(&#39;Theme is required&#39;);  
  }  
  const normalized = input.toLowerCase().trim();  
  const parsedTheme = parseTheme(normalized);  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {  
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);  
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);  
  }  
  return parsedTheme;  
}  
</code></pre>
<p>Uses both <code class="inline-code">parseTheme</code> validations and <code class="inline-code">isValidTheme</code> checks to restrict themes to the enclave&#39;s predefined set.  </p>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {  
  if (!input?.trim()) {  
    return process.cwd();  
  }  
  if (input.length &gt; 500) {  
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);  
  }  
  if (input.includes(&#39;\0&#39;)) {  
    throw new Error(&#39;Project path contains invalid characters&#39;);  
  }  
  return input.trim();  
}  
</code></pre>
<p>Cleanses project paths while setting sensible upper length limits for reliability.  </p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Definitions and Utilities</h3>
<p>This file provides the canonical definitions and utility functions for themes in the adventure system. By leveraging accessible structures and helper functions, it ensures each theme effectively connects with user interactions and system flows.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> centralizes theme definitions with metadata.  </li>
<li><code class="inline-code">isValidTheme</code> verifies theme validity.  </li>
<li><code class="inline-code">getAllThemes</code> retrieves and organizes all available themes.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {  
  SPACE: {  
    id: 1,  
    key: &#39;space&#39;,  
    displayName: &#39;Space Exploration&#39;,  
    emoji: &#39;üöÄ&#39;,  
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,  
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]  
  },  
  MYTHICAL: {  
    id: 2,  
    key: &#39;mythical&#39;,  
    displayName: &#39;Enchanted Kingdom&#39;,  
    emoji: &#39;üè∞&#39;,  
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,  
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]  
  }  
  // Additional themes omitted for brevity.  
} as const;  
</code></pre>
<p>Structures themes as a single source of truth, ensuring flexibility while maintaining organization.  </p>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {  
  return THEMES_ARRAY.some(t =&gt; t.key === theme);  
}  
</code></pre>
<p>Provides a type-safe check to ensure theme adherence to defined keys.  </p>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {  
  return THEMES_ARRAY;  
}  
</code></pre>
<p>Aggregates all theme definitions for iteration and display purposes.  </p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Constants</h3>
<p>This file governs the configurable elements of the adventure system, establishing safeguards and customization parameters for themes and tools. Its highlight demonstrates how hardcoded defaults and dynamic values integrate for predictable results.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> sets cache lifetimes for system stability.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> places file size limits for memory safety.  </li>
<li><code class="inline-code">ERROR_MESSAGES</code> standardizes error handling.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env  
</code></pre>
<p>Offers a tunable cache expiration mechanism for controlled processing.  </p>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code  
</code></pre>
<p>Implements reliable guardrails against excessive file sizes during analysis.  </p>
<pre><code class="language-typescript">export const ERROR_MESSAGES = {  
  LLM_UNAVAILABLE: &#39;LLM service is currently unavailable. Please check your configuration.&#39;,  
  ANALYSIS_FAILED: &#39;Failed to analyze the project. Please ensure the path is valid.&#39;,  
  THEME_INVALID: &#39;Invalid theme specified. Using default theme.&#39;  
} as const;  
</code></pre>
<p>Encapsulates common error conditions for consistency and reusable responses.  </p>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">THEMES</code> as the central reference to expand or modify theme definitions.  </li>
<li>Focus on <code class="inline-code">validateTheme</code>&#39;s flow to understand user input validation.  </li>
<li>Tune <code class="inline-code">REPOMIX_CACHE_TTL</code> and related configs when scaling adventure generations.</li>
</ul>
<hr>
<p>The secrets of The Theme Enclave are now yours. Incorporate them wisely, adventurer!</p>
<p>Congratulations on committing the code and merging &#39;The Theme Enclave&#39; into your master branch‚Äî60% of the journey complete, you&#39;re refactoring brilliance into your quest log with üöÄ precision and üíé determination!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>