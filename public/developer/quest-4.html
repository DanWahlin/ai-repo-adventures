<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Configuration Scrolls & Theme Archive - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Repository Chronicles: A Tale of Code and Quests</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Configuration Scrolls &amp; Theme Archive</h1>
<hr>
<p>In the Repository Kingdom, where every line of code carries both purpose and power, the Configuration Scrolls and Theme Archive hold significant sway. These artifacts manage the sacred rules of the Adventure Generator, from environment setup to the magical themes that guide your choices. Today, you embark on an intricate quest: to decrypt the logic behind input validation, configuration constants, and theme definitions. By diving into these foundational files, you shall uncover how system rules are enforced and themes animated within the kingdom&#39;s realm.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Validation Rituals</strong>: How does the system ensure the integrity of user inputs such as adventure choices, themes, and paths?</li>
<li>‚ö° <strong>Configuration Schematics</strong>: What configuration values govern the behavior and limits of the Adventure Generator? How are they structured and secured?</li>
<li>üõ°Ô∏è <strong>Theme Invocation</strong>: How does the system parse, retrieve, and validate themes, and what techniques are used to match user input to available options?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: The Gatekeeper of Valid Inputs</h3>
<p>In this file, input validation is treated as a lightweight, rule-driven process to maintain data integrity. Here, the system tempers errors that could disrupt narrative generation, employing small, focused functions to standardize input handling. It trims excess whitespace, limits length, and leverages other utility functions for deeper checks.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures adventure choices are non-empty and within acceptable length constraints.</li>
<li><code class="inline-code">validateTheme</code>: Validates theme input against available themes and predefined rules, throwing errors for invalid entries.</li>
<li><code class="inline-code">validateProjectPath</code>: Handles path input, applying sanitization and fallbacks to protect against dangerous or malformed inputs.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: The Mystical Theme Archive</h3>
<p>This file defines, manages, and validates adventure themes, centralizing theme data as immutable constants. It uses utility functions to map user inputs (like theme names or IDs) to valid options, ensuring that every theme choice unlocks its intended magic.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getAllThemes</code>: Provides data on all available themes to ensure easy access without redundant data replication.</li>
<li><code class="inline-code">parseTheme</code>: Parses raw user input to match it to valid theme keys, IDs, or keywords, ensuring flexibly matched input.</li>
<li><code class="inline-code">isValidTheme</code>: Validates if a given theme string is a valid key within the theme repository.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: The Configuration Scrolls</h3>
<p>This file houses configurable constants for core system behavior. It ensures flexibility for runtime changes while adhering to safety limits. Environment variables and default values govern everything from API interaction timeouts to file system handling, keeping the system optimized for varied workloads.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines the maximum time for API interactions, balancing responsiveness and complexity.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Sets an upper limit for file size in analysis to mitigate memory issues.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: Specifies directory and file patterns excluded from scans, preventing unnecessary clutter in analysis.</li>
</ul>
<hr>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>This code trims input and checks for non-empty strings within a length constraint. It prevents overly long or blank adventure choices, ensuring clean data before processing.</li>
<li>Defensive coding is evident in its use of a simple error-throwing mechanism for validation failures.</li>
<li>The lightweight approach fits the principle of &quot;small, reusable functions&quot; to maintain system modularity.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>This function ties together theme parsing (<code class="inline-code">parseTheme</code>) and validation (<code class="inline-code">isValidTheme</code>) to ensure the theme exists before proceeding.</li>
<li>By normalizing input, it handles various input styles (e.g., <code class="inline-code">MyThical</code>, <code class="inline-code">2</code>).</li>
<li>Integrated error messaging enhances user experience by providing valid options when the input fails.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Provides a flexible default (current directory) when no input is provided.</li>
<li>Filters potentially harmful inputs, thwarting null bytes to mitigate injection risks.</li>
<li>Demonstrates robust validation suited for file system operations.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li>Efficiently retrieves all themes from a single source, ensuring consistent data without redundancy.</li>
<li>Converts a static theme object to a flexible array format enabling higher-order operations like sorting.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Supports flexible matching of themes via key, ID, or keywords, accommodating diverse user input methods.</li>
<li>Avoids complex decision trees by prioritizing clarity and linear search.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<ul>
<li>Employs an array search pattern to validate themes, emphasizing simplicity.</li>
<li>Type guarding ensures type safety when working with parsed theme inputs.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
</code></pre>
<ul>
<li>Configures system behavior for long-running operations, ensuring adequate time for processing without indefinite hangs.</li>
<li>Balances user expectations against resource management.</li>
</ul>
<hr>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<ul>
<li>Protects against resource exhaustion by preemptively limiting file sizes.</li>
<li>Encourages a focus on manageable units of analysis, promoting efficiency.</li>
</ul>
<hr>
<pre><code class="language-typescript">export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;.nuxt&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;coverage&#39;,
];
</code></pre>
<ul>
<li>Prevents inclusion of irrelevant or overly complex artifacts in scans, optimizing system focus.</li>
<li>Simplifies future maintenance as patterns can be expanded or revised centrally.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>To gain deeper insight, expand on the interactions between <code class="inline-code">parseTheme</code> and <code class="inline-code">validateTheme</code> to understand user input mapping fully.</li>
<li>Compare configuration constants with real-world deployments to identify tuning opportunities specific to your system needs.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Congratulations, developer! You&#39;ve successfully debugged the Configuration Scrolls &amp; Theme Archive quest, achieving 60% progress‚Äîyour codebase is evolving into a robust artifact of star-quality engineering üöÄ‚ö° keep pushing toward full deployment!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>