<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: Unlock the Configuration Codes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Repository Chronicles: Building Adventures Through Code</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Unlock the Configuration Codes</h1>
<hr>
<p>As the light from ancient coding patterns illuminates the repository, you stand before a locked vault containing the configuration codes‚Äîthe mechanisms powering the adventure system itself. Every line unveils security protocols, dynamic settings, and technical foundations that shape the journey. Dive into the intricacies of validation methods, theme definitions, and configurable limits. Decode the artifacts hidden within layers of structured logic, and secure the keys to unlock the adventure framework&#39;s full potential.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Validator Shield Activation</strong>: How are input fields sanitized and validated for safety and usability?  </li>
<li>‚ö° <strong>Theme Alignment Protocol</strong>: How are themes defined and dynamically accessed within the system?  </li>
<li>üõ°Ô∏è <strong>Configuration Safeguards</strong>: What mechanisms ensure stability and error handling in system-wide configuration settings?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Validation System</h3>
<p>This file contains utility functions that ensure valid user input, sanitize fields for display, and provide error-free interaction with the adventure system. Its simple yet robust approach to validation plays a critical role in safeguarding the system. The highlights show how input data is processed at critical junctions to guarantee usability, security, and proper integration within larger workflows.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures that user-selected choices are provided, trimmed, and within acceptable length limits.</li>
<li><code class="inline-code">validateTheme</code>: Validates user-input themes against allowed options while normalizing data and showing possible valid choices.</li>
<li><code class="inline-code">validateProjectPath</code>: Checks for project path errors including invalid length and forbidden characters, ensuring fallback to the current working directory.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Removes unsafe characters and trims lengthy strings for safe output in user-facing contexts.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Management and Access</h3>
<p>This file is the central hub of theme definitions, organizing system-wide theme-related data into reusable components. By validating and parsing input themes and generating formatted theme content, it serves as the backbone for thematic personalization in adventures. The highlights dive into how themes are structured, accessed, and displayed.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A constant defining the available themes, including their metadata such as ID, description, and keywords.</li>
<li><code class="inline-code">getThemeByKey</code>: Retrieves a specific theme object based on its key, enabling efficient system-wide theme accessibility.</li>
<li><code class="inline-code">parseTheme</code>: Processes user input to determine matching themes, supporting dynamic and error-tolerant theme selection.</li>
<li><code class="inline-code">getFormattedThemeOptions</code>: Generates a user-friendly list of themes for display in interactive choices.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration Parameters</h3>
<p>This file encapsulates constants and environment-driven settings that determine system-wide limits, API configurations, and error handling mechanisms. By centralizing all configurable aspects of the system, it ensures consistent behavior and adaptability across different environments. The highlights emphasize key parameters and their roles in preventing failures while optimizing performance.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Specifies the timeout for requests to language model APIs, balancing speed and robustness.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Controls cache duration for Repomix operations, ensuring efficiency without exhausting resources.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Enforces an upper limit on file size during analysis processes, preventing memory issues.</li>
<li><code class="inline-code">ERROR_MESSAGES</code>: A structured collection of standardized error messages that enhances troubleshooting and debugging consistency.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  return input.trim();
}
</code></pre>
<ul>
<li>Ensures user input is non-empty and within a manageable length.</li>
<li>Adopts a fail-fast approach with explanatory error messages.</li>
<li>Prevents invalid input from propagating into deeper system layers.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  return parsedTheme;
}
</code></pre>
<ul>
<li>Transforms raw input into normalized and validated theme keys.</li>
<li>Provides context-aware error messaging, showing valid options.</li>
<li>A dynamic mechanism for seamless user-theme interaction.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  return input.replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;).replace(/\s+/g, &#39; &#39;).trim().slice(0, maxLength);
}
</code></pre>
<ul>
<li>Removes special characters to prevent injection vulnerabilities.</li>
<li>Trims large strings‚Äîoptimized for display without truncation artifacts.</li>
<li>Ensures reliable formatting for consistent user-facing outputs.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = { 
  SPACE: { id: 1, key: &#39;space&#39;, displayName: &#39;Space Exploration&#39;, emoji: &#39;üöÄ&#39;, ... }, 
  MYTHICAL: { id: 2, key: &#39;mythical&#39;, displayName: &#39;Enchanted Kingdom&#39;, emoji: &#39;üè∞&#39;, ... }, 
  ANCIENT: { id: 3, key: &#39;ancient&#39;, displayName: &#39;Ancient Civilization&#39;, emoji: &#39;üè∫&#39;, ... }, 
  DEVELOPER: { id: 4, key: &#39;developer&#39;, displayName: &#39;Developer Documentation&#39;, emoji: &#39;üìñ&#39;, ... }, 
  CUSTOM: { id: 5, key: &#39;custom&#39;, displayName: &#39;Custom Theme&#39;, emoji: &#39;üé®&#39;, ... } 
}
</code></pre>
<ul>
<li>Represents themes with rich metadata for diverse adventures.</li>
<li>Facilitates organization by using a structured constant map.</li>
<li>Ensures extendibility for future custom-themed implementations.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  return THEMES_ARRAY.find(theme =&gt; theme.keywords.some(
    keyword =&gt; normalized.includes(keyword.toLowerCase())))?.key || null;
}
</code></pre>
<ul>
<li>Supports numeric ID and keyword-based parsing for flexible input.</li>
<li>Demonstrates defensive programming techniques with null handling.</li>
<li>Highlights the dynamic access model for interpreting theme choices.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getFormattedThemeOptions(): string {
  return getAllThemes()
    .sort((a, b) =&gt; a.id - b.id)
    .map(formatThemeOption)
    .join(&#39;\n&#39;);
}
</code></pre>
<ul>
<li>Generates human-readable lists of themes for user interfaces.</li>
<li>Sorts seamlessly by ID to maintain logical order.</li>
<li>Ensures consistent and engaging display for navigation scenarios.</li>
</ul>
<hr>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000;
</code></pre>
<ul>
<li>Balances speed with reliability for external API calls.</li>
</ul>
<hr>
<pre><code class="language-typescript">export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;);
</code></pre>
<ul>
<li>Uses environment-driven configurability to support flexible scenarios.</li>
</ul>
<hr>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10;
</code></pre>
<ul>
<li>Restricts file size to avoid computational inefficiencies.</li>
</ul>
<hr>
<pre><code class="language-typescript">export const ERROR_MESSAGES = {
  LLM_UNAVAILABLE: &#39;LLM service is currently unavailable ...&#39;,
  ... OTHER CONSTANT MESSAGES ...
};
</code></pre>
<ul>
<li>Provides consistent error responses through structured mappings.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Adjust theme definitions or error messages to suit custom project needs.  </li>
<li>Explore validation methods for extending input handling.  </li>
<li>Investigate dynamic constants for optimizing performance limits.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Congratulations, developer, you&#39;ve successfully debugged and deployed the configuration codes‚Äîyou&#39;re 60% through the system upgrade journey, a true architect of innovation! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>