<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The MCP Signal Nexus - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">Mission Analysis: Cosmic Chronicles of Code</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The MCP Signal Nexus</h1>
<hr>
<p>The <em>Starship Codexus</em> shuddered slightly as the navigation systems locked onto the mysterious MCP Signal Nexus, a fragmented beacon hidden in the binary clouds of the nearby Orionis Drifts. This signal wasn‚Äôt just data‚Äîit was a challenge. Cryptic directives whispered through the cosmic circuits, daring the Codexus crew to decode their meanings. &quot;All systems green. MCP Interface initialized,&quot; announced Chief Engineer Lila Voss. With every subsystem calibrated to perfection, it was time to activate the onboard tools to unravel this galactic enigma. The crew braced for the unknown‚Äîit was more than just code; it was the nexus of adventure itself.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/mcp/src/server.ts:</span> MCP server protocol implementation that hosts the adventure tools</h3>
<p>The <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/server.ts</code></a> file is the backbone of the MCP Signal Nexus, acting as the Starship Codexus&#39; neural hub. Here lies the core functionality that allows the <em>MCP Interface</em> to host its interactive storytelling tools. The <code class="inline-code">RepoAdventureServer</code> class is the architectural centerpiece, orchestrating communication and handling dynamic input from the crew. Within this file, the <code class="inline-code">setupHandlers()</code> method configures critical MCP protocol handlers, such as <code class="inline-code">ListToolsRequestSchema</code> and <code class="inline-code">CallToolRequestSchema</code>, dynamically registering tools and validating input via Zod schemas. Essentially, this is where the interface tells the crew, ‚ÄúThese are the tools at your disposal.‚Äù</p>
<p>The <code class="inline-code">run()</code> method is another star performer, setting up the primary communication transport with <code class="inline-code">StdioServerTransport</code> and pregenerating the <em>Repomix</em> content in the background. This ensures that the <em>Codexus</em> can efficiently analyze its target‚Äîthe repository in question. Meanwhile, the <code class="inline-code">main()</code> function wraps all operations, managing everything from signal-based shutdowns (<code class="inline-code">SIGINT</code>, <code class="inline-code">SIGTERM</code>) to graceful error recovery.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupHandlers()</code> dynamically binds MCP tools to protocol commands.</li>
<li>Uses robust Zod schemas for input validation, ensuring no rogue ‚Äúdata asteroids‚Äù compromise the ship.</li>
<li><code class="inline-code">run()</code> initializes key systems for <em>Repomix</em> analysis and crew interaction.</li>
</ul>
<h3><span class="header-prefix">packages/mcp/src/tools.ts:</span> Central registry of MCP tools for adventure navigation</h3>
<p>The <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/tools.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/tools.ts</code></a> file is the repository‚Äôs adventure compass, organizing and exporting the set of MCP tools available for exploration. It serves as the central registry, ensuring each narrative-driven method like <code class="inline-code">start_adventure()</code> and <code class="inline-code">explore_quest()</code> is easily accessible. By importing specialized implementations of these tools from other modules, this file ensures scalability and maintainability across the system.</p>
<p>Key functions include <code class="inline-code">start_adventure()</code>, which kickstarts the interaction with the repository by presenting options for the journey ahead, and <code class="inline-code">explore_quest()</code>, which facilitates the hands-on file exploration needed to decode critical galactic signals. The tools are seamlessly exported as a cohesive object to simplify dynamic registrations in the server.</p>
<h4>Highlights</h4>
<ul>
<li>Exports tools like <code class="inline-code">start_adventure()</code> and <code class="inline-code">view_progress()</code> for seamless MCP protocol interaction.</li>
<li>Acts as a modular interface, importing specific handler implementations.</li>
<li>Provides centralized management of the MCP toolkit.</li>
</ul>
<h2>Code</h2>
<h3>packages/mcp/src/server.ts</h3>
<pre><code class="language-typescript">private setupHandlers() {
  // Dynamic tool listing
  this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; {
    const toolList = Object.entries(tools).map(([name, tool]) =&gt; ({
      name,
      description: tool.description,
      inputSchema: zodToJsonSchema(tool.schema, { 
        target: &#39;jsonSchema7&#39;,
        $refStrategy: &#39;none&#39;
      })
    }));

    return { tools: toolList };
  });

  // Dynamic tool execution
  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    try {
      const { name, arguments: args } = request.params;

      if (!(name in tools)) {
        throw new McpError(ErrorCode.MethodNotFound, `Unknown tool: ${name}`);
      }

      const tool = tools[name as keyof typeof tools];
      
      // Validate arguments using the tool&#39;s Zod schema
      const validationResult = tool.schema.safeParse(args);
      if (!validationResult.success) {
        const errorMessages = validationResult.error.issues.map((err) =&gt; 
          `${err.path.join(&#39;.&#39;)}: ${err.message}`
        ).join(&#39;, &#39;);
        throw new McpError(ErrorCode.InvalidParams, `Invalid parameters: ${errorMessages}`);
      }

      // Execute the tool handler with validated arguments
      return await tool.handler(validationResult.data as any);

    } catch (error) {
      if (error instanceof McpError) {
        throw error;
      }
      throw new McpError(
        ErrorCode.InternalError,
        `Tool execution failed: ${error instanceof Error ? error.message : String(error)}`
      );
    }
  });
}
</code></pre>
<p>This method acts like a universal translator, ensuring every tool command received by the ship is valid and intelligible.</p>
<h3>packages/mcp/src/tools.ts</h3>
<pre><code class="language-typescript">export const tools = {
  start_adventure,
  choose_theme,
  explore_quest,
  view_progress
};
</code></pre>
<p>This exports the ship‚Äôs navigation tools neatly, much like an interstellar explorer packing their toolkit for a journey.</p>
<h2>Helpful Hints</h2>
<ul>
<li>When expanding the MCP toolset, focus on how Zod schemas can enhance validation and security.</li>
<li>For tighter integrations between tools and adventures, consider reviewing handler patterns in the <code class="inline-code">tools.ts</code> file.</li>
<li>Explore how <code class="inline-code">ListToolsRequestSchema</code> could dynamically update to reflect new Galactic themes in real time.</li>
</ul>
<hr>
<p>Mission accomplished, Star Voyager‚Äî&#39;Quest 1: The MCP Signal Nexus&#39; is locked in the cosmic log, fueling your engines for the next journey through the learning universe! ‚ö°üöÄ‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2: Navigation Across Stellar Stori... ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>