<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Archive of Utilities - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Chronicles of the Codebase</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Archive of Utilities</h1>
<hr>
<p>In the labyrinthine depths of the legendary coding repository, you encounter the Archive of Utilities. This section contains foundational magic ‚Äî critical components enabling the mythical Adventure Forge to conjure developer journeys. Your task is to decipher these vital scripts, ensuring that adventurers traverse well-defined paths, harness optimized configurations, and progress with minimal friction. With precision and clarity, you must unravel the secrets of utility functions, mastering their nuances to guide adventurers toward endless discovery.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Utility Functions for Adventure Configurations</h3>
<p>The <code class="inline-code">adventure-config.ts</code> file serves as a hub of critical tools supporting the Adventure Forge&#39;s versatility. It offers utilities to load, parse, and process configuration files integral to generating quests. These utilities emphasize robustness, enabling safe file I/O, JSON parsing, and validation. From extracting unique file paths to formatting config data for lightweight AI prompts, it ensures the core processes remain efficient and fault-tolerant. Understanding these functions will equip you to manage configuration intricacies confidently.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code> performs a safe load of the raw configuration file located in the project directory.</li>
<li><code class="inline-code">extractUniqueFilePaths</code> traverses the parsed config tree dynamically, gathering valid and existing path references.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code> optimizes data structures to minimize redundancy, crafting a compact format suitable for language model interactions.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<p>This function is like a scout, retrieving data without assumption or alteration, ensuring no critical file barriers go unnoticed.</p>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }
  return Array.from(unique);
}
</code></pre>
<p>Here, a moving compass finds valid paths by dynamically traversing and verifying the configuration data tree.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    const filePaths = quest.files
      .filter((f: any) =&gt; f.path)
      .map((f: any) =&gt; f.path);
    if (filePaths.length &gt; 0) {
      formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    }

    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .filter((h: any) =&gt; h.name)
      .map((h: any) =&gt; h.name);
    if (functions.length &gt; 0) {
      formatted += `Functions: ${functions.join(&#39;, &#39;)}\n`;
    }
    
    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<p>This transformation acts like an editor condensing a complex novel into an engaging synopsis with key takeaways.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Always validate the existence of critical files in your project, as seen with <code class="inline-code">readFileIfExists</code> in <code class="inline-code">loadAdventureConfig</code>.</li>
<li>Use sets like <code class="inline-code">extractUniqueFilePaths</code> to ensure no duplicate data entries lead to inefficiencies.</li>
<li>Format data contextually appropriate for downstream systems, ensuring functional clarity with tools like <code class="inline-code">formatAdventureConfigForPrompt</code>.</li>
</ul>
<hr>
<p>Task complete, adventurer! You‚Äôve unlocked the tools of the Archive of Utilities, empowering the Adventure Forge&#39;s inner mechanisms. Safeguard this wisdom as you prepare for the coding quests ahead.</p>
<p>Quest 5: The Archive of Utilities successfully executed‚Äîyour dependency graph is now optimized, modular functions deployed with precision, and the repository of knowledge is 80% closer to full stack mastery‚Äîkeep compiling greatness! üöÄ ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>