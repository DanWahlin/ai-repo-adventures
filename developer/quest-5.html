<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Crafting Themes and Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Repository Chronicles: Exploring the Architecture of AI-Driven Adventures</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Crafting Themes and Configurations</h1>
<hr>
<p>The final challenge invites you to delve into the systems that define and refine the adventure experience itself: themes and configurations. As the spine of the repository, these elements provide the structure and flexibility for dynamic narrative generation. Your exploration of the configuration and theme system will expose the key methods that handle validation, theme generation, and system-wide settings. The tools you uncover will empower you to experiment with tailoring your journey.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Expansion</strong>: How does the <code class="inline-code">THEMES</code> object encapsulate modular definitions for multiple adventure styles?</li>
<li>‚ö° <strong>Configuration Flow</strong>: What process is followed to parse and utilize adventure configurations effectively?</li>
<li>üõ°Ô∏è <strong>Validation Safeguards</strong>: How are inputs sanitized and validated to ensure safe and reliable user interactions?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Centralized Theme Definitions</h3>
<p>This file serves as the single source of truth for all theme-related data within the system. With a streamlined structure, it includes modular theme definitions and helper functions that simplify theme selection and validation. Key highlights outline how new themes can be integrated while maintaining cohesion across the adventure generator.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A static object defining themes with properties like <code class="inline-code">id</code>, <code class="inline-code">key</code>, <code class="inline-code">displayName</code>, and <code class="inline-code">keywords</code>.</li>
<li><code class="inline-code">getAllThemes</code>: Returns an exhaustive list of themes for easy iteration and display.</li>
<li><code class="inline-code">isValidTheme</code>: Ensures user-provided theme inputs match an existing theme key.</li>
<li><code class="inline-code">parseTheme</code>: Implements normalized parsing of user input to extract a matching theme, including fallback processing for IDs and keywords.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  DEVELOPER: {
    id: 4,
    key: &#39;developer&#39;,
    displayName: &#39;Developer Documentation&#39;,
    emoji: &#39;üíª&#39;,
    description: &#39;Technical documentation approach with clear explanations, best practices, and code analysis&#39;,
    keywords: [&#39;developer&#39;, &#39;code&#39;, &#39;technical&#39;, &#39;debug&#39;, &#39;guide&#39;, &#39;tutorial&#39;, &#39;binary&#39;]
  }
} as const;
</code></pre>
<ul>
<li><strong>Static Theme Definitions</strong>: Defines themes in a concise and modular format for effortless iteration and validation.</li>
<li><strong>Properties for Display</strong>: Themes include <code class="inline-code">emoji</code>, <code class="inline-code">description</code>, and <code class="inline-code">keywords</code>, enabling refined matching and clear presentation.</li>
<li><strong>Scalability Focus</strong>: Easy addition of new themes ensures future expandability without architectural overhead.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();

  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }

  return null;
}
</code></pre>
<ul>
<li><strong>Normalized Parsing</strong>: Handles different formats from user input (e.g., numeric IDs and keywords) for flexibility.</li>
<li><strong>Exact Match Prioritization</strong>: Validates precise matches before broader checks, enhancing accuracy.</li>
<li><strong>Fallback Matching</strong>: Uses keywords logic to adapt to user-based approximations.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Adventure Configuration Management</h3>
<p>This file is focused on loading, parsing, and extracting data from the adventure configuration. It enhances customization and validation, allowing developers to create tailored experiences while maintaining structural integrity.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code>: Reads the configuration file from a given path if it exists.</li>
<li><code class="inline-code">parseAdventureConfig</code>: Converts loaded raw configuration text into a structured format or handles errors gracefully.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Iterates through the parsed configuration to extract all referenced file paths.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<ul>
<li><strong>File Read Operations</strong>: Reads configuration files securely without crashing if files are missing.</li>
<li><strong>Dynamic Paths</strong>: Adapts to multiple project environments using calculated paths.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li><strong>Error Handling</strong>: Converts input text into structured data while catching invalid JSON formats.</li>
<li><strong>Centralized Parsing</strong>: Prevents repeated parsing logic throughout the codebase.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li><strong>Path Validation</strong>: Ensures referenced file paths actually exist within the project.</li>
<li><strong>Graph Traversal</strong>: Utilizes depth-first search to navigate nested structures effectively.</li>
<li><strong>Data Deduplication</strong>: Uses a <code class="inline-code">Set</code> to eliminate duplicate file paths.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Handling and Validation</h3>
<p>This file ensures user inputs meet expectations, safeguarding against invalid commands or unsafe data. By validating and sanitizing data, it prevents unexpected behavior across theme selection and project configuration.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Verifies user-provided adventure choices for length and format.</li>
<li><code class="inline-code">validateTheme</code>: Normalizes theme selection and checks against valid themes.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleans input for safe output in user-facing interfaces.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li><strong>Length Enforcement</strong>: Safeguards against overly long inputs to ensure system performance remains robust.</li>
<li><strong>Trimmed Input</strong>: Cleans unnecessary whitespace for consistency across user-provided data.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li><strong>Theme Normalization</strong>: Converts user input to predictable formats before validation.</li>
<li><strong>Error Feedback</strong>: Provides a helpful list of valid themes when inputs fail.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><strong>Input Scrubbing</strong>: Removes unsafe characters to protect user interfaces.</li>
<li><strong>Truncation Logic</strong>: Limits string length for performance and readability.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Experiment with adding new theme definitions in the <code class="inline-code">THEMES</code> object and observe how seamlessly they integrate across <code class="inline-code">parseTheme</code>, <code class="inline-code">isValidTheme</code>, and other helpers.</li>
<li>Review how <code class="inline-code">extractUniqueFilePaths</code> enables dynamic configuration based on file graph traversal.</li>
<li>Use <code class="inline-code">validateTheme</code> as a template to create custom validation functions for other user inputs.</li>
</ul>
<hr>
<p>You have mastered all the secrets of this project! Your adventure is complete.</p>
<p>Congratulations, developer! You&#39;ve successfully debugged your way through Quest 5, mastering the art of crafting modular themes and dynamic configurations‚Äîyou&#39;re now 80% deployed towards the final milestone! üöÄüíé‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>