<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Configuration & Theme System - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Architect's Blueprint: A Modular Adventure into Repository Design</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Configuration &amp; Theme System</h1>
<hr>
<p>Explore the backbone of the adventure system! This quest unravels the modular configuration system, the theme definitions powering creative journeys, and input validators ensuring robust and accurate user interactions. You‚Äôll dive into structured theme frameworks, explore how configurations are stored and processed, and analyze methods that ensure data integrity throughout the toolkit.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Alignment</strong>: How are themes constructed and validated, and what makes them a &quot;single source of truth&quot; system?</li>
<li>‚ö° <strong>System Configuration</strong>: How does the system enforce limits and manage environment variables effectively?</li>
<li>üõ°Ô∏è <strong>Input Integrity</strong>: What patterns ensure user inputs are sanitized and validated securely?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Simplified system configuration</h3>
<p>This file focuses on providing centralized constants and settings to regulate the behavior of the repo adventure toolkit. It&#39;s a simple yet essential facade for environment variables, file processing limits, cache settings, and default values used across the system. Additionally, structured error messages and patterns for ignored directories ensure clarity and usability across modules.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Defines the timeout duration for connecting to LLM services with environmental configurability.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code>: Specifies file and directory patterns ignored during project scanning, simplifying analysis workflows.</li>
<li><code class="inline-code">DEFAULT_THEME</code>: Establishes the fallback theme for adventures, ensuring consistent initialization under invalid conditions.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds for complex story generation with large prompts, configurable via env

export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;.nuxt&#39;,
  &#39;dist&#39;,
  &#39;build&#39;,
  &#39;coverage&#39;,
  &#39;.nyc_output&#39;,
  &#39;logs&#39;,
  &#39;*.log&#39;,
  &#39;.env&#39;,
  &#39;.DS_Store&#39;,
  &#39;Thumbs.db&#39;,
] as const;

export const DEFAULT_THEME = &#39;space&#39; as const;
</code></pre>
<ul>
<li><strong>LLM_REQUEST_TIMEOUT</strong>: Configurable via environment variables, this timeout ensures reliable performance for complex story generation processes.</li>
<li><strong>IGNORE_PATTERNS</strong>: These patterns enforce a streamlined file analysis process by excluding unnecessary or irrelevant directories.</li>
<li><strong>DEFAULT_THEME</strong>: The use of constants like <code class="inline-code">DEFAULT_THEME</code> guarantees fallback behaviors and prevents theme-related errors.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Centralized theme management</h3>
<p>This file acts as the cornerstone for theme-related operations, housing all theme definitions in a structured format. It offers helper functions for querying and validating themes based on user input. The use of TypeScript interfaces ensures the themes are strongly typed, reducing potential errors during runtime.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">ThemeDefinition</code>: Defines the structure for each theme, ensuring strict typing and clarity in theme attributes.</li>
<li><code class="inline-code">getAllThemes</code>: Provides a complete list of available themes, enabling seamless iteration across theme definitions.</li>
<li><code class="inline-code">parseTheme</code>: Parses user inputs to correctly determine the intended theme, handling both direct matches and keyword-based fuzzy matches.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export interface ThemeDefinition {
  readonly id: number;
  readonly key: string;
  readonly displayName: string;
  readonly emoji: string;
  readonly description: string;
  readonly keywords: readonly string[];
}

export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords using simple includes check
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li><strong>ThemeDefinition</strong>: This interface clearly defines the shape of a theme, making it easy to add, modify, and query theme data.</li>
<li><strong>getAllThemes</strong>: This function provides direct access to all themes, allowing dynamic iteration and selection for user-facing operations.</li>
<li><strong>parseTheme</strong>: Using normalization and keywords, <code class="inline-code">parseTheme</code> ensures that user inputs are accurately interpreted, supporting robust interaction.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> Theme CSS and presentations</h3>
<p>This file encapsulates functionalities related to theme-specific visual presentations. It supports operations like CSS generation, theme-based icon selection, and dynamic GitHub logo placement. The modular design of this class makes it versatile and adaptable.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateThemeCSS</code>: Combines base CSS files with theme-specific styles to produce customized outputs.</li>
<li><code class="inline-code">getThemeIcons</code>: Selects theme-specific icons for templates and presentations, ensuring visual consistency.</li>
<li><code class="inline-code">isLightTheme</code>: Determines whether a theme‚Äôs background settings necessitate special visual adjustments, such as using a dark logo variant.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;), 
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
  
  let combinedCSS = &#39;&#39;;
  
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
  
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}

getThemeIcons(theme: AdventureTheme): { theme: string; quest: string } {
  const themeIcons = {
    space: { theme: &#39;üöÄ&#39;, quest: &#39;‚≠ê&#39; },
    mythical: { theme: &#39;üè∞&#39;, quest: &#39;‚öîÔ∏è&#39; },
    ancient: { theme: &#39;üè∫&#39;, quest: &#39;üìú&#39; },
    developer: { theme: &#39;üíª&#39;, quest: &#39;üîß&#39; },
    custom: { theme: &#39;üé®&#39;, quest: &#39;‚≠ê&#39; }
  };

  return (themeIcons as any)[theme] || themeIcons.space;
}

isLightTheme(theme: AdventureTheme): boolean {
  const lightThemes: AdventureTheme[] = [&#39;mythical&#39;];
  return lightThemes.includes(theme);
}
</code></pre>
<ul>
<li><strong>generateThemeCSS</strong>: This method dynamically generates theme-specific CSS files by merging multiple CSS sources, promoting modular styling practices.</li>
<li><strong>getThemeIcons</strong>: Ensures that each theme is accompanied by its unique iconography, aligning with consistent branding.</li>
<li><strong>isLightTheme</strong>: Simplifies background color and logo decisions, preserving usability and aesthetic harmony across themes.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>To customize or extend themes, update the <code class="inline-code">ThemeDefinition</code> structure and <code class="inline-code">THEMES</code> object in <code class="inline-code">theme.ts</code>.</li>
<li>Investigate edge cases handled by <code class="inline-code">validateTheme()</code> and <code class="inline-code">parseTheme()</code> to strengthen user input validation.</li>
<li>Review CSS files in the <code class="inline-code">themesDir</code> directory to understand how theme visuals are implemented.</li>
</ul>
<hr>
<p>You have mastered all the secrets of this technical toolkit! Your adventure is complete.</p>
<p>Congratulations, developer! You&#39;ve successfully debugged the intricacies of Quest 5‚Äôs Configuration &amp; Theme System‚Äîshipping 80% progress to production with precision and scalability; keep pushing for the final deployment! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>