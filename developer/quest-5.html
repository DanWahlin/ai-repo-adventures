<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Unearth the Foundation - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Repository of Endless Adventures</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Unearth the Foundation</h1>
<hr>
<p>The ancient repository whispers secrets of the foundational configurations underpinning every quest. Fragments of code within these files hold the key to understanding critical paths, file extractions, and prompt formatting. To delve into the core structure of adventure generation, one must investigate the unseen logic of parsing and optimization buried within the walls of <code class="inline-code">adventure-config</code>. The way forward is clear: unearth the foundation and claim mastery over the tools that generate the adventure itself.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Core configuration logic unifying adventures</h3>
<p>This file holds the cornerstone functions used to parse adventure configurations, extract file paths, and structure the data into optimized formats for LLM prompts. At the heart of its implementation lies the delicate balance between raw file handling and nuanced data structuring for higher-level interactions. Functions like <code class="inline-code">parseAdventureConfig</code> transform JSON into accessible objects while gracefully managing errors. Meanwhile, <code class="inline-code">extractUniqueFilePaths</code> uses recursive exploration to locate and validate file paths. Finally, <code class="inline-code">formatAdventureConfigForPrompt</code> condenses the data into concise representations, providing an efficient interface for AI-driven tools. Together, these functions embody essential patterns for handling data complexity in quest generation.</p>
<h4>Highlights</h4>
<ul>
<li>Loads and parses configuration files (<code class="inline-code">loadAdventureConfig</code>, <code class="inline-code">parseAdventureConfig</code>)</li>
<li>Extracts file paths referenced in the configuration (<code class="inline-code">extractUniqueFilePaths</code>)</li>
<li>Formats configuration for efficient interfacing with LLMs (<code class="inline-code">formatAdventureConfigForPrompt</code>)</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<p>This function is like a key that opens a hidden chest, reading raw configuration data if the chest exists.</p>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>Parsing here acts as an interpreter translating a cryptic scroll (JSON) into readable instructions for the quest engine.</p>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    const filePaths = quest.files
      .filter((f: any) =&gt; f.path)
      .map((f: any) =&gt; f.path);
    if (filePaths.length &gt; 0) {
      formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    }
    
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .filter((h: any) =&gt; h.name)
      .map((h: any) =&gt; h.name);
    if (functions.length &gt; 0) {
      formatted += `Functions: ${functions.join(&#39;, &#39;)}\n`;
    }
    
    formatted += `\n`;
  }

  return formatted;
}
</code></pre>
<p>This function distills a dense scroll of information into a concise road map, preparing it for use in magical systems like LLMs.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Use <code class="inline-code">loadAdventureConfig</code> and <code class="inline-code">parseAdventureConfig</code> together to verify and validate configuration inputs effectively.</li>
<li>Recursive validations in <code class="inline-code">extractUniqueFilePaths</code> enable safer file path referencing. Leverage this for detecting missing dependencies.</li>
<li>Optimize the output of <code class="inline-code">formatAdventureConfigForPrompt</code> when interacting with LLMs by focusing on quest structure and actionable highlights.</li>
</ul>
<hr>
<p>The foundation has been unearthed, granting you deeper control over adventure generation and a renewed understanding of its inner workings.</p>
<p>Achievement unlocked: Quest 5 completeâ€”Your codebase is now 80% optimized, with stellar refactoring and solid foundational commits; deploy the final sprint with confidence! ðŸš€âš¡ðŸ’Ž</p>

</div>


    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>