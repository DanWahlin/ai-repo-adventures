<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Scrolls of Configuration - Mapping the Adventure Paths - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'developer' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Chronicles of the Code Repository: The Architect's Adventure</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Scrolls of Configuration - Mapping the Adventure Paths</h1>
<hr>
<p>The path forward in your journey reveals an intricate matrix—these Scrolls of Configuration, ancient and brimming with secrets, hold the power to shape your quests. With every scroll deciphered, you uncover new methods to steer the Essence Core. As you map their paths, vivid imagery of digital kingdoms takes shape, where themes provide the very bones of this place. Yet, a warning resides on the wind: only through careful validation and clarity will the configurations bow to your will. Harness the Scrolls, adventurer, and guide your story where it belongs.</p>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a>: Configuration System for the Adventure Framework</h3>
<p>This file serves as the heart of the adventure system, defining essential constants and options that guide the entire framework. From crafting limits on file size to setting cache lifetimes, the <code class="inline-code">config.ts</code> file ensures that every quest unfolds with reliability and precision. Notably, it centralizes environment variables, such as <code class="inline-code">LLM_API_KEY</code>, loaded through <code class="inline-code">dotenv</code>, which empower the adventure’s mechanics. It also provides fail-safes, like default values for tokens or timeouts, ensuring robust behavior under various conditions.</p>
<p>The file emphasizes simplicity through the usage of direct constants rather than intricate objects, streamlining how configuration data propagates throughout the system. Constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> safeguard against prolonged requests to neural networks during story generation, while <code class="inline-code">MAX_FILE_SIZE_MB</code> ensures memory efficiency in code analysis tasks. The configurations for &quot;adventure settings&quot; (e.g., <code class="inline-code">DEFAULT_THEME</code>, <code class="inline-code">MAX_FILES_PER_QUEST</code>) illuminate how story generation intertwines with technical safeguards. What’s more, this file provides error-handling defaults, such as <code class="inline-code">PERMISSION_DENIED</code>, that surface user-centric messaging in failure scenarios—a clever mix of developer foresight and user empathy.</p>
<h4>Highlights</h4>
<ul>
<li>Defines environment-dependent variables (e.g., <code class="inline-code">LLM_API_KEY</code>, <code class="inline-code">LLM_BASE_URL</code>) and sensible defaults for key settings.</li>
<li>Centralizes control over project-wide constraints like <code class="inline-code">MAX_SCAN_DEPTH</code> and <code class="inline-code">MAX_FILE_LINES_FOR_LLM</code>.</li>
<li>Facilitates seamless error management with predefined user-friendly messages and safety checks.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: Thematic Foundations of Adventure Creation</h3>
<p>The <code class="inline-code">theme.ts</code> file embodies the creative spirit of the adventure system, serving as the single source of truth for all built-in themes. Each theme is defined through the <code class="inline-code">ThemeDefinition</code> interface, which neatly encapsulates the theme’s metadata: <code class="inline-code">id</code>, <code class="inline-code">key</code>, <code class="inline-code">displayName</code>, <code class="inline-code">emoji</code>, <code class="inline-code">description</code>, and an array of <code class="inline-code">keywords</code>. These traits not only add a vibrant personality to the themes but also ensure a user-friendly system for validating and parsing user inputs.</p>
<p>Key functions like <code class="inline-code">isValidTheme()</code> and <code class="inline-code">parseTheme()</code> provide robust validation mechanisms through structured array iterations. They ensure lightning-fast checks by leveraging normalized strings and exact matches, preventing mismatches or anomalies. Furthermore, the file introduces <code class="inline-code">formatThemeOption()</code> to construct human-readable theme summaries, combining their emojis, names, and descriptions in a polished presentation style. By using the <code class="inline-code">getAllThemes()</code> helper, the system delivers a unified view of all themes—an API that reduces manual overhead in adventurous story creation.</p>
<h4>Highlights</h4>
<ul>
<li>Defines built-in themes (e.g., <code class="inline-code">SPACE</code>, <code class="inline-code">MYTHICAL</code>, <code class="inline-code">DEVELOPER</code>) with rich descriptions and human-centric keywords.</li>
<li>Implements flexible theme input handling through <code class="inline-code">parseTheme()</code> and <code class="inline-code">isValidTheme()</code>.</li>
<li>Encourages intuitive theme exploration using <code class="inline-code">formatThemeOption()</code> and <code class="inline-code">getFormattedThemeOptions()</code>.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Ensuring Proper Validation in Player Choices</h3>
<p>Input validation lies at the foundation of any secure system, and <code class="inline-code">input-validator.ts</code> guarantees that adventurers tread only valid pathways. Core validation functions like <code class="inline-code">validateAdventureChoice()</code> and <code class="inline-code">validateTheme()</code> sanitize critical inputs, defending against garbage data and injection risks. The adventure input validator offers dual utility—it cleans user-provided strings via trimming and normalization while enforcing length constraints (e.g., 200 characters for adventure choices).</p>
<p>Functions like <code class="inline-code">validateTheme()</code> build atop <code class="inline-code">theme.ts</code>, offering higher-level checks while leaning on the parsing capabilities of <code class="inline-code">parseTheme()</code>. Meanwhile, <code class="inline-code">sanitizeForDisplay()</code> ensures safe output by stripping away unsafe characters and truncating overly verbose inputs, making it invaluable during feedback or UI rendering. Together, these functions form a robust gatekeeper, filtering out invalid or malicious entries before they can disrupt the storytelling system.</p>
<h4>Highlights</h4>
<ul>
<li>Prevents invalid path manipulations using <code class="inline-code">validateProjectPath()</code> and system-safe checks.</li>
<li>Sanitizes display text, removing risky symbols and lengthy verbosity with <code class="inline-code">sanitizeForDisplay()</code>.</li>
<li>Integrates theming logic via <code class="inline-code">validateTheme()</code>, coupling functionality directly with the <code class="inline-code">THEMES</code> structure.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<pre><code class="language-typescript">/**
 * Simplified configuration for the MCP Repo Adventure system
 */

import { config } from &#39;dotenv&#39;;

// Load environment variables
config({ quiet: true });

// Simple constants instead of complex nested objects
export const LLM_API_KEY = process.env.LLM_API_KEY || &#39;&#39;;
export const LLM_BASE_URL = process.env.LLM_BASE_URL || &#39;https://api.openai.com/v1&#39;;
export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts

export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
export const DEFAULT_THEME = &#39;space&#39; as const;
</code></pre>
<p>This acts like the compass of your system—it ensures every decision aligns properly by keeping fundamental constraints and keys easily accessible.</p>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">/**
 * Central theme definitions for the adventure system
 * Single source of truth for all theme-related data
 */

// Define the structure of a theme
export interface ThemeDefinition {
  readonly id: number;
  readonly key: string;
  readonly displayName: string;
  readonly emoji: string;
  readonly description: string;
  readonly keywords: readonly string[];  // For matching user input
}

export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;🚀&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust.&#39;,
    keywords: [&#39;space&#39;, &#39;galaxy&#39;, &#39;cosmic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;🏰&#39;,
    description: &#39;Explore magical and mythical realms where functions are powerful spells.&#39;,
    keywords: [&#39;magic&#39;, &#39;dragon&#39;, &#39;castle&#39;]
  }
} as const;
</code></pre>
<p>These themes are the building blocks for your adventures, infusing them with the flair and imagination needed for a captivating journey.</p>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">/**
 * Simplified input validation
 */

import { parseTheme, isValidTheme } from &#39;./theme.js&#39;;

export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  return input.trim();
}

export function validateTheme(input: string): string {
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  return parsedTheme;
}
</code></pre>
<p>These input checks resemble a vigilant guardian; they prevent adventurers from veering onto treacherous or undefined paths.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Configuration files should remain lightweight yet thorough, avoiding over-engineering to maintain clarity and readability.</li>
<li>Expand on the utility of existing helper functions—e.g., integrate <code class="inline-code">validateProjectPath()</code> into custom workflows.</li>
<li>Experiment with modularizing custom themes or extending the theme input processor for user-provided categories.</li>
</ul>
<hr>
<p>Congratulations, developer! You&#39;ve refactored the &quot;Scrolls of Configuration&quot; with precision, dynamically mapped out the adventure paths, and achieved 60% progress—keep iterating toward deployment! 🚀⚡💎</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5: Theme Nexus - Binding the Realm... →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>