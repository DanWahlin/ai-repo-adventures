<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Labyrinth of Themes and Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'developer' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Codex of Infinite Adventures</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Labyrinth of Themes and Configurations</h1>
<hr>
<p>Your journey deepens as you navigate the twisting corridors of the Labyrinth, a tangled maze of interconnected code constructs and bubbling configuration secrets. Armed with your trusty validation functions, intricate theme definitions, and the ever-watchful Codex at your side, you must unravel the complexities within. Every keystroke brings you closer to taming the mighty Repomix engine&#39;s mysteries, a feat that will forever carve your name in the digital archives of adventurer legends.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Simplified Input Validation</h3>
<p>This file is a cornerstone of security and user input handling in the adventure system. It ensures reliable input validation for theme selections, adventure choices, and project paths. The <code class="inline-code">validateAdventureChoice()</code> method sanitizes user inputs, ensuring they don&#39;t exceed character limits or contain problematic characters. Meanwhile, <code class="inline-code">validateTheme()</code> checks if theme inputs match predefined keys or associated keywords, conveying clear error messages when invalid themes are provided. This method integrates directly with the theme utility functions like <code class="inline-code">parseTheme()</code> and <code class="inline-code">isValidTheme()</code>. By enforcing stringent input validation rules, this file prevents injection attacks and ensures smooth theme selection processes for adventurers.</p>
<h4>Highlights</h4>
<ul>
<li>Clear error handling prevents invalid user inputs and improves security.</li>
<li>Uses <code class="inline-code">sanitizeForDisplay()</code> for safe output without risking HTML injection.</li>
<li>Validates inputs with practical length limits for user clarity and system performance.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Central Theme Definitions</h3>
<p><code class="inline-code">theme.ts</code> is the thematic beating heart of the adventure system, defining not just the available themes but their essence and purpose. Each theme, like SPACE and MYTHICAL, is defined as part of the <code class="inline-code">THEMES</code> object, detailing its id, key, display name, emoji, description, and associated keywords for matching. The file provides utility functions such as <code class="inline-code">getThemeById()</code> and <code class="inline-code">parseTheme()</code> to map user inputs to themes using numeric ids, keywords, or exact matches. These functions simplify the adventure system&#39;s ability to curate personalized narratives by allowing flexible theme input validation with seamless interactions.</p>
<h4>Highlights</h4>
<ul>
<li>Defines themes with details like keywords and visual emoji identifiers.</li>
<li>Provides helper functions to parse and match themes flexibly.</li>
<li>Includes efficient methods like <code class="inline-code">getFormattedThemeOptions()</code> for displaying theme lists.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Simplified Configuration for MCP Repo Adventure</h3>
<p>This file serves as the backbone of system-wide settings and configurations. Environment variables, such as <code class="inline-code">LLM_API_KEY</code>, are loaded using <code class="inline-code">dotenv</code> for secure API integration. Constants like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> and <code class="inline-code">REPOMIX_CACHE_TTL</code> manage timing and resource constraints during execution. These settings ensure the adventure system remains performant while handling resource-intensive LLM queries and Repomix operations. Additionally, it sets maximum file size limits and error messaging defaults, preventing the system from breaking under extreme user inputs or configurations.</p>
<h4>Highlights</h4>
<ul>
<li>Manages timeout and caching settings for balanced performance during execution.</li>
<li>Environment variables provide security and configurability for external APIs.</li>
<li>Offers clear error messaging limits for better user experience during failures.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<p>Like a vigilant gatekeeper, these functions ensure that only clean and valid user inputs enter the adventure system.</p>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  }
} as const;

export function getThemeByKey(key: string): ThemeDefinition | null {
  return THEMES_ARRAY.find(theme =&gt; theme.key === key) || null;
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<p>This code provides flexible ways for adventurers to express their thematic desires, even through fuzzy matches on keywords or numeric IDs.</p>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_API_KEY = process.env.LLM_API_KEY || &#39;&#39;;
export const FILE_READ_TIMEOUT = 10000;
export const MAX_FILE_SIZE_MB = 10;

export const ERROR_MESSAGES = {
  LLM_UNAVAILABLE: &#39;LLM service is currently unavailable. Please check your configuration.&#39;,
  ANALYSIS_FAILED: &#39;Failed to analyze the project. Please ensure the path is valid.&#39;,
  THEME_INVALID: &#39;Invalid theme specified. Using default theme.&#39;,
} as const;

export const IGNORE_PATTERNS = [
  &#39;node_modules&#39;,
  &#39;.git&#39;,
  &#39;.next&#39;,
  &#39;dist&#39;,
] as const;
</code></pre>
<p>These constants act like a compass, guiding the system&#39;s behavior and the explorer&#39;s journey through the labyrinth of generated content and settings.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Validating inputs is crucial ‚Äî always ensure validation methods check for edge cases like overly long strings or invalid characters.</li>
<li>Explore thematic flexibility by extending <code class="inline-code">THEMES_ARRAY</code> with additional themes relevant to your user base.</li>
<li>Consider enhancing configuration settings with better error logging and environment-variable-driven overrides for end-user adaptability.</li>
</ul>
<hr>
<p>Congratulations, developer-adventurer! You&#39;ve successfully debugged the labyrinth of themes and configurations, pushing your progress to 75% complete‚Äîkeep refactoring, iterating, and compiling greatness as you approach the final deployment! ‚ö°üöÄüó∫Ô∏è</p>

</div>


    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>