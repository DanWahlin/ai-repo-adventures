<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Threads of Creation - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Chronicles of Codecraft: Forge of Adventure</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Threads of Creation</h1>
<hr>
<p>In the labyrinth of interconnected lines of code, the Repository holds the unifying Threads of Creation. As a code wizard, you now embark on an intricate challenge: unraveling the interconnected systems that power the themes, validations, and configurations of the digital realm. By weaving these threads, you unlock the secrets that craft personalized project journeys for adventurers. Prepare to validate the logic, align the themes, and configure the core systems that make the Repository thrive.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Centralized Configuration Management</h3>
<p>The <code class="inline-code">config.ts</code> file is the anchor for the Repository&#39;s environment configuration, governing system-wide parameters for reliability and scalability. It simplifies project settings by defining constants for timeouts, LLM parameters, cache settings, and analysis limits. Through structured environmental variables and fallback defaults, it ensures adaptability across diverse workflows. Key highlights include <code class="inline-code">LLM_REQUEST_TIMEOUT</code> to manage API responsiveness, <code class="inline-code">REPOMIX_CACHE_TTL</code> for content freshness, and <code class="inline-code">MAX_FILE_SIZE_MB</code> to enforce boundaries on resource-intensive file analysis.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Sets limits for LLM API request duration.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Configures cache expiration for repository content.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Caps file size during analysis to optimize performance.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
</code></pre>
<p>Timeouts are like setting limits for adventure plot twists to ensure the pace keeps flowing smoothly.</p>
<pre><code class="language-typescript">export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
</code></pre>
<p>Cache durations resemble treasures hidden for a limited time—frequent refresh ensures up-to-date narratives.</p>
<pre><code class="language-typescript">export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues and focus on source code
</code></pre>
<p>Maximum file size constraints act like restricting an adventurer’s backpack to avoid unnecessary weight.</p>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme System for Dynamic Adventures</h3>
<p>The <code class="inline-code">theme.ts</code> file functions as the creative essence of the Repository, allowing adventurers to dive into distinct thematic journeys. Its <code class="inline-code">THEMES</code> constant acts as a repository of vibrant settings, while the <code class="inline-code">getAllThemes</code> method offers easy access to available options. The <code class="inline-code">validateThemeInput</code> function ensures users interact with only predefined themes derived from robust validation logic.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Centralized definitions for built-in adventure themes.</li>
<li><code class="inline-code">getAllThemes</code>: Retrieves a list of all valid themes for presenting options.</li>
<li><code class="inline-code">validateThemeInput</code>: Validates user input against predefined or custom themes.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;🚀&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  // Other themes omitted for brevity...
} as const;
</code></pre>
<p>Themes are like magical portals, transforming the same map into fantastical realms with varying motives.</p>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<p>Retrieving all themes resembles opening a compendium of different worlds for adventurers to choose from.</p>
<pre><code class="language-typescript">export function isValidTheme(theme: string): theme is AdventureTheme {
  return THEMES_ARRAY.some(t =&gt; t.key === theme);
}
</code></pre>
<p>Theme validation ensures would-be explorers are equipped with genuine maps and guides suited for their journeys.</p>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Input Validation for Secure Adventure Choices</h3>
<p>The <code class="inline-code">input-validator.ts</code> file secures user inputs by stripping potentially malicious data. It processes adventure choices, themes, and paths through targeted validation functions. <code class="inline-code">validateAdventureChoice</code> ensures quality selections, <code class="inline-code">validateProjectPath</code> prevents security vulnerabilities, and <code class="inline-code">sanitizeForDisplay</code> protects display surfaces against injection attacks. Together, these utilities enforce robust guardrails, making adventures secure and error-free.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Sanitizes adventure input to prevent invalid or malicious choices.</li>
<li><code class="inline-code">validateProjectPath</code>: Ensures user-provided paths are safe and appropriate.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips harmful characters for UI-safe representation of inputs.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<p>Sanitizing adventure choices is akin to verifying an explorer’s map before embarking on a quest.</p>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<p>Validating file paths is like ensuring a traveler’s route avoids treacherous terrain or uncertain bridges.</p>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<p>Sanitization works as a defensive charm, cleansing inputs before they are revealed to the world.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Define clear timeout configurations to avoid prolonged or stalled quests within the system.</li>
<li>Leverage the central <code class="inline-code">THEMES</code> repository to maintain uniformity in thematic offerings.</li>
<li>Always validate and sanitize inputs across all functions interfacing with user-provided data.</li>
</ul>
<hr>
<p>The threads of creation are now unraveled, adventurer! Piece them together to build immersive journeys while keeping the Repository structured and secure. Onward to your next challenge!</p>
<p>Achievement unlocked: 🚀 Quest 4: The Threads of Creation successfully committed—your codebase of knowledge now refactors into version 3/5, debugging the path to mastery with stellar precision and algorithmic triumph! ⭐</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5: The Foundation of Guidance →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>