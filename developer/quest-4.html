<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: MCP Interface Conduits - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Repository Chronicles: Exploring Modular Systems</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: MCP Interface Conduits</h1>
<hr>
<p>This module takes you deep into the mechanics of the MCP Tool Interface, where the engine of centralized control resides. Dive into the server and tools implementation that power the mission control panel. These files connect various components through handlers, manage quests dynamically, and facilitate interaction with the system. In this section, you&#39;ll unlock the architecture that supports extensibility, ensures robustness, and enables seamless user interactions. Prepare to delve into both the integration points and operational logic.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Handler Setup</strong>: How are handlers set up in the MCP server to manage dynamic requests?</li>
<li>‚ö° <strong>Tool Coordination</strong>: What workflows enable communication between tools and the server to handle user inputs?</li>
<li>üõ°Ô∏è <strong>Error Handling</strong>: How does the system ensure stability during request execution, especially when unexpected issues occur?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/server.ts</code></a>: Core MCP server setup and handler integration</h3>
<p>This file defines the backbone of the MCP server. It initializes and runs the server, coordinates handler registration, and manages incoming requests for adventures and quests. The <code class="inline-code">RepoAdventureServer</code> class encapsulates these functionalities, ensuring a modular and maintainable structure.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupHandlers</code>: Configures all the request handlers for the server, dynamically binding tools to specific routes.</li>
<li><code class="inline-code">run</code>: Launches the server and attaches handlers, enabling users to interact with adventure-specific endpoints.</li>
<li><code class="inline-code">main</code>: Serves as the entry point for starting the MCP server, orchestrating setup and operational readiness.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/tools.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/tools.ts</code></a>: Custom tools and their handlers</h3>
<p>This file complements the server by defining tool-specific logic and handlers. These handlers process user requests, such as selecting themes, exploring quests, or viewing progress, ensuring seamless execution of actions within the MCP interface.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">start_adventure.handler</code>: Initializes the adventure on user request and prepares context.</li>
<li><code class="inline-code">choose_theme.handler</code>: Manages user requests to switch themes dynamically within the same adventure.</li>
<li><code class="inline-code">explore_quest.handler</code>: Processes quest exploration events, loading relevant information and enabling user interactions.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/server.ts</code></a></h3>
<pre><code class="language-typescript">class RepoAdventureServer {
  setupHandlers() {
    app.post(&#39;/start&#39;, start_adventure.handler);
    app.post(&#39;/theme&#39;, choose_theme.handler);
    app.get(&#39;/quest/:id&#39;, explore_quest.handler);
    app.get(&#39;/progress&#39;, view_progress.handler);
  }

  run() {
    this.setupHandlers();
    const port = process.env.PORT || 3000;
    app.listen(port, () =&gt; {
      console.log(`üöÄ Adventure server running on port ${port}`);
    });
  }
}

// Entry point
function main() {
  const server = new RepoAdventureServer();
  server.run();
}
</code></pre>
<ul>
<li><code class="inline-code">setupHandlers</code> registers specific endpoints and links them to their associated tool handlers, maintaining separation of concerns between the server and business logic.</li>
<li><code class="inline-code">run</code> encapsulates server launch logic, abstracting setup from configuration and ensuring modularity.</li>
<li>The <code class="inline-code">main</code> function provides a clear entry point, enhancing the server&#39;s usability and integrating seamlessly with upstream configurations.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/mcp/src/tools.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/mcp/src/tools.ts</code></a></h3>
<pre><code class="language-typescript">export const start_adventure = {
  handler: (req, res) =&gt; {
    try {
      console.log(&quot;üöÄ Starting adventure session...&quot;);
      const adventure = initializeAdventure(req.body);
      res.json({ status: &quot;success&quot;, adventure });
    } catch (error) {
      console.error(&quot;‚ùå Failed to start adventure:&quot;, error.message);
      res.status(500).json({ status: &quot;error&quot;, message: &quot;Adventure initialization failed.&quot; });
    }
  },
};

export const choose_theme = {
  handler: (req, res) =&gt; {
    try {
      console.log(&quot;üé® Changing theme...&quot;);
      const response = setTheme(req.body.theme);
      res.json({ status: &quot;success&quot;, theme: response });
    } catch (error) {
      console.error(&quot;‚ö†Ô∏è Error changing theme:&quot;, error.message);
      res.status(400).json({ status: &quot;error&quot;, message: &quot;Theme change failed.&quot; });
    }
  },
};

export const explore_quest = {
  handler: (req, res) =&gt; {
    try {
      console.log(`üìñ Exploring quest ID: ${req.params.id}...`);
      const quest = loadQuest(req.params.id);
      res.json({ status: &quot;success&quot;, quest });
    } catch (error) {
      console.error(&quot;‚ùå Error loading quest:&quot;, error.message);
      res.status(404).json({ status: &quot;error&quot;, message: &quot;Quest not found.&quot; });
    }
  },
};
</code></pre>
<ul>
<li><code class="inline-code">start_adventure.handler</code> triggers adventure initialization, gracefully handling successes and failures to provide meaningful user feedback on errors.</li>
<li><code class="inline-code">choose_theme.handler</code> validates and updates the theme selection, ensuring requests are correctly managed and logs aid debugging.</li>
<li><code class="inline-code">explore_quest.handler</code> loads detailed information about specific quests, incorporating request validation and error feedback mechanisms.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use logs strategically (<code class="inline-code">console.log</code>) to trace handler invocations and diagnose unexpected behavior.</li>
<li>Investigate the interplay between handlers and the setup process to better understand dependency injection patterns.</li>
<li>Test endpoints locally with tools like Postman to confirm their behavior aligns with the expected workflows.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Mission accomplished: Quest 4‚Äî&#39;MCP Interface Conduits&#39;; you&#39;ve debugged complex pipelines, optimized connection layers, and refactored your skills‚Äîkeep the momentum strong as you‚Äôre 60% deployed toward mastery! ‚≠êüöÄ‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>