<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: The Temple of Eternal Stories - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Codex of Lost Civilizations</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: The Temple of Eternal Stories</h1>
<hr>
<p>Long ago, in the sprawling jungles of an ancient civilization, there was a sacred site whispered about only in hushed tones: the Temple of Eternal Stories. At its heart lay the &quot;Framework of Infinite Journeys,&quot; carved into stone‚Äîa technology far beyond its time. Hidden glyphs revealed the art of harnessing advanced modular systems to craft endless adventures. Your first steps bring you to the temple gates, where you must decipher the initial glyphs by exploring how this legendary construct is laid out and the foundations it rests upon.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Glyph Decoding</strong>: How does the <code class="inline-code">HTMLAdventureGenerator</code> orchestrate the process of generating an intricate adventure system, connecting themes with quests and assets? </li>
<li>‚ö° <strong>Ritual of Substitution</strong>: How does the <code class="inline-code">TemplateEngine</code> render and manipulate placeholders to bring templated content to life?</li>
<li>üõ°Ô∏è <strong>Preservation Techniques</strong>: How does the <code class="inline-code">AssetManager.copyGlobalAssets</code> ensure the safe duplication of shared resources in the system?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/generator/src/cli/template-engine.ts:</span> The Glyph Weaver</h3>
<p>The <code class="inline-code">TemplateEngine</code> serves as the temple&#39;s scribe, tasked with crafting HTML constructs from raw materials. It transforms placeholders into dynamic content with its efficient template rendering system. This component is key to injecting life into static structures.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Handles the retrieval of templates while leveraging a caching mechanism to avoid redundant reads.</li>
<li><code class="inline-code">replacePlaceholders</code>: Substitutes placeholders in a template with provided variables, ensuring seamless interaction between fragments.</li>
<li><code class="inline-code">renderPage</code>: Renders a full page by combining a base and content template, establishing the primary UI structure.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/asset-manager.ts:</span> The Keeper of the Vault</h3>
<p>The <code class="inline-code">AssetManager</code> is the guardian of visual treasures, ensuring that assets are copied correctly into their new homes during the generation ritual. Its methods are attuned to handling themes and shared resources.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyImages</code>: Copies theme-specific images, ensuring assets for each adventure are complete.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Transfers specific files required for navigating the narrative, enabling smooth user interaction.</li>
<li><code class="inline-code">copyGlobalAssets</code>: Handles the duplication of globally shared resources, ensuring robustness and accessibility.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/html-generator.ts:</span> The Storyteller&#39;s Architect</h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> is the primary guide through this process, orchestrating the transformation of fragmented tales and scattered resources into cohesive adventures.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: Manages the end-to-end generation of an adventure, from analyzing the configuration to saving outputs.</li>
<li><code class="inline-code">generateAllThemes</code>: Executes the process for multiple themes, leveraging parallelism and reusing shared assets when appropriate.</li>
<li><code class="inline-code">startHttpServer</code>: Launches a local server, allowing adventurers to preview the generated terrain of their storyworld.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/template-engine.ts</h3>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Caches templates to improve performance and reduce I/O operations during rendering.</li>
<li>Loads templates dynamically from disk if not already cached, ensuring streamlined access.</li>
<li>Error handling ensures graceful failures when templates are missing or inaccessible.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  return result;
}
</code></pre>
<ul>
<li>Manages placeholder substitution, allowing dynamic content injection.</li>
<li>Uses regular expressions to reliably replace all occurrences of placeholders.</li>
<li>A clean and modular design makes it easy to integrate new variables.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);

  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Renders an entire page by layering templates and injecting the necessary variables.</li>
<li>Combines base templates with specific content, promoting code reuse.</li>
<li>Supports a systematic approach to templated HTML rendering.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<pre><code class="language-typescript">copyGlobalAssets(outputDir: string): void {
  try {
    const globalAssetsDir = path.join(outputDir, &#39;assets&#39;);
    const targetImagesDir = path.join(globalAssetsDir, &#39;images&#39;);
    fs.mkdirSync(targetImagesDir, { recursive: true });

    const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
    fs.mkdirSync(globalSharedDir, { recursive: true });
    
    const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
    globalImages.forEach(file =&gt; {
      const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
      if (fs.existsSync(sourcePath)) {
        const targetPath = path.join(globalSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      }
    });

    const headerImageSource = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;, &#39;ai-adventures.png&#39;);
    if (fs.existsSync(headerImageSource)) {
      const headerImageTarget = path.join(targetImagesDir, &#39;ai-adventures.png&#39;);
      fs.copyFileSync(headerImageSource, headerImageTarget);
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy global images&#39;));
  }
}
</code></pre>
<ul>
<li>Ensures that globally shared assets are copied, maintaining consistency across themes.</li>
<li>Conditional checks for file existence prevent runtime errors.</li>
<li>Leverages a modular directory structure for intuitive organization of output assets.</li>
</ul>
<hr>
<h3>packages/generator/src/cli/html-generator.ts</h3>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
  console.log();

  console.log(chalk.dim(&#39;üìä Analyzing codebase...&#39;));
  const projectInfo = createProjectInfo(await repoAnalyzer.generateRepomixContext(this.projectPath));

  console.log(chalk.dim(&#39;‚ú® Generating themed story and quests...&#39;));
  const storyContent = await this.adventureManager.initializeAdventure(projectInfo, this.selectedTheme, this.projectPath);

  console.log(chalk.dim(&#39;üñºÔ∏è Copying images...&#39;));
  this.copyImages();

  console.log(chalk.dim(&#39;üìù Creating main adventure page...&#39;));
  this.generateIndexHTML();

  console.log(chalk.dim(&#39;üìñ Generating quest pages...&#39;));
  await this.generateQuestPages();

  console.log(chalk.dim(&#39;üéâ Creating adventure summary page...&#39;));
  await this.generateSummaryHTML();
}
</code></pre>
<ul>
<li>Coordinates the various steps necessary for generating an entire adventure.</li>
<li>Integrates project analysis, story generation, and resource management.</li>
<li>Modular method calls break the process into easily understandable stages.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>üó∫Ô∏è Pay attention to the caching mechanism in <code class="inline-code">loadTemplate</code>; it&#39;s critical for efficiency.</li>
<li>üìú When exploring <code class="inline-code">generateAdventure</code>, note how it connects analysis with generation.</li>
<li>üõ†Ô∏è Use <code class="inline-code">copyGlobalAssets</code> as a guide for understanding error-tolerant file copying logic.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Hail, seeker of wisdom‚Äîthy triumph in unearthing the sacred truths of the Temple of Eternal Stories marks the dawn of a legendary odyssey where ancient knowledge shall illumine thy path forevermore! ‚ö°üíéüëÅÔ∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>