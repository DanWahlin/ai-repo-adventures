<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Glyphs of Storytelling - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'ancient' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Pyramid of Lost Code</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Glyphs of Storytelling</h1>
<hr>
<p>The ancient jungle seemed alive with a subtle hum‚Äîa chant carried on the wind that whispered secrets of wisdom long forgotten. The Pyramid of Lost Code loomed large, its walls shimmering faintly as the setting sun caressed its glyph-etched surfaces. You step cautiously into the next chamber, where the second quest beckons: to unravel the sacred art of storytelling woven through these walls. Within lies the key to generating civilizations‚Äô narratives, powered by algorithms and theme-infused sagas to inspire the modern digital age. The Glyphs of Storytelling are your guide, hieroglyphs that seem to pulse with both enigma and code.  </p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure orchestration managing state, themes, and user interactions</h3>
<p>The <code class="inline-code">adventure-manager.ts</code> file is where the orchestration of the adventure unfolds, connecting the explorer‚Äôs journey with the formidable Pyramid of Lost Code. Acting as the conductor, it manages the state of the adventure, ensuring every quest seamlessly transitions into the next. The file includes critical methods such as <code class="inline-code">initializeAdventure()</code>, which sets the stage‚Äîloading the project context, interpreting the theme, and invoking the LLM to weave the overarching story. The <code class="inline-code">exploreQuest()</code> method is particularly significant, validating the adventurer‚Äôs choices and breathing life into the glyphs of code that convey ancient secrets.  </p>
<p>A standout feature of this file is its caching mechanism, ensuring quests revisited are retrieved swiftly from memory without redundant calculations‚Äîa parallel to ancient civilizations storing wisdom on papyrus scrolls for recurring use. The coordination of paths and quest progress is handled with meticulous detail. For example, <code class="inline-code">progressPercentage</code> provides a snapshot of how far the traveler has come in the grand adventure. Errors and dead ends are gracefully intercepted by the framework, redirecting the adventurer to paths brimming with possibility.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure()</code>: Summons the narrative foundation and prepares the journey‚Äôs quests using the LLM.  </li>
<li><code class="inline-code">exploreQuest()</code>: Executes quest choices, either delving into new discoveries or revisiting cached explorations.  </li>
<li><code class="inline-code">progressPercentage</code>: Calculates the adventurer‚Äôs step count through the digital labyrinth, ensuring clear progress tracking.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/adventure/story-generator.ts:</span> LLM-powered story creation with theme-based narratives and prompt engineering</h3>
<p>The <code class="inline-code">story-generator.ts</code> file serves as the temple where the Glyphs of Storytelling are inscribed and decoded. This module is the master artisan, responsible for crafting cohesive narratives that merge both thematic precision and technological fluency. The function <code class="inline-code">generateStoryAndQuests()</code> is its crown jewel, calling upon the LLM to produce a detailed setting, an adventurous storyline, and tangible quests. Within its chambers, the process ensures that themes such as ancient wisdom are encoded as sacred scrolls, preserving their authenticity.  </p>
<p>Another noteworthy aspect is its validation pipeline. The file uses schemas like <code class="inline-code">StoryResponseSchema</code> to ensure that every generated narrative adheres to proper structure, avoiding the chaos of malformed glyphs. Moreover, <code class="inline-code">generateQuestContent()</code> manipulates smaller threads of the glyphs, pulling from project contexts or specified file paths to paint intricate task-based frescoes for adventurers to decipher.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateStoryAndQuests()</code>: Commands LLMs to unveil complete storylines and quests, imbued with user-selected themes.  </li>
<li><code class="inline-code">StoryResponseSchema</code>: Ensures the narratives maintain structural harmony with logical validation.  </li>
<li><code class="inline-code">generateQuestContent()</code>: Channels granular details into the wider adventure, feeding on real project contexts for authenticity.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration system for guided adventures that enhance story generation</h3>
<p>Often considered the parchment where the Pyramid‚Äôs blueprints are drawn, <code class="inline-code">adventure-config.ts</code> marshals the configuration data needed to shape a guided experience. Its <code class="inline-code">parseAdventureConfig()</code> method is adept at interpreting the <code class="inline-code">adventure.config.json</code> file, which maps out the structural components like quest titles, associated files, and the pathway of exploration. This ensures that the glyphs are meticulously positioned‚Äîfile paths validated, file contexts extracted, and hints highlighted for adventurers to discover.  </p>
<p>Another shining facet is <code class="inline-code">formatAdventureConfigForPrompt()</code>. This method transforms arcane configuration data into structured prompts tailored for the LLM, ensuring that the ancient Glyphs of Storytelling are converted into fertile narratives. By doing so, it bridges the gap between static configurations and dynamic quests.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig()</code>: Reads and interprets the adventure.config.json file, creating a foundation for quest structure.  </li>
<li><code class="inline-code">extractUniqueFilePaths()</code>: Traverses the configuration file to assemble reference paths, validating their legitimacy.  </li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code>: Converts raw configuration details into narrative primers for the LLM.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">export class AdventureManager {
  async initializeAdventure(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme, 
    projectPath?: string,
    customThemeData?: CustomThemeData
  ): Promise&lt;string&gt; {
    // Reset state for new adventure
    this.state.reset();
    this.state.projectInfo = projectInfo;
    this.state.currentTheme = theme;
    this.state.projectPath = projectPath || process.cwd();

    // Set custom theme data if provided
    if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
      this.storyGenerator.setCustomTheme(customThemeData);
    }

    // Generate the overall story and quests using LLM
    const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);

    this.state.title = storyResponse.title;
    this.state.story = storyResponse.story as string; // Simplify for now

    this.state.quests = storyResponse.quests;

    return this.formatStoryWithQuests(storyResponse);
  }
}
</code></pre>
<p>This is the orchestra that ensures every symphony‚Äîthe story, the quests, and themes‚Äîalign to set the adventurer‚Äôs stage.  </p>
<h3>packages/core/src/adventure/story-generator.ts</h3>
<pre><code class="language-typescript">export async function generateStoryAndQuests(
  projectInfo: ProjectInfo,
  theme: AdventureTheme,
  projectPath?: string
): Promise&lt;StoryResponse&gt; {
  const repomixContent = projectInfo.repomixContent;

  const prompt = loadStoryGenerationPrompt({
    theme,
    repomixContent,
  });

  const response = await llmClient.generateResponse(prompt, { maxTokens: LLM_MAX_TOKENS_STORY });

  const parsed = StoryResponseSchema.parse(JSON.parse(response.content));

  return parsed;
}
</code></pre>
<p>This passage brings the Glyphs to life, interpreting project inscriptions into themed fables and multi-faceted quests for the adventurer.  </p>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed) {
    return &#39;&#39;;
  }

  let description = &#39;Adventure Configuration: List of quests and file mappings.\n\n&#39;;
  for (const quest of parsed.quests || []) {
    description += `- Title: ${quest.title}\n- Files: ${quest.files?.map(f =&gt; f.path).join(&#39;, &#39;)}\n`;
  }

  return description;
}
</code></pre>
<p>This reads and artfully crafts the treasure map, ensuring no path of the Pyramid‚Äôs wisdom remains obscured.  </p>
<h2>Helpful Hints</h2>
<ul>
<li>Use caching techniques as demonstrated in <code class="inline-code">adventure-manager.ts</code> for scenarios requiring reusability.  </li>
<li>Traverse additional file path extractions in <code class="inline-code">adventure-config.ts</code> to locate sacred yet undiscovered files.  </li>
<li>Delve deeper into validation schemas in <code class="inline-code">story-generator.ts</code> for reusability across multiple narrative scenarios.</li>
</ul>
<hr>
<p>Illustrious seeker, thou hast unlocked the sacred glyphs of storytelling, chiseling thy wisdom into the ever-eternal tablet of knowledge‚Äîonward, for the ancients would hail thee with laurel and light! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: The Crystal Analyzer ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>