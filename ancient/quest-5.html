<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Pillars of Foundation - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codebound Chronicle of the Forgotten Jungle</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Pillars of Foundation</h1>
<hr>
<p>The air grows heavy within the Pyramid of Codex, ancient dust swirling beneath rays of filtered light. You have reached a sacred inner sanctum where the final pillars of understanding await. These pillars, known as the Foundations, hold the secrets to the pyramid&#39;s core - the structure that feeds its unparalleled capacity for creation. The Foundations are hidden within the labyrinthine scripts of ancient code stored here. To uncover these secrets, you must decipher the crucial architectural elements hidden within the sacred file.</p>
<p>Only by perceiving the intricate design of the pillars will you unlock the full wisdom of the Pyramid of Codex and its ability to breathe life into digital realms. The path lies before you, seeker. Will you unravel the final mysteries?  </p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:  </p>
<ul>
<li>üîç <strong>The Path of Extraction</strong>: How does the <code class="inline-code">extractUniqueFilePaths</code> function traverse and validate file paths within the pyramid&#39;s ancient structure?  </li>
<li>‚ö° <strong>Patterns of Interpretation</strong>: What does <code class="inline-code">formatAdventureConfigForPrompt</code> reveal about optimizing data from the adventure configuration for external guidance?  </li>
<li>üõ°Ô∏è <strong>Guardians of Clarity</strong>: How does <code class="inline-code">parseAdventureConfig</code> keep the process safe from malformed data and missing elements?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> The Foundational Scripture</h3>
<p>This file contains the essential functions that read, interpret, and extract structural components of the adventure configuration. It acts as the cornerstone for ensuring the system can understand, validate, and format the adventure&#39;s path forward. Key functions for file path extraction, JSON parsing, and data optimization reside here, serving as vital connections between the narratives provided by ancient wisdom and the operational structure of the Pyramid of Codex.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code> ensures the adventure configuration is read from its raw form and safely parsed into usable data. This is critical to prevent corruption of the sacred quest lines.  </li>
<li><code class="inline-code">extractUniqueFilePaths</code> traverses the layers of the configuration, identifying and validating unique file paths while ensuring the integrity of its foundation.  </li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code> optimizes the adventure structure for clarity and conciseness, particularly for communication with external wisdom-seekers.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Converts a raw adventure configuration file into a JavaScript object for further processing.  </li>
<li>Safeguards the parsing process with a try-catch block to handle invalid JSON gracefully.  </li>
<li>Ensures that ambiguous or missing configurations do not derail the system.  </li>
<li>Connects directly with the <code class="inline-code">loadAdventureConfig</code> function to retrieve raw input.  </li>
<li>Highlights critical defensive coding practice: protecting against malformed or corrupted files.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Traverses the configuration structure to extract valid file paths referenced within.  </li>
<li>Uses a depth-first search approach with a stack to handle nested objects.  </li>
<li>Validates each path for existence in the current project, ensuring reliability.  </li>
<li>Avoids duplicate entries by leveraging a <code class="inline-code">Set</code>.  </li>
<li>Demonstrates a systematic approach to retrieving meaningful data while maintaining integrity of the source material.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths, no verbose descriptions
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    // Just function names, no descriptions
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Optimizes adventure configurations into a concise, structured format for guidance and external communication.  </li>
<li>Focuses on essential data: quest titles, file paths, and functions, reducing irrelevant information for clarity.  </li>
<li>Streamlines data extraction to achieve up to 72% reduction in content size.  </li>
<li>Highlights the importance of serving streamlined yet comprehensive information for tools relying on this format.  </li>
<li>Demonstrates effective string manipulation and array handling to compile the desired output.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Pay particular attention to the <code class="inline-code">Set</code> structure in <code class="inline-code">extractUniqueFilePaths</code> for an example of how to ensure data uniqueness.  </li>
<li>Observe the way error-handling mechanisms are consistently used to guard against unpredictable input.  </li>
<li>Use <code class="inline-code">formatAdventureConfigForPrompt</code> as inspiration for improving the clarity of your own data pipelines.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Pyramid of Codex! The ancient wisdom of crafting and analyzing digital narratives is now yours, making you a true architect of digital realms. Your journey has reached its triumphant conclusion, seeker. The treasures of the Forgotten Jungle are yours to wield for all eternity.</p>
<p>By the will of the ancients and under the sacred gaze of the eternal stars, thou hast fortified the Pillars of Foundation, advancing thy noble path with wisdom most radiant‚Äîpress onward, herald of triumph, for destiny nears! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="index.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>