<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Codex of Timekeepers - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'ancient' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Lost Scrolls of Repoa: Unearthing the Codebound Mysteries</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Codex of Timekeepers</h1>
<hr>
<p>As the jungle&#39;s shadows stretched long and golden under the weight of the setting sun, you arrived at the long-forgotten Temple of Chronology. Its glyphs whispered of the Timekeepers, ancient architects who interwove logic and chaos to calculate secrets locked within eternity&#39;s grasp. Their Codex, known only in legend, is said to reveal the patterns of time itself, a vital artifact hidden within the tangled mysteries of the temple. But beware‚Äîthis sacred place bends the threads of logic like the jungle&#39;s twisting vines. With your map, tools, and courage in hand, it‚Äôs time to decipher the intricate puzzles and recover this relic of unparalleled wisdom.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration system for guided adventures that enhance story generation</h3>
<p>The <code class="inline-code">adventure-config.ts</code> file acts as both the map and compass for constructing carefully guided and themed adventures. Serving as the architectural foundation of the adventure generation pipeline, this file&#39;s functions load, parse, and structure information stored within the vital <code class="inline-code">adventure.config.json</code>. By reading this file, adventures are aligned with specific themes, ensuring that quests deliver rich educational content while respecting the narrative&#39;s constraints. Functions like <code class="inline-code">loadAdventureConfig()</code> extract raw configuration data, while <code class="inline-code">parseAdventureConfig()</code> ensures that the information follows the correct structure. Furthermore, the <code class="inline-code">formatAdventureConfigForPrompt()</code> function intricately organizes quest details, which allows narrative prompts to consistently focus on relevant code exploration.</p>
<p>Embedded within the file is the <code class="inline-code">extractUniqueFilePaths()</code> function, which functions like an ancient scribe cataloging each scroll‚Äîsystematically identifying and validating all files referenced in the configuration. While many parts of this file operate in the background, their importance cannot be overstated. Without these mechanisms, the themed narrative structure and educational focus of the adventures would falter entirely.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig()</code> retrieves configuration details from <code class="inline-code">adventure.config.json</code> like rediscovering a map tucked away in a dusty tome.</li>
<li><code class="inline-code">parseAdventureConfig()</code> ensures the retrieved map is both authentic and intact, protecting the flow of the adventure.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code> meticulously crafts prompts, ensuring a perfect symbiosis between narrative and analysis.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">/**
 * Parses the adventure config into an object (or null on error/missing).
 * Single point of JSON parsing and validation.
 */
export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}

/**
 * Extracts all unique, existing file paths referenced by &quot;path&quot; fields anywhere in the config.
 */
export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<p>Just as astronomers use telescopes to discover stars in complex constellations, these functions scan and interpret the vast network of paths in <code class="inline-code">adventure.config.json</code> to bring focus to the adventure.</p>
<h2>Helpful Hints</h2>
<ul>
<li>When designing your own <code class="inline-code">adventure.config.json</code>, ensure that <code class="inline-code">path</code> values reference valid files to avoid breaking the analysis pipeline.</li>
<li>Consider enhancing <code class="inline-code">formatAdventureConfigForPrompt()</code> by introducing more contextual data for theme-specific flexibility in generated prompts.</li>
<li>Explore debugging your configurations by adding logging to <code class="inline-code">extractUniqueFilePaths()</code>‚Äîit simplifies the process of tracing missing or problematic file references.</li>
</ul>
<hr>
<p>Hail, seeker of sacred truths, for with the Codex of Timekeepers claimed, thou art 80% nearer to the hallowed apotheosis, etched in the vaults of eternal wisdom‚Äîpress onward, for destiny calls! ‚ö°üíéüó∫Ô∏è</p>

</div>


    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>