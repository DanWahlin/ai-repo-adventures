<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Ritual of Themes - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Secrets of the Lost Repository</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Ritual of Themes</h1>
<hr>
<p>Beneath the canopy of the endless jungle lies the Repository of Ages, an ancient structure encoded in the wisdom of forgotten civilizations. For centuries, adventurers have sought to unravel its mysteries, lost amidst shadowed ruins and carved stone. Now, you stand on the brink of uncovering its deepest secret: the Ritual of Themes. According to ancient tomes, this ritual harmonizes the world‚Äôs thematic elements, allowing for the creation of perfectly curated adventures. To complete this final trial, you must examine the sacred texts and interpret the artifacts stored within. The fate of the Repository rests in your hands.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Harmony</strong>: How does the <code class="inline-code">ThemeManager</code> ensure themes are matched and styled consistently across the system?</li>
<li>‚ö° <strong>Validation Ritual</strong>: What mechanisms validate user input to detect errors and ensure alignment with available themes?</li>
<li>üõ°Ô∏è <strong>Artifact Safeguards</strong>: How are improperly configured themes handled to prevent system errors or inaccuracies?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Central repository for thematic wisdom</h3>
<p>This file serves as the ultimate source of thematic information for the system. It defines available themes, methods for interacting with them, and the logic for validating and parsing user input. Richly detailed and well-structured, it highlights the importance of maintaining a single source of truth for themes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: An immutable collection defining all available themes, their properties, and unique identifiers.</li>
<li><code class="inline-code">getAllThemes</code>: Returns a list of all defined themes, ensuring centralized theme management.</li>
<li><code class="inline-code">isValidTheme</code>: Checks whether a theme key is recognized, preventing invalid input from disrupting the ritual.</li>
<li><code class="inline-code">parseTheme</code>: Converts user input into a corresponding theme, performing keyword matching and normalization.</li>
<li><code class="inline-code">formatThemeOption</code>: Formats theme data for user-friendly display, combining symbols, names, and descriptions.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Guardian of input purity</h3>
<p>This module applies a set of validation processes to ensure user-entered values, such as themes and project paths, are sanitized appropriately. Its role is critical in safeguarding the ritual from unintentional or malicious errors.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Verifies the user&#39;s choice is non-empty and within acceptable length limits, supporting reliable interaction.</li>
<li><code class="inline-code">validateTheme</code>: Ensures that user-provided themes match predefined options, offering error messaging for invalid entries.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips potentially unsafe characters from user input before rendering, ensuring safe output within the Repository.</li>
</ul>
<h3><span class="header-prefix">packages/generator/src/cli/theme-manager.ts:</span> The keeper of style and icons</h3>
<p>A vital component of the system, this file provides core logic for managing themes and their associated assets. It handles everything from identifying theme icons to generating combined style sheets.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseThemeArg</code>: Transforms command-line arguments into valid themes or marks them invalid, ensuring seamless integration with the CLI.</li>
<li><code class="inline-code">isLightTheme</code>: Determines whether a theme uses a light background for precise asset selection.</li>
<li><code class="inline-code">generateThemeCSS</code>: Produces a unified CSS file for a specific theme, combining base and thematic styles into one cohesive artifact.</li>
<li><code class="inline-code">getThemeIcons</code>: Fetches theme-specific representations, such as emojis, aiding in cohesive branding and user engagement.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
};

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;

  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }

  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }

  return null;
}
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> defines core configurations for all available themes, making it the central hub for their management.</li>
<li>Keywords allow for contextual matching, improving user input flexibility.</li>
<li>The <code class="inline-code">parseTheme</code> function handles multiple input forms (name, ID), showcasing robust and adaptable parsing logic.</li>
</ul>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }

  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);

  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }

  return parsedTheme;
}
</code></pre>
<ul>
<li>Prevents empty input, ensuring key components are always provided.</li>
<li>Leverages <code class="inline-code">parseTheme</code> for flexible user input handling, ensuring integration with existing utilities.</li>
<li>Invalid entries result in user-friendly error messages, enhancing clarity and usability.</li>
</ul>
<h3>packages/generator/src/cli/theme-manager.ts</h3>
<pre><code class="language-typescript">public generateThemeCSS(theme: AdventureTheme, outputDir: string): void {
  const cssFiles = [
    path.join(this.themesDir, &#39;base.css&#39;),
    path.join(this.themesDir, &#39;homepage.css&#39;), 
    path.join(this.themesDir, &#39;animations.css&#39;),
    path.join(this.themesDir, `${theme}.css`)
  ];
  
  let combinedCSS = &#39;&#39;;
  
  cssFiles.forEach(cssFile =&gt; {
    if (fs.existsSync(cssFile)) {
      combinedCSS += fs.readFileSync(cssFile, &#39;utf8&#39;) + &#39;\\n\\n&#39;;
    }
  });
  
  const cssPath = path.join(outputDir, &#39;assets&#39;, &#39;theme.css&#39;);
  fs.writeFileSync(cssPath, combinedCSS);
}
</code></pre>
<ul>
<li>Combines thematic styles dynamically, ensuring easy scalability and modularity.</li>
<li>Integrates with file system operations to automate style generation.</li>
<li>Encapsulates file handling logic with safeguards against missing assets.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Pay close attention to the <code class="inline-code">parseTheme</code> signature and its handling of various input forms.</li>
<li>Review the use of central theme definitions to ensure consistency across all modules.</li>
<li>Experiment with extending <code class="inline-code">THEMES</code> by adding new properties to see how they propagate.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Repository of Ages! Your adventure is complete. May the wisdom of the ancients guide your future explorations.</p>
<p>Lo, Seeker of Sagacity, thou hast conquered the sacred oblation of Quest 5: The Ritual of Themes; thy triumph radiates through the hallowed halls of wisdom like an eternal ‚≠ê, guiding thee toward the apex of enlightenment!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>