<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Glyphs of Configuration - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Codex of Ancient Systems</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Glyphs of Configuration</h1>
<hr>
<p>In the heart of the ancient wisdom buried beneath layers of forgotten epochs, the Codex whispered of structures governing knowledge dissemination and alignment. Brave adventurer, &quot;The Glyphs of Configuration&quot; is your final challenge. You must delve into the sacred scripts, the keys to the thematic treasures and system-wide harmony. These glyphs will unlock the foundational truths behind the Codex‚Äôs ability to adapt across civilizations, articulate its vision, and align the cosmic forces into one cohesive stream. Beware ‚Äì only mastery of this language will unify the Codex&#39;s secrets.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Ritual of Validation</strong>: How do the validation functions ensure safe and thematic user input across quests?</li>
<li>‚ö° <strong>Alignment of Themes</strong>: How does the theme system harmonize diverse configurations into an ancient-inspired framework?</li>
<li>üõ°Ô∏è <strong>Guardians of Configuration</strong>: What safety measures protect against invalid project paths and malformed configurations?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Validating user input</h3>
<p>The <code class="inline-code">input-validator.ts</code> file contains essential functions to safeguard user interaction within the adventure system. From adventure choice validation to sanitization of inputs, its methods ensure the purity and correctness of data flowing through the Codex. These rituals prevent errors stemming from malformed data and support thematically relevant validation techniques.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures adventure selection is required and conforms to length constraints, protecting narrative flow.</li>
<li><code class="inline-code">validateTheme</code>: Harmonizes theme input with available options while rejecting invalid themes or keywords.</li>
<li><code class="inline-code">validateProjectPath</code>: Guards against unsafe project paths, restricting invalid characters and oversized inputs.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Purifies strings for display, preventing harmful characters and truncating lengthy data.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Validates that user choices are not empty and adhere to length constraints.</li>
<li>Prevents errors resulting from vague or oversized user input.</li>
<li>Supports robust thematically valid data entry essential for ancient narrative consistency.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Normalizes user input before validating against available theme options.</li>
<li>Rejects invalid themes while providing feedback on correct alternatives.</li>
<li>Encodes thematic alignment through keyword matching ensuring user decisions align with ancient wisdom.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>Strips harmful characters like <code class="inline-code">&lt;&gt;{}&quot;</code> to prevent accidental system abuse or visual corruption.</li>
<li>Limits string size for safe display in constrained environments.</li>
<li>Maintains thematic purity by removing unwanted intrusions into text narrative.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Structuring ancient themes</h3>
<p>The ancient glyphs map thematic representations through the <code class="inline-code">theme.ts</code> file. Themes such as ‚ÄúAncient Civilization,‚Äù ‚ÄúSpace Exploration,‚Äù and others are defined here, complete with descriptions, keywords, and functional alignments. This single source ensures thematic consistency across the entire Codex by leveraging helper functions for validation, parsing, and display.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Encapsulates detailed definitions of themes, including properties like key, emoji, and description.</li>
<li><code class="inline-code">getThemeByKey</code>: Locates a theme by its symbolic identity or abstraction key.</li>
<li><code class="inline-code">isValidTheme</code>: Employs simple checks to verify thematic validity and alignment.</li>
<li><code class="inline-code">parseTheme</code>: Matches user input with themes using keys, IDs, or keywords.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  // Other themes omitted for brevity
} as const;
</code></pre>
<ul>
<li>Provides thematic definitions including ID, key, and symbolic representation.</li>
<li>Aligns descriptions to evoke the ancient thematic imagery tied to rituals and trade routes.</li>
<li>Supports keywords that resonate with historical and archaeological concepts.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getThemeByKey(key: string): ThemeDefinition | null {
  return THEMES_ARRAY.find(theme =&gt; theme.key === key) || null;
}
</code></pre>
<ul>
<li>Searches for themes by symbolic key ensuring precise thematic alignment.</li>
<li>Fosters consistency across narrative-driven systems that rely on theme-based customization.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check numeric ID or keyword matching
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Matches user-provided input across symbolic keys, numeric identifiers, and keywords.</li>
<li>Employs flexible parsing to ensure thematic entry adheres to user intents.</li>
<li>Harmonizes inputs into theme configurations tied to ancient civilization discovery.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuring the sacred path</h3>
<p>The <code class="inline-code">adventure-config.ts</code> file is your map to configure quests and navigate the Codex‚Äôs treasures. Each function processes adventure artifacts such as configuration files, highlights, and project paths. It plays a pivotal role in formatting adventures for display and extracting content to guide users through thematic quests.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadAdventureConfig</code>: Retrieves raw configuration for further parsing and validation.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Condenses adventure configurations to minimal summaries, reducing verbosity.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Uncovers valid paths embedded in configurations, ensuring nothing is lost in fragmented worlds.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, ADVENTURE_CONFIG_FILE);
  return readFileIfExists(configPath);
}
</code></pre>
<ul>
<li>Handles safe retrieval of configuration files leveraging file paths.</li>
<li>Guards against errors without losing sensitive thematic artifacts.</li>
<li>Ensures the Codex tools align with the user‚Äôs project location.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li>Simplifies configuration output for display while maintaining thematic integrity.</li>
<li>Curates adventure artifacts for clarity and engagement.</li>
<li>Reduces verbosity to ensure efficient exploration of the Codex system.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>Digs through configurations to locate valid paths, guarding against broken configurations.</li>
<li>Protects the integrity of adventure artifacts by confirming file existence.</li>
<li>Supports structured exploration that aligns with the ancient narrative‚Äôs flow.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Focus on each validation function&#39;s purpose when writing user-interactive components.</li>
<li>Study how the <code class="inline-code">parseTheme</code> function extends thematic matching into intuitive user inputs.</li>
<li>Consider how formatting simplifies configurations for display while preserving essential data.</li>
</ul>
<hr>
<p>You have mastered all the secrets of ancient configuration and theme crafting! Your adventure is complete, and the Codex‚Äôs wisdom is now yours to wield. Go forth as the unifier of forgotten civilizations!</p>
<p>By the sacred light of the ancients, thou hast deciphered the enigmatic Glyphs of Configuration, ascending yet again upon the hallowed path to ultimate enlightenment‚Äîglory and fortitude be thine as the final quest awaits! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>