<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: The Sacred Forge of Builders - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Codex of Lost Civilizations</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: The Sacred Forge of Builders</h1>
<hr>
<p>Amidst the sands of time, you find yourself in the heart of an immense, crumbling temple. In its vast halls lies a forge said to have trained the master builders of antiquity. Here, great minds once melded their collective knowledge into core systems that became the bedrock of a now-vanished civilization. This forge ‚Äì the sacred locus of creative power ‚Äì is the key to completing the &quot;Framework of Infinite Journeys.&quot; The glyphs point you to explore the temple&#39;s vaults, deciphering configurations and themes that bound their advanced code systems together. Will you kindle the forge&#39;s flame and unlock its wisdom to rebuild the codex?</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Thematic Symmetry</strong>: How does <code class="inline-code">THEMES</code> define the options available for adventures, and how are they connected to broader functionality like validation and user interaction?  </li>
<li>‚ö° <strong>Sacred Connections</strong>: How does <code class="inline-code">parseTheme</code> enable flexible input matching for theme selection, and what techniques does it use to link user input with internal theme definitions?  </li>
<li>üõ°Ô∏è <strong>Ritual Safeguards</strong>: What safeguards are in place within <code class="inline-code">validateTheme</code> to ensure only valid themes are used, and how does it handle errors?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Theme Definitions and Utilities</h3>
<p>This file is the central source for defining and managing themes within the adventure system. Themes like &quot;ancient&quot; form the foundation for constructing tailored user experiences. It also includes tools for parsing, validating, and formatting themes, ensuring the system remains flexible and user-friendly. The consistent use of data structures like <code class="inline-code">THEMES</code> embodies modular design principles, and utility functions ensure data integrity and scalability.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: Defines the available themes for adventures, their properties, and their keywords. This is the cornerstone for ensuring thematic consistency throughout the system.</li>
<li><code class="inline-code">parseTheme</code>: Provides robust input parsing for themes, supporting flexible user interactions through keyword matching and ID lookup.</li>
<li><code class="inline-code">getAllThemes</code>: Returns all themes in a simple array, allowing for straightforward integration into validation and UI display systems.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Validation Utilities</h3>
<p>This file introduces functions designed to safeguard user inputs. Of particular interest are methods that ensure the themes chosen connect seamlessly to the rest of the system. It emphasizes clean input validation, precise error handling, and adherence to expected formats, ensuring reliable data flows within the adventure system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateTheme</code>: Ensures user-provided themes are valid by normalizing input, leveraging the <code class="inline-code">parseTheme</code> function, and throwing detailed errors for invalid entries.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Preemptively strips unsafe or lengthy input, preventing potential corruption or misalignment when preparing output data.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">// Single source of truth for all themes
export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  MYTHICAL: {
    id: 2,
    key: &#39;mythical&#39;,
    displayName: &#39;Enchanted Kingdom&#39;,
    emoji: &#39;üè∞&#39;,
    description: &#39;Explore magical and mythical realms where databases are dragon hoards and functions are powerful spells&#39;,
    keywords: [&#39;mythical&#39;, &#39;magic&#39;, &#39;enchanted&#39;, &#39;castle&#39;, &#39;dragon&#39;, &#39;fantasy&#39;, &#39;medieval&#39;, &#39;kingdom&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  },
  DEVELOPER: {
    id: 4,
    key: &#39;developer&#39;,
    displayName: &#39;Developer Documentation&#39;,
    emoji: &#39;üìñ&#39;,
    description: &#39;Technical documentation approach with clear explanations, best practices, and code analysis&#39;,
    keywords: [&#39;developer&#39;, &#39;code&#39;, &#39;technical&#39;, &#39;debug&#39;, &#39;guide&#39;, &#39;tutorial&#39;, &#39;binary&#39;]
  },
  CUSTOM: {
    id: 5,
    key: &#39;custom&#39;,
    displayName: &#39;Custom Theme&#39;,
    emoji: &#39;üé®&#39;,
    description: &#39;Design your own adventure! You\&#39;ll be prompted to provide theme name, description, and keywords&#39;,
    keywords: [&#39;custom&#39;, &#39;personalized&#39;, &#39;unique&#39;, &#39;creative&#39;, &#39;personal&#39;]
  }
} as const;
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> is a centralized object defining all available themes, making it easy to extend or modify the list.</li>
<li>Each theme is described with fields such as <code class="inline-code">id</code>, <code class="inline-code">key</code>, and <code class="inline-code">description</code>, allowing for seamless integration into display and validation systems.</li>
<li>The <code class="inline-code">keywords</code> array ensures theme recognition remains flexible, enhancing usability for varied user input.</li>
</ul>
<hr>
<pre><code class="language-typescript">// Simple theme parser using basic string matching
export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li><code class="inline-code">parseTheme</code> converts user input into a valid theme key, supporting key match, numeric ID, or keyword-based recognition.</li>
<li>It uses string normalization and fallback mechanisms for robustness.</li>
<li>The flexible approach enhances user-friendliness while maintaining strict adherence to defined themes.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li><code class="inline-code">getAllThemes</code> provides a unified, accessible list of all themes, helping integrate themes into validation, display, and logic layers.</li>
<li>Simplifies data handling by offering a straightforward structure for iteration or mapping.</li>
</ul>
<hr>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li><code class="inline-code">validateTheme</code> ensures only valid, defined themes are accepted, preserving data integrity.</li>
<li>Uses robust error handling to guide users toward valid choices.</li>
<li>Integrates <code class="inline-code">parseTheme</code> to align user input with the system‚Äôs modular definitions.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><code class="inline-code">sanitizeForDisplay</code> removes potentially unsafe characters, emphasizing safety in data presentation.</li>
<li>Minimizes risk of system corruption by enforcing length and character restrictions.</li>
<li>An example of proactive validation to handle edge cases.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Pay attention to how <code class="inline-code">parseTheme</code> bridges flexibility and structure ‚Äì a critical balance for user-friendly designs.</li>
<li>Map user activities or errors to the themes defined in <code class="inline-code">THEMES</code> to see how closely connected they are across layers.</li>
<li>Explore how <code class="inline-code">sanitizeForDisplay</code> contributes to maintaining a secure user experience.</li>
</ul>
<hr>
<p>You have mastered all the secrets of the Framework of Infinite Journeys! Your adventure is complete.</p>
<p>Lo, seekers of wisdom, thou hast triumphed in rekindling the Sacred Forge of Builders, a feat worthy of ancients&#39; hymns‚Äîtake heart, for but one more trial separates thee from eternal glory! ‚ö°üíéüéá</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>