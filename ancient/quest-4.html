<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Altar of Themes and Rituals - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Sacred Codex: Adventures in the Repository of Lost Wisdom</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Altar of Themes and Rituals</h1>
<hr>
<p>In the midst of the jungle&#39;s labyrinth, you arrive at a solemn chamber adorned with carvings depicting ancient civilizations. This sanctuary glimmers with the knowledge of <code class="inline-code">themes</code> and the sacred rituals that bind adventures together. Here lies &quot;The Altar of Themes and Rituals,&quot; where the lost wisdom of selecting, validating, and applying themes is kept. By unraveling these codes, you will harness the power to unify your adventures under meaningful narratives. Tread carefully, for every line reveals a trial woven into the jungle&#39;s digital fabric.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Ritual of Validation</strong>: How does the system ensure input themes are valid before use in adventures?</li>
<li>‚ö° <strong>Summoning All Themes</strong>: In what way are themes stored, retrieved, and displayed for the user?</li>
<li>üõ°Ô∏è <strong>Guarding Against Chaos</strong>: What techniques protect the adventure&#39;s integrity from invalid or malicious input?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a>: Ensuring Sacred Choices</h3>
<p>This file contains the primary mechanisms for validating various user inputs like adventure choices, themes, and project paths. The functions here act as ritualistic safeguards, ensuring no invalid input traverses the sacred system. Each function applies systematic checks and cleanses the data before passing it onward to maintain the integrity of the adventure experience.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code> ensures the adventure choice follows length and presence requirements. It is critical for avoiding unintended behavior from improperly formatted input.</li>
<li><code class="inline-code">validateTheme</code> transforms and maps user input into normalized themes, validating against the defined set of possible themes in the <code class="inline-code">theme.ts</code> file.</li>
<li><code class="inline-code">sanitizeForDisplay</code> removes unsafe characters from inputs and ensures data is cleaned for presentation.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/input-validator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/input-validator.ts</code></a></h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>This function checks that the input is not empty, trims irrelevant whitespaces, and ensures the length constraint is respected.</li>
<li>It prevents downstream issues by halting invalid input early, offering clear errors about length and presence.</li>
<li>These validations ensure smooth processing of adventure choices in the system.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>A streamlined process converts user input into a valid theme or throws errors if no matching theme is found.</li>
<li>Uses helpers from the <code class="inline-code">theme.ts</code> file like <code class="inline-code">parseTheme</code> and <code class="inline-code">isValidTheme</code> to verify themes against predefined data.</li>
<li>This function&#39;s role is pivotal in linking user input to system-recognized themes seamlessly.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li>This function cleans potentially unsafe characters like <code class="inline-code">&lt;</code>, <code class="inline-code">&gt;</code>, and extra whitespaces.</li>
<li>Implemented to prevent injection attacks and ensure safe display of user data.</li>
<li>The <code class="inline-code">maxLength</code> parameter helps avoid overloading static areas that display textual information.</li>
</ul>
<hr>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a>: The Sacred Codex of Themes</h3>
<p>This file acts as the cornerstone of all theme-related rituals in the adventure system. By providing a structured design for themes (<code class="inline-code">ThemeDefinition</code>) and helper functions (<code class="inline-code">getThemeById</code>, <code class="inline-code">isValidTheme</code>), it standardizes how themes are defined, managed, and accessed throughout the repository.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code> defines all available themes in the system, each with its unique properties, description, and matching keywords. This drives the ritualistic selection of themes.</li>
<li><code class="inline-code">getAllThemes</code> allows the complete collection of themes to be retrieved, ensuring no theme is overlooked during explorations.</li>
<li><code class="inline-code">parseTheme</code> works to identify themes from varied user inputs, ensuring the system adapts to flexible interpretations.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases where data flows like stardust and APIs connect distant galaxies&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;, &#39;starship&#39;, &#39;astronaut&#39;, &#39;sci-fi&#39;, &#39;futuristic&#39;]
  },
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  }
} as const;
</code></pre>
<ul>
<li>Defines the structure of all system-recognized themes like <code class="inline-code">SPACE</code>, <code class="inline-code">ANCIENT</code>, linking internal keys to rich display information.</li>
<li>Each theme features <code class="inline-code">keywords</code> for flexible input matching and <code class="inline-code">emoji</code> for a visually engaging experience.</li>
<li>This data is the basis for many features, including adventure creation and validation.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function getAllThemes(): ThemeDefinition[] {
  return THEMES_ARRAY;
}
</code></pre>
<ul>
<li>Retrieves the complete collection of themes as an array.</li>
<li>Allows for easy iteration and randomized usage, key in displaying all options to users consistently.</li>
<li>Simple but vital for centralizing access to a theme‚Äôs identity.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  
  // Check for exact key match
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  // Check for numeric ID
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Check keywords
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Converts user-provided input to a valid <code class="inline-code">AdventureTheme</code> using key match, numeric ID mapping, or keyword scans.</li>
<li>Adapts gracefully to loosely formatted inputs to maximize usability.</li>
<li>By utilizing <code class="inline-code">THEMES_ARRAY</code> iteratively, flexibility in fetching themes enhances user experience.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Consider the approach to theme parsing - how does normalization and array-based iteration simplify the logic?</li>
<li>Investigate how <code class="inline-code">input-validator.ts</code> and <code class="inline-code">theme.ts</code> collaborate to uphold adventure integrity.</li>
<li>Experiment with modifying a theme&#39;s <code class="inline-code">keywords</code> to see how it impacts the system&#39;s ability to recognize input.</li>
</ul>
<hr>
<p>By a golden brazier of glowing runes, the chamber&#39;s secrets unfold. Another layer of lost wisdom claimed ‚Äì your journey continues!</p>
<p>By the sacred fires of yon ancient altar, thou hast unlocked the arcane rites of themed wisdom, advancing thy journey with valor and forging ever nearer to the eternal temple of mastery‚Äîpress onward, seeker of truths! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>