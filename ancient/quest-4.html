<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Sanctum of Eternal Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'ancient' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Lost Scrolls of Repoa: Unearthing the Codebound Mysteries</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Sanctum of Eternal Configurations</h1>
<hr>
<p>Amid the sprawling complexities of Repoa&#39;s ancient civilization, your quest leads deeper into the jungle to the Sanctum of Eternal Configurations. Here lies the third fragment of the Scrolls of Codebound Wisdom‚Äîits secrets interwoven with the foundational threads of system configuration. Towering glyph-laden columns guide you to a hidden repository, where the power to shape and control the ancient mechanisms of creation resides. Only by deciphering encrypted patterns and unraveling its structured wisdom can you hope to reclaim the clarity that formed the bedrock of Repoa. Beware‚Äîthe sanctum tests not only intellect but discipline, for its secrets bow only to precision.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Simplified Configuration for the Adventure System</h3>
<p>This file acts as the cornerstone of the adventure system, defining constants and settings that govern how the tools interact with repositories, timeouts, cache management, and thematic choices. It&#39;s packed with practical factors: time limits for LLM operations (<code class="inline-code">LLM_REQUEST_TIMEOUT</code>), analysis constraints (<code class="inline-code">MAX_FILE_SIZE_MB</code>), and definitions for cache expiration (<code class="inline-code">REPOMIX_CACHE_TTL</code>). Each of these constants plays a vital role in ensuring the orchestration of quests remains efficient and manageable. This structural precision mirrors the ancient civilization‚Äôs meticulous approach to creating order amidst chaos, reinforcing thematic elements present throughout the adventure system.</p>
<p>The file also introduces the <code class="inline-code">ERROR_MESSAGES</code> object‚Äîa collection of predefined error strings that enhance clarity when unexpected issues arise. From warnings about invalid themes (<code class="inline-code">THEME_INVALID</code>) to safeguards against permission errors, the configuration ensures that the adventurer&#39;s path through the quests remains informed and secure. Furthermore, directory patterns like <code class="inline-code">IGNORE_PATTERNS</code> prevent distractions by excluding unnecessary files during analysis, allowing the system to focus only on source code essentials.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code> ensures stable response times from long prompts without exceeding limits.</li>
<li><code class="inline-code">IGNORE_PATTERNS</code> actively excludes irrelevant folders and files during system engagement.</li>
<li><code class="inline-code">ERROR_MESSAGES</code> provides predefined, readable feedback, enhancing user trust in the adventure experience.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Security and Sanitization for Input Validation</h3>
<p>This file battles the chaotic jungle of user inputs, wielding functions like <code class="inline-code">validateAdventureChoice()</code> and <code class="inline-code">validateProjectPath()</code> that ensure adherence to strict boundaries. It scrutinizes inputs, filtering out risky characters while upholding the integrity of configuration paths. With max length constraints (<code class="inline-code">maxLength = 500</code>) and display sanitization (<code class="inline-code">replace(/[&lt;&gt;{}&quot;</code>]/g, &#39;&#39;)`), its design embodies the spirit of ancient wisdom‚Äîconverting unpredictable variables into a state of structured harmony, much as Repoa sought to wield clarity above chaos.</p>
<p>The file also demonstrates how safeguarding mechanisms like <code class="inline-code">sanitizeForDisplay()</code> sanitize strings into readable formats for user interfaces. Similarly, <code class="inline-code">validateTheme(input)</code> not only enforces input consistency but ties the user‚Äôs chosen theme to the adventure system‚Äôs sacred offerings, further reinforcing the link between adventurer and source code wisdom.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateProjectPath()</code> ensures repository paths are valid and secure, avoiding distractions or errors.</li>
<li><code class="inline-code">sanitizeForDisplay()</code> cleans potentially dangerous input for safe presentation.</li>
<li><code class="inline-code">validateAdventureChoice()</code> handles thematic selection with considerate realism and control.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const LLM_CACHE_TTL = 300000; // 5 minutes
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds, configurable via env
export const REPOMIX_SUBPROCESS_TIMEOUT = parseInt(process.env.REPOMIX_SUBPROCESS_TIMEOUT || &#39;120000&#39;); // 2 minutes
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this
</code></pre>
<p>Timeouts and cache definitions ensure the system handles large operations efficiently without overwhelming resources.</p>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }

  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }

  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }

  return input.trim();
}
</code></pre>
<p>This function carefully shields unsafe inputs from compromising the sanctity of the system&#39;s directory navigation.</p>
<pre><code class="language-typescript">export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<p>Strings are elegantly purified into meaningful, safe formats for display across the adventure interface.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Timeouts like <code class="inline-code">LLM_REQUEST_TIMEOUT</code> help balance system performance with complex operations‚Äîconsider adjusting these based on content scale.</li>
<li>Input sanitization should be rigorous, especially if public users interact with potentially risky configurations.</li>
<li>Adventure progress tracking can be refined further by exploring ties between <code class="inline-code">config.ts</code> and themes in <code class="inline-code">theme.ts</code>.</li>
</ul>
<hr>
<p>Hail, seeker of sagacity, for thy wisdom hath unlocked the sacred enigmas of the Sanctum of Eternal Configurations‚Äîmarch forth, for the stars favor thy destined mastery! ‚ö°‚≠êüíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5: The Codex of Timekeepers ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>