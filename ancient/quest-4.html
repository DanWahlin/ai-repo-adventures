<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Ritual Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="assets/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Codebound Chronicle of the Forgotten Jungle</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Ritual Configurations</h1>
<hr>
<p>Long ago, explorers who dared traverse the sacred Pyramid of Codex learned of the Ritual Configurations - ancient parameters governing the creation and validation of stories from the artifacts found within its halls. Held in three sacred tomes (<code class="inline-code">config.ts</code>, <code class="inline-code">theme.ts</code>, and <code class="inline-code">input-validator.ts</code>), these configurations are pivotal to deciphering the pyramid‚Äôs secrets and ensuring harmony between wisdom and creation. You are tasked with unraveling the truths hidden deep within these files to align the pyramid‚Äôs ancient systems with your noble mission.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Invocation Framework</strong>: How are critical environment variables managed and defaults set in <code class="inline-code">config.ts</code>?</li>
<li>‚ö° <strong>Thematic Codex Discovery</strong>: What methods in <code class="inline-code">theme.ts</code> help define and retrieve various adventure themes?</li>
<li>üõ°Ô∏è <strong>Validation Rituals</strong>: How does <code class="inline-code">input-validator.ts</code> ensure user inputs remain secure, meaningful, and aligned with adventure requirements?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Sacred Parameters of Creation</h3>
<p>This file contains configurations for managing environment variables, system resources, and key parameters required to generate dynamic content safely and efficiently. It introduces constants to manage input limits, API interactions, timeout values, and default settings across the Pyramid‚Äôs systems.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Sets the limit for LLM service response, ensuring timely processing and avoiding system bottlenecks during storytelling.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Governs caching within analysis processes, optimizing memory retention and retrieval for quest generation tools.</li>
<li><code class="inline-code">ERROR_MESSAGES</code>: Provides predefined messages for various error scenarios, ensuring the system can gracefully handle disruptions.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = 60000; // 60 seconds for complex story generation with large prompts
export const REPOMIX_CACHE_TTL = 300000; // 5 minutes
export const ERROR_MESSAGES = {
  LLM_UNAVAILABLE: &#39;LLM service is currently unavailable. Please check your configuration.&#39;,
  ANALYSIS_FAILED: &#39;Failed to analyze the project. Please ensure the path is valid.&#39;,
  THEME_INVALID: &#39;Invalid theme specified. Using default theme.&#39;,
  FILE_NOT_FOUND: &#39;The requested file could not be found.&#39;,
  PERMISSION_DENIED: &#39;Permission denied accessing the specified path.&#39;
} as const;
</code></pre>
<ul>
<li><strong>Timeout Configuration</strong>: <code class="inline-code">LLM_REQUEST_TIMEOUT</code> ensures robust handling of complex content requests by restricting their duration, optimizing system responsiveness.</li>
<li><strong>Cache Strategy</strong>: <code class="inline-code">REPOMIX_CACHE_TTL</code> establishes cache retention, limiting redundant computations while adhering to memory constraints.</li>
<li><strong>Error Messaging Framework</strong>: <code class="inline-code">ERROR_MESSAGES</code> highlights user-friendly error responses that maintain clarity and allow swift troubleshooting.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Blueprint of Adventure Realms</h3>
<p>The thematic core of the adventure rests here, where themes are meticulously defined and validated. This file ensures that adventurers can align their quests with a chosen theme, enriching the narrative experience with custom parameters.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A comprehensive repository of predefined themes, each imbued with unique identifiers, keywords, and descriptions for distinct adventures.</li>
<li><code class="inline-code">getThemeByKey</code>: Simplifies retrieval of themes using their string identifiers, ensuring consistency across different files and user interactions.</li>
<li><code class="inline-code">parseTheme</code>: Processes user input to match theme properties, employing keyword scanning and validation mechanisms.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  ANCIENT: {
    id: 3,
    key: &#39;ancient&#39;,
    displayName: &#39;Ancient Civilization&#39;,
    emoji: &#39;üè∫&#39;,
    description: &#39;Discover lost temples of code where algorithms are ancient wisdom and APIs are trade routes&#39;,
    keywords: [&#39;ancient&#39;, &#39;temple&#39;, &#39;pyramid&#39;, &#39;archaeology&#39;, &#39;historical&#39;, &#39;civilization&#39;, &#39;ruins&#39;]
  }
} as const;

export function getThemeByKey(key: string): ThemeDefinition | null {
  return THEMES_ARRAY.find(theme =&gt; theme.key === key) || null;
}

export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  return null;
}
</code></pre>
<ul>
<li><strong>Theme Repository</strong>: <code class="inline-code">THEMES</code> offers adventurers a diverse catalog of journeys to choose from, including the Pyramid quest itself.</li>
<li><strong>Key-Based Retrieval</strong>: <code class="inline-code">getThemeByKey</code> ensures swift selection and validation of themes, minimizing user error and maximizing precision.</li>
<li><strong>Input Parsing</strong>: <code class="inline-code">parseTheme</code> adjusts user entries to match normalized keys, leveraging error tolerance and adaptability.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Guardians of Input Sanctity</h3>
<p>The <code class="inline-code">input-validator.ts</code> file is crucial to safeguarding the Pyramid‚Äôs integrity. It validates and sanitizes user inputs to ensure they align with the adventure‚Äôs theme and prevent unintended consequences.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures that adventurers‚Äô path choices are meaningful and conform to expected parameters.</li>
<li><code class="inline-code">validateTheme</code>: Confirms the alignment of chosen themes with predefined options, protecting thematic consistency.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Cleans data for presentation, eliminating potentially harmful or malformed content.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function sanitizeForDisplay(input: string, maxLength = 1000): string {
  if (!input) return &#39;&#39;;
  
  return input
    .replace(/[&lt;&gt;{}&quot;`]/g, &#39;&#39;)
    .replace(/\s+/g, &#39; &#39;)
    .trim()
    .slice(0, maxLength);
}
</code></pre>
<ul>
<li><strong>Adventure Input Validation</strong>: <code class="inline-code">validateAdventureChoice</code> prevents entry errors, requiring concise and precise inputs.</li>
<li><strong>Theme Validation</strong>: <code class="inline-code">validateTheme</code> reinforces consistency by confirming user-selected themes against the Pyramid‚Äôs predefined repository.</li>
<li><strong>Sanitization Mechanism</strong>: <code class="inline-code">sanitizeForDisplay</code> guarantees safe output by filtering harmful characters and applying constraints.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Safeguard your inputs with the <code class="inline-code">input-validator.ts</code> rituals before configuring adventures.</li>
<li>Indulge in thematic exploration through <code class="inline-code">theme.ts</code> and test edge cases like invalid keywords.</li>
<li>Dive into <code class="inline-code">config.ts</code> to understand error handling and optimize timeout values for richer ritual performance.</li>
</ul>
<hr>
<p>You have unearthed another critical piece of the Pyramid‚Äôs secrets, brave explorer! Excellent work. Proceed to the final chapter to unlock all its mysteries.</p>
<p>With sacred wisdom unveiled and the celestial Ritual Configurations now mastered, thy path through these ancient quests shines brilliantly like a gilded star upon the tapestry of time‚Äîonward, seeker, to even greater triumph! ‚≠êüíé‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="assets/quest-navigator.js"></script>
</body>
</html>