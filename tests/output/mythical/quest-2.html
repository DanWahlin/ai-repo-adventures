<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Engine of Eternal Stories - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'mythical' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">Chronicles of the Mystic Codebase: The Enchanted Repository</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Engine of Eternal Stories</h1>
<hr>
<p>The shimmering realm of Codoria quivers as a new call to adventure resounds from the Great Repository. Deep within the repository‚Äôs labyrinthine halls lies the Engine of Eternal Stories, a mystical mechanism that spins the world‚Äôs logic and lore into intertwining threads of coherence. Yet, its rhythmic hum has faltered, leaving parts of Codoria ensnared in confusion. As a newly anointed apprentice of the Order of Engineers, you must venture forth into the heart of the repository. Decode the riddles of the Engine and awaken its dormant magic before Codoria succumbs to chaos.</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure orchestration managing state, themes, and user interactions</h3>
<p>This file serves as the architect of Codoria&#39;s intertwined narratives and player interactions. It orchestrates how the grand adventures are seeded, woven, and maintained. Within its intricate folds, <code class="inline-code">AdventureManager</code> acts as the central steward of both the narrative and the player&#39;s progression, adjusting the tale dynamically as actions are taken. For instance, the <code class="inline-code">initializeAdventure</code> function lays the foundation by setting the context for the entire adventure using project details, themes, and configurations. It prepares a suite of quests driven by the might of the Story Generator. Meanwhile, the <code class="inline-code">exploreQuest</code> function ensures that each choice made resonates with care, validating actions and directing users toward their chosen journey. To help track progress, <code class="inline-code">AdventureState.progressPercentage</code> emerges as a sentinel, measuring completion percentages and marking milestones along the quest path.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">AdventureManager.initializeAdventure</code>: Establishes the adventure context and prepares storylines and quests.</li>
<li><code class="inline-code">AdventureManager.exploreQuest</code>: Manages quest execution, validating choices and generating rich content.</li>
<li><code class="inline-code">AdventureState.progressPercentage</code>: Calculates and relays completion milestones for the quest chain.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/adventure/story-generator.ts:</span> LLM-powered story creation with theme-based narratives and prompt engineering</h3>
<p>The <code class="inline-code">story-generator.ts</code> file is the alchemical laboratory where narrative fragments transform into living quests. Anchored by the <code class="inline-code">StoryGenerator</code> class, it links the logic of Codoria‚Äôs codebase to the realms of myth and imagination. Its powerful <code class="inline-code">generateStoryAndQuests</code> function acts as a master spell, summoning a cohesive tapestry of themes and quests by channeling the LLM‚Äôs capabilities. It works alongside the <code class="inline-code">generateQuestContent</code> function to breathe life into individual adventures, shaping them with detailed prompts and incorporating real-world project data. This file also employs <code class="inline-code">parseMarkdownToStoryResponse</code> to transform markdown LLM responses into structured storylines, a process akin to deciphering ancient runes.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">StoryGenerator.generateStoryAndQuests</code>: Generates overarching narratives and instantiates thematic quest lines.</li>
<li><code class="inline-code">StoryGenerator.generateQuestContent</code>: Produces in-depth adventures using the LLM and project-specific code.</li>
<li><code class="inline-code">parseMarkdownToStoryResponse</code>: Translates markdown responses into actionable quest objects.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Configuration system for guided adventures that enhance story generation</h3>
<p>This file serves as the compass and map for Codoria‚Äôs guided experiences. By parsing the <code class="inline-code">adventure.config.json</code> file through the <code class="inline-code">parseAdventureConfig</code> function, it distills structure and requirements into actionable insights. The <code class="inline-code">formatAdventureConfigForPrompt</code> function becomes vital for aligning LLM responses to Codoria‚Äôs storytelling needs, transforming the essence of adventures into clear, structured guidelines. Additionally, the <code class="inline-code">extractUniqueFilePaths</code> function traverses the maze of referenced paths in the configuration file, ensuring that all required files exist without redundancy.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Deciphers the adventure configuration to enable tailored guidance.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Structures configurations for optimized integration with LLM-driven generation.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Gathers unique and validated file paths from configuration references.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">export class AdventureManager {
  private state: AdventureState = new AdventureState();
  private storyGenerator: StoryGenerator;

  constructor() {
    this.storyGenerator = new StoryGenerator();
  }

  async initializeAdventure(
    projectInfo: ProjectInfo, 
    theme: AdventureTheme, 
    projectPath?: string,
    customThemeData?: CustomThemeData
  ): Promise&lt;string&gt; {
    this.state.reset();
    this.state.projectInfo = projectInfo; 
    this.state.currentTheme = theme; 
    // ...
  }
}
</code></pre>
<p>The <code class="inline-code">AdventureManager</code> functions like a master puppeteer intricately managing the strings of Codoria‚Äôs story-web.</p>
<h3>packages/core/src/adventure/story-generator.ts</h3>
<pre><code class="language-typescript">export class StoryGenerator {
  async generateStoryAndQuests(projectInfo: ProjectInfo, theme: AdventureTheme, projectPath?: string): Promise&lt;StoryResponse&gt; {
    // ...
    const response = await this.withTimeout(
      this.llmClient.generateResponse(prompt, { maxTokens: LLM_MAX_TOKENS_STORY })
    );
    // ...
  }
}
</code></pre>
<p>Operating like a mythical bard, the <code class="inline-code">StoryGenerator</code> crafts themes and quests through its magic-imbued generator.</p>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p><code class="inline-code">parseAdventureConfig</code> deciphers the ‚Äúscript‚Äù of Codoria‚Äôs adventure, much like a translator for ancient texts.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Ensure <code class="inline-code">adventure.config.json</code> is accurate, as it fuels tailored quest experiences.</li>
<li>Dive deeper into <code class="inline-code">AdventureManager</code> to explore how adventure states preserve continuity.</li>
<li>Experiment with creating custom themes to unleash entirely new Codoria landscapes.</li>
</ul>
<hr>
<p>With the stars as your witness and the Muses singing your praise, you have unlocked the Engine of Eternal Stories, crafting a path through legends untold‚Äîhail the hero 25% closer to glory! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: The Scribe‚Äôs Insightful Lens ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>