<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: The Forge of Stories - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'ancient' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <a href="index.html">The Lost Codex of the Repository</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 2: The Forge of Stories</h1>
<hr>
<p>Deep within the Repository&#39;s labyrinth, an ancient chamber known as the Forge of Stories hums with dormant potential. Legend has it the Codemasters used its tools to craft tales that illuminated the secrets of the code within. To awaken the Forge, you must decipher the glyphs hidden in its design and breathe life into narratives long forgotten. Armed with your archeotechnologist&#39;s insight and the wisdom of ancient civilizations encoded in the files, the quest to activate the Forge of Stories begins!</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/adventure/adventure-manager.ts:</span> Adventure orchestration managing state, themes, and user interactions</h3>
<p>The <code class="inline-code">AdventureManager</code> serves as the architect for all quests within the digital labyrinth. Acting as the guiding hand, this file&#39;s functionality enables explorers to choose themes, initialize adventures, and delve into quests. One of its core responsibilities is the <code class="inline-code">initializeAdventure()</code> function, which sets the stage by parsing project information, setting themes, and creating story prompts. The <code class="inline-code">exploreQuest()</code> function furthers this ingenious design, validating user choices to ensure that every journey aligns with the labyrinth&#39;s rules. Meanwhile, <code class="inline-code">AdventureState.progressPercentage</code> calculates how far the explorer has ventured into unlocking codified wisdom.</p>
<p>In essence, this file acts like the central planner for your exploration, akin to a sacred map etched on the walls of an ancient pyramid, signaling what lies ahead. It turns user actions and repository details into meaningful progress, ensuring the complexity of the system is coherently navigated.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">AdventureManager.initializeAdventure</code>: Builds the groundwork for quests based on project context and themes.</li>
<li><code class="inline-code">AdventureManager.exploreQuest</code>: Validates choices and executes quests, maintaining narrative consistency.</li>
<li><code class="inline-code">AdventureState.progressPercentage</code>: Tracks explorer progress across completed quests.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/adventure/story-generator.ts:</span> LLM-powered story creation with theme-based narratives and prompt engineering</h3>
<p>This file is the repository’s very own scribe, orchestrating stories and quests using ancient-like precision with LLM technology. Among its standout functions is <code class="inline-code">generateStoryAndQuests()</code>, where themes are validated, stories crafted, and quests forged into structured outputs. The <code class="inline-code">generateQuestContent()</code> function then delves deeper, weaving code-focused tasks from repository files into vivid quests fitted with glyph-like prompts and thematic overtones. Lastly, the <code class="inline-code">generateCompletionSummary()</code> function ties the journey together, delivering summaries as if they were murals revealing the tale of your triumph.</p>
<p>With its mastery over prompts and story creation, the <code class="inline-code">StoryGenerator</code> draws inspiration from the sacred texts of ancient kingdoms, ensuring technical elements align with the rich thematic vision presented to the user. It’s a tool that bridges the structural rigor of code with the mysticism of storytelling.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateStoryAndQuests</code>: Crafts complete stories and quests driven by themes.</li>
<li><code class="inline-code">generateQuestContent</code>: Transforms repository analysis into adventurous narratives.</li>
<li><code class="inline-code">generateCompletionSummary</code>: Summarizes achievements with thematic flair.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Central configuration handling for quest generation</h3>
<p>The <code class="inline-code">adventure-config.ts</code> file acts as a key to decode structured guidance for the Repository’s quests. Its role centers around the <code class="inline-code">parseAdventureConfig()</code> function, responsible for exploring and validating the contents of the sacred <code class="inline-code">adventure.config.json</code> file. By extracting unique file paths through <code class="inline-code">extractUniqueFilePaths()</code>, it ensures explorers can navigate precisely to the files most crucial for unlocking the Codex. Moreover, <code class="inline-code">formatAdventureConfigForPrompt()</code> refines this guidance into readable formats, seamlessly blending human and machine-led exploration.</p>
<p>This file resembles an ancient artifact — it allows explorers to unearth treasures hidden deep within the Repository through meticulously organized instructions chiseled into JSON format.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Reads and validates the adventure configuration file.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Collects all referenced file paths based on attributes.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Structures configuration data into prompts for deeper exploration.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();
  
  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  
  this.state.title = storyResponse.title;
  this.state.story = typeof storyResponse.story === &#39;string&#39; ? storyResponse.story : storyResponse.story.content;
  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({
    ...storyResponse,
    quests: this.state.quests
  });
}
</code></pre>
<p>This function acts like a cartographer drawing the map of your coding adventure, defining both where you begin and the challenges that await.</p>
<hr>
<h3>packages/core/src/adventure/story-generator.ts</h3>
<pre><code class="language-typescript">async generateStoryAndQuests(
  projectInfo: ProjectInfo,
  theme: AdventureTheme,
  projectPath?: string
): Promise&lt;StoryResponse&gt; {
  this.currentProject = projectInfo;
  this.projectPath = projectPath;
  
  const validatedTheme = this.validateTheme(theme);
  return await this.generateWithLLM(projectInfo, validatedTheme);
}
</code></pre>
<p>Much like a mystical oracle, this function crafts the foretold narrative and opportunities within your quest.</p>
<hr>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = parsed.adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure Guidelines\n\n`;
  formatted += `**CRITICAL: Each quest MUST include dedicated file analysis sections**\n\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    formatted += `${quest.description}\n\n`;
    formatted += `**Required File Analysis Sections:**\n`;
    for (const file of quest.files) {
      if (!file.path || !file.description) continue;

      formatted += `\n**File: \`${file.path}\`**\n`;
      formatted += `- Description: ${file.description}\n`;
    }
  }

  return formatted;
}
</code></pre>
<p>This function mirrors ancient scrolls, converting cryptic instructions into a readable guide to uncover wisdom.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Mix thematic flair with structured exploration to ensure guides are both engaging and functional.</li>
<li>Always validate the adventure configuration file to discover overlooked insights.</li>
<li>Next, explore additional themes for deeper connections between narrative cohesion and technical clarity.</li>
</ul>
<hr>
<p>By the sacred light of the eternal stars, thy mind hath tempered wisdom in the Forge of Stories, ascending one-fourth the sacred path—press onward, seeker of truths, for greatness awaits!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: The Oracle of Analysis →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">
                <img src="assets/images/github-mark-white.svg" alt="GitHub" width="20" height="20" style="vertical-align: middle; margin-right: 8px;">
                MCP Repo Adventure
            </a>
        </div>
    </footer>
</body>
</html>