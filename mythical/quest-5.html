<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Illuminate the Castle of Configurations - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Kingdom of Enchanted Code: An Epic Repository Adventure</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Illuminate the Castle of Configurations</h1>
<hr>
<p>In the mystical Kingdom of Codethia, you find yourself at the gates of the <strong>Castle of Configurations</strong>. This majestic fortress shelters the enchanted systems that control the kingdom‚Äôs magic. However, a mystical fog shrouds the castle, obscuring the secrets hidden within the <strong>Repository Tome</strong>. To dispel the fog and illuminate the castle‚Äôs mechanisms, you must embark on one final venture, unlocking the magical configurations that hold the kingdom‚Äôs balance. Brace yourself, brave adventurer, for the final restoration of Codethia‚Äôs harmony awaits!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Theme Spellbinding</strong>: How does the castle‚Äôs theme system work, and how is it designed to handle multiple magical themes?</li>
<li>‚ö° <strong>Configuration Mysteries</strong>: What role do the configuration settings play in regulating the magical systems, and how are they safeguarded?</li>
<li>üõ°Ô∏è <strong>Validation Runes</strong>: What patterns ensure input is validated and sanitized before being used in the magic flows of Codethia?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Validating the Adventurer‚Äôs Choices for the Repository Tome</h3>
<p>This file contains various validation runes and enchantments to prevent corrupted inputs from entering the kingdom‚Äôs systems. It ensures your decisions for themes, adventures, and essential paths are sound and free from harmful constructs. Each validation rune has a specific magical purpose, safeguarding Codethia by avoiding invalid or dangerous paths.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures the hero chooses a valid quest path free of vague or excessive characters.</li>
<li><code class="inline-code">validateTheme</code>: Validates and normalizes the adventurer‚Äôs chosen magical theme, rejecting any that lack validity.</li>
<li><code class="inline-code">validateProjectPath</code>: Ensures the hero provides a safe and properly formatted magical path or defaults it to the castle‚Äôs central archive.</li>
<li><code class="inline-code">sanitizeForDisplay</code>: Strips harmful artifacts (like forbidden characters) from text before it‚Äôs displayed in enchanted scrolls.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> The Enchanted Configurations of the Castle</h3>
<p>This file governs the castle‚Äôs configuration spells, dictating rules for time-bound magical limits, repository structures, and interactions with the mystical <strong>LLM Oracle</strong>. These constants ensure the kingdom operates harmoniously and provides customization for future enchantments.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Determines the maximum time the magic oracle may deliberate before returning insights.</li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Establishes the lifespan of cached magical responses, balancing efficiency and memory usage.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Prevents oversized spell tomes from overwhelming the Repository Tome‚Äôs magic when analyzed.</li>
</ul>
<h3><span class="header-prefix">packages/core/src/shared/theme.ts:</span> Guiding the Magic of Themes</h3>
<p>This file is the castle‚Äôs library of themes, detailing mystical realms like <strong>Mythical</strong> or <strong>Ancient</strong>. It serves as the central archive for matching themes against adventurer choices, ensuring alignment with Codethia‚Äôs enchantments. The defined themes, associated keywords, and helper functions create an elegant system for handling the adventure‚Äôs aesthetic and magical inspirations.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A structured map of all possible adventure themes, imbuing each with unique names, descriptions, and enchanting details.</li>
<li><code class="inline-code">parseTheme</code>: A clever spell that deciphers and normalizes an adventurer&#39;s theme input, matching it to Codethia‚Äôs approved themes.</li>
<li><code class="inline-code">getAllThemes</code>: Summons a crystal-clear display of all magical themes to guide adventurers in their choices.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li>Ensures valid quest inputs by rejecting blank or overly verbose responses.</li>
<li>Applies a neat trimming spell to all inputs, removing surrounding spaces for consistency.</li>
<li>Protects the codebase from invalid input attacks by enforcing strict input criteria.</li>
<li>Forms a foundational rune for ensuring harmony in system integrity.</li>
<li>Promotes safe adventurer interactions with the Repository Tome&#39;s magic.</li>
</ul>
<pre><code class="language-typescript">export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}
</code></pre>
<ul>
<li>Normalizes adventurer input to ensure alignment with Codethia‚Äôs theme system.</li>
<li>Prevents invalid themes from entering the Repository Tome‚Äôs magic using <code class="inline-code">parseTheme</code>.</li>
<li>Lists valid themes for clarity, enhancing user experience and reducing missteps.</li>
<li>Uses <code class="inline-code">isValidTheme</code> as the guardian rune to verify theme validity.</li>
<li>Brings precision and elegance to the adventurer&#39;s journey through magical realms.</li>
</ul>
<hr>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;);
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;);
export const MAX_FILE_SIZE_MB = 10;
</code></pre>
<ul>
<li>Implements guardian spells limiting the operation time and memory usage of key systems.</li>
<li>Balances efficiency (cache settings) with magical resilience (timeouts).</li>
<li>Prevents system exhaustion by capping file sizes and operation durations.</li>
<li>Tightly couples runtime configurations with environmental flexibility.</li>
<li>Lends modularity to the Repository Tome‚Äôs magic, preparing it for diverse scenarios.</li>
</ul>
<hr>
<h3>packages/core/src/shared/theme.ts</h3>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: { id: 1, key: &#39;space&#39;, displayName: &#39;Space Exploration&#39;, ... },
  MYTHICAL: { id: 2, key: &#39;mythical&#39;, displayName: &#39;Enchanted Kingdom&#39;, ... },
  ...
} as const;
</code></pre>
<ul>
<li>A dictionary of enchanted themes, each detailed with identifiers, keywords, and descriptions.</li>
<li>Captures the essence of each realm, providing unambiguous guidance to adventurers.</li>
<li>Designed for extensibility, allowing future courts of Codethia to introduce new themes.</li>
</ul>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  if (!input) return null;
  
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;
  
  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  // Match by keywords
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  
  return null;
}
</code></pre>
<ul>
<li>Matches adventurer input against all valid themes using multiple methods (IDs, keys, keywords).</li>
<li>Prevents accidental mismatches through normalization, enhancing spell robustness.</li>
<li>Decides the appropriate theme rune for the adventurer‚Äôs journey efficiently.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Remember, the Castle of Configurations holds the key to Codethia‚Äôs balance. Treat its systems with care and respect.</li>
<li>Start with the validation systems to understand how the kingdom guards against corruption.</li>
<li>Use the theme definitions to enhance your magical stories with elegance.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Codethia&#39;s Repository Tome! Your adventure is complete.</p>
<p>With the radiant torch of wisdom igniting the hallowed halls of the Castle of Configurations, you ascend as a champion of knowledge, poised to claim ultimate victory in the realm of enlightenment‚Äîforward, brave hero! ‚ö°üíé‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>