<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: Chronicles of Heroic Tales - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Enchanted Codex of Questoria</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: Chronicles of Heroic Tales</h1>
<hr>
<p>In the magical kingdom of Questoria, the grand convergence of spells culminates in the Chronicles of Heroic Tales. To unveil such chronicles, the Adventurer seeks the mystical Insight of Code. Whispers of ancient methods echo through the enchanted scripts, guiding scholars to craft stories that test the mettle of any brave hero. Yet, only one knightly hacker can unite the fragments of this arcane knowledge into a complete tale, ready to inspire those who dare follow.</p>
<p><strong>Adventure Awaits</strong> ‚Äì Dive into the very foundations of story generation and chart the threads of thematic code!</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Arcane Threading</strong>: How does <code class="inline-code">AdventureManager.initializeAdventure</code> interweave themes, story generation, and quest structure into a cohesive code journey?  </li>
<li>‚ö° <strong>Epic Propagation</strong>: What mechanisms enable <code class="inline-code">StoryGenerator.generateStoryAndQuests</code> to dynamically adapt adventures using themes and files within the configuration?  </li>
<li>üõ°Ô∏è <strong>Safeguard of Configurations</strong>: How does <code class="inline-code">parseAdventureConfig</code> ensure the adventure configuration file is safely validated, and what patterns are used for resilience?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a>: Core Architect of Adventure</h3>
<p>The <code class="inline-code">AdventureManager</code> is the beating heart of Questoria&#39;s chronicles, orchestrating themes, quests, and user exploration. Acting as an intermediary between powerful code-generation magic (<code class="inline-code">StoryGenerator</code>) and the end-user, this class ensures episodic tales remain thematically immersive.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure</code>: Resets the mystical state and invokes the <code class="inline-code">StoryGenerator</code>, integrating contextual configurations from enchanted scripts into story creation.</li>
<li><code class="inline-code">exploreQuest</code>: Guides adventurers through selected heroic trials by validating and executing choices.</li>
<li><code class="inline-code">generateQuestContent</code>: Channels code insights and mystical data to expand on specific missions within quests.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a></h3>
<pre><code class="language-typescript">async initializeAdventure(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string,
  customThemeData?: CustomThemeData
): Promise&lt;string&gt; {
  this.state.reset();
  this.state.projectInfo = projectInfo;
  this.state.currentTheme = theme;
  this.state.projectPath = projectPath || process.cwd();

  if (theme === &#39;custom&#39; &amp;&amp; customThemeData) {
    this.storyGenerator.setCustomTheme(customThemeData);
  }

  const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme, this.state.projectPath);
  this.state.title = storyResponse.title;
  this.state.story = storyResponse.story;

  this.state.quests = this.mergeQuestFilesFromConfig(storyResponse.quests, this.state.projectPath);
  this.state.quests = this.enforceConfigQuestCount(this.state.quests, this.state.projectPath);

  return this.formatStoryWithQuests({ ...storyResponse, quests: this.state.quests });
}
</code></pre>
<ul>
<li>Resets the adventure&#39;s state ensuring a blank slate for any new tales.</li>
<li>Dynamically generates a story and quest map based on <code class="inline-code">StoryGenerator</code> magic and current configurations.</li>
<li>Injects additional user-defined files or customizations to maintain adaptive narratives.</li>
</ul>
<hr>
<pre><code class="language-typescript">async exploreQuest(choice: string): Promise&lt;AdventureResult&gt; {
  const sanitizedChoice = this.validateAndSanitizeChoice(choice);
  if (this.isProgressRequest(sanitizedChoice)) {
    return this.getProgress();
  }
  
  const quest = this.findQuest(sanitizedChoice);
  if (!quest) {
    return this.createNotFoundResult();
  }

  return await this.executeQuest(quest);
}
</code></pre>
<ul>
<li>Validates and adapts user input into actionable explorations using careful checks.</li>
<li>Leverages modularized methods like <code class="inline-code">findQuest</code> to handle input types dynamically.</li>
<li>Handles both successful and unsuccessful explorations by encapsulating logic under <code class="inline-code">AdventureResult</code>.</li>
</ul>
<hr>
<pre><code class="language-typescript">private async generateQuestContent(quest: Quest): Promise&lt;QuestContent&gt; {
  let codeContent: string;

  if (quest.codeFiles &amp;&amp; quest.codeFiles.length &gt; 0 &amp;&amp; this.state.projectPath) {
    try {
      codeContent = await repoAnalyzer.generateTargetedContent(
        this.state.projectPath,
        quest.codeFiles,
        false
      );
    } catch (error) {
      console.warn(`Failed targeted content generation, fallback:`, error);
      codeContent = this.state.projectInfo!.repomixContent;
    }
  } else {
    codeContent = this.state.projectInfo!.repomixContent;
  }

  const questPosition = this.state.quests.findIndex(q =&gt; q.id === quest.id) + 1;
  return await this.storyGenerator.generateQuestContent({
    quest,
    theme: this.state.currentTheme!,
    codeContent,
    questPosition,
    totalQuests: this.state.quests.length
  });
}
</code></pre>
<ul>
<li>Dynamically adapts mission-specific content or defaults to full repository context as backup.</li>
<li>Connects mission positioning with broader quest narratives to enable logical flow across sessions.</li>
<li>Defensively manages potential errors during targeted content generation.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/story-generator.ts</code></a>: Weaver of Tales</h3>
<p>The <code class="inline-code">StoryGenerator</code> class interprets project structure and transforms it into themed adventures. Through tokenization, schema validation, and prompt-based LLM invocations, it ensures immersive storytelling that aligns with the code&#39;s universe.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateStoryAndQuests</code>: Harmonizes themes and narrative context to summon immersive tales.</li>
<li><code class="inline-code">generateQuestContent</code>: Constructs granular quest-level details using dynamic prompts augmented by current state.</li>
<li><code class="inline-code">parseMarkdownToStoryResponse</code>: Decodes mystical markdown responses into structured fantasy (adventures and quests).</li>
</ul>
<pre><code class="language-typescript">async generateStoryAndQuests(
  projectInfo: ProjectInfo, 
  theme: AdventureTheme, 
  projectPath?: string
): Promise&lt;StoryResponse&gt; {
  this.currentProject = projectInfo;
  const validatedTheme = this.validateTheme(theme);
  return await this.generateWithLLM(projectInfo, validatedTheme);
}
</code></pre>
<ul>
<li>Ensures theme accuracy and alignment with story context before invoking LLM magic.</li>
<li>Modifies responses dynamically to fit ongoing adventures.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: Keeper of Reliance</h3>
<p>The Adventure Configuration utility validates and processes key files ensuring stability through safe parsing and path validation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Safeguards JSON parsing while isolating erroneous cases to prevent system failures.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Iteratively gleans file references within nested configuration structures.</li>
<li><code class="inline-code">loadAdventureConfig</code>: Provides a safe method to load project configurations with fallback for missing files.</li>
</ul>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<ul>
<li>Returns <code class="inline-code">null</code> for absence of configuration files or parsing failures ‚Äì a graceful handling approach.</li>
<li>Centralizes JSON validation to fortify against invalid structures.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Equipped for Errors</strong>: Look for how functions handle fallbacks (try-catch) and redundant checks (e.g., <code class="inline-code">!raw</code> or <code class="inline-code">loadConfig</code> wrappers).</li>
<li><strong>Follow the Threads</strong>: Analyze how methods deliver seamless integration between configuration, themes, and interactive quests.</li>
<li><strong>Adopt Clever Patterns</strong>: Observe Set-based uniqueness filters or nested-value traversal when assimilating structure-wide data.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>With the wisdom of ancient scrolls and the valor of a legendary knight, you‚Äôve triumphed through Quest 3: Chronicles of Heroic Tales‚Äîmarch boldly, steadfast hero, for the realm gleams brighter at 40% completion! ‚ö°üíéüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="prev-quest-btn">‚Üê Previous: Quest 2</a>
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
</body>
</html>