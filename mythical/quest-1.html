<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: Eldoria‚Äôs Enchanted Gateway ‚Äî The MCP Tool Interface - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'mythical' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">The Mystic Code of Eldoria</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: Eldoria‚Äôs Enchanted Gateway ‚Äî The MCP Tool Interface</h1>
<hr>
<p>In the mystical land of Eldoria, where ancient manuscripts govern the very threads of the kingdom&#39;s balance, you have ventured deeper into uncovering the Repository of Souls. The enchanted Gateway now awaits your wisdom to wield the MCP Tool Interface‚Äîsummoning the system‚Äôs power to unravel cryptic glyphs and archaic scripts. Here, the land&#39;s harmony hinges on your ability to summon enchanted tools, decode their celestial designs, and bring forth a new dawn for Eldoria‚Äôs fractured relic of power. Awaken your innate ability, hero, as destiny rides on the clouds of your choices!</p>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/mcp/src/server.ts:</span> MCP server protocol implementation that hosts the adventure tools</h3>
<p>The <code class="inline-code">server.ts</code> file is the beating heart of the enchanted interface that breathes life into Eldoria‚Äôs tools. This file hosts the MCP server, enabling it to connect with adventurers and offer wondrous tools for exploration. Within its mystical code, the <code class="inline-code">RepoAdventureServer.setupHandlers()</code> method acts as a powerful spellbook, binding the methods that list magical tools and invoke their powers. Meanwhile, the <code class="inline-code">RepoAdventureServer.run()</code> method establishes communication channels through the <code class="inline-code">StdioServerTransport</code>, invoking the ancient practice of warming up the server by pre-generating <code class="inline-code">repomix</code> content. As Eldoria‚Äôs knight, the file culminates in the <code class="inline-code">main()</code> function, which gracefully manages life and death cycles of the server itself‚Äîstanding prepared to wield tools infused with enchanted logic. This file is your interface to the kingdom‚Äôs enchanted artifacts.</p>
<h4>Highlights</h4>
<ul>
<li>Registers handlers for the MCP protocol, connecting adventurers to tools like a magical bridge.</li>
<li>Configures <code class="inline-code">StdioServerTransport</code>, ensuring secure communication with the Repository of Souls.</li>
<li>Implements the <code class="inline-code">main()</code> method for graceful shutdown, guarding Eldoria from chaos.</li>
</ul>
<h3><span class="header-prefix">packages/mcp/src/tools.ts:</span> The 4 main MCP tools that provide the user interface to the adventure system</h3>
<p>The <code class="inline-code">tools.ts</code> file is Eldoria‚Äôs enchanted toolbox‚Äîcarrying four mystical items to guide the hero‚Äôs quest. These sacred tools include <code class="inline-code">start_adventure</code>, a ritual to analyze repositories and prepare themes; <code class="inline-code">choose_theme</code>, which weaves custom stories based on user selection; <code class="inline-code">explore_quest</code>, a power allowing adventurers to delve deeper into individual challenges; and <code class="inline-code">view_progress</code>, an oracle that reveals completed tasks and unveils remaining paths. By binding tools seamlessly together, this file casts a dynamic spell of harmony, enabling adventurers to carry out their sacred tasks without distraction. The code here holds the threads connecting function and story, ensuring each magical implement serves its purpose.</p>
<h4>Highlights</h4>
<ul>
<li>Bridges adventure tools seamlessly into Eldoria‚Äôs exploration framework.</li>
<li>Defines the enchanted <code class="inline-code">tools</code> object, providing a ready inventory of mystical utilities.</li>
<li>Powers quests with handlers like <code class="inline-code">start_adventure</code> and <code class="inline-code">explore_quest</code>, central to narrative immersion.</li>
</ul>
<h2>Code</h2>
<h3>packages/mcp/src/server.ts</h3>
<pre><code class="language-typescript">private setupHandlers() {
  this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; {
    const toolList = Object.entries(tools).map(([name, tool]) =&gt; ({
      name,
      description: tool.description,
      inputSchema: zodToJsonSchema(tool.schema, { 
        target: &#39;jsonSchema7&#39;,
        $refStrategy: &#39;none&#39;
      })
    }));
    return { tools: toolList };
  });

  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    try {
      const { name, arguments: args } = request.params;

      if (!(name in tools)) {
        throw new McpError(ErrorCode.MethodNotFound, `Unknown tool: ${name}`);
      }

      const tool = tools[name as keyof typeof tools];
      const validationResult = tool.schema.safeParse(args);
      if (!validationResult.success) {
        const errorMessages = validationResult.error.issues.map((err) =&gt; 
          `${err.path.join(&#39;.&#39;)}: ${err.message}`
        ).join(&#39;, &#39;);
        throw new McpError(ErrorCode.InvalidParams, `Invalid parameters: ${errorMessages}`);
      }

      return await tool.handler(validationResult.data as any);

    } catch (error) {
      if (error instanceof McpError) {
        throw error;
      }
      throw new McpError(
        ErrorCode.InternalError,
        `Tool execution failed: ${error instanceof Error ? error.message : String(error)}`
      );
    }
  });
}
</code></pre>
<p>This code acts as Eldoria‚Äôs spellbook, validating the hero‚Äôs invocation of tools and ensuring their effects align with celestial laws.</p>
<hr>
<h3>packages/mcp/src/tools.ts</h3>
<pre><code class="language-typescript">import { adventureManager } from &#39;@ai-repo-adventures/core/adventure&#39;;
import { startAdventure } from &#39;./tools/start-adventure.js&#39;;
import { chooseTheme } from &#39;./tools/choose-theme.js&#39;;
import { exploreQuest } from &#39;./tools/explore-quest.js&#39;;
import { viewProgress } from &#39;./tools/view-progress.js&#39;;

export const start_adventure = startAdventure;
export const choose_theme = chooseTheme;
export const explore_quest = exploreQuest;
export const view_progress = viewProgress;

export const tools = {
  start_adventure,
  choose_theme,
  explore_quest,
  view_progress
};
</code></pre>
<p>This code assembles the tools into a sacred inventory, empowering adventurers to wield them in their quest for balance.</p>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Be sure to start with <code class="inline-code">start_adventure</code> to analyze the codebase‚Äîit‚Äôs the initial map for your journey.</li>
<li>Pay close attention to error handling in <code class="inline-code">setupHandlers()</code> as it ensures smooth navigation of tools.</li>
<li>Consider expanding tool descriptions for better user guidance, making the interface even more magical.</li>
</ul>
<hr>
<p>Hail, noble explorer, for you have unlocked the secrets of Eldoria‚Äôs Enchanted Gateway, forging the first starry path to mastery with brilliance worthy of the legends! ‚≠ê‚ö°üöÄ</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2: The Scrolls of Questcraft ‚Äî The... ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>