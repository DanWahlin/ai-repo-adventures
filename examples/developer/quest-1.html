<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: Static Site Generator & Asset Workflow - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Repository Adventurer's Technical Blueprint</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: Static Site Generator &amp; Asset Workflow</h1>
<hr>
<p>Dive into the intricacies of constructing a modern static site generator and designing an efficient asset management workflow. This quest takes you across critical modules responsible for rendering templates, managing themes, and copying assets. Learn how layers of tools combine to transform raw source files into a polished HTML experience.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Template Merging Mechanics</strong>: How do <code class="inline-code">TemplateEngine</code> methods process and assemble templates using placeholders and variables?</li>
<li>‚ö° <strong>Asset Workflow Steps</strong>: How does <code class="inline-code">AssetManager</code> handle copying asset files for both single and multi-theme configurations?</li>
<li>üõ°Ô∏è <strong>HTML Adventure Initialization</strong>: How does <code class="inline-code">HTMLAdventureGenerator.generateAdventure</code> orchestrate the pipeline for generating static HTML content?</li>
</ul>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/template-engine.ts</code></a>: Template processing for static site generation</h3>
<p>This file contains the <code class="inline-code">TemplateEngine</code> class, which handles loading templates from files, replacing their placeholders, and rendering complete HTML pages.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Caches and retrieves templates to avoid redundant I/O operations, ensuring performance efficiency.</li>
<li><code class="inline-code">replacePlaceholders</code>: Dynamically substitutes named placeholders in templates with provided variable values.</li>
<li><code class="inline-code">renderPage</code>: Combines a base template with a content template, filling placeholders to produce complete pages.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/template-engine.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/template-engine.ts</code></a></h3>
<pre><code class="language-typescript">/**
 * Load a template file with caching
 */
private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li>Uses a <code class="inline-code">Map</code> object for caching to minimize repetitive I/O operations.</li>
<li>Retrieves templates from a specific directory, improving modularity.</li>
<li>Throws errors for missing templates, enhancing traceability.</li>
</ul>
<pre><code class="language-typescript">/**
 * Replace placeholders in template with variables
 */
private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li>Iterates through provided variables to replace <code class="inline-code">{{key}}</code> placeholders.</li>
<li>Uses <code class="inline-code">RegExp</code> for global replacement, allowing flexibility in templates.</li>
<li>Ensures unbound placeholders do not break content generation by substituting empty strings.</li>
</ul>
<pre><code class="language-typescript">/**
 * Render a complete page using base template + content template
 */
renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  const pageVariables = { ...variables, CONTENT: renderedContent };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Combines a <code class="inline-code">base-template.html</code> structure with dynamic content injection.</li>
<li>Ensures flexibility by allowing nested rendering of content variables into the base.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/asset-manager.ts</code></a>: Asset copying for themes and shared resources</h3>
<p>The <code class="inline-code">AssetManager</code> class is the main handler for copying assets (images, CSS, JavaScript) across different output scenarios. It supports both single and multi-theme workflows.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyImages</code>: Handles copying of theme-specific and shared images, with support for recursive directory creation.</li>
<li><code class="inline-code">copySharedNavigator</code>: Ensures navigation-related assets are consolidated for multi-theme setups.</li>
<li><code class="inline-code">copyGlobalAssets</code>: Manages the copying of global shared assets to accessible locations.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/asset-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/asset-manager.ts</code></a></h3>
<pre><code class="language-typescript">/**
 * Copy images for single or multi-theme generation
 */
copyImages(outputDir: string, isMultiTheme: boolean = false): void {
  const sourceImagesDir = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;);
  const targetImagesDir = path.join(outputDir, &#39;assets&#39;, &#39;images&#39;);
  
  try {
    if (fs.existsSync(sourceImagesDir)) {
      fs.mkdirSync(targetImagesDir, { recursive: true });
      const imageFiles = fs.readdirSync(sourceImagesDir);
      imageFiles.forEach(file =&gt; {
        const sourcePath = path.join(sourceImagesDir, file);
        const targetPath = path.join(targetImagesDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      });
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy images from source directory&#39;));
  }
}
</code></pre>
<ul>
<li>Handles both theme-specific and shared images through path configurations.</li>
<li>Uses <code class="inline-code">fs.existsSync</code> to avoid redundant operations.</li>
<li>Reports errors without halting execution, maintaining overall workflow stability.</li>
</ul>
<pre><code class="language-typescript">/**
 * Copy shared navigator files to global location (for multi-theme)
 */
copySharedNavigator(rootOutputDir: string): void {
  const assetsDir = path.join(this.sourceDir, &#39;assets&#39;);
  const themeToggleCssSource = path.join(assetsDir, &#39;theme-toggle.css&#39;);
  
  const rootAssetsDir = path.join(rootOutputDir, &#39;assets&#39;);
  fs.mkdirSync(rootAssetsDir, { recursive: true });
  
  if (fs.existsSync(themeToggleCssSource)) {
    fs.copyFileSync(themeToggleCssSource, path.join(rootAssetsDir, &#39;theme-toggle.css&#39;));
  }
}
</code></pre>
<ul>
<li>Centralizes navigation-related files in a shared directory when generating multi-theme outputs.</li>
<li>Ensures accessibility of CSS/JS resources for switching themes dynamically.</li>
</ul>
<pre><code class="language-typescript">/**
 * Copy global shared assets for multi-theme generation
 */
copyGlobalAssets(outputDir: string): void {
  const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
  fs.mkdirSync(globalSharedDir, { recursive: true });

  const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
  globalImages.forEach(file =&gt; {
    const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
    if (fs.existsSync(sourcePath)) {
      const targetPath = path.join(globalSharedDir, file);
      fs.copyFileSync(sourcePath, targetPath);
    }
  });
}
</code></pre>
<ul>
<li>Specializes in copying assets like GitHub logos to a central shared location.</li>
<li>Creates shared directories only when necessary to reduce operations on redundant paths.</li>
</ul>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/html-generator.ts</code></a>: End-to-end pipeline for HTML generation</h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> class orchestrates the creation of a complete HTML-based adventure. It connects template rendering with asset management and serves the generated site.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: Core pipeline for initializing themes, analyzing the repository, and generating HTML files.</li>
<li><code class="inline-code">generateAllThemes</code>: Executes multi-theme generation with centralized asset sharing.</li>
<li><code class="inline-code">startHttpServer</code>: Enables an HTTP server for serving generated files locally.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/generator/src/cli/html-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/generator/src/cli/html-generator.ts</code></a></h3>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
  this.setupOutputDirectories(true);
  
  console.log(chalk.dim(&#39;üìä Analyzing codebase...&#39;));
  const projectInfo = createProjectInfo(await repoAnalyzer.generateRepomixContext(this.projectPath));

  console.log(chalk.dim(&#39;üìù Creating main adventure page...&#39;));
  this.generateIndexHTML();
  
  console.log(chalk.dim(&#39;üìñ Generating quest pages...&#39;));
  await this.generateQuestPages();

  console.log(chalk.green.bold(&#39;üéâ Adventure website generated successfully!&#39;));
}
</code></pre>
<ul>
<li>Establishes directory structure before generation.</li>
<li>Coordinates repository analysis, homepage creation, and individual quest pages.</li>
<li>Logs progress for modular workflow transparency.</li>
</ul>
<pre><code class="language-typescript">async generateAllThemes(args: Map&lt;string, string&gt;): Promise&lt;void&gt; {
  console.log(chalk.green(&#39;‚úÖ Generating all themes&#39;));
  this.isMultiTheme = true;
  
  const themes: AdventureTheme[] = [&#39;space&#39;, &#39;mythical&#39;, &#39;ancient&#39;, &#39;developer&#39;];
  const assetManager = new AssetManager(__dirname);
  assetManager.copySharedNavigator(this.outputDir);

  // Parallel theme generation
  const themePromises = themes.map(async theme =&gt; {
    const themeDir = path.join(this.outputDir, theme);
    fs.mkdirSync(themeDir, { recursive: true });
    const themeGenerator = new HTMLAdventureGenerator();
    themeGenerator[&#39;selectedTheme&#39;] = theme;
    themeGenerator[&#39;outputDir&#39;] = themeDir;
    await themeGenerator.generateAdventure();
  });

  await Promise.allSettled(themePromises);
  console.log(chalk.green.bold(&#39;üéâ All themes generated successfully!&#39;));
}
</code></pre>
<ul>
<li>Facilitates parallel generation of multiple themes while sharing common assets.</li>
<li>Creates isolated directories to prevent overwriting during concurrent operations.</li>
</ul>
<pre><code class="language-typescript">async startHttpServer(port: number = 8080): Promise&lt;void&gt; {
  const server = http.createServer(async (req, res) =&gt; {
    const filePath = path.join(this.outputDir, req.url === &#39;/&#39; ? &#39;index.html&#39; : req.url || &#39;&#39;);
    res.writeHead(200, { &#39;Content-Type&#39;: &#39;text/html&#39; });
    fs.createReadStream(filePath).pipe(res);
  });

  server.listen(port, () =&gt; {
    console.log(chalk.green(`üåê HTTP server started on http://localhost:${port}`));
  });
}
</code></pre>
<ul>
<li>Serves generated HTML locally via HTTP.</li>
<li>Incorporates error handling for missing file requests.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Explore caching techniques like <code class="inline-code">Map</code> usage in <code class="inline-code">TemplateEngine</code> to reduce redundant operations.</li>
<li>Note how <code class="inline-code">AssetManager</code> distinguishes theme-scoped and shared assets for flexibility.</li>
<li>Parallel processing in <code class="inline-code">generateAllThemes</code> provides a performance boost‚Äîconsider this approach in complex scenarios.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Congratulations on successfully refactoring your workflow pipeline and building a robust static site generator‚Äîyour codebase is now a shining example of modular design and deploy-ready brilliance! üöÄüíé‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>