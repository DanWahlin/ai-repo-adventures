<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stellar Configuration Hub - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tk53e05gf2");
    </script>
    
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Starship Repository Odyssey</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Stellar Configuration Hub</h1>
<hr>
<p>You arrive at the Stellar Configuration Hub, the heart of the Starship Odyssey‚Äôs adaptability. This system ensures the ship‚Äôs seamless operation across diverse cosmic environments by managing critical configurations and themes. The glowing interface of the hub pulses with the energy of countless possibilities, offering explorers the tools to shape their journey. Your mission is to decode the hub‚Äôs intricate systems, from theme definitions to adventure configuration, and ensure the Odyssey remains a beacon of interstellar exploration.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:  </p>
<ul>
<li>üéØ <strong>Dynamic Configuration</strong>: How centralized constants and environment variables control system behavior.  </li>
<li>üîç <strong>Theme Management</strong>: How themes are defined, validated, and applied to adventures.  </li>
<li>‚ö° <strong>Adventure Configuration Parsing</strong>: Techniques for extracting and formatting configuration data for downstream systems.  </li>
<li>üí° <strong>Input Validation</strong>: Ensuring robust user input handling to maintain system integrity.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/config.ts</code></a></h3>
<p>This file centralizes the configuration for the Odyssey‚Äôs systems, defining constants and environment-based settings. By consolidating these values, the system ensures consistency and simplifies updates. It also defines resource limits, timeouts, and validation parameters, which are crucial for maintaining performance and reliability during interstellar operations.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">LLM_REQUEST_TIMEOUT</code>: Sets the timeout for LLM requests, ensuring operations do not hang indefinitely.  </li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code>: Defines the cache duration for repository analysis results.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Limits the size of files analyzed to prevent resource exhaustion.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export const LLM_REQUEST_TIMEOUT = parseInt(process.env.LLM_REQUEST_TIMEOUT || &#39;60000&#39;); // 60 seconds
export const REPOMIX_CACHE_TTL = parseInt(process.env.REPOMIX_CACHE_TTL || &#39;60000&#39;); // 60 seconds
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues
</code></pre>
<ul>
<li>These constants ensure the system operates within defined resource limits.  </li>
<li>The <code class="inline-code">LLM_REQUEST_TIMEOUT</code> prevents long-running operations from stalling the system.  </li>
<li><code class="inline-code">REPOMIX_CACHE_TTL</code> optimizes performance by reusing cached results.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code> enforces memory efficiency by skipping overly large files.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/theme.ts</code></a></h3>
<p>This file defines the themes available for adventures, providing a single source of truth for their properties. It includes helper functions for theme retrieval, validation, and formatting, ensuring a consistent experience across the system.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">THEMES</code>: A centralized definition of all available themes.  </li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a>: Parses user input to match a valid theme, using keywords and IDs.  </li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L125" target="_blank" rel="noopener noreferrer"><code class="inline-code">getFormattedThemeOptions</code></a>: Returns a user-friendly list of all themes for display.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export const THEMES = {
  SPACE: {
    id: 1,
    key: &#39;space&#39;,
    displayName: &#39;Space Exploration&#39;,
    emoji: &#39;üöÄ&#39;,
    description: &#39;Journey through cosmic codebases...&#39;,
    keywords: [&#39;space&#39;, &#39;cosmic&#39;, &#39;galaxy&#39;]
  },
  MYTHICAL: { ... },
  ANCIENT: { ... },
};
</code></pre>
<ul>
<li><code class="inline-code">THEMES</code> provides a structured definition of each theme, including metadata like <code class="inline-code">id</code>, <code class="inline-code">key</code>, and <code class="inline-code">keywords</code>.  </li>
<li>The <code class="inline-code">keywords</code> property enables flexible user input matching.  </li>
<li>This design allows for easy addition of new themes without modifying core logic.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function parseTheme(input: string): AdventureTheme | null {
  const normalized = input.trim().toLowerCase();
  const exactMatch = getThemeByKey(normalized);
  if (exactMatch) return exactMatch.key as AdventureTheme;

  const numericId = parseInt(normalized, 10);
  if (!isNaN(numericId)) {
    const byId = getThemeById(numericId);
    if (byId) return byId.key as AdventureTheme;
  }
  
  for (const theme of THEMES_ARRAY) {
    if (theme.keywords.some(keyword =&gt; normalized.includes(keyword.toLowerCase()))) {
      return theme.key as AdventureTheme;
    }
  }
  return null;
}
</code></pre>
<ul>
<li>This function normalizes user input and matches it to a theme via <code class="inline-code">id</code>, <code class="inline-code">key</code>, or <code class="inline-code">keywords</code>.  </li>
<li>It demonstrates robust input handling by checking multiple criteria.  </li>
<li>The use of <code class="inline-code">THEMES_ARRAY</code> ensures the logic remains decoupled from the <code class="inline-code">THEMES</code> object.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a></h3>
<p>This file manages the loading and parsing of the <code class="inline-code">adventure.config.json</code> file, extracting relevant data for adventure generation. It ensures the configuration is validated and formatted for use in LLM prompts and other systems.</p>
<h4>Highlights</h4>
<ul>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L19" target="_blank" rel="noopener noreferrer"><code class="inline-code">loadAdventureConfig</code></a>: Reads the raw configuration file from the project directory.  </li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L41" target="_blank" rel="noopener noreferrer"><code class="inline-code">extractUniqueFilePaths</code></a>: Extracts all unique file paths referenced in the configuration.  </li>
<li><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L75" target="_blank" rel="noopener noreferrer"><code class="inline-code">formatAdventureConfigForPrompt</code></a>: Formats the configuration for efficient use in LLM prompts.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">export function loadAdventureConfig(projectPath: string): string | null {
  const configPath = path.join(projectPath, &#39;adventure.config.json&#39;);
  return readFileIfExists(configPath);
}
</code></pre>
<ul>
<li>This function abstracts file reading, handling errors gracefully.  </li>
<li>It ensures the system can operate even if the configuration file is missing.  </li>
<li>The use of <code class="inline-code">path.join</code> standardizes file path handling across environments.</li>
</ul>
<hr>
<pre><code class="language-typescript">export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (typeof node.path === &#39;string&#39; &amp;&amp; fs.existsSync(path.resolve(projectPath, node.path))) {
      unique.add(node.path.trim());
    }
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; stack.push(child));
  }

  return Array.from(unique);
}
</code></pre>
<ul>
<li>This function traverses the configuration object to extract valid file paths.  </li>
<li>It uses a stack-based approach to handle nested structures efficiently.  </li>
<li>The <code class="inline-code">Set</code> ensures all paths are unique, avoiding duplication.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use the <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> function to see how user input maps to available themes.  </li>
<li>Analyze the <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L41" target="_blank" rel="noopener noreferrer"><code class="inline-code">extractUniqueFilePaths</code></a> function to understand how nested data is processed.  </li>
<li>Review the <code class="inline-code">LLM_REQUEST_TIMEOUT</code> constant to explore how timeouts are managed across the system.</li>
</ul>
<h2>Try This</h2>
<ol>
<li><p><strong>Add a New Theme</strong>: Define a new theme in <code class="inline-code">themes.ts</code> with unique properties. Ensure it appears in the formatted options list by using <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L125" target="_blank" rel="noopener noreferrer"><code class="inline-code">getFormattedThemeOptions</code></a>.  </p>
</li>
<li><p><strong>Trace Configuration Flow</strong>: Add <code class="inline-code">console.log</code> statements to <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L19" target="_blank" rel="noopener noreferrer"><code class="inline-code">loadAdventureConfig</code></a> and <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts#L75" target="_blank" rel="noopener noreferrer"><code class="inline-code">formatAdventureConfigForPrompt</code></a> to observe how configuration data is read and transformed.  </p>
</li>
<li><p><strong>Improve Theme Matching</strong>: Modify <a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/theme.ts#L93" target="_blank" rel="noopener noreferrer"><code class="inline-code">parseTheme</code></a> to support partial keyword matching (e.g., &quot;cos&quot; for &quot;cosmic&quot;). Test the robustness of the updated function.</p>
</li>
</ol>
<hr>
<p>You have mastered all the secrets of the Starship Odyssey! Your adventure is complete.</p>
<p>Mission accomplished, cosmic navigator‚Äîyour mastery of the Stellar Configuration Hub has propelled you 80% closer to the final frontier; keep blazing through the galaxy like a supernova! ‚≠êüöÄ‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>