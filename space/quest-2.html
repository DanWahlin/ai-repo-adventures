<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 2: Stargates of Imagination: The Core Story Generator - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Set theme-aware CSS variables for animations
        document.addEventListener('DOMContentLoaded', function() {
            // Manually trigger Prism highlighting after page load
            if (window.Prism) {
                window.Prism.highlightAll();
            }
            // Detect theme from current CSS variables or default to space
            const root = document.documentElement;
            
            // Simple theme detection based on page content or default to space
            const theme = 'space' || 'space';
            
            // Set display variables for animated elements
            root.style.setProperty('--space-display', theme === 'space' ? 'block' : 'none');
            root.style.setProperty('--ancient-display', theme === 'ancient' ? 'block' : 'none');
            root.style.setProperty('--mythical-display', theme === 'mythical' ? 'block' : 'none');
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Odyssey in the Code Galaxy: Adventures Among the Stellar Repositories</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <p>Sure! Below is the content generated for <strong>Quest 2: Stargates of Imagination: The Core Story Generator</strong>.</p>
<hr>
<h1>Quest 2: Stargates of Imagination: The Core Story Generator</h1>
<hr>
<p>As the <em>Refactor Prism</em> moves deeper into the Code Galaxy, its sensors light up with an anomaly near the <strong>Stargates of Imagination</strong>. These legendary gates are said to craft stories and adventures beyond comprehension, a skill vital for our mission. The crew prepares as the <em>Refactor Prism</em> approaches a swirling vortex resembling the heart of a language model. The infinite computational architecture of the <em>Story Generator Engine</em> hums, ready to transform data streams into tales of daring quests. But beware—crossing these gates means unraveling the codebase one structured adventure at a time. Let the transformation begin!</p>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/story-generator.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/story-generator.ts</code></a>: Story Generation and Quest Crafting</h3>
<p>The <code class="inline-code">story-generator.ts</code> file lies at the heart of the Story Generator Engine, orchestrating the creation of vivid narratives and crafting themed quests. It uses Large Language Models (LLMs) to generate and adapt stories, bringing the vision of the codebase to life. The primary interface includes the <code class="inline-code">StoryGenerator</code> class, which tackles story and quest generation with precision. It collaborates with its LLM partner to construct prompts, validate code snippets, and weave narratives to specific themes like space or mythology. Notably, <code class="inline-code">generateStoryAndQuests()</code> initializes the process, leveraging LLM feedback for narrative flow, while <code class="inline-code">generateQuestContent()</code> dives deep into quest details using targeted code analysis. Each method ensures structured data and optimizations so the adventures align with user goals. Like a cosmic architect, <code class="inline-code">story-generator.ts</code> ensures coding adventures are as engaging as they are educational.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateStoryAndQuests()</code>: Generates story with quests using LLM responses tailored to the theme.</li>
<li><code class="inline-code">generateQuestContent()</code>: Creates detailed content for individual quests, integrating code-focused exploration.</li>
<li><code class="inline-code">parseMarkdownToStoryResponse()</code>: Parses markdown responses into structured story and quest data.</li>
<li><code class="inline-code">removeLLMMetaCommentary()</code>: Cleans response content to focus on user-essential outputs.</li>
<li><code class="inline-code">validateTheme()</code>: Normalizes and validates the story theme input, defaulting to the appropriate fallback.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/adventure/adventure-manager.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/adventure/adventure-manager.ts</code></a>: Orchestrator of Adventure Progression</h3>
<p>The <code class="inline-code">adventure-manager.ts</code> file acts as the mission command for the <em>Refactor Prism</em>, managing the state and flow of generated adventures. This file harnesses the <code class="inline-code">AdventureManager</code> class to connect and synchronize with the Story Generator Engine and its state. The <code class="inline-code">initializeAdventure()</code> method sets the stage by loading project data, enforcing configuration rules, and triggering story generation. It ensures smooth coordination between quests and their individual exploration pathways. Meanwhile, <code class="inline-code">exploreQuest()</code> validates user choices and executes the progression of adventures, caching completed quests for efficiency. Whether it’s managing encapsulated quest content, tracking progress percentages, or delivering polished adventure summaries, <code class="inline-code">adventure-manager.ts</code> ensures each storyline remains cohesive and empowering.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">initializeAdventure()</code>: Sets up the adventure context and links to the Story Generator Engine.</li>
<li><code class="inline-code">exploreQuest()</code>: Executes quest choices, validates input, and generates or retrieves quest content.</li>
<li><code class="inline-code">markQuestCompleted()</code>: Logs quest completion while enabling users to revisit past quests.</li>
<li><code class="inline-code">getProgress()</code>: Visualizes the percentage of adventure completion for optimal user encouragement.</li>
<li><code class="inline-code">enforceConfigQuestCount()</code>: Ensures generated quests align with configuration rules from <code class="inline-code">adventure.config.json</code>.</li>
</ul>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/shared/adventure-config.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/shared/adventure-config.ts</code></a>: Guidelines for Structuring the Journey</h3>
<p><code class="inline-code">adventure-config.ts</code> is the navigator’s compass, ensuring every quest follows a clear structure tailored to the unique needs of the user’s project. Essential functions like <code class="inline-code">parseAdventureConfig()</code> handle loading and validating settings from <code class="inline-code">adventure.config.json</code>, ensuring only feasible quests are included. The <code class="inline-code">extractUniqueFilePaths()</code> function gathers referenced file paths for focused analysis, avoiding unnecessary detours. Meanwhile, <code class="inline-code">formatAdventureConfigForPrompt()</code> enhances the quest generation process by preparing contextual guidance for the LLM. This ensures that adventures build upon solid foundations and that each generated file aligns with its thematic directives. Whether mapping out exploration zones or preparing clear analyses, this file ensures precision in every interstellar adventure.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig()</code>: Loads and validates the <code class="inline-code">adventure.config.json</code> file for structured quest information.</li>
<li><code class="inline-code">extractUniqueFilePaths()</code>: Collects and verifies referenced file paths for analysis in quests.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt()</code>: Prepares clear adventure guidelines for integration into LLM prompts.</li>
<li><code class="inline-code">loadAdventureConfig()</code>: Retrieves raw configuration content with a fallback for missing or invalid files.</li>
<li><code class="inline-code">readFileIfExists()</code>: Provides a file utility function to safely read files without system interruptions.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/adventure/story-generator.ts</h3>
<pre><code class="language-typescript">export class StoryGenerator {
  private llmClient: LLMClient;

  constructor() {
    this.llmClient = new LLMClient();
  }

  async generateStoryAndQuests(projectInfo: ProjectInfo, theme: AdventureTheme): Promise&lt;StoryResponse&gt; {
    const prompt = loadStoryGenerationPrompt({ theme, repomixContent: projectInfo.repomixContent });
    const response = await this.llmClient.generateResponse(prompt);
    const parsed = parseMarkdownToStoryResponse(response.content.trim());
    return parsed; 
  }
}
</code></pre>
<p>This function constructs stories and quests like a skilled storyteller collaborating with an imaginative AI companion.</p>
<h3>packages/core/src/adventure/adventure-manager.ts</h3>
<pre><code class="language-typescript">export class AdventureManager {
  async initializeAdventure(projectInfo: ProjectInfo, theme: AdventureTheme): Promise&lt;string&gt; {
    this.state.reset();
    this.state.projectInfo = projectInfo;
    const storyResponse = await this.storyGenerator.generateStoryAndQuests(projectInfo, theme);
    this.state.quests = storyResponse.quests;
    return this.formatStoryWithQuests(storyResponse);
  }
}
</code></pre>
<p>This module is akin to mission control, ensuring every element of the interstellar quest is fully aligned and ready for execution.</p>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}
</code></pre>
<p>Parsing configuration files is like plotting a course on a star chart, ensuring every coordinate is correct before launch.</p>
<h2>Helpful Hints</h2>
<ul>
<li>Streamline quest generation by ensuring all configuration files (like <code class="inline-code">adventure.config.json</code>) are accurate and well-structured.</li>
<li>Use <code class="inline-code">adventure-manager.ts</code> as your primary entry point for linking interactive quests with generated stories.</li>
<li>Next, explore <code class="inline-code">repo-analyzer.ts</code> to understand how project details and analysis contribute to narrative crafting.</li>
</ul>
<hr>
<p>Mission accomplished, cosmic voyager—Quest 2 complete; your storytelling core is now a supernova of creativity, fueling your starship’s journey to infinite horizons! 🚀⭐💎</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="next-quest-btn">Next: Quest 3: The Repomix Observatory: Extrac... →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>