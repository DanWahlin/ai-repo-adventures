<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 5: Configure the Ship‚Äôs Stellar Core - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Starship Nexus: Adventures in the Code Cosmos</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 5: Configure the Ship‚Äôs Stellar Core</h1>
<hr>
<p>The Starship Nexus is approaching the final frontier of its mission to decipher the secrets of the Code Cosmos. All paths lead here: the Stellar Core of the Nexus. This cosmic command hub drives theme alignment, adventure validation, and system configuration for our coding voyages. The crew must calibrate intergalactic settings to ensure seamless navigation, maximum performance, and compatibility with fluid cosmic data streams. Will you master the Stellar Core and unify the code-driven creativity of the galaxy? </p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Core Configuration Dynamics</strong>: How does the <code class="inline-code">DEFAULT_THEME</code> interact with validators, and why is theme validation essential for navigating Code Cosmos?  </li>
<li>‚ö° <strong>Code-Based Navigation</strong>: How does <code class="inline-code">extractUniqueFilePaths</code> ensure compatibility and error-free exploration of project data?  </li>
<li>üõ°Ô∏è <strong>Safety Mechanisms</strong>: What protections do <code class="inline-code">validateAdventureChoice</code> and <code class="inline-code">validateProjectPath</code> enforce to maintain safe and efficient Stellar Core operations?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/core/src/shared/config.ts:</span> Configuration constants and error handling</h3>
<p>The <code class="inline-code">config.ts</code> file defines the universal constants powering the Nexus‚Äô systems. It handles environment variables, timeout limits, and system thresholds for error handling and safe exploration. These constants ensure the Starship Nexus operates within controlled parameters to avoid data overloads or mission disruptions. </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">DEFAULT_THEME</code>: Specifies the default cosmic configuration, critical for theme-based exploration.</li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Establishes file size limitations for performance and memory efficiency in galaxy navigation.</li>
<li><code class="inline-code">ERROR_MESSAGES</code>: A collection of error definitions ensuring safe mission execution during Stellar Core calibration.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/config.ts</h3>
<pre><code class="language-typescript">export const DEFAULT_THEME = &#39;space&#39; as const;
export const MAX_FILE_SIZE_MB = 10; // Skip files larger than this to avoid memory issues
export const ERROR_MESSAGES = {
  LLM_UNAVAILABLE: &#39;LLM service is currently unavailable. Please check your configuration.&#39;,
  ANALYSIS_FAILED: &#39;Failed to analyze the project. Please ensure the path is valid.&#39;,
  THEME_INVALID: &#39;Invalid theme specified. Using default theme.&#39;,
  FILE_NOT_FOUND: &#39;The requested file could not be found.&#39;,
  PERMISSION_DENIED: &#39;Permission denied accessing the specified path.&#39;,
} as const;
</code></pre>
<ul>
<li><code class="inline-code">DEFAULT_THEME</code>: Anchors theme selection to &quot;space&quot; for consistent exploration prompts. It ensures the Starship Nexus functions even when configurations are incomplete.  </li>
<li><code class="inline-code">MAX_FILE_SIZE_MB</code>: Protects Stellar Core efficiency by excluding large files, optimizing resource allocation with a 10MB limit.  </li>
<li><code class="inline-code">ERROR_MESSAGES</code>: Provides predefined alerts for failures like invalid themes and file access issues, keeping operations secure and informative.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/input-validator.ts:</span> Validation utilities</h3>
<p>This file handles user input validation, enforcing strict rules for adventure selection, theme compatibility, and file path sanitization. These checks are vital for error prevention and aligning user inputs with mission goals.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Ensures mission selections are meaningful and non-empty.</li>
<li><code class="inline-code">validateTheme</code>: Validates cosmic theme options using robust keyword matching.</li>
<li><code class="inline-code">validateProjectPath</code>: Protects against invalid path entries and prevents disruptions due to unsafe file configurations.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/input-validator.ts</h3>
<pre><code class="language-typescript">export function validateAdventureChoice(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Choice is required&#39;);
  }
  
  if (input.length &gt; 200) {
    throw new Error(&#39;Choice too long (max 200 characters)&#39;);
  }
  
  return input.trim();
}

export function validateTheme(input: string): string {
  if (!input?.trim()) {
    throw new Error(&#39;Theme is required&#39;);
  }
  
  const normalized = input.toLowerCase().trim();
  const parsedTheme = parseTheme(normalized);
  
  if (!parsedTheme || !isValidTheme(parsedTheme)) {
    const validThemes = getAllThemes().map(t =&gt; t.key).join(&#39;, &#39;);
    throw new Error(`Invalid theme. Valid themes: ${validThemes}`);
  }
  
  return parsedTheme;
}

export function validateProjectPath(input?: string): string {
  if (!input?.trim()) {
    return process.cwd();
  }
  
  if (input.length &gt; 500) {
    throw new Error(&#39;Project path too long (max 500 characters)&#39;);
  }
  
  if (input.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Project path contains invalid characters&#39;);
  }
  
  return input.trim();
}
</code></pre>
<ul>
<li><code class="inline-code">validateAdventureChoice</code>: Guards against invalid mission selection, enforcing meaningful exploration guidelines.  </li>
<li><code class="inline-code">validateTheme</code>: Implements strict cosmic theme validation, ensuring system compatibility and seamless user navigation through the galaxy.  </li>
<li><code class="inline-code">validateProjectPath</code>: Performs sanitization and error prevention for file paths, reducing risks of unsafe operations and access issues.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/core/src/shared/adventure-config.ts:</span> Galactic file path extraction</h3>
<p>This file enables parsing and validation of Stellar Core configurations to determine file paths crucial for exploration. It ensures extracted data aligns with mission objectives and avoids resource redundancy.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Provides structured JSON parsing for config stability.</li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Identifies valid paths within galaxy data flows using recursive validation.</li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Optimizes file configuration for shorter, more efficient mission prompts.</li>
</ul>
<h2>Code</h2>
<h3>packages/core/src/shared/adventure-config.ts</h3>
<pre><code class="language-typescript">export function parseAdventureConfig(projectPath: string): unknown | null {
  const raw = loadAdventureConfig(projectPath);
  if (!raw) return null;
  try {
    return JSON.parse(raw);
  } catch {
    return null;
  }
}

export function extractUniqueFilePaths(projectPath: string): string[] {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) return [];

  const unique = new Set&lt;string&gt;();
  const stack: any[] = [parsed];

  while (stack.length) {
    const node = stack.pop();
    if (!node || typeof node !== &#39;object&#39;) continue;

    // Extract and validate path
    if (typeof node.path === &#39;string&#39; &amp;&amp; node.path.trim()) {
      const rel = node.path.trim();
      if (fs.existsSync(path.resolve(projectPath, rel))) {
        unique.add(rel);
      }
    }

    // Add children to stack
    const children = Array.isArray(node) ? node : Object.values(node);
    children.forEach(child =&gt; {
      if (child &amp;&amp; typeof child === &#39;object&#39;) stack.push(child);
    });
  }

  return Array.from(unique);
}

export function formatAdventureConfigForPrompt(projectPath: string): string {
  const parsed = parseAdventureConfig(projectPath);
  if (!parsed || typeof parsed !== &#39;object&#39;) {
    return &#39;&#39;;
  }

  const adventure = (parsed as any).adventure;
  if (!adventure || !Array.isArray(adventure.quests)) {
    return &#39;&#39;;
  }

  let formatted = `## Quest Structure\n`;

  for (const quest of adventure.quests) {
    if (!quest.title || !Array.isArray(quest.files)) continue;

    formatted += `### ${quest.title}\n`;
    
    // Just file paths, no verbose descriptions
    const filePaths = quest.files.map((f: any) =&gt; f.path).filter(Boolean);
    formatted += `Files: ${filePaths.join(&#39;, &#39;)}\n`;
    
    // Just function names, no descriptions
    const functions = quest.files
      .flatMap((f: any) =&gt; f.highlights || [])
      .map((h: any) =&gt; h.name)
      .filter(Boolean);
    formatted += `Functions: ${functions.join(&#39;, &#39;)}\n\n`;
  }

  return formatted;
}
</code></pre>
<ul>
<li><code class="inline-code">parseAdventureConfig</code>: Decodes and stabilizes the adventure configuration to support cosmic file integrations.  </li>
<li><code class="inline-code">extractUniqueFilePaths</code>: Validates and extracts file paths, providing reliable data sources for navigation commands.  </li>
<li><code class="inline-code">formatAdventureConfigForPrompt</code>: Enhances mission configuration for efficient LLM interaction and story planning.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Remember to configure constants like <code class="inline-code">DEFAULT_THEME</code> before validating other inputs to prevent initialization issues.</li>
<li>Use <code class="inline-code">extractUniqueFilePaths</code> to identify critical file paths and avoid redundant or unsafe resources during mission preparation.</li>
<li>Sanitize all inputs using safe validators to maintain voyage integrity and optimal system performance.</li>
</ul>
<hr>
<p>You have mastered all the secrets of Code Cosmos! Your adventure is complete. The crew of the Starship Nexus salutes your achievement. Fly high, intergalactic explorer!</p>
<p>‚≠ê Stellar triumph achieved! With the Ship&#39;s core now blazing brighter than a supernova, your cosmic navigation skills are propelling this mission toward the ultimate star-bound victory‚Äîone quest away from charting a legendary voyage! üöÄüíé‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="prev-quest-btn">‚Üê Previous: Quest 4</a>
        <a href="summary.html" class="next-quest-btn complete-btn">Complete Adventure ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>