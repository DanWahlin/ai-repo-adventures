<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: HTML Generator & Static Site Pipeline - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Galactic Code Chronicles: Missions Beyond the Repository</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: HTML Generator &amp; Static Site Pipeline</h1>
<hr>
<p>Aboard the starship <em>Celestial Refactor</em>, your mission shifts focus to the intricate machinery of the HTML generation core. The team is tasked with investigating the <code class="inline-code">HTMLAdventureGenerator</code>, uncovering how it transforms raw data from the interstellar codebase into dazzling static site destinations. Paired with two crucial components, the <code class="inline-code">TemplateEngine</code> and the <code class="inline-code">AssetManager</code>, you&#39;ll trace the cosmic path from blueprint templates to fully rendered HTML displays. As you uncover these interstellar pipelines, consider the adaptive brilliance behind each function and its role in ensuring the starship&#39;s automated missions succeed.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Render Coordinates</strong>: How does <code class="inline-code">renderPage</code> in the <code class="inline-code">TemplateEngine</code> convert templates into complete HTML pages? What placeholder patterns does it employ?</li>
<li>‚ö° <strong>Asset Teleportation</strong>: How does <code class="inline-code">copyGlobalAssets</code> in <code class="inline-code">AssetManager</code> ensure shared assets are available across mission paths? What safeguards are in place to avoid redundancy or failure during this process?</li>
<li>üõ°Ô∏è <strong>Pipeline Overdrive</strong>: How does <code class="inline-code">generateAdventure</code> in <code class="inline-code">HTMLAdventureGenerator</code> integrate components to create an entire adventure from theme configuration to fully generated pages? Where does state persist across its flow?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/generator/src/cli/template-engine.ts:</span> Template Rendering Logic</h3>
<p>In this file, the <code class="inline-code">TemplateEngine</code> class provides the starship with its ability to render templates into actionable HTML. By loading and caching static templates, it injects placeholders with mission-specific variables, ensuring every page aligns with the current adventure‚Äôs parameters.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Loads static template files from storage into memory, with caching for efficiency.</li>
<li><code class="inline-code">replacePlaceholders</code>: Replaces placeholders within templates (e.g., <code class="inline-code">{{CONTENT}}</code>) with dynamic variable data, ensuring the mission&#39;s context is properly reflected.</li>
<li><code class="inline-code">renderPage</code>: Integrates a base template with dynamic content to form the complete, layered HTML page for an adventure.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/template-engine.ts</h3>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
    if (this.templateCache.has(templateName)) {
      return this.templateCache.get(templateName)!;
    }

    const templatePath = path.join(this.templatesDir, templateName);
    
    try {
      const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
      this.templateCache.set(templateName, content);
      return content;
    } catch (error) {
      throw new Error(`Failed to load template ${templateName}: ${error}`);
    }
}
</code></pre>
<ul>
<li>Efficiently caches templates in-memory for repeated access, reducing I/O overhead.</li>
<li>Employs <code class="inline-code">fs.readFileSync</code> to synchronously load templates, ensuring availability before proceeding with render steps.</li>
<li>Encapsulates error handling and throws descriptive messages for troubleshooting.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
    let result = template;
    
    for (const [key, value] of Object.entries(variables)) {
      const placeholder = `{{${key}}}`;
      result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
    }
    
    return result;
}
</code></pre>
<ul>
<li>Iterates over variables, replacing <code class="inline-code">{{key}}</code> placeholders with their corresponding values.</li>
<li>Uses regex global replacement to ensure all instances of a placeholder within the template are updated.</li>
<li>Prevents null/undefined values from breaking substitution by using fallback empty strings.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
    const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
    const contentHtml = this.loadTemplate(contentTemplate);
    
    const renderedContent = this.replacePlaceholders(contentHtml, variables);
    const pageVariables = {
      ...variables,
      CONTENT: renderedContent
    };
    
    return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li>Combines multiple templates, first rendering dynamic content and then integrating it into a base page structure.</li>
<li>Extends template flexibility with nested rendering, enabling complex layouts.</li>
<li>Demonstrates separation of concerns, allowing updates to base or content templates independently.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/asset-manager.ts:</span> Asset Transportation for Adventures</h3>
<p>The <code class="inline-code">AssetManager</code> is responsible for ensuring the starship&#39;s navigational aids ‚Äì images and shared scripts ‚Äì reach their proper orbit around the newly generated adventures. It meticulously handles common assets across multi-theme missions while safeguarding against interruptions.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyGlobalAssets</code>: Transfers shared assets (SVGs, CSS) to the global directory for accessibility across adventure themes.</li>
<li><code class="inline-code">copyQuestNavigator</code>: Ensures essential files like navigators and switchers are present in the theme-specific directories.</li>
<li><code class="inline-code">copyImages</code>: Handles image transfers, respecting theme scopes and ensuring shared and specific files are appropriately placed.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<pre><code class="language-typescript">copyGlobalAssets(outputDir: string): void {
    try {
      const globalAssetsDir = path.join(outputDir, &#39;assets&#39;);
      const targetImagesDir = path.join(globalAssetsDir, &#39;images&#39;);
      fs.mkdirSync(targetImagesDir, { recursive: true });

      const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
      fs.mkdirSync(globalSharedDir, { recursive: true });
      
      const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
      globalImages.forEach(file =&gt; {
        const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
        if (fs.existsSync(sourcePath)) {
          const targetPath = path.join(globalSharedDir, file);
          fs.copyFileSync(sourcePath, targetPath);
        }
      });
    } catch (error) {
      console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy global images&#39;));
    }
}
</code></pre>
<ul>
<li>Consolidates shared assets into a unified &quot;global&quot; directory for reuse across multi-theme missions.</li>
<li>Implements defensive coding with directory existence checks to prevent redundant operations.</li>
<li>Uses <code class="inline-code">copyFileSync</code> for atomic transfers, ensuring operations succeed or fail without partial results.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/html-generator.ts:</span> Commanding the Galactic Site Pipeline</h3>
<p>This file houses the <code class="inline-code">HTMLAdventureGenerator</code>, the primary orchestrator of the HTML generation pipeline on the <em>Celestial Refactor</em>. It binds together template rendering, asset management, and multi-theme handling to deploy complete static adventure sites.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: The main mission pipeline ‚Äì processes templates, assets, and quests to construct a cohesive site.</li>
<li><code class="inline-code">generateAllThemes</code>: Supports multi-theme adventures by orchestrating parallel generation for diverse mission styles.</li>
<li><code class="inline-code">startHttpServer</code>: Launches a local server for immediate exploration of generated missions.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/html-generator.ts</h3>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
    console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));

    // Load repository URL from adventure.config.json
    const config = parseAdventureConfig(this.projectPath);
    if (config &amp;&amp; &#39;adventure&#39; in config) {
      this.repoUrl = config.adventure.url?.replace(/\/$/, &#39;&#39;) || null;
    }

    // Step 1: Analyze and initialize
    const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);
    const projectInfo = createProjectInfo(repomixContent);

    console.log(chalk.dim(&#39;‚ú® Initializing adventure...&#39;));
    const storyContent = await this.adventureManager.initializeAdventure(projectInfo, this.selectedTheme, this.projectPath);

    this.extractQuestInfo();

    // Step 2: Generate files
    console.log(chalk.dim(&#39;üé® Creating theme styling...&#39;));
    this.generateThemeCSS();

    console.log(chalk.dim(&#39;üß≠ Adding quest navigator...&#39;));
    this.copyQuestNavigator();

    console.log(chalk.dim(&#39;üñºÔ∏è Copying images...&#39;));
    this.copyImages();

    await this.generateQuestPages();

    console.log(chalk.dim(&#39;üéâ Adventure generation complete.&#39;));
}
</code></pre>
<ul>
<li>Outlines the entire static site generation process, highlighting reusable components like <code class="inline-code">repomixContent</code> and <code class="inline-code">initializeAdventure</code>.</li>
<li>Divides the pipeline into distinct stages: preprocessing, content generation, and asset deployment, for logical progression.</li>
<li>Leverages helper methods to encapsulate logic for CSS, images, and quest management, maintaining readability.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Use Placeholders Wisely</strong>: When investigating template rendering, pay close attention to placeholder names and their variable mappings within <code class="inline-code">replacePlaceholders</code>.</li>
<li><strong>Combat Missing Assets</strong>: If the mission payload lacks images or CSS, check for directory existence and permissions in <code class="inline-code">copyGlobalAssets</code>.</li>
<li><strong>Expand Mission Horizons</strong>: Dive into multi-theme handling in <code class="inline-code">generateAllThemes</code> to explore how the pipeline adapts for diverse configurations.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>Mission accomplished, Starcoder‚Äîyour successful launch of the HTML Generator &amp; Static Site Pipeline has propelled you into the coding cosmos at warp speed toward the next stellar quest! ‚≠êüöÄ‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>