<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 1: Stellar Site Forge - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Cosmic Code Chronicles: A stellar voyage into exploration systems</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 1: Stellar Site Forge</h1>
<hr>
<p>Your starship&#39;s AI systems flicker to life as you approach the cosmic repository of intergalactic data streams. The Stellar Site Forge‚Äîan advanced modular framework‚Äîlies dormant, waiting to be activated. This galaxy-wide hub is the backbone of starship adventures, generating dynamic websites that document missions with precision. Your task is to unlock its secrets and understand the intricate connections between modules managing templates, assets, and content generation. Strap in, astronaut, and navigate the codebase&#39;s core functions to bring the forge to life.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Template Transmutation</strong>: How does the <code class="inline-code">TemplateEngine</code> dynamically replace placeholders within HTML templates to ensure seamless story generation?</li>
<li>‚ö° <strong>Asset Assimilation</strong>: What strategies does <code class="inline-code">AssetManager</code> use to copy and organize assets for single- and multi-theme site generation?</li>
<li>üõ°Ô∏è <strong>Adventure Bootstrap</strong>: How does <code class="inline-code">generateAdventure</code> orchestrate the creation of usable HTML files, ensuring a smooth thematic experience?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">packages/generator/src/cli/template-engine.ts:</span> Handles Template Loading &amp; Rendering</h3>
<p>The <code class="inline-code">TemplateEngine</code> is a critical module that processes HTML templates, dynamically replacing placeholders with mission-specific variables. It maintains a cache for loaded templates, reducing redundancy and enhancing system performance. This module ensures that both individual template fragments and full pages are rendered dynamically, creating a cohesive user experience.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">loadTemplate</code>: Loads HTML files from the <code class="inline-code">templates</code> directory, using caching for efficiency. Ensures templates are accessible for all rendering operations.</li>
<li><code class="inline-code">replacePlaceholders</code>: Parses placeholders (e.g., <code class="inline-code">{{VARIABLE}}</code>) in loaded templates and replaces them with provided values, building dynamic HTML fragments.</li>
<li><code class="inline-code">renderPage</code>: Combines a base template (e.g., <code class="inline-code">base-template.html</code>) with mission-specific content, ensuring scalable and structured page generation.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/template-engine.ts</h3>
<pre><code class="language-typescript">private loadTemplate(templateName: string): string {
  if (this.templateCache.has(templateName)) {
    return this.templateCache.get(templateName)!;
  }

  const templatePath = path.join(this.templatesDir, templateName);
  
  try {
    const content = fs.readFileSync(templatePath, &#39;utf-8&#39;);
    this.templateCache.set(templateName, content);
    return content;
  } catch (error) {
    throw new Error(`Failed to load template ${templateName}: ${error}`);
  }
}
</code></pre>
<ul>
<li><strong>Caching</strong>: Templates are cached to avoid redundant file read operations, enhancing performance.</li>
<li><strong>Robust Error Handling</strong>: Error messages include the template name for debugging clarity.</li>
<li><strong>Flexibility</strong>: Loaded templates can be reused across the entire system.</li>
</ul>
<hr>
<pre><code class="language-typescript">private replacePlaceholders(template: string, variables: TemplateVariables): string {
  let result = template;
  
  for (const [key, value] of Object.entries(variables)) {
    const placeholder = `{{${key}}}`;
    result = result.replace(new RegExp(placeholder, &#39;g&#39;), value || &#39;&#39;);
  }
  
  return result;
}
</code></pre>
<ul>
<li><strong>Dynamic Replacement</strong>: Custom values are injected by replacing placeholders, enabling seamless integration of contextual content.</li>
<li><strong>Pattern Matching</strong>: Uses regular expressions to handle multiple instances of the same placeholder.</li>
<li><strong>Adaptability</strong>: Allows substitution across diverse templates and placeholders.</li>
</ul>
<hr>
<pre><code class="language-typescript">renderPage(contentTemplate: string, variables: TemplateVariables): string {
  const baseTemplate = this.loadTemplate(&#39;base-template.html&#39;);
  const contentHtml = this.loadTemplate(contentTemplate);
  
  const renderedContent = this.replacePlaceholders(contentHtml, variables);
  const pageVariables = {
    ...variables,
    CONTENT: renderedContent
  };
  
  return this.replacePlaceholders(baseTemplate, pageVariables);
}
</code></pre>
<ul>
<li><strong>Structured Page Rendering</strong>: Sequentially combines content and base templates, facilitating modular development.</li>
<li><strong>Custom Embed Support</strong>: Injects rendered content into the base template using a <code class="inline-code">CONTENT</code> variable.</li>
<li><strong>Scalability</strong>: Can support a wide range of templates for large-scale missions.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/asset-manager.ts:</span> Asset Operations for Themes</h3>
<p>The <code class="inline-code">AssetManager</code> module ensures that all visual and shared assets are correctly copied to the appropriate directories. The system is optimized for both single-theme and multi-theme adventures, making sure every layout is visually consistent and functionally complete.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">copyImages</code>: Copies theme-specific and shared images into accessible directories, preparing them for site deployment.</li>
<li><code class="inline-code">copySharedNavigator</code>: Gathers and organizes shared CSS, JavaScript, and navigational assets into global locations for multi-theme usage.</li>
<li><code class="inline-code">copyGlobalAssets</code>: Handles global assets like header images and branding logos, ensuring consistent visuals across all outputs.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/asset-manager.ts</h3>
<pre><code class="language-typescript">copyImages(outputDir: string, isMultiTheme: boolean = false): void {
  const sourceImagesDir = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;);
  const sourceSharedDir = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;);
  const targetImagesDir = path.join(outputDir, &#39;assets&#39;, &#39;images&#39;);
  const targetSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);

  try {
    if (fs.existsSync(sourceImagesDir)) {
      fs.mkdirSync(targetImagesDir, { recursive: true });
      const imageFiles = fs.readdirSync(sourceImagesDir);
      imageFiles.forEach(file =&gt; {
        const sourcePath = path.join(sourceImagesDir, file);
        const targetPath = path.join(targetImagesDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      });
    }

    if (fs.existsSync(sourceSharedDir)) {
      fs.mkdirSync(targetSharedDir, { recursive: true });
      const sharedFiles = fs.readdirSync(sourceSharedDir);
      sharedFiles.forEach(file =&gt; {
        const sourcePath = path.join(sourceSharedDir, file);
        const targetPath = path.join(targetSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      });
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy images from source directory&#39;));
  }
}
</code></pre>
<ul>
<li><strong>Multi-Theme Optimization</strong>: Differentiates between theme-specific and shared assets for organizational clarity.</li>
<li><strong>Fail-Safe Execution</strong>: Uses <code class="inline-code">try-catch</code> blocks to prevent process failures from blocking mission-critical tasks.</li>
<li><strong>Scalability</strong>: Supports large asset directories with recursive creation mechanisms.</li>
</ul>
<hr>
<pre><code class="language-typescript">copySharedNavigator(rootOutputDir: string): void {
  const templatesDir = path.join(this.sourceDir, &#39;templates&#39;);
  const assetsDir = path.join(this.sourceDir, &#39;assets&#39;);
  const cssSource = path.join(templatesDir, &#39;quest-navigator.css&#39;);
  const jsSource = path.join(templatesDir, &#39;quest-navigator.js&#39;);
  const svgSource = path.join(templatesDir, &#39;compass-icon.svg&#39;);
  
  const sharedAssetsDir = path.join(rootOutputDir, &#39;assets&#39;, &#39;shared&#39;);
  fs.mkdirSync(sharedAssetsDir, { recursive: true });

  if (fs.existsSync(cssSource)) {
    fs.copyFileSync(cssSource, path.join(sharedAssetsDir, &#39;quest-navigator.css&#39;));
  }
  if (fs.existsSync(jsSource)) {
    fs.copyFileSync(jsSource, path.join(sharedAssetsDir, &#39;quest-navigator.js&#39;));
  }
  if (fs.existsSync(svgSource)) {
    fs.copyFileSync(svgSource, path.join(sharedAssetsDir, &#39;compass-icon.svg&#39;));
  }
}
</code></pre>
<ul>
<li><strong>Shared Component Management</strong>: Consolidates CSS, JavaScript, and SVG files into a single, accessible location for reuse.</li>
<li><strong>Theme Compatibility</strong>: Supports assets across multiple themes with consistent directory structures.</li>
<li><strong>Efficiency</strong>: Reduces redundancy by centralizing key navigational assets.</li>
</ul>
<hr>
<pre><code class="language-typescript">copyGlobalAssets(outputDir: string): void {
  try {
    const globalSharedDir = path.join(outputDir, &#39;assets&#39;, &#39;shared&#39;);
    fs.mkdirSync(globalSharedDir, { recursive: true });
    
    const globalImages = [&#39;github-mark.svg&#39;, &#39;github-mark-white.svg&#39;];
    globalImages.forEach(file =&gt; {
      const sourcePath = path.join(this.sourceDir, &#39;assets&#39;, &#39;shared&#39;, file);
      if (fs.existsSync(sourcePath)) {
        const targetPath = path.join(globalSharedDir, file);
        fs.copyFileSync(sourcePath, targetPath);
      }
    });

    const headerImageSource = path.join(this.sourceDir, &#39;assets&#39;, &#39;images&#39;, &#39;ai-adventures.png&#39;);
    if (fs.existsSync(headerImageSource)) {
      const headerImageTarget = path.join(outputDir, &#39;assets&#39;, &#39;images&#39;, &#39;ai-adventures.png&#39;);
      fs.copyFileSync(headerImageSource, headerImageTarget);
    }
  } catch (error) {
    console.log(chalk.yellow(&#39;‚ö†Ô∏è Warning: Could not copy global images&#39;));
  }
}
</code></pre>
<ul>
<li><strong>Global Branding</strong>: Copies essential branding elements like logos and header images universally across themes.</li>
<li><strong>Centralized Asset Management</strong>: Creates a structured directory for critical shared assets.</li>
<li><strong>Error Resilience</strong>: Ensures that even partial asset failures do not impact the overall system.</li>
</ul>
<hr>
<h3><span class="header-prefix">packages/generator/src/cli/html-generator.ts:</span> Adventure Generation Entry Point</h3>
<p>The <code class="inline-code">HTMLAdventureGenerator</code> class is the epicenter of the Stellar Site Forge. It manages the entire workflow from template rendering to asset copying and file generation. This overarching structure ensures that all system components work in harmony.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">generateAdventure</code>: Orchestrates the end-to-end creation of HTML adventures, utilizing <code class="inline-code">TemplateEngine</code> and <code class="inline-code">AssetManager</code>.</li>
<li><code class="inline-code">generateAllThemes</code>: Facilitates multi-theme generation by creating isolated outputs for each selected theme.</li>
<li><code class="inline-code">startHttpServer</code>: Sets up a web server for previewing the generated site, ensuring mission readiness before launch.</li>
</ul>
<h2>Code</h2>
<h3>packages/generator/src/cli/html-generator.ts</h3>
<pre><code class="language-typescript">async generateAdventure(): Promise&lt;void&gt; {
  console.log(chalk.yellow.bold(&#39;üöÄ Generating Adventure...&#39;));
  console.log();

  // Load repository URL from adventure.config.json
  const config = parseAdventureConfig(this.projectPath);
  if (config &amp;&amp; typeof config === &#39;object&#39; &amp;&amp; &#39;adventure&#39; in config) {
    const adventure = (config as any).adventure;
    if (adventure &amp;&amp; typeof adventure.url === &#39;string&#39;) {
      this.repoUrl = adventure.url.replace(/\/$/, &#39;&#39;); // Remove trailing slash
    }
  }

  console.log(chalk.dim(&#39;üìä Analyzing codebase...&#39;));
  const repomixContent = await repoAnalyzer.generateRepomixContext(this.projectPath);

  console.log(chalk.dim(&#39;‚ú® Generating themed story and quests...&#39;));
  const storyContent = await this.adventureManager.initializeAdventure(
    createProjectInfo(repomixContent), 
    this.selectedTheme, 
    this.projectPath
  );

  console.log(chalk.dim(&#39;üìñ Generating quest pages...&#39;));
  const quests = this.adventureManager.getAllQuests();
  for (const quest of quests) {
    // Generate individual quest files
    const content = this.adventureManager.exploreQuest(quest.id);
    const html = this.buildQuestHTML(quest, content, quests.indexOf(quest));
    fs.writeFileSync(path.join(this.outputDir, `quest-${quest.id}.html`), html);
  }
}
</code></pre>
<ul>
<li><strong>End-to-End Workflow</strong>: Executes the complete adventure creation pipeline, delegating tasks to associated modules.</li>
<li><strong>Repository Integration</strong>: Loads repository details to tailor generated content.</li>
<li><strong>Atomic Generation</strong>: Processes quests individually, allowing for easy debugging and incremental builds.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>üåå Inject dynamic quest configurations by modifying <code class="inline-code">TemplateEngine.replacePlaceholders</code>.</li>
<li>üó∫Ô∏è Organize assets for new themes efficiently using <code class="inline-code">AssetManager.copyImages</code>.</li>
<li>‚öôÔ∏è Tailor the full generation pipeline with adjustments in <code class="inline-code">generateAdventure</code>.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Stellar Site Forge.</p>
<p>Congratulations, cosmic explorer‚ÄîQuest 1: Stellar Site Forge has been completed, igniting your engines for intergalactic greatness with 5 missions on the horizon! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom nav-next-only">
        <a href="quest-2.html" class="next-quest-btn">Next: Quest 2 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>