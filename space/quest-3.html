<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 3: Analyzing Nebulae of Code - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body>

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="index.html">Voyage of the Galactic Repository</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/danwahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="assets/images/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 3: Analyzing Nebulae of Code</h1>
<hr>
<p>The galactic federation has directed the starship <em>Codeseeker-42</em> toward the swirling nebulae of configuration and code within uncharted repositories. As the chief navigator, you must decipher energy pulsations emanating from the files <em>repo-analyzer.ts</em> and <em>llm-client.ts</em>, ensuring stellar documentation for future explorers. Decode cosmic analysis through repomix systems, computing LLM responses to chart a course through the galaxy’s vast coding depths.</p>
<h2>File Exploration</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/analyzer/repo-analyzer.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/analyzer/repo-analyzer.ts</code></a>: Repomix Integration for Codebase Navigations</h3>
<p>The <em>repo-analyzer</em> file is a key subsystem in <em>Codeseeker-42</em>, running repomix for extracting contextual knowledge from unknown codebases. It provides dynamic target file validations to prevent unsafe explorations into forbidden data zones. The <code class="inline-code">RepoAnalyzer</code> class, much like a stellar probe, uses its <code class="inline-code">generateTargetedContent</code> and <code class="inline-code">generateRepomixContext</code> methods to isolate relevant information amidst the chaos of cosmic data streams.</p>
<h4>Highlights</h4>
<ul>
<li><strong>RepoAnalyzer.generateRepomixContext</strong>: Generates full project insights, caching results to conserve computational energy.</li>
<li><strong>RepoAnalyzer.generateTargetedContent</strong>: Extracts repomix outputs for specific files using controlled file inclusion.</li>
<li><strong>RepoAnalyzer.validateProjectPath</strong>: Ensures exploration remains secure, avoiding dangerous interstellar directory traversal.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/analyzer/repo-analyzer.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/analyzer/repo-analyzer.ts</code></a></h3>
<pre><code class="language-typescript">async generateRepomixContext(projectPath: string, options: RepomixOptions = {}): Promise&lt;string&gt; {
  this.validateProjectPath(projectPath);
  const configuredFiles = extractUniqueFilePaths(projectPath);

  if (configuredFiles.length &gt; 0) {
    try {
      return await this.generateTargetedContent(projectPath, configuredFiles);
    } catch (error) {
      console.warn(`Fallback due to failure: ${error.message}`);
    }
  }
  
  const cacheKey = `${path.resolve(projectPath)}:${JSON.stringify(options)}`;
  const cached = this.cache.get(cacheKey);
  if (cached &amp;&amp; (Date.now() - cached.timestamp) &lt; REPOMIX_CACHE_TTL) {
    return cached.content;
  }

  // Ignored patterns for uncharted directory zones
  try {
    const ignorePatterns = [&#39;node_modules&#39;, &#39;dist&#39;, &#39;.git&#39;];
    const cliOptions = { style: options.style || &#39;markdown&#39;, compress: true, ignore: ignorePatterns.join(&#39;,&#39;) };
    const context = await this.captureRepomixStdout([&#39;.&#39;], projectPath, cliOptions);
    this.cache.set(cacheKey, { content: context, timestamp: Date.now() });
    
    return context;
  } catch (error) {
    throw new Error(`Repomix failed: ${error.message}`);
  }
}
</code></pre>
<p>Much like charting unexplored star systems, this function uses caching to conserve resources while navigating vast galactic repositories.</p>
<pre><code class="language-typescript">async generateTargetedContent(projectPath: string, targetFiles: string[], compress: boolean = true): Promise&lt;string&gt; {
  this.validateProjectPath(projectPath);
  
  if (!targetFiles || targetFiles.length === 0) {
    throw new Error(&#39;Target files required!&#39;);
  }
  
  const safeFiles = this.validateAndNormalizeTargetFiles(projectPath, targetFiles);
  if (safeFiles.length === 0) {
    throw new Error(&#39;No valid files!&#39;);
  }

  const cacheKey = `${path.resolve(projectPath)}:targeted:${safeFiles.join(&#39;,&#39;)} compress=${compress}`;
  const cached = this.cache.get(cacheKey);
  if (cached &amp;&amp; (Date.now() - cached.timestamp) &lt; REPOMIX_CACHE_TTL) {
    return cached.content;
  }

  const cliOptions: CliOptions = { style: &#39;markdown&#39;, compress, include: safeFiles.join(&#39;,&#39;) };
  const context = await this.captureRepomixStdout([&#39;.&#39;], projectPath, cliOptions);
  this.cache.set(cacheKey, { content: context, timestamp: Date.now() });
  
  return context;
}
</code></pre>
<p>This “targeted nebula probe” avoids exploring irrelevant cosmic data zones by focusing only on validated galactic hotspots.</p>
<pre><code class="language-typescript">private validateProjectPath(projectPath: string): void {
  if (!projectPath || typeof projectPath !== &#39;string&#39; || projectPath.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Invalid project path!&#39;);
  }

  const trimmedPath = projectPath.trim();
  if (!trimmedPath || trimmedPath.includes(&#39;\0&#39;)) {
    throw new Error(&#39;Unsafe path detected!&#39;);
  }
}
</code></pre>
<p>Function as a galactic firewall, ensuring only safe star systems are navigated by ignoring invalid or malicious paths.</p>
<hr>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/llm/llm-client.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/llm/llm-client.ts</code></a>: Interstellar Communication via LLM</h3>
<p>The <em>llm-client</em> file enables <em>Codeseeker-42</em> to connect with LLM providers like OpenAI and Azure OpenAI. Its intelligence systems analyze prompts and convert their cosmic mysteries into actionable insights. The <code class="inline-code">LLMClient</code> class is a universal translator that facilitates rich interstellar dialogue by managing API integration and formatting responses.</p>
<h4>Highlights</h4>
<ul>
<li><strong>LLMClient.generateResponse</strong>: Constructs an intelligent response from raw prompt inputs, ensuring timely communication across vast distances.</li>
<li><strong>LLMClient.constructor</strong>: Configures the client for OpenAI or Azure protocols, depending on the destination.</li>
<li><strong>LLMClient.getApiKey</strong>: Selects the optimal API key for secure data transmission to the right galactic endpoint.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/danwahlin/ai-repo-adventures/blob/main/packages/core/src/llm/llm-client.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">packages/core/src/llm/llm-client.ts</code></a></h3>
<pre><code class="language-typescript">async generateResponse(prompt: string, options?: LLMRequestOptions): Promise&lt;LLMResponse&gt; {
  try {
    const requestParams = this.buildRequestParams(prompt, options);
    const completion = await this.executeRequest(requestParams);

    let content = this.validateResponse(completion);
    if (options?.responseFormat === &#39;json_object&#39;) {
      content = this.cleanJsonResponse(content);
    }

    this.logTokenUsage(completion);
    return { content };
  } catch (error) {
    const message = error instanceof Error ? error.message : &#39;Unknown error&#39;;
    throw new Error(`LLM failed: ${message}`);
  }
}
</code></pre>
<p>Much like decoding alien transmissions, the function processes prompts and extracts clear messages from encrypted signals.</p>
<pre><code class="language-typescript">constructor() {
  this.model = LLM_MODEL;
  const apiKey = this.getApiKey();
  if (!apiKey || !LLM_BASE_URL) {
    throw new Error(&#39;Missing configuration!&#39;);
  }

  if (this.isAzureOpenAI()) {
    const azureEndpoint = LLM_BASE_URL.split(&#39;/openai/deployments&#39;)[0];
    this.client = new AzureOpenAI({ endpoint: azureEndpoint, apiKey, apiVersion: LLM_API_VERSION });
  } else {
    this.client = new OpenAI({ apiKey, baseURL: LLM_BASE_URL });
  }
}
</code></pre>
<p>Configures the LLM communication system to ensure interaction with the correct planetary intelligence protocols.</p>
<pre><code class="language-typescript">private getApiKey(): string {
  if (LLM_BASE_URL.includes(&#39;models.inference.ai.azure.com&#39;)) {
    if (!GITHUB_TOKEN) throw new Error(&#39;GitHub key missing!&#39;);
    return GITHUB_TOKEN;
  }

  if (!LLM_API_KEY) throw new Error(&#39;API key missing!&#39;);
  return LLM_API_KEY;
}
</code></pre>
<p>Acts as a Galactic Authorization Identifier, selecting the correct key to pass security gates of distant galactic endpoints.</p>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Use caching to save energy by avoiding redundant computation during repomix analysis cycles.</li>
<li>Validate paths and file sizes carefully to avoid interstellar accidents while navigating repository nebulae.</li>
<li>Debug LLM errors using enhanced logs to pinpoint communication issues with the galactic API provider.</li>
</ul>
<hr>
<p>Your analysis of the swirling nebulae of code has illuminated pathways for future explorers. Keep navigating with precision, brave adventurer!</p>
<p>With cosmic precision, you&#39;ve navigated through the stellar maze of Quest 3, decoding the nebulae of complexity—your mission shines brighter than a supernova as you rocket toward mastery at warp speed! ⭐🚀💎</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-4.html" class="next-quest-btn">Next: Quest 4: Setting Stellar Trajectories →</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
</body>
</html>